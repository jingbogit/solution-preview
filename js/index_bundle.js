!function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/build",t(t.s=95)}([function(e,t){e.exports=React},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ReactCSS=t.loop=t.handleActive=t.handleHover=t.hover=void 0;var i=r(123),o=n(i),a=r(196),s=n(a),l=r(221),u=n(l),c=r(222),h=n(c),d=r(223),f=n(d),p=r(224),m=n(p);t.hover=h.default,t.handleHover=h.default,t.handleActive=f.default,t.loop=m.default;var v=t.ReactCSS=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=(0,o.default)(r),a=(0,s.default)(e,i);return(0,u.default)(a)};t.default=v},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(225);Object.defineProperty(t,"Alpha",{enumerable:!0,get:function(){return n(i).default}});var o=r(89);Object.defineProperty(t,"Checkboard",{enumerable:!0,get:function(){return n(o).default}});var a=r(228);Object.defineProperty(t,"EditableInput",{enumerable:!0,get:function(){return n(a).default}});var s=r(229);Object.defineProperty(t,"Hue",{enumerable:!0,get:function(){return n(s).default}});var l=r(231);Object.defineProperty(t,"Saturation",{enumerable:!0,get:function(){return n(l).default}});var u=r(91);Object.defineProperty(t,"ColorWrap",{enumerable:!0,get:function(){return n(u).default}});var c=r(239);Object.defineProperty(t,"Swatch",{enumerable:!0,get:function(){return n(c).default}})},function(e,t){var r=Array.isArray;e.exports=r},function(e,t,r){var n=r(56),i="object"==typeof self&&self&&self.Object===Object&&self,o=n||i||Function("return this")();e.exports=o},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function o(e){if(h===clearTimeout)return clearTimeout(e);if((h===n||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function a(){m&&f&&(m=!1,f.length?p=f.concat(p):v=-1,p.length&&s())}function s(){if(!m){var e=i(a);m=!0;for(var t=p.length;t;){for(f=p,p=[];++v<t;)f&&f[v].run();v=-1,t=p.length}f=null,m=!1,o(e)}}function l(e,t){this.fun=e,this.array=t}function u(){}var c,h,d=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(e){c=r}try{h="function"==typeof clearTimeout?clearTimeout:n}catch(e){h=n}}();var f,p=[],m=!1,v=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];p.push(new l(e,t)),1!==p.length||m||i(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=u,d.addListener=u,d.once=u,d.off=u,d.removeListener=u,d.removeAllListeners=u,d.emit=u,d.prependListener=u,d.prependOnceListener=u,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u={sliderContainer:{width:"100%",padding:"8px 0 8px 0",margin:"0 0 0 0"},slider:{width:"90%",margin:"0 auto 0 auto"},box:{width:"100%",fontSize:"12px",backgroundColor:"#2a2b2d",border:"none",borderRadius:"3px",textAlign:"center"}},c=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleChange=r.handleChange.bind(r),r.state={value:e.defaultValue},r}return o(t,e),a(t,[{key:"handleChange",value:function(e){if(e.target.value.indexOf(".")!==e.target.value.length-1&&(0!==e.target.value.indexOf("0")||1!==e.target.value.length)){var t=parseFloat(e.target.value);if(isNaN(t))return this.refs.inputBox.value=this.state.value,void(this.refs.slider.value=this.state.value);if(t>this.props.max&&(t=parseFloat(this.props.max)),t<this.props.min&&(t=parseFloat(this.props.min)),this.props.handler)try{this.props.handler(t)}catch(e){return this.refs.inputBox.value=this.state.value,void(this.refs.slider.value=this.state.value)}this.refs.inputBox.value=t,this.refs.slider.value=t,this.setState({value:t})}}},{key:"componentDidMount",value:function(){var e=this.refs.slider.clientHeight;this.setState({height:3*e})}},{key:"componentWillReceiveProps",value:function(e){this.refs.slider.value=e.defaultValue,this.refs.inputBox.value=e.defaultValue,this.setState({value:e.defaultValue})}},{key:"render",value:function(){var e=this,t=this.refs.slider&&this.state.height?Math.round((this.state.height-this.refs.slider.clientHeight)/2):0;return t+="px",l.default.createElement("div",{className:"row",style:u.sliderContainer},l.default.createElement("div",{className:"col-sm-9",style:{top:t,paddingRight:"0px"}},l.default.createElement("input",{className:"myslider",style:u.slider,type:"range",min:this.props.min,max:this.props.max,ref:"slider",defaultValue:this.state.value,step:this.props.step,onInput:this.handleChange})),l.default.createElement("div",{className:"col-sm-3",style:{paddingLeft:"0px"}},l.default.createElement("input",{style:Object.assign({},u.box,this.state.height&&{height:this.state.height}),type:"text",defaultValue:this.state.value,onInput:this.handleChange,ref:"inputBox",onClick:function(){e.refs.inputBox.focus()}})))}}]),t}(l.default.Component);t.default=c},function(e,t){function r(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}e.exports=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.red=void 0;var i=r(236),o=n(i),a=r(238),s=n(a);t.default={simpleCheckForValidColor:function(e){var t=["r","g","b","a","h","s","a","v"],r=0,n=0;return(0,o.default)(t,function(t){e[t]&&(r+=1,isNaN(e[t])||(n+=1))}),r===n&&e},toState:function(e,t){var r=e.hex?(0,s.default)(e.hex):(0,s.default)(e),n=r.toHsl(),i=r.toHsv(),o=r.toRgb(),a=r.toHex();return 0===n.s&&(n.h=t||0,i.h=t||0),{hsl:n,hex:"000000"===a&&0===o.a?"transparent":"#"+a,rgb:o,hsv:i,oldHue:e.h||t||n.h,source:e.source}},isValidHex:function(e){return(0,s.default)(e).isValid()}};t.red={hsl:{a:1,h:0,l:.5,s:1},hex:"#ff0000",rgb:{r:255,g:0,b:0,a:1},hsv:{h:0,s:1,v:1,a:1}}},function(e,t,r){function n(e,t){return(s(e)?i:a)(e,o(t,3))}var i=r(66),o=r(138),a=r(194),s=r(3);e.exports=n},function(module,exports,__webpack_require__){!function(e,t){module.exports=t()}(0,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=45)}([function(e,t,r){"use strict";function n(){}function i(e,t){this.x=e||0,this.y=t||0}function o(e,t,r,n,a,s,l,u,c,h){Object.defineProperty(this,"id",{value:ks++}),this.uuid=Ts.generateUUID(),this.name="",this.image=void 0!==e?e:o.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:o.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:wa,this.wrapT=void 0!==n?n:wa,this.magFilter=void 0!==a?a:Ta,this.minFilter=void 0!==s?s:Sa,this.anisotropy=void 0!==c?c:1,this.format=void 0!==l?l:Va,this.type=void 0!==u?u:Ca,this.offset=new i(0,0),this.repeat=new i(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==h?h:vs,this.version=0,this.onUpdate=null}function a(e,t,r,n){this.x=e||0,this.y=t||0,this.z=r||0,this.w=void 0!==n?n:1}function s(e,t,r){this.uuid=Ts.generateUUID(),this.width=e,this.height=t,this.scissor=new a(0,0,e,t),this.scissorTest=!1,this.viewport=new a(0,0,e,t),r=r||{},void 0===r.minFilter&&(r.minFilter=Ta),this.texture=new o(void 0,void 0,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}function l(e,t,r){s.call(this,e,t,r),this.activeCubeFace=0,this.activeMipMapLevel=0}function u(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._w=void 0!==n?n:1}function c(e,t,r){this.x=e||0,this.y=t||0,this.z=r||0}function h(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function d(e,t,r,n,i,a,s,l,u,c,h,d){o.call(this,null,a,s,l,u,c,n,i,h,d),this.image={data:e,width:t,height:r},this.magFilter=void 0!==u?u:Ma,this.minFilter=void 0!==c?c:Ma,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function f(e,t,r,n,i,a,s,l,u,c){e=void 0!==e?e:[],t=void 0!==t?t:fa,o.call(this,e,t,r,n,i,a,s,l,u,c),this.flipY=!1}function p(){this.seq=[],this.map={}}function m(e,t,r){var n=e[0];if(n<=0||n>0)return e;var i=t*r,o=Ps[i];if(void 0===o&&(o=new Float32Array(i),Ps[i]=o),0!==t){n.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=r,e[a].toArray(o,s)}return o}function v(e,t){var r=Os[t];void 0===r&&(r=new Int32Array(t),Os[t]=r);for(var n=0;n!==t;++n)r[n]=e.allocTextureUnit();return r}function g(e,t){e.uniform1f(this.addr,t)}function y(e,t){e.uniform1i(this.addr,t)}function b(e,t){void 0===t.x?e.uniform2fv(this.addr,t):e.uniform2f(this.addr,t.x,t.y)}function _(e,t){void 0!==t.x?e.uniform3f(this.addr,t.x,t.y,t.z):void 0!==t.r?e.uniform3f(this.addr,t.r,t.g,t.b):e.uniform3fv(this.addr,t)}function w(e,t){void 0===t.x?e.uniform4fv(this.addr,t):e.uniform4f(this.addr,t.x,t.y,t.z,t.w)}function x(e,t){e.uniformMatrix2fv(this.addr,!1,t.elements||t)}function M(e,t){void 0===t.elements?e.uniformMatrix3fv(this.addr,!1,t):(Ls.set(t.elements),e.uniformMatrix3fv(this.addr,!1,Ls))}function E(e,t){void 0===t.elements?e.uniformMatrix4fv(this.addr,!1,t):(Rs.set(t.elements),e.uniformMatrix4fv(this.addr,!1,Rs))}function A(e,t,r){var n=r.allocTextureUnit();e.uniform1i(this.addr,n),r.setTexture2D(t||Ss,n)}function T(e,t,r){var n=r.allocTextureUnit();e.uniform1i(this.addr,n),r.setTextureCube(t||Cs,n)}function k(e,t){e.uniform2iv(this.addr,t)}function S(e,t){e.uniform3iv(this.addr,t)}function C(e,t){e.uniform4iv(this.addr,t)}function P(e){switch(e){case 5126:return g;case 35664:return b;case 35665:return _;case 35666:return w;case 35674:return x;case 35675:return M;case 35676:return E;case 35678:case 36198:return A;case 35680:return T;case 5124:case 35670:return y;case 35667:case 35671:return k;case 35668:case 35672:return S;case 35669:case 35673:return C}}function O(e,t){e.uniform1fv(this.addr,t)}function R(e,t){e.uniform1iv(this.addr,t)}function L(e,t){e.uniform2fv(this.addr,m(t,this.size,2))}function I(e,t){e.uniform3fv(this.addr,m(t,this.size,3))}function B(e,t){e.uniform4fv(this.addr,m(t,this.size,4))}function D(e,t){e.uniformMatrix2fv(this.addr,!1,m(t,this.size,4))}function j(e,t){e.uniformMatrix3fv(this.addr,!1,m(t,this.size,9))}function z(e,t){e.uniformMatrix4fv(this.addr,!1,m(t,this.size,16))}function N(e,t,r){var n=t.length,i=v(r,n);e.uniform1iv(this.addr,i);for(var o=0;o!==n;++o)r.setTexture2D(t[o]||Ss,i[o])}function U(e,t,r){var n=t.length,i=v(r,n);e.uniform1iv(this.addr,i);for(var o=0;o!==n;++o)r.setTextureCube(t[o]||Cs,i[o])}function F(e){switch(e){case 5126:return O;case 35664:return L;case 35665:return I;case 35666:return B;case 35674:return D;case 35675:return j;case 35676:return z;case 35678:return N;case 35680:return U;case 5124:case 35670:return R;case 35667:case 35671:return k;case 35668:case 35672:return S;case 35669:case 35673:return C}}function H(e,t,r){this.id=e,this.addr=r,this.setValue=P(t.type)}function V(e,t,r){this.id=e,this.addr=r,this.size=t.size,this.setValue=F(t.type)}function G(e){this.id=e,p.call(this)}function W(e,t){e.seq.push(t),e.map[t.id]=t}function X(e,t,r){var n=e.name,i=n.length;for(Is.lastIndex=0;;){var o=Is.exec(n),a=Is.lastIndex,s=o[1],l="]"===o[2],u=o[3];if(l&&(s|=0),void 0===u||"["===u&&a+2===i){W(r,void 0===u?new H(s,e,t):new V(s,e,t));break}var c=r.map,h=c[s];void 0===h&&(h=new G(s),W(r,h)),r=h}}function Y(e,t,r){p.call(this),this.renderer=r;for(var n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<n;++i){var o=e.getActiveUniform(t,i),a=o.name;X(o,e.getUniformLocation(t,a),this)}}function q(e,t,r){return void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}function K(e,t){this.min=void 0!==e?e:new i(1/0,1/0),this.max=void 0!==t?t:new i(-1/0,-1/0)}function Z(e,t){function r(){var e=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),t=new Uint16Array([0,1,2,0,2,3]);o=p.createBuffer(),a=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,o),p.bufferData(p.ARRAY_BUFFER,e,p.STATIC_DRAW),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,a),p.bufferData(p.ELEMENT_ARRAY_BUFFER,t,p.STATIC_DRAW),d=p.createTexture(),f=p.createTexture(),m.bindTexture(p.TEXTURE_2D,d),p.texImage2D(p.TEXTURE_2D,0,p.RGB,16,16,0,p.RGB,p.UNSIGNED_BYTE,null),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),m.bindTexture(p.TEXTURE_2D,f),p.texImage2D(p.TEXTURE_2D,0,p.RGBA,16,16,0,p.RGBA,p.UNSIGNED_BYTE,null),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),s={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},l=n(s),u={vertex:p.getAttribLocation(l,"position"),uv:p.getAttribLocation(l,"uv")},h={renderType:p.getUniformLocation(l,"renderType"),map:p.getUniformLocation(l,"map"),occlusionMap:p.getUniformLocation(l,"occlusionMap"),opacity:p.getUniformLocation(l,"opacity"),color:p.getUniformLocation(l,"color"),scale:p.getUniformLocation(l,"scale"),rotation:p.getUniformLocation(l,"rotation"),screenPosition:p.getUniformLocation(l,"screenPosition")}}function n(t){var r=p.createProgram(),n=p.createShader(p.FRAGMENT_SHADER),i=p.createShader(p.VERTEX_SHADER),o="precision "+e.getPrecision()+" float;\n";return p.shaderSource(n,o+t.fragmentShader),p.shaderSource(i,o+t.vertexShader),p.compileShader(n),p.compileShader(i),p.attachShader(r,n),p.attachShader(r,i),p.linkProgram(r),r}var o,a,s,l,u,h,d,f,p=e.context,m=e.state;this.render=function(n,s,v){if(0!==t.length){var g=new c,y=v.w/v.z,b=.5*v.z,_=.5*v.w,w=16/v.w,x=new i(w*y,w),M=new c(1,1,0),E=new i(1,1),A=new K;A.min.set(v.x,v.y),A.max.set(v.x+(v.z-16),v.y+(v.w-16)),void 0===l&&r(),p.useProgram(l),m.initAttributes(),m.enableAttribute(u.vertex),m.enableAttribute(u.uv),m.disableUnusedAttributes(),p.uniform1i(h.occlusionMap,0),p.uniform1i(h.map,1),p.bindBuffer(p.ARRAY_BUFFER,o),p.vertexAttribPointer(u.vertex,2,p.FLOAT,!1,16,0),p.vertexAttribPointer(u.uv,2,p.FLOAT,!1,16,8),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,a),m.disable(p.CULL_FACE),m.buffers.depth.setMask(!1);for(var T=0,k=t.length;T<k;T++){w=16/v.w,x.set(w*y,w);var S=t[T];if(g.set(S.matrixWorld.elements[12],S.matrixWorld.elements[13],S.matrixWorld.elements[14]),g.applyMatrix4(s.matrixWorldInverse),g.applyMatrix4(s.projectionMatrix),M.copy(g),E.x=v.x+M.x*b+b-8,E.y=v.y+M.y*_+_-8,!0===A.containsPoint(E)){m.activeTexture(p.TEXTURE0),m.bindTexture(p.TEXTURE_2D,null),m.activeTexture(p.TEXTURE1),m.bindTexture(p.TEXTURE_2D,d),p.copyTexImage2D(p.TEXTURE_2D,0,p.RGB,E.x,E.y,16,16,0),p.uniform1i(h.renderType,0),p.uniform2f(h.scale,x.x,x.y),p.uniform3f(h.screenPosition,M.x,M.y,M.z),m.disable(p.BLEND),m.enable(p.DEPTH_TEST),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),m.activeTexture(p.TEXTURE0),m.bindTexture(p.TEXTURE_2D,f),p.copyTexImage2D(p.TEXTURE_2D,0,p.RGBA,E.x,E.y,16,16,0),p.uniform1i(h.renderType,1),m.disable(p.DEPTH_TEST),m.activeTexture(p.TEXTURE1),m.bindTexture(p.TEXTURE_2D,d),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),S.positionScreen.copy(M),S.customUpdateCallback?S.customUpdateCallback(S):S.updateLensFlares(),p.uniform1i(h.renderType,2),m.enable(p.BLEND);for(var C=0,P=S.lensFlares.length;C<P;C++){var O=S.lensFlares[C];O.opacity>.001&&O.scale>.001&&(M.x=O.x,M.y=O.y,M.z=O.z,w=O.size*O.scale/v.w,x.x=w*y,x.y=w,p.uniform3f(h.screenPosition,M.x,M.y,M.z),p.uniform2f(h.scale,x.x,x.y),p.uniform1f(h.rotation,O.rotation),p.uniform1f(h.opacity,O.opacity),p.uniform3f(h.color,O.color.r,O.color.g,O.color.b),m.setBlending(O.blending,O.blendEquation,O.blendSrc,O.blendDst),e.setTexture2D(O.texture,1),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0))}}}m.enable(p.CULL_FACE),m.enable(p.DEPTH_TEST),m.buffers.depth.setMask(!0),e.resetGLState()}}}function Q(e,t){function r(){var e=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),t=new Uint16Array([0,1,2,0,2,3]);a=p.createBuffer(),s=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,a),p.bufferData(p.ARRAY_BUFFER,e,p.STATIC_DRAW),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,s),p.bufferData(p.ELEMENT_ARRAY_BUFFER,t,p.STATIC_DRAW),l=n(),h={position:p.getAttribLocation(l,"position"),uv:p.getAttribLocation(l,"uv")},d={uvOffset:p.getUniformLocation(l,"uvOffset"),uvScale:p.getUniformLocation(l,"uvScale"),rotation:p.getUniformLocation(l,"rotation"),scale:p.getUniformLocation(l,"scale"),color:p.getUniformLocation(l,"color"),map:p.getUniformLocation(l,"map"),opacity:p.getUniformLocation(l,"opacity"),modelViewMatrix:p.getUniformLocation(l,"modelViewMatrix"),projectionMatrix:p.getUniformLocation(l,"projectionMatrix"),fogType:p.getUniformLocation(l,"fogType"),fogDensity:p.getUniformLocation(l,"fogDensity"),fogNear:p.getUniformLocation(l,"fogNear"),fogFar:p.getUniformLocation(l,"fogFar"),fogColor:p.getUniformLocation(l,"fogColor"),alphaTest:p.getUniformLocation(l,"alphaTest")};var r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");r.width=8,r.height=8;var i=r.getContext("2d");i.fillStyle="white",i.fillRect(0,0,8,8),f=new o(r),f.needsUpdate=!0}function n(){var t=p.createProgram(),r=p.createShader(p.VERTEX_SHADER),n=p.createShader(p.FRAGMENT_SHADER);return p.shaderSource(r,["precision "+e.getPrecision()+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),p.shaderSource(n,["precision "+e.getPrecision()+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),p.compileShader(r),p.compileShader(n),p.attachShader(t,r),p.attachShader(t,n),p.linkProgram(t),t}function i(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:t.id-e.id}var a,s,l,h,d,f,p=e.context,m=e.state,v=new c,g=new u,y=new c;this.render=function(n,o){if(0!==t.length){void 0===l&&r(),p.useProgram(l),m.initAttributes(),m.enableAttribute(h.position),m.enableAttribute(h.uv),m.disableUnusedAttributes(),m.disable(p.CULL_FACE),m.enable(p.BLEND),p.bindBuffer(p.ARRAY_BUFFER,a),p.vertexAttribPointer(h.position,2,p.FLOAT,!1,16,0),p.vertexAttribPointer(h.uv,2,p.FLOAT,!1,16,8),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,s),p.uniformMatrix4fv(d.projectionMatrix,!1,o.projectionMatrix.elements),m.activeTexture(p.TEXTURE0),p.uniform1i(d.map,0);var u=0,c=0,b=n.fog;b?(p.uniform3f(d.fogColor,b.color.r,b.color.g,b.color.b),b.isFog?(p.uniform1f(d.fogNear,b.near),p.uniform1f(d.fogFar,b.far),p.uniform1i(d.fogType,1),u=1,c=1):b.isFogExp2&&(p.uniform1f(d.fogDensity,b.density),p.uniform1i(d.fogType,2),u=2,c=2)):(p.uniform1i(d.fogType,0),u=0,c=0);for(var _=0,w=t.length;_<w;_++){var x=t[_];x.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,x.matrixWorld),x.z=-x.modelViewMatrix.elements[14]}t.sort(i);for(var M=[],_=0,w=t.length;_<w;_++){var x=t[_],E=x.material;if(!1!==E.visible){x.onBeforeRender(e,n,o,void 0,E,void 0),p.uniform1f(d.alphaTest,E.alphaTest),p.uniformMatrix4fv(d.modelViewMatrix,!1,x.modelViewMatrix.elements),x.matrixWorld.decompose(v,g,y),M[0]=y.x,M[1]=y.y;var A=0;n.fog&&E.fog&&(A=c),u!==A&&(p.uniform1i(d.fogType,A),u=A),null!==E.map?(p.uniform2f(d.uvOffset,E.map.offset.x,E.map.offset.y),p.uniform2f(d.uvScale,E.map.repeat.x,E.map.repeat.y)):(p.uniform2f(d.uvOffset,0,0),p.uniform2f(d.uvScale,1,1)),p.uniform1f(d.opacity,E.opacity),p.uniform3f(d.color,E.color.r,E.color.g,E.color.b),p.uniform1f(d.rotation,E.rotation),p.uniform2fv(d.scale,M),m.setBlending(E.blending,E.blendEquation,E.blendSrc,E.blendDst,E.blendEquationAlpha,E.blendSrcAlpha,E.blendDstAlpha,E.premultipliedAlpha),m.buffers.depth.setTest(E.depthTest),m.buffers.depth.setMask(E.depthWrite),E.map?e.setTexture2D(E.map,0):e.setTexture2D(f,0),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),x.onAfterRender(e,n,o,void 0,E,void 0)}}m.enable(p.CULL_FACE),e.resetGLState()}}}function J(){Object.defineProperty(this,"id",{value:Us++}),this.uuid=Ts.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=Co,this.side=_o,this.shading=Eo,this.vertexColors=Ao,this.opacity=1,this.transparent=!1,this.blendSrc=Vo,this.blendDst=Go,this.blendEquation=Io,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=$o,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.needsUpdate=!0}function $(e){J.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function ee(e){J.call(this),this.type="MeshDepthMaterial",this.depthPacking=Es,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function te(e,t){this.min=void 0!==e?e:new c(1/0,1/0,1/0),this.max=void 0!==t?t:new c(-1/0,-1/0,-1/0)}function re(e,t){this.center=void 0!==e?e:new c,this.radius=void 0!==t?t:0}function ne(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function ie(e,t){this.normal=void 0!==e?e:new c(1,0,0),this.constant=void 0!==t?t:0}function oe(e,t,r,n,i,o){this.planes=[void 0!==e?e:new ie,void 0!==t?t:new ie,void 0!==r?r:new ie,void 0!==n?n:new ie,void 0!==i?i:new ie,void 0!==o?o:new ie]}function ae(e,t,r,n){function o(t,r,n,i){var o=t.geometry,a=null,s=M,l=t.customDepthMaterial;if(n&&(s=E,l=t.customDistanceMaterial),l)a=l;else{var u=!1;r.morphTargets&&(o&&o.isBufferGeometry?u=o.morphAttributes&&o.morphAttributes.position&&o.morphAttributes.position.length>0:o&&o.isGeometry&&(u=o.morphTargets&&o.morphTargets.length>0)),t.isSkinnedMesh&&!1===r.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var c=t.isSkinnedMesh&&r.skinning,h=0;u&&(h|=_),c&&(h|=w),a=s[h]}if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var d=a.uuid,f=r.uuid,p=A[d];void 0===p&&(p={},A[d]=p);var m=p[f];void 0===m&&(m=a.clone(),p[f]=m),a=m}a.visible=r.visible,a.wireframe=r.wireframe;var v=r.side;return j.renderSingleSided&&v==xo&&(v=_o),j.renderReverseSided&&(v===_o?v=wo:v===wo&&(v=_o)),a.side=v,a.clipShadows=r.clipShadows,a.clippingPlanes=r.clippingPlanes,a.wireframeLinewidth=r.wireframeLinewidth,a.linewidth=r.linewidth,n&&void 0!==a.uniforms.lightPos&&a.uniforms.lightPos.value.copy(i),a}function l(t,n,i,a){if(!1!==t.visible){if(t.layers.test(n.layers)&&(t.isMesh||t.isLine||t.isPoints)&&t.castShadow&&(!t.frustumCulled||f.intersectsObject(t))){t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld);var s=r.update(t),u=t.material;if(Array.isArray(u))for(var c=s.groups,h=0,d=c.length;h<d;h++){var p=c[h],m=u[p.materialIndex];if(m&&m.visible){var v=o(t,m,a,b);e.renderBufferDirect(i,null,s,v,t,p)}}else if(u.visible){var v=o(t,u,a,b);e.renderBufferDirect(i,null,s,v,t,null)}}for(var g=t.children,y=0,_=g.length;y<_;y++)l(g[y],n,i,a)}}var u=e.context,d=e.state,f=new oe,p=new h,m=t.shadows,v=new i,g=new i(n.maxTextureSize,n.maxTextureSize),y=new c,b=new c,_=1,w=2,x=1+(_|w),M=new Array(x),E=new Array(x),A={},T=[new c(1,0,0),new c(-1,0,0),new c(0,0,1),new c(0,0,-1),new c(0,1,0),new c(0,-1,0)],k=[new c(0,1,0),new c(0,1,0),new c(0,1,0),new c(0,1,0),new c(0,0,1),new c(0,0,-1)],S=[new a,new a,new a,new a,new a,new a],C=new ee;C.depthPacking=As,C.clipping=!0;for(var P=Ns.distanceRGBA,O=js.clone(P.uniforms),R=0;R!==x;++R){var L=0!=(R&_),I=0!=(R&w),B=C.clone();B.morphTargets=L,B.skinning=I,M[R]=B;var D=new $({defines:{USE_SHADOWMAP:""},uniforms:O,vertexShader:P.vertexShader,fragmentShader:P.fragmentShader,morphTargets:L,skinning:I,clipping:!0});E[R]=D}var j=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=yo,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(t,r){if(!1!==j.enabled&&(!1!==j.autoUpdate||!1!==j.needsUpdate)&&0!==m.length){d.disable(u.BLEND),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var n,i=0,o=m.length;i<o;i++){var a=m[i],c=a.shadow,h=a&&a.isPointLight;if(void 0!==c){var _=c.camera;if(v.copy(c.mapSize),v.min(g),h){var w=v.x,x=v.y;S[0].set(2*w,x,w,x),S[1].set(0,x,w,x),S[2].set(3*w,x,w,x),S[3].set(w,x,w,x),S[4].set(3*w,0,w,x),S[5].set(w,0,w,x),v.x*=4,v.y*=2}if(null===c.map){var M={minFilter:Ma,magFilter:Ma,format:Va};c.map=new s(v.x,v.y,M),c.map.texture.name=a.name+".shadowMap",_.updateProjectionMatrix()}c.isSpotLightShadow&&c.update(a);var E=c.map,A=c.matrix;b.setFromMatrixPosition(a.matrixWorld),_.position.copy(b),h?(n=6,A.makeTranslation(-b.x,-b.y,-b.z)):(n=1,y.setFromMatrixPosition(a.target.matrixWorld),_.lookAt(y),_.updateMatrixWorld(),A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(_.projectionMatrix),A.multiply(_.matrixWorldInverse)),e.setRenderTarget(E),e.clear();for(var C=0;C<n;C++){if(h){y.copy(_.position),y.add(T[C]),_.up.copy(k[C]),_.lookAt(y),_.updateMatrixWorld();var P=S[C];d.viewport(P)}p.multiplyMatrices(_.projectionMatrix,_.matrixWorldInverse),f.setFromMatrix(p),l(t,r,_,h)}}else console.warn("THREE.WebGLShadowMap:",a,"has no shadow.")}var O=e.getClearColor(),R=e.getClearAlpha();e.setClearColor(O,R),j.needsUpdate=!1}}}function se(e){function t(t,r){var n=t.array,i=t.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW,o=e.createBuffer();e.bindBuffer(r,o),e.bufferData(r,n,i),t.onUploadCallback();var a=e.FLOAT;return n instanceof Float32Array?a=e.FLOAT:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?a=e.UNSIGNED_SHORT:n instanceof Int16Array?a=e.SHORT:n instanceof Uint32Array?a=e.UNSIGNED_INT:n instanceof Int32Array?a=e.INT:n instanceof Int8Array?a=e.BYTE:n instanceof Uint8Array&&(a=e.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:n.BYTES_PER_ELEMENT,version:t.version}}function r(t,r,n){var i=r.array,o=r.updateRange;e.bindBuffer(n,t),!1===r.dynamic?e.bufferData(n,i,e.STATIC_DRAW):-1===o.count?e.bufferSubData(n,0,i):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(n,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}function n(e){return e.isInterleavedBufferAttribute&&(e=e.data),a[e.uuid]}function i(t){t.isInterleavedBufferAttribute&&(t=t.data);var r=a[t.uuid];r&&(e.deleteBuffer(r.buffer),delete a[t.uuid])}function o(e,n){e.isInterleavedBufferAttribute&&(e=e.data);var i=a[e.uuid];void 0===i?a[e.uuid]=t(e,n):i.version<e.version&&(r(i.buffer,e,n),i.version=e.version)}var a={};return{get:n,remove:i,update:o}}function le(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._order=n||le.DefaultOrder}function ue(){this.mask=1}function ce(){function e(){i.setFromEuler(n,!1)}function t(){n.setFromQuaternion(i,void 0,!1)}Object.defineProperty(this,"id",{value:Fs++}),this.uuid=Ts.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ce.DefaultUp.clone();var r=new c,n=new le,i=new u,o=new c(1,1,1);n.onChange(e),i.onChange(t),Object.defineProperties(this,{position:{enumerable:!0,value:r},rotation:{enumerable:!0,value:n},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:o},modelViewMatrix:{value:new h},normalMatrix:{value:new ne}}),this.matrix=new h,this.matrixWorld=new h,this.matrixAutoUpdate=ce.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ue,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function he(){ce.call(this),this.type="Camera",this.matrixWorldInverse=new h,this.projectionMatrix=new h}function de(e,t,r,n,i,o){he.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function fe(e,t,r,n){he.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==r?r:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function pe(e,t,r,n,i,o){this.a=e,this.b=t,this.c=r,this.normal=n&&n.isVector3?n:new c,this.vertexNormals=Array.isArray(n)?n:[],this.color=i&&i.isColor?i:new q,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}function me(){return Hs++}function ve(){Object.defineProperty(this,"id",{value:me()}),this.uuid=Ts.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function ge(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=Ts.generateUUID(),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===r,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function ye(e,t){ge.call(this,new Int8Array(e),t)}function be(e,t){ge.call(this,new Uint8Array(e),t)}function _e(e,t){ge.call(this,new Uint8ClampedArray(e),t)}function we(e,t){ge.call(this,new Int16Array(e),t)}function xe(e,t){ge.call(this,new Uint16Array(e),t)}function Me(e,t){ge.call(this,new Int32Array(e),t)}function Ee(e,t){ge.call(this,new Uint32Array(e),t)}function Ae(e,t){ge.call(this,new Float32Array(e),t)}function Te(e,t){ge.call(this,new Float64Array(e),t)}function ke(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Se(e){if(0===e.length)return-1/0;for(var t=e[0],r=1,n=e.length;r<n;++r)e[r]>t&&(t=e[r]);return t}function Ce(){Object.defineProperty(this,"id",{value:me()}),this.uuid=Ts.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function Pe(e,t,r,n,i,o){ve.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new Oe(e,t,r,n,i,o)),this.mergeVertices()}function Oe(e,t,r,n,i,o){function a(e,t,r,n,i,o,a,m,v,g,y){var b,_,w=o/v,x=a/g,M=o/2,E=a/2,A=m/2,T=v+1,k=g+1,S=0,C=0,P=new c;for(_=0;_<k;_++){var O=_*x-E;for(b=0;b<T;b++){var R=b*w-M;P[e]=R*n,P[t]=O*i,P[r]=A,u.push(P.x,P.y,P.z),P[e]=0,P[t]=0,P[r]=m>0?1:-1,h.push(P.x,P.y,P.z),d.push(b/v),d.push(1-_/g),S+=1}}for(_=0;_<g;_++)for(b=0;b<v;b++){var L=f+b+T*_,I=f+b+T*(_+1),B=f+(b+1)+T*(_+1),D=f+(b+1)+T*_;l.push(L,I,D),l.push(I,B,D),C+=6}s.addGroup(p,C,y),p+=C,f+=S}Ce.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:o};var s=this;n=Math.floor(n)||1,i=Math.floor(i)||1,o=Math.floor(o)||1;var l=[],u=[],h=[],d=[],f=0,p=0;a("z","y","x",-1,-1,r,t,e,o,i,0),a("z","y","x",1,-1,r,t,-e,o,i,1),a("x","z","y",1,1,e,r,t,n,o,2),a("x","z","y",1,-1,e,r,-t,n,o,3),a("x","y","z",1,-1,e,t,r,n,i,4),a("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(l),this.addAttribute("position",new Ae(u,3)),this.addAttribute("normal",new Ae(h,3)),this.addAttribute("uv",new Ae(d,2))}function Re(e,t,r,n){ve.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n},this.fromBufferGeometry(new Le(e,t,r,n)),this.mergeVertices()}function Le(e,t,r,n){Ce.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};var i,o,a=e/2,s=t/2,l=Math.floor(r)||1,u=Math.floor(n)||1,c=l+1,h=u+1,d=e/l,f=t/u,p=[],m=[],v=[],g=[];for(o=0;o<h;o++){var y=o*f-s;for(i=0;i<c;i++){var b=i*d-a;m.push(b,-y,0),v.push(0,0,1),g.push(i/l),g.push(1-o/u)}}for(o=0;o<u;o++)for(i=0;i<l;i++){var _=i+c*o,w=i+c*(o+1),x=i+1+c*(o+1),M=i+1+c*o;p.push(_,w,M),p.push(w,x,M)}this.setIndex(p),this.addAttribute("position",new Ae(m,3)),this.addAttribute("normal",new Ae(v,3)),this.addAttribute("uv",new Ae(g,2))}function Ie(e){J.call(this),this.type="MeshBasicMaterial",this.color=new q(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ia,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Be(e,t){this.origin=void 0!==e?e:new c,this.direction=void 0!==t?t:new c}function De(e,t){this.start=void 0!==e?e:new c,this.end=void 0!==t?t:new c}function je(e,t,r){this.a=void 0!==e?e:new c,this.b=void 0!==t?t:new c,this.c=void 0!==r?r:new c}function ze(e,t){ce.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Ce,this.material=void 0!==t?t:new Ie({color:16777215*Math.random()}),this.drawMode=fs,this.updateMorphTargets()}function Ne(e,t,r,n){function i(t,n,i){var d=t.background;null===d?o(c,h):d&&d.isColor&&(o(d,1),i=!0),(e.autoClear||i)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),d&&d.isCubeTexture?(void 0===l&&(l=new fe,u=new ze(new Oe(5,5,5),new $({uniforms:Ns.cube.uniforms,vertexShader:Ns.cube.vertexShader,fragmentShader:Ns.cube.fragmentShader,side:wo,depthTest:!1,depthWrite:!1,fog:!1}))),l.projectionMatrix.copy(n.projectionMatrix),l.matrixWorld.extractRotation(n.matrixWorld),l.matrixWorldInverse.getInverse(l.matrixWorld),u.material.uniforms.tCube.value=d,u.modelViewMatrix.multiplyMatrices(l.matrixWorldInverse,u.matrixWorld),r.update(u),e.renderBufferDirect(l,null,u.geometry,u.material,u,null)):d&&d.isTexture&&(void 0===a&&(a=new de(-1,1,1,-1,0,1),s=new ze(new Le(2,2),new Ie({depthTest:!1,depthWrite:!1,fog:!1}))),s.material.map=d,r.update(s),e.renderBufferDirect(a,null,s.geometry,s.material,s,null))}function o(e,r){t.buffers.color.setClear(e.r,e.g,e.b,r,n)}var a,s,l,u,c=new q(0),h=0;return{getClearColor:function(){return c},setClearColor:function(e,t){c.set(e),h=void 0!==t?t:1,o(c,h)},getClearAlpha:function(){return h},setClearAlpha:function(e){h=e,o(c,h)},render:i}}function Ue(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Fe(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function He(){function e(){o=-1,s=-1}function t(e,t,r,n,l){var u,c;r.transparent?(u=a,c=++s):(u=i,c=++o);var h=u[c];h?(h.id=e.id,h.object=e,h.geometry=t,h.material=r,h.program=r.program,h.renderOrder=e.renderOrder,h.z=n,h.group=l):(h={id:e.id,object:e,geometry:t,material:r,program:r.program,renderOrder:e.renderOrder,z:n,group:l},u.push(h))}function r(){i.length=o+1,a.length=s+1}function n(){i.sort(Ue),a.sort(Fe)}var i=[],o=-1,a=[],s=-1;return{opaque:i,transparent:a,init:e,push:t,finish:r,sort:n}}function Ve(){function e(e,t){var n=e.id+","+t.id,i=r[n];return void 0===i&&(i=new He,r[n]=i),i}function t(){r={}}var r={};return{get:e,dispose:t}}function Ge(e,t,r){function n(e){s=e}function i(e){l=e.type,u=e.bytesPerElement}function o(t,n){e.drawElements(s,n,l,t*u),r.calls++,r.vertices+=n,s===e.TRIANGLES&&(r.faces+=n/3)}function a(n,i,o){var a=t.get("ANGLE_instanced_arrays");if(null===a)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");a.drawElementsInstancedANGLE(s,o,l,i*u,n.maxInstancedCount),r.calls++,r.vertices+=o*n.maxInstancedCount,s===e.TRIANGLES&&(r.faces+=n.maxInstancedCount*o/3)}var s,l,u;this.setMode=n,this.setIndex=i,this.render=o,this.renderInstances=a}function We(e,t,r){function n(e){a=e}function i(t,n){e.drawArrays(a,t,n),r.calls++,r.vertices+=n,a===e.TRIANGLES&&(r.faces+=n/3)}function o(n,i,o){var s=t.get("ANGLE_instanced_arrays");if(null===s)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var l=n.attributes.position;l.isInterleavedBufferAttribute?(o=l.data.count,s.drawArraysInstancedANGLE(a,0,o,n.maxInstancedCount)):s.drawArraysInstancedANGLE(a,i,o,n.maxInstancedCount),r.calls++,r.vertices+=o*n.maxInstancedCount,a===e.TRIANGLES&&(r.faces+=n.maxInstancedCount*o/3)}var a;this.setMode=n,this.render=i,this.renderInstances=o}function Xe(e,t,r){function n(e){var i=e.target,o=s[i.id];null!==o.index&&t.remove(o.index);for(var a in o.attributes)t.remove(o.attributes[a]);i.removeEventListener("dispose",n),delete s[i.id];var u=l[i.id];u&&(t.remove(u),delete l[i.id]),u=l[o.id],u&&(t.remove(u),delete l[o.id]),r.geometries--}function i(e,t){var i=s[t.id];return i||(t.addEventListener("dispose",n),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Ce).setFromObject(e)),i=t._bufferGeometry),s[t.id]=i,r.geometries++,i)}function o(r){var n=r.index,i=r.attributes;null!==n&&t.update(n,e.ELEMENT_ARRAY_BUFFER);for(var o in i)t.update(i[o],e.ARRAY_BUFFER);var a=r.morphAttributes;for(var o in a)for(var s=a[o],l=0,u=s.length;l<u;l++)t.update(s[l],e.ARRAY_BUFFER)}function a(r){var n=l[r.id];if(n)return n;var i=[],o=r.index,a=r.attributes;if(null!==o)for(var s=o.array,u=0,c=s.length;u<c;u+=3){var h=s[u+0],d=s[u+1],f=s[u+2];i.push(h,d,d,f,f,h)}else for(var s=a.position.array,u=0,c=s.length/3-1;u<c;u+=3){var h=u+0,d=u+1,f=u+2;i.push(h,d,d,f,f,h)}return n=new(Se(i)>65535?Ee:xe)(i,1),t.update(n,e.ELEMENT_ARRAY_BUFFER),l[r.id]=n,n}var s={},l={};return{get:i,update:o,getWireframeAttribute:a}}function Ye(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var r;switch(t.type){case"DirectionalLight":r={direction:new c,color:new q,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"SpotLight":r={position:new c,direction:new c,color:new q,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"PointLight":r={position:new c,color:new q,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"HemisphereLight":r={direction:new c,skyColor:new q,groundColor:new q};break;case"RectAreaLight":r={color:new q,position:new c,halfWidth:new c,halfHeight:new c}}return e[t.id]=r,r}}}function qe(e,t,r){function n(e){var n=r.frame,i=e.geometry,a=t.get(e,i);return o[a.id]!==n&&(i.isGeometry&&a.updateFromObject(e),t.update(a),o[a.id]=n),a}function i(){o={}}var o={};return{update:n,clear:i}}function Ke(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")}function Ze(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),!1===e.getShaderParameter(n,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(n),Ke(r)),n}function Qe(e){switch(e){case vs:return["Linear","( value )"];case gs:return["sRGB","( value )"];case bs:return["RGBE","( value )"];case ws:return["RGBM","( value, 7.0 )"];case xs:return["RGBM","( value, 16.0 )"];case Ms:return["RGBD","( value, 256.0 )"];case ys:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function Je(e,t){var r=Qe(t);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function $e(e,t){var r=Qe(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function et(e,t){var r;switch(t){case la:r="Linear";break;case ua:r="Reinhard";break;case ca:r="Uncharted2";break;case ha:r="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function tt(e,t,r){return e=e||{},[e.derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&r.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&r.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&r.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(it).join("\n")}function rt(e){var t=[];for(var r in e){var n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}function nt(e,t,r){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<i;o++){var a=e.getActiveAttrib(t,o),s=a.name;n[s]=e.getAttribLocation(t,s)}return n}function it(e){return""!==e}function ot(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function at(e){function t(e,t){var r=zs[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return at(r)}var r=/^[ \t]*#include +<([\w\d.]+)>/gm;return e.replace(r,t)}function st(e){function t(e,t,r,n){for(var i="",o=parseInt(t);o<parseInt(r);o++)i+=n.replace(/\[ i \]/g,"[ "+o+" ]");return i}var r=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return e.replace(r,t)}function lt(e,t,r,n,i){var o=e.context,a=r.extensions,s=r.defines,l=n.vertexShader,u=n.fragmentShader,c="SHADOWMAP_TYPE_BASIC";i.shadowMapType===yo?c="SHADOWMAP_TYPE_PCF":i.shadowMapType===bo&&(c="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",d="ENVMAP_MODE_REFLECTION",f="ENVMAP_BLENDING_MULTIPLY";if(i.envMap){switch(r.envMap.mapping){case fa:case pa:h="ENVMAP_TYPE_CUBE";break;case ya:case ba:h="ENVMAP_TYPE_CUBE_UV";break;case ma:case va:h="ENVMAP_TYPE_EQUIREC";break;case ga:h="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case pa:case va:d="ENVMAP_MODE_REFRACTION"}switch(r.combine){case ia:f="ENVMAP_BLENDING_MULTIPLY";break;case oa:f="ENVMAP_BLENDING_MIX";break;case aa:f="ENVMAP_BLENDING_ADD"}}var p,m,v=e.gammaFactor>0?e.gammaFactor:1,g=tt(a,i,e.extensions),y=rt(s),b=o.createProgram();r.isRawShaderMaterial?(p=[y,"\n"].filter(it).join("\n"),m=[g,y,"\n"].filter(it).join("\n")):(p=["precision "+i.precision+" float;","precision "+i.precision+" int;","#define SHADER_NAME "+n.name,y,i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+v,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+d:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&!1===i.flatShading?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+i.numClippingPlanes,i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+c:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&e.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(it).join("\n"),m=[g,"precision "+i.precision+" float;","precision "+i.precision+" int;","#define SHADER_NAME "+n.name,y,i.alphaTest?"#define ALPHATEST "+i.alphaTest:"","#define GAMMA_FACTOR "+v,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.envMap?"#define "+d:"",i.envMap?"#define "+f:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+i.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(i.numClippingPlanes-i.numClipIntersection),i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+c:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&e.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",i.envMap&&e.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",i.toneMapping!==sa?"#define TONE_MAPPING":"",i.toneMapping!==sa?zs.tonemapping_pars_fragment:"",i.toneMapping!==sa?et("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.outputEncoding||i.mapEncoding||i.envMapEncoding||i.emissiveMapEncoding?zs.encodings_pars_fragment:"",i.mapEncoding?Je("mapTexelToLinear",i.mapEncoding):"",i.envMapEncoding?Je("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMapEncoding?Je("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.outputEncoding?$e("linearToOutputTexel",i.outputEncoding):"",i.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(it).join("\n")),l=at(l),l=ot(l,i),u=at(u),u=ot(u,i),r.isShaderMaterial||(l=st(l),u=st(u));var _=p+l,w=m+u,x=Ze(o,o.VERTEX_SHADER,_),M=Ze(o,o.FRAGMENT_SHADER,w);o.attachShader(b,x),o.attachShader(b,M),void 0!==r.index0AttributeName?o.bindAttribLocation(b,0,r.index0AttributeName):!0===i.morphTargets&&o.bindAttribLocation(b,0,"position"),o.linkProgram(b);var E=o.getProgramInfoLog(b),A=o.getShaderInfoLog(x),T=o.getShaderInfoLog(M),k=!0,S=!0;!1===o.getProgramParameter(b,o.LINK_STATUS)?(k=!1,console.error("THREE.WebGLProgram: shader error: ",o.getError(),"gl.VALIDATE_STATUS",o.getProgramParameter(b,o.VALIDATE_STATUS),"gl.getProgramInfoLog",E,A,T)):""!==E?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",E):""!==A&&""!==T||(S=!1),S&&(this.diagnostics={runnable:k,material:r,programLog:E,vertexShader:{log:A,prefix:p},fragmentShader:{log:T,prefix:m}}),o.deleteShader(x),o.deleteShader(M);var C;this.getUniforms=function(){return void 0===C&&(C=new Y(o,b,e)),C};var P;return this.getAttributes=function(){return void 0===P&&(P=nt(o,b)),P},this.destroy=function(){o.deleteProgram(b),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Vs++,this.code=t,this.usedTimes=1,this.program=b,this.vertexShader=x,this.fragmentShader=M,this}function ut(e,t){function r(e){var r=e.skeleton,n=r.bones;if(t.floatVertexTextures)return 1024;var i=t.maxVertexUniforms,o=Math.floor((i-20)/4),a=Math.min(o,n.length);return a<n.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+n.length+" bones. This GPU supports "+a+"."),0):a}function n(e,t){var r;return e?e.isTexture?r=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),r=e.texture.encoding):r=vs,r===vs&&t&&(r=ys),r}var i=[],o={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},a=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];this.getParameters=function(i,a,s,l,u,c){var h=o[i.type],d=c.isSkinnedMesh?r(c):0,f=e.getPrecision();null!==i.precision&&(f=t.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",f,"instead.");var p=e.getRenderTarget();return{shaderID:h,precision:f,supportsVertexTextures:t.vertexTextures,outputEncoding:n(p?p.texture:null,e.gammaOutput),map:!!i.map,mapEncoding:n(i.map,e.gammaInput),envMap:!!i.envMap,envMapMode:i.envMap&&i.envMap.mapping,envMapEncoding:n(i.envMap,e.gammaInput),envMapCubeUV:!!i.envMap&&(i.envMap.mapping===ya||i.envMap.mapping===ba),lightMap:!!i.lightMap,aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:n(i.emissiveMap,e.gammaInput),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,combine:i.combine,vertexColors:i.vertexColors,fog:!!s,useFog:i.fog,fogExp:s&&s.isFogExp2,flatShading:i.shading===Mo,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:t.logarithmicDepthBuffer,skinning:i.skinning&&d>0,maxBones:d,useVertexTexture:t.floatVertexTextures,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numClippingPlanes:l,numClipIntersection:u,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.receiveShadow&&a.shadows.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:i.side===xo,flipSided:i.side===wo,depthPacking:void 0!==i.depthPacking&&i.depthPacking}},this.getProgramCode=function(t,r){var n=[];if(r.shaderID?n.push(r.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)n.push(i),n.push(t.defines[i]);for(var o=0;o<a.length;o++)n.push(r[a[o]]);return n.push(t.onBeforeCompile.toString()),n.push(e.gammaOutput),n.join()},this.acquireProgram=function(t,r,n,o){for(var a,s=0,l=i.length;s<l;s++){var u=i[s];if(u.code===o){a=u,++a.usedTimes;break}}return void 0===a&&(a=new lt(e,o,t,r,n),i.push(a)),a},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=i.indexOf(e);i[t]=i[i.length-1],i.pop(),e.destroy()}},this.programs=i}function ct(e,t,r,n,i,o,a){function s(e,t){if(e.width>t||e.height>t){var r=t/Math.max(e.width,e.height),n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return n.width=Math.floor(e.width*r),n.height=Math.floor(e.height*r),n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height,e),n}return e}function l(e){return Ts.isPowerOfTwo(e.width)&&Ts.isPowerOfTwo(e.height)}function u(e){if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement){var t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return t.width=Ts.nearestPowerOfTwo(e.width),t.height=Ts.nearestPowerOfTwo(e.height),t.getContext("2d").drawImage(e,0,0,t.width,t.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+t.width+"x"+t.height,e),t}return e}function c(e){return e.wrapS!==wa||e.wrapT!==wa||e.minFilter!==Ma&&e.minFilter!==Ta}function h(e,t){return e.generateMipmaps&&t&&e.minFilter!==Ma&&e.minFilter!==Ta}function d(t){return t===Ma||t===Ea||t===Aa?e.NEAREST:e.LINEAR}function f(e){var t=e.target;t.removeEventListener("dispose",f),m(t),a.textures--}function p(e){var t=e.target;t.removeEventListener("dispose",p),v(t),a.textures--}function m(t){var r=n.get(t);if(t.image&&r.__image__webglTextureCube)e.deleteTexture(r.__image__webglTextureCube);else{if(void 0===r.__webglInit)return;e.deleteTexture(r.__webglTexture)}n.remove(t)}function v(t){var r=n.get(t),i=n.get(t.texture);if(t){if(void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLRenderTargetCube)for(var o=0;o<6;o++)e.deleteFramebuffer(r.__webglFramebuffer[o]),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[o]);else e.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer);n.remove(t.texture),n.remove(t)}}function g(t,i){var o=n.get(t);if(t.version>0&&o.__version!==t.version){var a=t.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t);else{if(!1!==a.complete)return void w(o,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t)}}r.activeTexture(e.TEXTURE0+i),r.bindTexture(e.TEXTURE_2D,o.__webglTexture)}function y(t,u){var c=n.get(t);if(6===t.image.length)if(t.version>0&&c.__version!==t.version){c.__image__webglTextureCube||(t.addEventListener("dispose",f),c.__image__webglTextureCube=e.createTexture(),a.textures++),r.activeTexture(e.TEXTURE0+u),r.bindTexture(e.TEXTURE_CUBE_MAP,c.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var d=t&&t.isCompressedTexture,p=t.image[0]&&t.image[0].isDataTexture,m=[],v=0;v<6;v++)m[v]=d||p?p?t.image[v].image:t.image[v]:s(t.image[v],i.maxCubemapSize);var g=m[0],y=l(g),b=o(t.format),w=o(t.type);_(e.TEXTURE_CUBE_MAP,t,y);for(var v=0;v<6;v++)if(d)for(var x,M=m[v].mipmaps,E=0,A=M.length;E<A;E++)x=M[E],t.format!==Va&&t.format!==Ha?r.getCompressedTextureFormats().indexOf(b)>-1?r.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,E,b,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,E,b,x.width,x.height,0,b,w,x.data);else p?r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,b,m[v].width,m[v].height,0,b,w,m[v].data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,b,b,w,m[v]);h(t,y)&&e.generateMipmap(e.TEXTURE_CUBE_MAP),c.__version=t.version,t.onUpdate&&t.onUpdate(t)}else r.activeTexture(e.TEXTURE0+u),r.bindTexture(e.TEXTURE_CUBE_MAP,c.__image__webglTextureCube)}function b(t,i){r.activeTexture(e.TEXTURE0+i),r.bindTexture(e.TEXTURE_CUBE_MAP,n.get(t).__webglTexture)}function _(r,a,s){var l;if(s?(e.texParameteri(r,e.TEXTURE_WRAP_S,o(a.wrapS)),e.texParameteri(r,e.TEXTURE_WRAP_T,o(a.wrapT)),e.texParameteri(r,e.TEXTURE_MAG_FILTER,o(a.magFilter)),e.texParameteri(r,e.TEXTURE_MIN_FILTER,o(a.minFilter))):(e.texParameteri(r,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(r,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),a.wrapS===wa&&a.wrapT===wa||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",a),e.texParameteri(r,e.TEXTURE_MAG_FILTER,d(a.magFilter)),e.texParameteri(r,e.TEXTURE_MIN_FILTER,d(a.minFilter)),a.minFilter!==Ma&&a.minFilter!==Ta&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",a)),l=t.get("EXT_texture_filter_anisotropic")){if(a.type===Ba&&null===t.get("OES_texture_float_linear"))return;if(a.type===Da&&null===t.get("OES_texture_half_float_linear"))return;(a.anisotropy>1||n.get(a).__currentAnisotropy)&&(e.texParameterf(r,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),n.get(a).__currentAnisotropy=a.anisotropy)}}function w(t,n,d){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",f),t.__webglTexture=e.createTexture(),a.textures++),r.activeTexture(e.TEXTURE0+d),r.bindTexture(e.TEXTURE_2D,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment);var p=s(n.image,i.maxTextureSize);c(n)&&!1===l(p)&&(p=u(p));var m=l(p),v=o(n.format),g=o(n.type);_(e.TEXTURE_2D,n,m);var y,b=n.mipmaps;if(n.isDepthTexture){var w=e.DEPTH_COMPONENT;if(n.type===Ba){if(!S)throw new Error("Float Depth Texture only supported in WebGL2.0");w=e.DEPTH_COMPONENT32F}else S&&(w=e.DEPTH_COMPONENT16);n.format===Ya&&w===e.DEPTH_COMPONENT&&n.type!==Ra&&n.type!==Ia&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=Ra,g=o(n.type)),n.format===qa&&(w=e.DEPTH_STENCIL,n.type!==Ua&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=Ua,g=o(n.type))),r.texImage2D(e.TEXTURE_2D,0,w,p.width,p.height,0,v,g,null)}else if(n.isDataTexture)if(b.length>0&&m){for(var x=0,M=b.length;x<M;x++)y=b[x],r.texImage2D(e.TEXTURE_2D,x,v,y.width,y.height,0,v,g,y.data);n.generateMipmaps=!1}else r.texImage2D(e.TEXTURE_2D,0,v,p.width,p.height,0,v,g,p.data);else if(n.isCompressedTexture)for(var x=0,M=b.length;x<M;x++)y=b[x],n.format!==Va&&n.format!==Ha?r.getCompressedTextureFormats().indexOf(v)>-1?r.compressedTexImage2D(e.TEXTURE_2D,x,v,y.width,y.height,0,y.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(e.TEXTURE_2D,x,v,y.width,y.height,0,v,g,y.data);else if(b.length>0&&m){for(var x=0,M=b.length;x<M;x++)y=b[x],r.texImage2D(e.TEXTURE_2D,x,v,v,g,y);n.generateMipmaps=!1}else r.texImage2D(e.TEXTURE_2D,0,v,v,g,p);h(n,m)&&e.generateMipmap(e.TEXTURE_2D),t.__version=n.version,n.onUpdate&&n.onUpdate(n)}function x(t,i,a,s){var l=o(i.texture.format),u=o(i.texture.type);r.texImage2D(s,0,l,i.width,i.height,0,l,u,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,a,s,n.get(i.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function M(t,r){e.bindRenderbuffer(e.RENDERBUFFER,t),r.depthBuffer&&!r.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,r.width,r.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):r.depthBuffer&&r.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,r.width,r.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,r.width,r.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}function E(t,r){if(r&&r.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported!");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),g(r.depthTexture,0);var i=n.get(r.depthTexture).__webglTexture;if(r.depthTexture.format===Ya)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,i,0);else{if(r.depthTexture.format!==qa)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,i,0)}}function A(t){var r=n.get(t),i=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");E(r.__webglFramebuffer,t)}else if(i){r.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[o]),r.__webglDepthbuffer[o]=e.createRenderbuffer(),M(r.__webglDepthbuffer[o],t)}else e.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),M(r.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}function T(t){var i=n.get(t),o=n.get(t.texture);t.addEventListener("dispose",p),o.__webglTexture=e.createTexture(),a.textures++;var s=!0===t.isWebGLRenderTargetCube,u=l(t);if(s){i.__webglFramebuffer=[];for(var c=0;c<6;c++)i.__webglFramebuffer[c]=e.createFramebuffer()}else i.__webglFramebuffer=e.createFramebuffer();if(s){r.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture),_(e.TEXTURE_CUBE_MAP,t.texture,u);for(var c=0;c<6;c++)x(i.__webglFramebuffer[c],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+c);h(t.texture,u)&&e.generateMipmap(e.TEXTURE_CUBE_MAP),r.bindTexture(e.TEXTURE_CUBE_MAP,null)}else r.bindTexture(e.TEXTURE_2D,o.__webglTexture),_(e.TEXTURE_2D,t.texture,u),x(i.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),h(t.texture,u)&&e.generateMipmap(e.TEXTURE_2D),r.bindTexture(e.TEXTURE_2D,null);t.depthBuffer&&A(t)}function k(t){var i=t.texture;if(h(i,l(t))){var o=t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,a=n.get(i).__webglTexture;r.bindTexture(o,a),e.generateMipmap(o),r.bindTexture(o,null)}}var S="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext;this.setTexture2D=g,this.setTextureCube=y,this.setTextureCubeDynamic=b,this.setupRenderTarget=T,this.updateRenderTargetMipmap=k}function ht(){function e(e){var t=e.uuid,r=n[t];return void 0===r&&(r={},n[t]=r),r}function t(e){delete n[e.uuid]}function r(){n={}}var n={};return{get:e,remove:t,clear:r}}function dt(e,t,r){function n(){var t=!1,r=new a,n=null,i=new a;return{setMask:function(r){n===r||t||(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,n,o,a,s){!0===s&&(t*=a,n*=a,o*=a),r.set(t,n,o,a),!1===i.equals(r)&&(e.clearColor(t,n,o,a),i.copy(r))},reset:function(){t=!1,n=null,i.set(0,0,0,1)}}}function i(){var t=!1,r=null,n=null,i=null;return{setTest:function(t){t?f(e.DEPTH_TEST):p(e.DEPTH_TEST)},setMask:function(n){r===n||t||(e.depthMask(n),r=n)},setFunc:function(t){if(n!==t){if(t)switch(t){case Zo:e.depthFunc(e.NEVER);break;case Qo:e.depthFunc(e.ALWAYS);break;case Jo:e.depthFunc(e.LESS);break;case $o:e.depthFunc(e.LEQUAL);break;case ea:e.depthFunc(e.EQUAL);break;case ta:e.depthFunc(e.GEQUAL);break;case ra:e.depthFunc(e.GREATER);break;case na:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);n=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,r=null,n=null,i=null}}}function o(){var t=!1,r=null,n=null,i=null,o=null,a=null,s=null,l=null,u=null;return{setTest:function(t){t?f(e.STENCIL_TEST):p(e.STENCIL_TEST)},setMask:function(n){r===n||t||(e.stencilMask(n),r=n)},setFunc:function(t,r,a){n===t&&i===r&&o===a||(e.stencilFunc(t,r,a),n=t,i=r,o=a)},setOp:function(t,r,n){a===t&&s===r&&l===n||(e.stencilOp(t,r,n),a=t,s=r,l=n)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,r=null,n=null,i=null,o=null,a=null,s=null,l=null,u=null}}}function s(t,r,n){var i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var a=0;a<n;a++)e.texImage2D(r+a,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);return o}function l(){O.setClear(0,0,0,1),R.setClear(1),L.setClear(0),f(e.DEPTH_TEST),R.setFunc($o),y(!1),b(ho),f(e.CULL_FACE),f(e.BLEND),v(Co)}function u(){for(var e=0,t=B.length;e<t;e++)B[e]=0}function c(r){B[r]=1,0===D[r]&&(e.enableVertexAttribArray(r),D[r]=1),0!==j[r]&&(t.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(r,0),j[r]=0)}function h(r,n){B[r]=1,0===D[r]&&(e.enableVertexAttribArray(r),D[r]=1),j[r]!==n&&(t.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(r,n),j[r]=n)}function d(){for(var t=0,r=D.length;t!==r;++t)D[t]!==B[t]&&(e.disableVertexAttribArray(t),D[t]=0)}function f(t){!0!==z[t]&&(e.enable(t),z[t]=!0)}function p(t){!1!==z[t]&&(e.disable(t),z[t]=!1)}function m(){if(null===N&&(N=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")))for(var r=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),n=0;n<r.length;n++)N.push(r[n]);return N}function v(t,n,i,o,a,s,l,u){t!==So?f(e.BLEND):p(e.BLEND),t===Lo||t===U&&u===Y||(t===Po?u?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)):t===Oo?u?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR)):t===Ro?u?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR)):u?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)),U=t,Y=u),t===Lo?(a=a||n,s=s||i,l=l||o,n===F&&a===G||(e.blendEquationSeparate(r(n),r(a)),F=n,G=a),i===H&&o===V&&s===W&&l===X||(e.blendFuncSeparate(r(i),r(o),r(s),r(l)),H=i,V=o,W=s,X=l)):(F=null,H=null,V=null,G=null,W=null,X=null)}function g(t){t.side===xo?p(e.CULL_FACE):f(e.CULL_FACE),y(t.side===wo),!0===t.transparent?v(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):v(So),R.setFunc(t.depthFunc),R.setTest(t.depthTest),R.setMask(t.depthWrite),O.setMask(t.colorWrite),w(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function y(t){q!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),q=t)}function b(t){t!==co?(f(e.CULL_FACE),t!==K&&(t===ho?e.cullFace(e.BACK):t===fo?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):p(e.CULL_FACE),K=t}function _(t){t!==Z&&(re&&e.lineWidth(t),Z=t)}function w(t,r,n){t?(f(e.POLYGON_OFFSET_FILL),Q===r&&J===n||(e.polygonOffset(r,n),Q=r,J=n)):p(e.POLYGON_OFFSET_FILL)}function x(){return $}function M(t){$=t,t?f(e.SCISSOR_TEST):p(e.SCISSOR_TEST)}function E(t){void 0===t&&(t=e.TEXTURE0+ee-1),ne!==t&&(e.activeTexture(t),ne=t)}function A(t,r){null===ne&&E();var n=ie[ne];void 0===n&&(n={type:void 0,texture:void 0},ie[ne]=n),n.type===t&&n.texture===r||(e.bindTexture(t,r||se[t]),n.type=t,n.texture=r)}function T(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function k(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function S(t){!1===oe.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),oe.copy(t))}function C(t){!1===ae.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),ae.copy(t))}function P(){for(var t=0;t<D.length;t++)1===D[t]&&(e.disableVertexAttribArray(t),D[t]=0);z={},N=null,ne=null,ie={},U=null,q=null,K=null,O.reset(),R.reset(),L.reset()}var O=new n,R=new i,L=new o,I=e.getParameter(e.MAX_VERTEX_ATTRIBS),B=new Uint8Array(I),D=new Uint8Array(I),j=new Uint8Array(I),z={},N=null,U=null,F=null,H=null,V=null,G=null,W=null,X=null,Y=!1,q=null,K=null,Z=null,Q=null,J=null,$=null,ee=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),te=parseFloat(/^WebGL\ ([0-9])/.exec(e.getParameter(e.VERSION))[1]),re=parseFloat(te)>=1,ne=null,ie={},oe=new a,ae=new a,se={};return se[e.TEXTURE_2D]=s(e.TEXTURE_2D,e.TEXTURE_2D,1),se[e.TEXTURE_CUBE_MAP]=s(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),{buffers:{color:O,depth:R,stencil:L},init:l,initAttributes:u,enableAttribute:c,enableAttributeAndDivisor:h,disableUnusedAttributes:d,enable:f,disable:p,getCompressedTextureFormats:m,setBlending:v,setMaterial:g,setFlipSided:y,setCullFace:b,setLineWidth:_,setPolygonOffset:w,getScissorTest:x,setScissorTest:M,activeTexture:E,bindTexture:A,compressedTexImage2D:T,texImage2D:k,scissor:S,viewport:C,reset:P}}function ft(e,t,r){function n(){if(void 0!==o)return o;var r=t.get("EXT_texture_filter_anisotropic");return o=null!==r?e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o,a=void 0!==r.precision?r.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var l=!0===r.logarithmicDepthBuffer&&!!t.get("EXT_frag_depth"),u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),c=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_TEXTURE_SIZE),d=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),f=e.getParameter(e.MAX_VERTEX_ATTRIBS),p=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),m=e.getParameter(e.MAX_VARYING_VECTORS),v=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),g=c>0,y=!!t.get("OES_texture_float");return{getMaxAnisotropy:n,getMaxPrecision:i,precision:a,logarithmicDepthBuffer:l,maxTextures:u,maxVertexTextures:c,maxTextureSize:h,maxCubemapSize:d,maxAttributes:f,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:g&&y}}function pt(e){fe.call(this),this.cameras=e||[]}function mt(e){function t(){if(n.isPresenting){var t=n.getEyeParameters("left"),i=t.renderWidth,o=t.renderHeight;p=e.getPixelRatio(),f=e.getSize(),e.setDrawingBufferSize(2*i,o,1)}else r.enabled&&e.setDrawingBufferSize(f.width,f.height,p)}var r=this,n=null,i=null;"VRFrameData"in window&&(i=new window.VRFrameData);var o=new h,s=new h,l=new h,u=new fe;u.bounds=new a(0,0,.5,1),u.layers.enable(1);var c=new fe;c.bounds=new a(.5,0,.5,1),c.layers.enable(2);var d=new pt([u,c]);d.layers.enable(1),d.layers.enable(2);var f,p;window.addEventListener("vrdisplaypresentchange",t,!1),this.enabled=!1,this.standing=!1,this.getDevice=function(){return n},this.setDevice=function(e){void 0!==e&&(n=e)},this.getCamera=function(e){if(null===n)return e;n.depthNear=e.near,n.depthFar=e.far,n.getFrameData(i);var t=i.pose;null!==t.position?e.position.fromArray(t.position):e.position.set(0,0,0),null!==t.orientation&&e.quaternion.fromArray(t.orientation),e.updateMatrixWorld();var r=n.stageParameters;if(this.standing&&r&&(s.fromArray(r.sittingToStandingTransform),l.getInverse(s),e.matrixWorld.multiply(s),e.matrixWorldInverse.multiply(l)),!1===n.isPresenting)return e;d.matrixWorld.copy(e.matrixWorld),d.matrixWorldInverse.copy(e.matrixWorldInverse),u.matrixWorldInverse.fromArray(i.leftViewMatrix),c.matrixWorldInverse.fromArray(i.rightViewMatrix),this.standing&&r&&(u.matrixWorldInverse.multiply(l),c.matrixWorldInverse.multiply(l));var a=e.parent;null!==a&&(o.getInverse(a.matrixWorld),u.matrixWorldInverse.multiply(o),c.matrixWorldInverse.multiply(o)),u.matrixWorld.getInverse(u.matrixWorldInverse),c.matrixWorld.getInverse(c.matrixWorldInverse),u.projectionMatrix.fromArray(i.leftProjectionMatrix),c.projectionMatrix.fromArray(i.rightProjectionMatrix),d.projectionMatrix.copy(u.projectionMatrix);var h=n.getLayers();if(h.length){var f=h[0];null!==f.leftBounds&&4===f.leftBounds.length&&u.bounds.fromArray(f.leftBounds),null!==f.rightBounds&&4===f.rightBounds.length&&c.bounds.fromArray(f.rightBounds)}return d},this.getStandingMatrix=function(){return s},this.submitFrame=function(){n&&n.isPresenting&&n.submitFrame()}}function vt(e){var t={};return{get:function(r){if(void 0!==t[r])return t[r];var n;switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":n=e.getExtension("WEBGL_compressed_texture_etc1");break;default:n=e.getExtension(r)}return null===n&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),t[r]=n,n}}}function gt(){function e(){u.value!==n&&(u.value=n,u.needsUpdate=i>0),r.numPlanes=i,r.numIntersection=0}function t(e,t,n,i){var o=null!==e?e.length:0,a=null;if(0!==o){if(a=u.value,!0!==i||null===a){var c=n+4*o,h=t.matrixWorldInverse;l.getNormalMatrix(h),(null===a||a.length<c)&&(a=new Float32Array(c));for(var d=0,f=n;d!==o;++d,f+=4)s.copy(e[d]).applyMatrix4(h,l),s.normal.toArray(a,f),a[f+3]=s.constant}u.value=a,u.needsUpdate=!0}return r.numPlanes=o,a}var r=this,n=null,i=0,o=!1,a=!1,s=new ie,l=new ne,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(e,r,a){var s=0!==e.length||r||0!==i||o;return o=r,n=t(e,a,0),i=e.length,s},this.beginShadows=function(){a=!0,t(null)},this.endShadows=function(){a=!1,e()},this.setState=function(r,s,l,c,h,d){if(!o||null===r||0===r.length||a&&!l)a?t(null):e();else{var f=a?0:i,p=4*f,m=h.clippingState||null;u.value=m,m=t(r,c,p,d);for(var v=0;v!==p;++v)m[v]=n[v];h.clippingState=m,this.numIntersection=s?this.numPlanes:0,this.numPlanes+=f}}}function yt(e){function t(){return null===ee?me:1}function r(){Be.init(),Be.scissor(ue.copy(ve).multiplyScalar(me)),Be.viewport(he.copy(ye).multiplyScalar(me))}function n(){$=null,ie=null,ne="",re=-1,Be.reset()}function i(e){e.preventDefault(),n(),r(),De.clear(),Fe.clear()}function o(e){var t=e.target;t.removeEventListener("dispose",o),s(t)}function s(e){l(e),De.remove(e)}function l(e){var t=De.get(e).program;e.program=void 0,void 0!==t&&He.releaseProgram(t)}function u(e,t,r){e.render(function(e){J.renderBufferImmediate(e,t,r)})}function f(e,t){return Math.abs(t[0])-Math.abs(e[0])}function p(e,t,r,n){if(r&&r.isInstancedBufferGeometry&&null===Le.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===n&&(n=0),Be.initAttributes();var i=r.attributes,o=t.getAttributes(),a=e.defaultAttributeValues;for(var s in o){var l=o[s];if(l>=0){var u=i[s];if(void 0!==u){var c=u.normalized,h=u.itemSize,d=ze.get(u),f=d.buffer,p=d.type,m=d.bytesPerElement;if(u.isInterleavedBufferAttribute){var v=u.data,g=v.stride,y=u.offset;v&&v.isInstancedInterleavedBuffer?(Be.enableAttributeAndDivisor(l,v.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=v.meshPerAttribute*v.count)):Be.enableAttribute(l),Oe.bindBuffer(Oe.ARRAY_BUFFER,f),Oe.vertexAttribPointer(l,h,p,c,g*m,(n*g+y)*m)}else u.isInstancedBufferAttribute?(Be.enableAttributeAndDivisor(l,u.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=u.meshPerAttribute*u.count)):Be.enableAttribute(l),Oe.bindBuffer(Oe.ARRAY_BUFFER,f),Oe.vertexAttribPointer(l,h,p,c,0,n*h*m)}else if(void 0!==a){var b=a[s];if(void 0!==b)switch(b.length){case 2:Oe.vertexAttrib2fv(l,b);break;case 3:Oe.vertexAttrib3fv(l,b);break;case 4:Oe.vertexAttrib4fv(l,b);break;default:Oe.vertexAttrib1fv(l,b)}}}}Be.disableUnusedAttributes()}function m(e,t,r){if(e.visible){if(e.layers.test(t.layers))if(e.isLight)G.push(e);else if(e.isSprite)e.frustumCulled&&!be.intersectsSprite(e)||q.push(e);else if(e.isLensFlare)K.push(e);else if(e.isImmediateRenderObject)r&&Ee.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Me),W.push(e,null,e.material,Ee.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||be.intersectsObject(e))){r&&Ee.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Me);var n=Fe.update(e),i=e.material;if(Array.isArray(i))for(var o=n.groups,a=0,s=o.length;a<s;a++){var l=o[a],u=i[l.materialIndex];u&&u.visible&&W.push(e,n,u,Ee.z,l)}else i.visible&&W.push(e,n,i,Ee.z,null)}for(var c=e.children,a=0,s=c.length;a<s;a++)m(c[a],t,r)}}function v(e,t,r,n){for(var i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,l=a.geometry,u=void 0===n?a.material:n,c=a.group;if(r.isArrayCamera){le=r;for(var h=r.cameras,d=0,f=h.length;d<f;d++){var p=h[d];if(s.layers.test(p.layers)){var m=p.bounds,v=m.x*fe,y=m.y*pe,b=m.z*fe,_=m.w*pe;J.setViewport(v,y,b,_),J.setScissor(v,y,b,_),J.setScissorTest(!0),g(s,t,p,l,u,c)}}}else le=null,g(s,t,r,l,u,c)}}function g(e,t,r,n,i,o){if(e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.onBeforeRender(J,t,r,n,i,o),e.isImmediateRenderObject){Be.setMaterial(i);var a=b(r,t.fog,i,e);ne="",u(e,a,i)}else J.renderBufferDirect(r,t.fog,n,i,e,o);e.onAfterRender(J,t,r,n,i,o)}function y(e,t,r){var n=De.get(e),i=He.getParameters(e,ke,t,_e.numPlanes,_e.numIntersection,r),a=He.getProgramCode(e,i),s=n.program,u=!0;if(void 0===s)e.addEventListener("dispose",o);else if(s.code!==a)l(e);else{if(void 0!==i.shaderID)return;u=!1}if(u){if(i.shaderID){var c=Ns[i.shaderID];n.shader={name:e.type,uniforms:js.clone(c.uniforms),vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}}else n.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(n.shader),s=He.acquireProgram(e,n.shader,i,a),n.program=s,e.program=s}var h=s.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var d=0;d<J.maxMorphTargets;d++)h["morphTarget"+d]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(var d=0;d<J.maxMorphNormals;d++)h["morphNormal"+d]>=0&&e.numSupportedMorphNormals++}var f=n.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(n.numClippingPlanes=_e.numPlanes,n.numIntersection=_e.numIntersection,f.clippingPlanes=_e.uniform),n.fog=t,n.lightsHash=ke.hash,e.lights&&(f.ambientLightColor.value=ke.ambient,f.directionalLights.value=ke.directional,f.spotLights.value=ke.spot,f.rectAreaLights.value=ke.rectArea,f.pointLights.value=ke.point,f.hemisphereLights.value=ke.hemi,f.directionalShadowMap.value=ke.directionalShadowMap,f.directionalShadowMatrix.value=ke.directionalShadowMatrix,f.spotShadowMap.value=ke.spotShadowMap,f.spotShadowMatrix.value=ke.spotShadowMatrix,f.pointShadowMap.value=ke.pointShadowMap,f.pointShadowMatrix.value=ke.pointShadowMatrix);var p=n.program.getUniforms(),m=Y.seqWithValue(p.seq,f);n.uniformsList=m}function b(e,t,r,n){de=0;var i=De.get(r);if(we&&(xe||e!==ie)){var o=e===ie&&r.id===re;_e.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,e,i,o)}!1===r.needsUpdate&&(void 0===i.program?r.needsUpdate=!0:r.fog&&i.fog!==t?r.needsUpdate=!0:r.lights&&i.lightsHash!==ke.hash?r.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===_e.numPlanes&&i.numIntersection===_e.numIntersection||(r.needsUpdate=!0)),r.needsUpdate&&(y(r,t,n),r.needsUpdate=!1);var a=!1,s=!1,l=!1,u=i.program,c=u.getUniforms(),h=i.shader.uniforms;if(u.id!==$&&(Oe.useProgram(u.program),$=u.id,a=!0,s=!0,l=!0),r.id!==re&&(re=r.id,s=!0),a||e!==ie){if(c.setValue(Oe,"projectionMatrix",e.projectionMatrix),Ie.logarithmicDepthBuffer&&c.setValue(Oe,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),ie!==(le||e)&&(ie=le||e,s=!0,l=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial||r.envMap){var f=c.map.cameraPosition;void 0!==f&&f.setValue(Oe,Ee.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.skinning)&&c.setValue(Oe,"viewMatrix",e.matrixWorldInverse)}if(r.skinning){c.setOptional(Oe,n,"bindMatrix"),c.setOptional(Oe,n,"bindMatrixInverse");var p=n.skeleton;if(p){var m=p.bones;if(Ie.floatVertexTextures){if(void 0===p.boneTexture){var v=Math.sqrt(4*m.length);v=Ts.nextPowerOfTwo(Math.ceil(v)),v=Math.max(v,4);var g=new Float32Array(v*v*4);g.set(p.boneMatrices);var b=new d(g,v,v,Va,Ba);p.boneMatrices=g,p.boneTexture=b,p.boneTextureSize=v}c.setValue(Oe,"boneTexture",p.boneTexture),c.setValue(Oe,"boneTextureSize",p.boneTextureSize)}else c.setOptional(Oe,p,"boneMatrices")}}return s&&(c.setValue(Oe,"toneMappingExposure",J.toneMappingExposure),c.setValue(Oe,"toneMappingWhitePoint",J.toneMappingWhitePoint),r.lights&&O(h,l),t&&r.fog&&E(h,t),(r.isMeshBasicMaterial||r.isMeshLambertMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial||r.isMeshNormalMaterial||r.isMeshDepthMaterial)&&_(h,r),r.isLineBasicMaterial?w(h,r):r.isLineDashedMaterial?(w(h,r),x(h,r)):r.isPointsMaterial?M(h,r):r.isMeshLambertMaterial?A(h,r):r.isMeshToonMaterial?k(h,r):r.isMeshPhongMaterial?T(h,r):r.isMeshPhysicalMaterial?C(h,r):r.isMeshStandardMaterial?S(h,r):r.isMeshDepthMaterial?r.displacementMap&&(h.displacementMap.value=r.displacementMap,h.displacementScale.value=r.displacementScale,h.displacementBias.value=r.displacementBias):r.isMeshNormalMaterial&&P(h,r),void 0!==h.ltcMat&&(h.ltcMat.value=Ds.LTC_MAT_TEXTURE),void 0!==h.ltcMag&&(h.ltcMag.value=Ds.LTC_MAG_TEXTURE),Y.upload(Oe,i.uniformsList,h,J)),c.setValue(Oe,"modelViewMatrix",n.modelViewMatrix),c.setValue(Oe,"normalMatrix",n.normalMatrix),c.setValue(Oe,"modelMatrix",n.matrixWorld),u}function _(e,t){e.opacity.value=t.opacity,e.diffuse.value=t.color,t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),e.map.value=t.map,e.specularMap.value=t.specularMap,e.alphaMap.value=t.alphaMap,t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity);var r;if(t.map?r=t.map:t.specularMap?r=t.specularMap:t.displacementMap?r=t.displacementMap:t.normalMap?r=t.normalMap:t.bumpMap?r=t.bumpMap:t.roughnessMap?r=t.roughnessMap:t.metalnessMap?r=t.metalnessMap:t.alphaMap?r=t.alphaMap:t.emissiveMap&&(r=t.emissiveMap),void 0!==r){r.isWebGLRenderTarget&&(r=r.texture);var n=r.offset,i=r.repeat;e.offsetRepeat.value.set(n.x,n.y,i.x,i.y)}e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio}function w(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function x(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}function M(e,t){if(e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*me,e.scale.value=.5*pe,e.map.value=t.map,null!==t.map){var r=t.map.offset,n=t.map.repeat;e.offsetRepeat.value.set(r.x,r.y,n.x,n.y)}}function E(e,t){e.fogColor.value=t.color,t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}function A(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}function T(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function k(e,t){T(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}function S(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}function C(e,t){e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness,S(e,t)}function P(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function O(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLights.needsUpdate=t,e.pointLights.needsUpdate=t,e.spotLights.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}function R(e){for(var t=0,r=0,n=e.length;r<n;r++){var i=e[r];i.castShadow&&(ke.shadows[t]=i,t++)}ke.shadows.length=t}function L(e,t){var r,n,i,o,a,s,l,u,c=0,h=0,d=0,f=t.matrixWorldInverse,p=0,m=0,v=0,g=0,y=0;for(r=0,n=e.length;r<n;r++)if(i=e[r],a=i.color,s=i.intensity,l=i.distance,u=i.shadow&&i.shadow.map?i.shadow.map.texture:null,i.isAmbientLight)c+=a.r*s,h+=a.g*s,d+=a.b*s;else if(i.isDirectionalLight){var b=Ke.get(i);b.color.copy(i.color).multiplyScalar(i.intensity),b.direction.setFromMatrixPosition(i.matrixWorld),Ee.setFromMatrixPosition(i.target.matrixWorld),b.direction.sub(Ee),b.direction.transformDirection(f),b.shadow=i.castShadow,i.castShadow&&(o=i.shadow,b.shadowBias=o.bias,b.shadowRadius=o.radius,b.shadowMapSize=o.mapSize),ke.directionalShadowMap[p]=u,ke.directionalShadowMatrix[p]=i.shadow.matrix,ke.directional[p]=b,p++}else if(i.isSpotLight){var b=Ke.get(i);b.position.setFromMatrixPosition(i.matrixWorld),b.position.applyMatrix4(f),b.color.copy(a).multiplyScalar(s),b.distance=l,b.direction.setFromMatrixPosition(i.matrixWorld),Ee.setFromMatrixPosition(i.target.matrixWorld),b.direction.sub(Ee),b.direction.transformDirection(f),b.coneCos=Math.cos(i.angle),b.penumbraCos=Math.cos(i.angle*(1-i.penumbra)),b.decay=0===i.distance?0:i.decay,b.shadow=i.castShadow,i.castShadow&&(o=i.shadow,b.shadowBias=o.bias,b.shadowRadius=o.radius,b.shadowMapSize=o.mapSize),ke.spotShadowMap[v]=u,ke.spotShadowMatrix[v]=i.shadow.matrix,ke.spot[v]=b,v++}else if(i.isRectAreaLight){var b=Ke.get(i);b.color.copy(a).multiplyScalar(s/(i.width*i.height)),b.position.setFromMatrixPosition(i.matrixWorld),b.position.applyMatrix4(f),Te.identity(),Ae.copy(i.matrixWorld),Ae.premultiply(f),Te.extractRotation(Ae),b.halfWidth.set(.5*i.width,0,0),b.halfHeight.set(0,.5*i.height,0),b.halfWidth.applyMatrix4(Te),b.halfHeight.applyMatrix4(Te),ke.rectArea[g]=b,g++}else if(i.isPointLight){var b=Ke.get(i);b.position.setFromMatrixPosition(i.matrixWorld),b.position.applyMatrix4(f),b.color.copy(i.color).multiplyScalar(i.intensity),b.distance=i.distance,b.decay=0===i.distance?0:i.decay,b.shadow=i.castShadow,i.castShadow&&(o=i.shadow,b.shadowBias=o.bias,b.shadowRadius=o.radius,b.shadowMapSize=o.mapSize),ke.pointShadowMap[m]=u,ke.pointShadowMatrix[m]=i.shadow.matrix,ke.point[m]=b,m++}else if(i.isHemisphereLight){var b=Ke.get(i);b.direction.setFromMatrixPosition(i.matrixWorld),b.direction.transformDirection(f),b.direction.normalize(),b.skyColor.copy(i.color).multiplyScalar(s),b.groundColor.copy(i.groundColor).multiplyScalar(s),ke.hemi[y]=b,y++}ke.ambient[0]=c,ke.ambient[1]=h,ke.ambient[2]=d,ke.directional.length=p,ke.spot.length=v,ke.rectArea.length=g,ke.point.length=m,ke.hemi.length=y,ke.hash=p+","+m+","+v+","+g+","+y+","+ke.shadows.length}function I(){var e=de;return e>=Ie.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+Ie.maxTextures),de+=1,e}function B(e){var t;if(e===_a)return Oe.REPEAT;if(e===wa)return Oe.CLAMP_TO_EDGE;if(e===xa)return Oe.MIRRORED_REPEAT;if(e===Ma)return Oe.NEAREST;if(e===Ea)return Oe.NEAREST_MIPMAP_NEAREST;if(e===Aa)return Oe.NEAREST_MIPMAP_LINEAR;if(e===Ta)return Oe.LINEAR;if(e===ka)return Oe.LINEAR_MIPMAP_NEAREST;if(e===Sa)return Oe.LINEAR_MIPMAP_LINEAR;if(e===Ca)return Oe.UNSIGNED_BYTE;if(e===ja)return Oe.UNSIGNED_SHORT_4_4_4_4;if(e===za)return Oe.UNSIGNED_SHORT_5_5_5_1;if(e===Na)return Oe.UNSIGNED_SHORT_5_6_5;if(e===Pa)return Oe.BYTE;if(e===Oa)return Oe.SHORT;if(e===Ra)return Oe.UNSIGNED_SHORT;if(e===La)return Oe.INT;if(e===Ia)return Oe.UNSIGNED_INT;if(e===Ba)return Oe.FLOAT;if(e===Da&&null!==(t=Le.get("OES_texture_half_float")))return t.HALF_FLOAT_OES;if(e===Fa)return Oe.ALPHA;if(e===Ha)return Oe.RGB;if(e===Va)return Oe.RGBA;if(e===Ga)return Oe.LUMINANCE;if(e===Wa)return Oe.LUMINANCE_ALPHA;if(e===Ya)return Oe.DEPTH_COMPONENT;if(e===qa)return Oe.DEPTH_STENCIL;if(e===Io)return Oe.FUNC_ADD;if(e===Bo)return Oe.FUNC_SUBTRACT;if(e===Do)return Oe.FUNC_REVERSE_SUBTRACT;if(e===No)return Oe.ZERO;if(e===Uo)return Oe.ONE;if(e===Fo)return Oe.SRC_COLOR;if(e===Ho)return Oe.ONE_MINUS_SRC_COLOR;if(e===Vo)return Oe.SRC_ALPHA;if(e===Go)return Oe.ONE_MINUS_SRC_ALPHA;if(e===Wo)return Oe.DST_ALPHA;if(e===Xo)return Oe.ONE_MINUS_DST_ALPHA;if(e===Yo)return Oe.DST_COLOR;if(e===qo)return Oe.ONE_MINUS_DST_COLOR;if(e===Ko)return Oe.SRC_ALPHA_SATURATE;if((e===Ka||e===Za||e===Qa||e===Ja)&&null!==(t=Le.get("WEBGL_compressed_texture_s3tc"))){if(e===Ka)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Za)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Qa)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Ja)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((e===$a||e===es||e===ts||e===rs)&&null!==(t=Le.get("WEBGL_compressed_texture_pvrtc"))){if(e===$a)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===es)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===ts)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===rs)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===ns&&null!==(t=Le.get("WEBGL_compressed_texture_etc1")))return t.COMPRESSED_RGB_ETC1_WEBGL;if((e===jo||e===zo)&&null!==(t=Le.get("EXT_blend_minmax"))){if(e===jo)return t.MIN_EXT;if(e===zo)return t.MAX_EXT}return e===Ua&&null!==(t=Le.get("WEBGL_depth_texture"))?t.UNSIGNED_INT_24_8_WEBGL:0}console.log("THREE.WebGLRenderer",lo),e=e||{};var D=void 0!==e.canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),j=void 0!==e.context?e.context:null,z=void 0!==e.alpha&&e.alpha,N=void 0===e.depth||e.depth,U=void 0===e.stencil||e.stencil,F=void 0!==e.antialias&&e.antialias,H=void 0===e.premultipliedAlpha||e.premultipliedAlpha,V=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,G=[],W=null,X=new Float32Array(8),q=[],K=[];this.domElement=D,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=la,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var J=this,$=null,ee=null,te=null,re=-1,ne="",ie=null,le=null,ue=new a,ce=null,he=new a,de=0,fe=D.width,pe=D.height,me=1,ve=new a(0,0,fe,pe),ge=!1,ye=new a(0,0,fe,pe),be=new oe,_e=new gt,we=!1,xe=!1,Me=new h,Ee=new c,Ae=new h,Te=new h,ke={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},Se={geometries:0,textures:0},Pe={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:Pe,memory:Se,programs:null};var Oe;try{var Re={alpha:z,depth:N,stencil:U,antialias:F,premultipliedAlpha:H,preserveDrawingBuffer:V};if(null===(Oe=j||D.getContext("webgl",Re)||D.getContext("experimental-webgl",Re)))throw null!==D.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===Oe.getShaderPrecisionFormat&&(Oe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),D.addEventListener("webglcontextlost",i,!1)}catch(e){console.error("THREE.WebGLRenderer: "+e)}var Le=new vt(Oe);Le.get("WEBGL_depth_texture"),Le.get("OES_texture_float"),Le.get("OES_texture_float_linear"),Le.get("OES_texture_half_float"),Le.get("OES_texture_half_float_linear"),Le.get("OES_standard_derivatives"),Le.get("ANGLE_instanced_arrays"),Le.get("OES_element_index_uint")&&(Ce.MaxIndex=4294967296);var Ie=new ft(Oe,Le,e),Be=new dt(Oe,Le,B),De=new ht,je=new ct(Oe,Le,Be,De,Ie,B,Se),ze=new se(Oe),Ue=new Xe(Oe,ze,Se),Fe=new qe(Oe,Ue,Pe),He=new ut(this,Ie),Ke=new Ye,Ze=new Ve,Qe=new Ne(this,Be,Fe,H),Je=new mt(this);this.info.programs=He.programs;var $e=new We(Oe,Le,Pe),et=new Ge(Oe,Le,Pe);r(),this.context=Oe,this.capabilities=Ie,this.extensions=Le,this.properties=De,this.renderLists=Ze,this.state=Be,this.vr=Je;var tt=new ae(this,ke,Fe,Ie);this.shadowMap=tt;var rt=new Q(this,q),nt=new Z(this,K);this.getContext=function(){return Oe},this.getContextAttributes=function(){return Oe.getContextAttributes()},this.forceContextLoss=function(){var e=Le.get("WEBGL_lose_context");e&&e.loseContext()},this.getMaxAnisotropy=function(){return Ie.getMaxAnisotropy()},this.getPrecision=function(){return Ie.precision},this.getPixelRatio=function(){return me},this.setPixelRatio=function(e){void 0!==e&&(me=e,this.setSize(fe,pe,!1))},this.getSize=function(){return{width:fe,height:pe}},this.setSize=function(e,t,r){var n=Je.getDevice();if(n&&n.isPresenting)return void console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");fe=e,pe=t,D.width=e*me,D.height=t*me,!1!==r&&(D.style.width=e+"px",D.style.height=t+"px"),this.setViewport(0,0,e,t)},this.getDrawingBufferSize=function(){return{width:fe*me,height:pe*me}},this.setDrawingBufferSize=function(e,t,r){fe=e,pe=t,me=r,D.width=e*r,D.height=t*r,this.setViewport(0,0,e,t)},this.setViewport=function(e,t,r,n){ye.set(e,pe-t-n,r,n),Be.viewport(he.copy(ye).multiplyScalar(me))},this.setScissor=function(e,t,r,n){ve.set(e,pe-t-n,r,n),Be.scissor(ue.copy(ve).multiplyScalar(me))},this.setScissorTest=function(e){Be.setScissorTest(ge=e)},this.getClearColor=Qe.getClearColor,this.setClearColor=Qe.setClearColor,this.getClearAlpha=Qe.getClearAlpha,this.setClearAlpha=Qe.setClearAlpha,this.clear=function(e,t,r){var n=0;(void 0===e||e)&&(n|=Oe.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=Oe.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=Oe.STENCIL_BUFFER_BIT),Oe.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,r,n){this.setRenderTarget(e),this.clear(t,r,n)},this.resetGLState=n,this.dispose=function(){D.removeEventListener("webglcontextlost",i,!1),Ze.dispose()},this.renderBufferImmediate=function(e,t,r){Be.initAttributes();var n=De.get(e);e.hasPositions&&!n.position&&(n.position=Oe.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=Oe.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=Oe.createBuffer()),e.hasColors&&!n.color&&(n.color=Oe.createBuffer());var i=t.getAttributes();if(e.hasPositions&&(Oe.bindBuffer(Oe.ARRAY_BUFFER,n.position),Oe.bufferData(Oe.ARRAY_BUFFER,e.positionArray,Oe.DYNAMIC_DRAW),Be.enableAttribute(i.position),Oe.vertexAttribPointer(i.position,3,Oe.FLOAT,!1,0,0)),e.hasNormals){if(Oe.bindBuffer(Oe.ARRAY_BUFFER,n.normal),!r.isMeshPhongMaterial&&!r.isMeshStandardMaterial&&!r.isMeshNormalMaterial&&r.shading===Mo)for(var o=0,a=3*e.count;o<a;o+=9){var s=e.normalArray,l=(s[o+0]+s[o+3]+s[o+6])/3,u=(s[o+1]+s[o+4]+s[o+7])/3,c=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=l,s[o+1]=u,s[o+2]=c,s[o+3]=l,s[o+4]=u,s[o+5]=c,s[o+6]=l,s[o+7]=u,s[o+8]=c}Oe.bufferData(Oe.ARRAY_BUFFER,e.normalArray,Oe.DYNAMIC_DRAW),Be.enableAttribute(i.normal),Oe.vertexAttribPointer(i.normal,3,Oe.FLOAT,!1,0,0)}e.hasUvs&&r.map&&(Oe.bindBuffer(Oe.ARRAY_BUFFER,n.uv),Oe.bufferData(Oe.ARRAY_BUFFER,e.uvArray,Oe.DYNAMIC_DRAW),Be.enableAttribute(i.uv),Oe.vertexAttribPointer(ze.uv,2,Oe.FLOAT,!1,0,0)),e.hasColors&&r.vertexColors!==Ao&&(Oe.bindBuffer(Oe.ARRAY_BUFFER,n.color),Oe.bufferData(Oe.ARRAY_BUFFER,e.colorArray,Oe.DYNAMIC_DRAW),Be.enableAttribute(i.color),Oe.vertexAttribPointer(i.color,3,Oe.FLOAT,!1,0,0)),Be.disableUnusedAttributes(),Oe.drawArrays(Oe.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,r,n,i,o,a){Be.setMaterial(i);var s=b(e,r,i,o),l=n.id+"_"+s.id+"_"+(!0===i.wireframe),u=!1;l!==ne&&(ne=l,u=!0);var c=o.morphTargetInfluences;if(void 0!==c){for(var h=[],d=0,m=c.length;d<m;d++){var v=c[d];h.push([v,d])}h.sort(f),h.length>8&&(h.length=8);for(var g=n.morphAttributes,d=0,m=h.length;d<m;d++){var v=h[d];if(X[d]=v[0],0!==v[0]){var y=v[1];!0===i.morphTargets&&g.position&&n.addAttribute("morphTarget"+d,g.position[y]),!0===i.morphNormals&&g.normal&&n.addAttribute("morphNormal"+d,g.normal[y])}else!0===i.morphTargets&&n.removeAttribute("morphTarget"+d),!0===i.morphNormals&&n.removeAttribute("morphNormal"+d)}for(var d=h.length,_=X.length;d<_;d++)X[d]=0;s.getUniforms().setValue(Oe,"morphTargetInfluences",X),u=!0}var y=n.index,w=n.attributes.position,x=1;!0===i.wireframe&&(y=Ue.getWireframeAttribute(n),x=2);var M,E=$e;null!==y&&(M=ze.get(y),E=et,E.setIndex(M)),u&&(p(i,s,n),null!==y&&Oe.bindBuffer(Oe.ELEMENT_ARRAY_BUFFER,M.buffer));var A=0;null!==y?A=y.count:void 0!==w&&(A=w.count);var T=n.drawRange.start*x,k=n.drawRange.count*x,S=null!==a?a.start*x:0,C=null!==a?a.count*x:1/0,P=Math.max(T,S),O=Math.min(A,T+k,S+C)-1,R=Math.max(0,O-P+1);if(0!==R){if(o.isMesh)if(!0===i.wireframe)Be.setLineWidth(i.wireframeLinewidth*t()),E.setMode(Oe.LINES);else switch(o.drawMode){case fs:E.setMode(Oe.TRIANGLES);break;case ps:E.setMode(Oe.TRIANGLE_STRIP);break;case ms:E.setMode(Oe.TRIANGLE_FAN)}else if(o.isLine){var L=i.linewidth;void 0===L&&(L=1),Be.setLineWidth(L*t()),o.isLineSegments?E.setMode(Oe.LINES):o.isLineLoop?E.setMode(Oe.LINE_LOOP):E.setMode(Oe.LINE_STRIP)}else o.isPoints&&E.setMode(Oe.POINTS);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&E.renderInstances(n,P,R):E.render(P,R)}},this.compile=function(e,t){G=[],e.traverse(function(e){e.isLight&&G.push(e)}),L(G,t),e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var r=0;r<t.material.length;r++)y(t.material[r],e.fog,t);else y(t.material,e.fog,t)})},this.animate=function(e){function t(){e(),(Je.getDevice()||window).requestAnimationFrame(t)}(Je.getDevice()||window).requestAnimationFrame(t)},this.render=function(e,t,r,n){if(!t||!t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");ne="",re=-1,ie=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),Je.enabled&&(t=Je.getCamera(t)),Me.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),be.setFromMatrix(Me),G.length=0,q.length=0,K.length=0,xe=this.localClippingEnabled,we=_e.init(this.clippingPlanes,xe,t),W=Ze.get(e,t),W.init(),m(e,t,J.sortObjects),W.finish(),!0===J.sortObjects&&W.sort(),we&&_e.beginShadows(),R(G),tt.render(e,t),L(G,t),we&&_e.endShadows(),Pe.frame++,Pe.calls=0,Pe.vertices=0,Pe.faces=0,Pe.points=0,void 0===r&&(r=null),this.setRenderTarget(r),Qe.render(e,t,n);var i=W.opaque,o=W.transparent;if(e.overrideMaterial){var a=e.overrideMaterial;i.length&&v(i,e,t,a),o.length&&v(o,e,t,a)}else i.length&&v(i,e,t),o.length&&v(o,e,t);rt.render(e,t),nt.render(e,t,he),r&&je.updateRenderTargetMipmap(r),Be.buffers.depth.setTest(!0),Be.buffers.depth.setMask(!0),Be.buffers.color.setMask(!0),t.isArrayCamera&&J.setScissorTest(!1),Je.enabled&&Je.submitFrame()},this.setFaceCulling=function(e,t){Be.setCullFace(e),Be.setFlipSided(t===mo)},this.allocTextureUnit=I,this.setTexture2D=function(){var e=!1;return function(t,r){t&&t.isWebGLRenderTarget&&(e||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),je.setTexture2D(t,r)}}(),this.setTexture=function(){var e=!1;return function(t,r){e||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),e=!0),je.setTexture2D(t,r)}}(),this.setTextureCube=function(){var e=!1;return function(t,r){t&&t.isWebGLRenderTargetCube&&(e||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?je.setTextureCube(t,r):je.setTextureCubeDynamic(t,r)}}(),this.getRenderTarget=function(){return ee},this.setRenderTarget=function(e){ee=e,e&&void 0===De.get(e).__webglFramebuffer&&je.setupRenderTarget(e);var t,r=e&&e.isWebGLRenderTargetCube;if(e){var n=De.get(e);t=r?n.__webglFramebuffer[e.activeCubeFace]:n.__webglFramebuffer,ue.copy(e.scissor),ce=e.scissorTest,he.copy(e.viewport)}else t=null,ue.copy(ve).multiplyScalar(me),ce=ge,he.copy(ye).multiplyScalar(me);if(te!==t&&(Oe.bindFramebuffer(Oe.FRAMEBUFFER,t),te=t),Be.scissor(ue),Be.setScissorTest(ce),Be.viewport(he),r){var i=De.get(e.texture);Oe.framebufferTexture2D(Oe.FRAMEBUFFER,Oe.COLOR_ATTACHMENT0,Oe.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,i.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,r,n,i,o){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");var a=De.get(e).__webglFramebuffer;if(a){var s=!1;a!==te&&(Oe.bindFramebuffer(Oe.FRAMEBUFFER,a),s=!0);try{var l=e.texture,u=l.format,c=l.type;if(u!==Va&&B(u)!==Oe.getParameter(Oe.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(c===Ca||B(c)===Oe.getParameter(Oe.IMPLEMENTATION_COLOR_READ_TYPE)||c===Ba&&(Le.get("OES_texture_float")||Le.get("WEBGL_color_buffer_float"))||c===Da&&Le.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Oe.checkFramebufferStatus(Oe.FRAMEBUFFER)===Oe.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-n&&r>=0&&r<=e.height-i&&Oe.readPixels(t,r,n,i,B(u),B(c),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&Oe.bindFramebuffer(Oe.FRAMEBUFFER,te)}}}}function bt(e,t){this.name="",this.color=new q(e),this.density=void 0!==t?t:25e-5}function _t(e,t,r){this.name="",this.color=new q(e),this.near=void 0!==t?t:1,this.far=void 0!==r?r:1e3}function wt(){ce.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function xt(e,t,r,n,i){ce.call(this),this.lensFlares=[],this.positionScreen=new c,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,r,n,i)}function Mt(e){J.call(this),this.type="SpriteMaterial",this.color=new q(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(e)}function Et(e){ce.call(this),this.type="Sprite",this.material=void 0!==e?e:new Mt}function At(){ce.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Tt(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new h)}}function kt(){ce.call(this),this.type="Bone"}function St(e,t){ze.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new h,this.bindMatrixInverse=new h;var r=this.initBones(),n=new Tt(r);this.bind(n,this.matrixWorld),this.normalizeSkinWeights()}function Ct(e){J.call(this),this.type="LineBasicMaterial",this.color=new q(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function Pt(e,t,r){if(1===r)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new Ot(e,t);ce.call(this),this.type="Line",this.geometry=void 0!==e?e:new Ce,this.material=void 0!==t?t:new Ct({color:16777215*Math.random()})}function Ot(e,t){Pt.call(this,e,t),this.type="LineSegments"}function Rt(e,t){Pt.call(this,e,t),this.type="LineLoop"}function Lt(e){J.call(this),this.type="PointsMaterial",this.color=new q(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(e)}function It(e,t){ce.call(this),this.type="Points",this.geometry=void 0!==e?e:new Ce,this.material=void 0!==t?t:new Lt({color:16777215*Math.random()})}function Bt(){ce.call(this),this.type="Group"}function Dt(e,t,r,n,i,a,s,l,u){function c(){requestAnimationFrame(c),e.readyState>=e.HAVE_CURRENT_DATA&&(h.needsUpdate=!0)}o.call(this,e,t,r,n,i,a,s,l,u),this.generateMipmaps=!1;var h=this;c()}function jt(e,t,r,n,i,a,s,l,u,c,h,d){o.call(this,null,a,s,l,u,c,n,i,h,d),this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function zt(e,t,r,n,i,a,s,l,u){o.call(this,e,t,r,n,i,a,s,l,u),this.needsUpdate=!0}function Nt(e,t,r,n,i,a,s,l,u,c){if((c=void 0!==c?c:Ya)!==Ya&&c!==qa)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&c===Ya&&(r=Ra),void 0===r&&c===qa&&(r=Ua),o.call(this,null,n,i,a,s,l,c,r,u),this.image={width:e,height:t},this.magFilter=void 0!==s?s:Ma,this.minFilter=void 0!==l?l:Ma,this.flipY=!1,this.generateMipmaps=!1}function Ut(e){Ce.call(this),this.type="WireframeGeometry";var t,r,n,i,o,a,s,l,u,h,d=[],f=[0,0],p={},m=["a","b","c"];if(e&&e.isGeometry){var v=e.faces;for(t=0,n=v.length;t<n;t++){var g=v[t];for(r=0;r<3;r++)s=g[m[r]],l=g[m[(r+1)%3]],f[0]=Math.min(s,l),f[1]=Math.max(s,l),u=f[0]+","+f[1],void 0===p[u]&&(p[u]={index1:f[0],index2:f[1]})}for(u in p)a=p[u],h=e.vertices[a.index1],d.push(h.x,h.y,h.z),h=e.vertices[a.index2],d.push(h.x,h.y,h.z)}else if(e&&e.isBufferGeometry){var y,b,_,w,x,M,E,A;if(h=new c,null!==e.index){for(y=e.attributes.position,b=e.index,_=e.groups,0===_.length&&(_=[{start:0,count:b.count,materialIndex:0}]),i=0,o=_.length;i<o;++i)for(w=_[i],x=w.start,M=w.count,t=x,n=x+M;t<n;t+=3)for(r=0;r<3;r++)s=b.getX(t+r),l=b.getX(t+(r+1)%3),f[0]=Math.min(s,l),f[1]=Math.max(s,l),u=f[0]+","+f[1],void 0===p[u]&&(p[u]={index1:f[0],index2:f[1]});for(u in p)a=p[u],h.fromBufferAttribute(y,a.index1),d.push(h.x,h.y,h.z),h.fromBufferAttribute(y,a.index2),d.push(h.x,h.y,h.z)}else for(y=e.attributes.position,t=0,n=y.count/3;t<n;t++)for(r=0;r<3;r++)E=3*t+r,h.fromBufferAttribute(y,E),d.push(h.x,h.y,h.z),A=3*t+(r+1)%3,h.fromBufferAttribute(y,A),d.push(h.x,h.y,h.z)}this.addAttribute("position",new Ae(d,3))}function Ft(e,t,r){ve.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:r},this.fromBufferGeometry(new Ht(e,t,r)),this.mergeVertices()}function Ht(e,t,r){Ce.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:r};var n,i,o=[],a=[],s=[],l=[],u=new c,h=new c,d=new c,f=new c,p=new c,m=t+1;for(n=0;n<=r;n++){var v=n/r;for(i=0;i<=t;i++){var g=i/t;h=e(g,v,h),a.push(h.x,h.y,h.z),g-1e-5>=0?(d=e(g-1e-5,v,d),f.subVectors(h,d)):(d=e(g+1e-5,v,d),f.subVectors(d,h)),v-1e-5>=0?(d=e(g,v-1e-5,d),p.subVectors(h,d)):(d=e(g,v+1e-5,d),p.subVectors(d,h)),u.crossVectors(f,p).normalize(),s.push(u.x,u.y,u.z),l.push(g,v)}}for(n=0;n<r;n++)for(i=0;i<t;i++){var y=n*m+i,b=n*m+i+1,_=(n+1)*m+i+1,w=(n+1)*m+i;o.push(y,b,w),o.push(b,_,w)}this.setIndex(o),this.addAttribute("position",new Ae(a,3)),this.addAttribute("normal",new Ae(s,3)),this.addAttribute("uv",new Ae(l,2))}function Vt(e,t,r,n){ve.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},this.fromBufferGeometry(new Gt(e,t,r,n)),this.mergeVertices()}function Gt(e,t,r,n){function o(e,t,r,n){var i,o,a=Math.pow(2,n),l=[];for(i=0;i<=a;i++){l[i]=[];var u=e.clone().lerp(r,i/a),c=t.clone().lerp(r,i/a),h=a-i;for(o=0;o<=h;o++)l[i][o]=0===o&&i===a?u:u.clone().lerp(c,o/h)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var d=Math.floor(o/2);o%2==0?(s(l[i][d+1]),s(l[i+1][d]),s(l[i][d])):(s(l[i][d+1]),s(l[i+1][d+1]),s(l[i+1][d]))}}function a(){for(var e=0;e<m.length;e+=6){var t=m[e+0],r=m[e+2],n=m[e+4],i=Math.max(t,r,n),o=Math.min(t,r,n);i>.9&&o<.1&&(t<.2&&(m[e+0]+=1),r<.2&&(m[e+2]+=1),n<.2&&(m[e+4]+=1))}}function s(e){p.push(e.x,e.y,e.z)}function l(t,r){var n=3*t;r.x=e[n+0],r.y=e[n+1],r.z=e[n+2]}function u(){for(var e=new c,t=new c,r=new c,n=new c,o=new i,a=new i,s=new i,l=0,u=0;l<p.length;l+=9,u+=6){e.set(p[l+0],p[l+1],p[l+2]),t.set(p[l+3],p[l+4],p[l+5]),r.set(p[l+6],p[l+7],p[l+8]),o.set(m[u+0],m[u+1]),a.set(m[u+2],m[u+3]),s.set(m[u+4],m[u+5]),n.copy(e).add(t).add(r).divideScalar(3);var f=d(n);h(o,u+0,e,f),h(a,u+2,t,f),h(s,u+4,r,f)}}function h(e,t,r,n){n<0&&1===e.x&&(m[t]=e.x-1),0===r.x&&0===r.z&&(m[t]=n/2/Math.PI+.5)}function d(e){return Math.atan2(e.z,-e.x)}function f(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}Ce.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},r=r||1,n=n||0;var p=[],m=[];!function(e){for(var r=new c,n=new c,i=new c,a=0;a<t.length;a+=3)l(t[a+0],r),l(t[a+1],n),l(t[a+2],i),o(r,n,i,e)}(n),function(e){for(var t=new c,r=0;r<p.length;r+=3)t.x=p[r+0],t.y=p[r+1],t.z=p[r+2],t.normalize().multiplyScalar(e),p[r+0]=t.x,p[r+1]=t.y,p[r+2]=t.z}(r),function(){for(var e=new c,t=0;t<p.length;t+=3){e.x=p[t+0],e.y=p[t+1],e.z=p[t+2];var r=d(e)/2/Math.PI+.5,n=f(e)/Math.PI+.5;m.push(r,1-n)}u(),a()}(),this.addAttribute("position",new Ae(p,3)),this.addAttribute("normal",new Ae(p.slice(),3)),this.addAttribute("uv",new Ae(m,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function Wt(e,t){ve.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Xt(e,t)),this.mergeVertices()}function Xt(e,t){var r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],n=[2,1,0,0,3,2,1,3,0,2,3,1];Gt.call(this,r,n,e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Yt(e,t){ve.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new qt(e,t)),this.mergeVertices()}function qt(e,t){var r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];Gt.call(this,r,n,e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Kt(e,t){ve.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Zt(e,t)),this.mergeVertices()}function Zt(e,t){var r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],i=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];Gt.call(this,n,i,e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Qt(e,t){ve.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Jt(e,t)),this.mergeVertices()}function Jt(e,t){var r=(1+Math.sqrt(5))/2,n=1/r,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];Gt.call(this,i,o,e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function $t(e,t,r,n,i,o){ve.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new er(e,t,r,n,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function er(e,t,r,n,o){function a(i){var o=e.getPointAt(i/t),a=u.normals[i],s=u.binormals[i];for(d=0;d<=n;d++){var l=d/n*Math.PI*2,c=Math.sin(l),h=-Math.cos(l);p.x=h*a.x+c*s.x,p.y=h*a.y+c*s.y,p.z=h*a.z+c*s.z,p.normalize(),g.push(p.x,p.y,p.z),f.x=o.x+r*p.x,f.y=o.y+r*p.y,f.z=o.z+r*p.z,v.push(f.x,f.y,f.z)}}function s(){for(d=1;d<=t;d++)for(h=1;h<=n;h++){var e=(n+1)*(d-1)+(h-1),r=(n+1)*d+(h-1),i=(n+1)*d+h,o=(n+1)*(d-1)+h;b.push(e,r,o),b.push(r,i,o)}}function l(){for(h=0;h<=t;h++)for(d=0;d<=n;d++)m.x=h/t,m.y=d/n,y.push(m.x,m.y)}Ce.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:o},t=t||64,r=r||1,n=n||8,o=o||!1;var u=e.computeFrenetFrames(t,o);this.tangents=u.tangents,this.normals=u.normals,this.binormals=u.binormals;var h,d,f=new c,p=new c,m=new i,v=[],g=[],y=[],b=[];!function(){for(h=0;h<t;h++)a(h);a(!1===o?t:0),l(),s()}(),this.setIndex(b),this.addAttribute("position",new Ae(v,3)),this.addAttribute("normal",new Ae(g,3)),this.addAttribute("uv",new Ae(y,2))}function tr(e,t,r,n,i,o,a){ve.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new rr(e,t,r,n,i,o)),this.mergeVertices()}function rr(e,t,r,n,i,o){function a(e,t,r,n,i){var o=Math.cos(e),a=Math.sin(e),s=r/t*e,l=Math.cos(s);i.x=n*(2+l)*.5*o,i.y=n*(2+l)*a*.5,i.z=n*Math.sin(s)*.5}Ce.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:o},e=e||100,t=t||40,r=Math.floor(r)||64,n=Math.floor(n)||8,i=i||2,o=o||3;var s,l,u=[],h=[],d=[],f=[],p=new c,m=new c,v=new c,g=new c,y=new c,b=new c,_=new c;for(s=0;s<=r;++s){var w=s/r*i*Math.PI*2;for(a(w,i,o,e,v),a(w+.01,i,o,e,g),b.subVectors(g,v),_.addVectors(g,v),y.crossVectors(b,_),_.crossVectors(y,b),y.normalize(),_.normalize(),l=0;l<=n;++l){var x=l/n*Math.PI*2,M=-t*Math.cos(x),E=t*Math.sin(x);p.x=v.x+(M*_.x+E*y.x),p.y=v.y+(M*_.y+E*y.y),p.z=v.z+(M*_.z+E*y.z),h.push(p.x,p.y,p.z),m.subVectors(p,v).normalize(),d.push(m.x,m.y,m.z),f.push(s/r),f.push(l/n)}}for(l=1;l<=r;l++)for(s=1;s<=n;s++){var A=(n+1)*(l-1)+(s-1),T=(n+1)*l+(s-1),k=(n+1)*l+s,S=(n+1)*(l-1)+s;u.push(A,T,S),u.push(T,k,S)}this.setIndex(u),this.addAttribute("position",new Ae(h,3)),this.addAttribute("normal",new Ae(d,3)),this.addAttribute("uv",new Ae(f,2))}function nr(e,t,r,n,i){ve.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},this.fromBufferGeometry(new ir(e,t,r,n,i)),this.mergeVertices()}function ir(e,t,r,n,i){Ce.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},e=e||100,t=t||40,r=Math.floor(r)||8,n=Math.floor(n)||6,i=i||2*Math.PI;var o,a,s=[],l=[],u=[],h=[],d=new c,f=new c,p=new c;for(o=0;o<=r;o++)for(a=0;a<=n;a++){var m=a/n*i,v=o/r*Math.PI*2;f.x=(e+t*Math.cos(v))*Math.cos(m),f.y=(e+t*Math.cos(v))*Math.sin(m),f.z=t*Math.sin(v),l.push(f.x,f.y,f.z),d.x=e*Math.cos(m),d.y=e*Math.sin(m),p.subVectors(f,d).normalize(),u.push(p.x,p.y,p.z),h.push(a/n),h.push(o/r)}for(o=1;o<=r;o++)for(a=1;a<=n;a++){var g=(n+1)*o+a-1,y=(n+1)*(o-1)+a-1,b=(n+1)*(o-1)+a,_=(n+1)*o+a;s.push(g,y,_),s.push(y,b,_)}this.setIndex(s),this.addAttribute("position",new Ae(l,3)),this.addAttribute("normal",new Ae(u,3)),this.addAttribute("uv",new Ae(h,2))}function or(e,t){ve.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new ar(e,t)),this.mergeVertices()}function ar(e,t){void 0!==e&&(Ce.call(this),this.type="ExtrudeBufferGeometry",e=Array.isArray(e)?e:[e],this.addShapeList(e,t),this.computeVertexNormals())}function sr(e,t){ve.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new lr(e,t)),this.mergeVertices()}function lr(e,t){t=t||{};var r=t.font;if(!r||!r.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new ve;var n=r.generateShapes(e,t.size,t.curveSegments);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),ar.call(this,n,t),this.type="TextBufferGeometry"}function ur(e,t,r,n,i,o,a){ve.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new cr(e,t,r,n,i,o,a)),this.mergeVertices()}function cr(e,t,r,n,i,o,a){Ce.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:a},e=e||50,t=Math.max(3,Math.floor(t)||8),r=Math.max(2,Math.floor(r)||6),n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;var s,l,u=o+a,h=0,d=[],f=new c,p=new c,m=[],v=[],g=[],y=[];for(l=0;l<=r;l++){var b=[],_=l/r;for(s=0;s<=t;s++){var w=s/t;f.x=-e*Math.cos(n+w*i)*Math.sin(o+_*a),f.y=e*Math.cos(o+_*a),f.z=e*Math.sin(n+w*i)*Math.sin(o+_*a),v.push(f.x,f.y,f.z),p.set(f.x,f.y,f.z).normalize(),g.push(p.x,p.y,p.z),y.push(w,1-_),b.push(h++)}d.push(b)}for(l=0;l<r;l++)for(s=0;s<t;s++){var x=d[l][s+1],M=d[l][s],E=d[l+1][s],A=d[l+1][s+1];(0!==l||o>0)&&m.push(x,M,A),(l!==r-1||u<Math.PI)&&m.push(M,E,A)}this.setIndex(m),this.addAttribute("position",new Ae(v,3)),this.addAttribute("normal",new Ae(g,3)),this.addAttribute("uv",new Ae(y,2))}function hr(e,t,r,n,i,o){ve.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new dr(e,t,r,n,i,o)),this.mergeVertices()}function dr(e,t,r,n,o,a){Ce.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:o,thetaLength:a},e=e||20,t=t||50,o=void 0!==o?o:0,a=void 0!==a?a:2*Math.PI,r=void 0!==r?Math.max(3,r):8,n=void 0!==n?Math.max(1,n):1;var s,l,u,h=[],d=[],f=[],p=[],m=e,v=(t-e)/n,g=new c,y=new i;for(l=0;l<=n;l++){for(u=0;u<=r;u++)s=o+u/r*a,g.x=m*Math.cos(s),g.y=m*Math.sin(s),d.push(g.x,g.y,g.z),f.push(0,0,1),y.x=(g.x/t+1)/2,y.y=(g.y/t+1)/2,p.push(y.x,y.y);m+=v}for(l=0;l<n;l++){var b=l*(r+1);for(u=0;u<r;u++){s=u+b;var _=s,w=s+r+1,x=s+r+2,M=s+1;h.push(_,w,M),h.push(w,x,M)}}this.setIndex(h),this.addAttribute("position",new Ae(d,3)),this.addAttribute("normal",new Ae(f,3)),this.addAttribute("uv",new Ae(p,2))}function fr(e,t,r,n){ve.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},this.fromBufferGeometry(new pr(e,t,r,n)),this.mergeVertices()}function pr(e,t,r,n){Ce.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=Math.floor(t)||12,r=r||0,n=n||2*Math.PI,n=Ts.clamp(n,0,2*Math.PI);var o,a,s,l=[],u=[],h=[],d=1/t,f=new c,p=new i;for(a=0;a<=t;a++){var m=r+a*d*n,v=Math.sin(m),g=Math.cos(m);for(s=0;s<=e.length-1;s++)f.x=e[s].x*v,f.y=e[s].y,f.z=e[s].x*g,u.push(f.x,f.y,f.z),p.x=a/t,p.y=s/(e.length-1),h.push(p.x,p.y)}for(a=0;a<t;a++)for(s=0;s<e.length-1;s++){o=s+a*e.length;var y=o,b=o+e.length,_=o+e.length+1,w=o+1;l.push(y,b,w),l.push(b,_,w)}if(this.setIndex(l),this.addAttribute("position",new Ae(u,3)),this.addAttribute("uv",new Ae(h,2)),this.computeVertexNormals(),n===2*Math.PI){var x=this.attributes.normal.array,M=new c,E=new c,A=new c;for(o=t*e.length*3,a=0,s=0;a<e.length;a++,s+=3)M.x=x[s+0],M.y=x[s+1],M.z=x[s+2],E.x=x[o+s+0],E.y=x[o+s+1],E.z=x[o+s+2],A.addVectors(M,E).normalize(),x[s+0]=x[o+s+0]=A.x,x[s+1]=x[o+s+1]=A.y,x[s+2]=x[o+s+2]=A.z}}function mr(e,t){ve.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new vr(e,t)),this.mergeVertices()}function vr(e,t){function r(e){var r,s,u,c=i.length/3,h=e.extractPoints(t),d=h.shape,f=h.holes;if(!1===Gs.isClockWise(d))for(d=d.reverse(),r=0,s=f.length;r<s;r++)u=f[r],!0===Gs.isClockWise(u)&&(f[r]=u.reverse());var p=Gs.triangulateShape(d,f);for(r=0,s=f.length;r<s;r++)u=f[r],d=d.concat(u);for(r=0,s=d.length;r<s;r++){var m=d[r];i.push(m.x,m.y,0),o.push(0,0,1),a.push(m.x,m.y)}for(r=0,s=p.length;r<s;r++){var v=p[r],g=v[0]+c,y=v[1]+c,b=v[2]+c;n.push(g,y,b),l+=3}}Ce.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],i=[],o=[],a=[],s=0,l=0;if(!1===Array.isArray(e))r(e);else for(var u=0;u<e.length;u++)r(e[u]),this.addGroup(s,l,u),s+=l,l=0;this.setIndex(n),this.addAttribute("position",new Ae(i,3)),this.addAttribute("normal",new Ae(o,3)),this.addAttribute("uv",new Ae(a,2))}function gr(e,t){Ce.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var r,n,i,o,a=[],s=Math.cos(Ts.DEG2RAD*t),l=[0,0],u={},c=["a","b","c"];e.isBufferGeometry?(o=new ve,o.fromBufferGeometry(e)):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,d=o.faces,f=0,p=d.length;f<p;f++)for(var m=d[f],v=0;v<3;v++)r=m[c[v]],n=m[c[(v+1)%3]],l[0]=Math.min(r,n),l[1]=Math.max(r,n),i=l[0]+","+l[1],void 0===u[i]?u[i]={index1:l[0],index2:l[1],face1:f,face2:void 0}:u[i].face2=f;for(i in u){var g=u[i];if(void 0===g.face2||d[g.face1].normal.dot(d[g.face2].normal)<=s){var y=h[g.index1];a.push(y.x,y.y,y.z),y=h[g.index2],a.push(y.x,y.y,y.z)}}this.addAttribute("position",new Ae(a,3))}function yr(e,t,r,n,i,o,a,s){ve.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new br(e,t,r,n,i,o,a,s)),this.mergeVertices()}function br(e,t,r,n,o,a,s,l){function u(r){var o,a,u,g=new i,_=new c,w=0,x=!0===r?e:t,M=!0===r?1:-1;for(a=v,o=1;o<=n;o++)f.push(0,y*M,0),p.push(0,M,0),m.push(.5,.5),v++;for(u=v,o=0;o<=n;o++){var E=o/n,A=E*l+s,T=Math.cos(A),k=Math.sin(A);_.x=x*k,_.y=y*M,_.z=x*T,f.push(_.x,_.y,_.z),p.push(0,M,0),g.x=.5*T+.5,g.y=.5*k*M+.5,m.push(g.x,g.y),v++}for(o=0;o<n;o++){var S=a+o,C=u+o;!0===r?d.push(C,C+1,S):d.push(C+1,C,S),w+=3}h.addGroup(b,w,!0===r?1:2),b+=w}Ce.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:o,openEnded:a,thetaStart:s,thetaLength:l};var h=this;e=void 0!==e?e:20,t=void 0!==t?t:20,r=void 0!==r?r:100,n=Math.floor(n)||8,o=Math.floor(o)||1,a=void 0!==a&&a,s=void 0!==s?s:0,l=void 0!==l?l:2*Math.PI;var d=[],f=[],p=[],m=[],v=0,g=[],y=r/2,b=0;!function(){var i,a,u=new c,_=new c,w=0,x=(t-e)/r;for(a=0;a<=o;a++){var M=[],E=a/o,A=E*(t-e)+e;for(i=0;i<=n;i++){var T=i/n,k=T*l+s,S=Math.sin(k),C=Math.cos(k);_.x=A*S,_.y=-E*r+y,_.z=A*C,f.push(_.x,_.y,_.z),u.set(S,x,C).normalize(),p.push(u.x,u.y,u.z),m.push(T,1-E),M.push(v++)}g.push(M)}for(i=0;i<n;i++)for(a=0;a<o;a++){var P=g[a][i],O=g[a+1][i],R=g[a+1][i+1],L=g[a][i+1];d.push(P,O,L),d.push(O,R,L),w+=6}h.addGroup(b,w,0),b+=w}(),!1===a&&(e>0&&u(!0),t>0&&u(!1)),this.setIndex(d),this.addAttribute("position",new Ae(f,3)),this.addAttribute("normal",new Ae(p,3)),this.addAttribute("uv",new Ae(m,2))}function _r(e,t,r,n,i,o,a){yr.call(this,0,e,t,r,n,i,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:o,thetaLength:a}}function wr(e,t,r,n,i,o,a){br.call(this,0,e,t,r,n,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:o,thetaLength:a}}function xr(e,t,r,n){ve.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},this.fromBufferGeometry(new Mr(e,t,r,n)),this.mergeVertices()}function Mr(e,t,r,n){Ce.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},e=e||50,t=void 0!==t?Math.max(3,t):8,r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI;var o,a,s=[],l=[],u=[],h=[],d=new c,f=new i;for(l.push(0,0,0),u.push(0,0,1),h.push(.5,.5),a=0,o=3;a<=t;a++,o+=3){var p=r+a/t*n;d.x=e*Math.cos(p),d.y=e*Math.sin(p),l.push(d.x,d.y,d.z),u.push(0,0,1),f.x=(l[o]/e+1)/2,f.y=(l[o+1]/e+1)/2,h.push(f.x,f.y)}for(o=1;o<=t;o++)s.push(o,o+1,0);this.setIndex(s),this.addAttribute("position",new Ae(l,3)),this.addAttribute("normal",new Ae(u,3)),this.addAttribute("uv",new Ae(h,2))}function Er(e){$.call(this,{uniforms:js.merge([Ds.lights,{opacity:{value:1}}]),vertexShader:zs.shadow_vert,fragmentShader:zs.shadow_frag}),this.lights=!0,this.transparent=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}}}),this.setValues(e)}function Ar(e){$.call(this,e),this.type="RawShaderMaterial"}function Tr(e){J.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new q(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new q(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function kr(e){Tr.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function Sr(e){J.call(this),this.type="MeshPhongMaterial",this.color=new q(16777215),this.specular=new q(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new q(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ia,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Cr(e){Sr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function Pr(e){J.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Or(e){J.call(this),this.type="MeshLambertMaterial",this.color=new q(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new q(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ia,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Rr(e){J.call(this),this.type="LineDashedMaterial",this.color=new q(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(e)}function Lr(e,t,r){var n=this,i=!1,o=0,a=0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){a++,!1===i&&void 0!==n.onStart&&n.onStart(e,o,a),i=!0},this.itemEnd=function(e){o++,void 0!==n.onProgress&&n.onProgress(e,o,a),o===a&&(i=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)}}function Ir(e){this.manager=void 0!==e?e:qs}function Br(e){this.manager=void 0!==e?e:qs,this._parser=null}function Dr(e){this.manager=void 0!==e?e:qs,this._parser=null}function jr(e){this.manager=void 0!==e?e:qs}function zr(e){this.manager=void 0!==e?e:qs}function Nr(e){this.manager=void 0!==e?e:qs}function Ur(e,t){ce.call(this),this.type="Light",this.color=new q(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Fr(e,t,r){Ur.call(this,e,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(ce.DefaultUp),this.updateMatrix(),this.groundColor=new q(t)}function Hr(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new i(512,512),this.map=null,this.matrix=new h}function Vr(){Hr.call(this,new fe(50,1,.5,500))}function Gr(e,t,r,n,i,o){Ur.call(this,e,t),this.type="SpotLight",this.position.copy(ce.DefaultUp),this.updateMatrix(),this.target=new ce,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==r?r:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new Vr}function Wr(e,t,r,n){Ur.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==r?r:0,this.decay=void 0!==n?n:1,this.shadow=new Hr(new fe(90,1,.5,500))}function Xr(){Hr.call(this,new de(-5,5,5,-5,.5,500))}function Yr(e,t){Ur.call(this,e,t),this.type="DirectionalLight",this.position.copy(ce.DefaultUp),this.updateMatrix(),this.target=new ce,this.shadow=new Xr}function qr(e,t){Ur.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Kr(e,t,r,n){Ur.call(this,e,t),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==r?r:10,this.height=void 0!==n?n:10}function Zr(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r}function Qr(e,t,r,n){Zr.call(this,e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Jr(e,t,r,n){Zr.call(this,e,t,r,n)}function $r(e,t,r,n){Zr.call(this,e,t,r,n)}function en(e,t,r,n){if(void 0===e)throw new Error("track name is undefined");if(void 0===t||0===t.length)throw new Error("no keyframes in track named "+e);this.name=e,this.times=Ks.convertArray(t,this.TimeBufferType),this.values=Ks.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation),this.validate(),this.optimize()}function tn(e,t,r,n){en.call(this,e,t,r,n)}function rn(e,t,r,n){Zr.call(this,e,t,r,n)}function nn(e,t,r,n){en.call(this,e,t,r,n)}function on(e,t,r,n){en.call(this,e,t,r,n)}function an(e,t,r,n){en.call(this,e,t,r,n)}function sn(e,t,r){en.call(this,e,t,r)}function ln(e,t,r,n){en.call(this,e,t,r,n)}function un(e,t,r,n){en.apply(this,arguments)}function cn(e,t,r){this.name=e,this.tracks=r,this.duration=void 0!==t?t:-1,this.uuid=Ts.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function hn(e){this.manager=void 0!==e?e:qs,this.textures={}}function dn(e){this.manager=void 0!==e?e:qs}function fn(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function pn(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:qs,this.withCredentials=!1}function mn(e){this.manager=void 0!==e?e:qs,this.texturePath=""}function vn(e,t,r,n,i){var o=.5*(n-t),a=.5*(i-r),s=e*e;return(2*r-2*n+o+a)*(e*s)+(-3*r+3*n-2*o-a)*s+o*e+r}function gn(e,t){var r=1-e;return r*r*t}function yn(e,t){return 2*(1-e)*e*t}function bn(e,t){return e*e*t}function _n(e,t,r,n){return gn(e,t)+yn(e,r)+bn(e,n)}function wn(e,t){var r=1-e;return r*r*r*t}function xn(e,t){var r=1-e;return 3*r*r*e*t}function Mn(e,t){return 3*(1-e)*e*e*t}function En(e,t){return e*e*e*t}function An(e,t,r,n,i){return wn(e,t)+xn(e,r)+Mn(e,n)+En(e,i)}function Tn(){this.arcLengthDivisions=200}function kn(e,t){Tn.call(this),this.v1=e,this.v2=t}function Sn(){Tn.call(this),this.curves=[],this.autoClose=!1}function Cn(e,t,r,n,i,o,a,s){Tn.call(this),this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s||0}function Pn(e){Tn.call(this),this.points=void 0===e?[]:e}function On(e,t,r,n){Tn.call(this),this.v0=e,this.v1=t,this.v2=r,this.v3=n}function Rn(e,t,r){Tn.call(this),this.v0=e,this.v1=t,this.v2=r}function Ln(e){Sn.call(this),this.currentPoint=new i,e&&this.fromPoints(e)}function In(){Ln.apply(this,arguments),this.holes=[]}function Bn(){this.subPaths=[],this.currentPath=null}function Dn(e){this.data=e}function jn(e){this.manager=void 0!==e?e:qs}function zn(e){this.manager=void 0!==e?e:qs}function Nn(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new fe,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new fe,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Un(e,t,r){ce.call(this),this.type="CubeCamera";var n=new fe(90,1,e,t);n.up.set(0,-1,0),n.lookAt(new c(1,0,0)),this.add(n);var i=new fe(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new c(-1,0,0)),this.add(i);var o=new fe(90,1,e,t);o.up.set(0,0,1),o.lookAt(new c(0,1,0)),this.add(o);var a=new fe(90,1,e,t);a.up.set(0,0,-1),a.lookAt(new c(0,-1,0)),this.add(a);var s=new fe(90,1,e,t);s.up.set(0,-1,0),s.lookAt(new c(0,0,1)),this.add(s);var u=new fe(90,1,e,t);u.up.set(0,-1,0),u.lookAt(new c(0,0,-1)),this.add(u);var h={format:Ha,magFilter:Ta,minFilter:Ta};this.renderTarget=new l(r,r,h),this.renderTarget.texture.name="CubeCamera",this.updateCubeMap=function(e,t){null===this.parent&&this.updateMatrixWorld();var r=this.renderTarget,l=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,r.activeCubeFace=0,e.render(t,n,r),r.activeCubeFace=1,e.render(t,i,r),r.activeCubeFace=2,e.render(t,o,r),r.activeCubeFace=3,e.render(t,a,r),r.activeCubeFace=4,e.render(t,s,r),r.texture.generateMipmaps=l,r.activeCubeFace=5,e.render(t,u,r),e.setRenderTarget(null)}}function Fn(){ce.call(this),this.type="AudioListener",this.context=nl.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Hn(e){ce.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Vn(e){Hn.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Gn(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Wn(e,t,r){this.binding=e,this.valueSize=r;var n,i=Float64Array;switch(t){case"quaternion":n=this._slerp;break;case"string":case"bool":i=Array,n=this._select;break;default:n=this._lerp}this.buffer=new i(4*r),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Xn(e,t,r){var n=r||Yn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function Yn(e,t,r){this.path=t,this.parsedPath=r||Yn.parseTrackName(t),this.node=Yn.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function qn(e){this.uuid=Ts.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var r=0,n=arguments.length;r!==n;++r)t[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}function Kn(e,t,r){this._mixer=e,this._clip=t,this._localRoot=r||null;for(var n=t.tracks,i=n.length,o=new Array(i),a={endingStart:cs,endingEnd:cs},s=0;s!==i;++s){var l=n[s].createInterpolant(null);o[s]=l,l.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=os,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Zn(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Qn(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Jn(){Ce.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function $n(e,t,r,n){this.uuid=Ts.generateUUID(),this.data=e,this.itemSize=t,this.offset=r,this.normalized=!0===n}function ei(e,t){this.uuid=Ts.generateUUID(),this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function ti(e,t,r){ei.call(this,e,t),this.meshPerAttribute=r||1}function ri(e,t,r){ge.call(this,e,t),this.meshPerAttribute=r||1}function ni(e,t,r,n){this.ray=new Be(e,t),this.near=r||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function ii(e,t){return e.distance-t.distance}function oi(e,t,r,n){if(!1!==e.visible&&(e.raycast(t,r),!0===n))for(var i=e.children,o=0,a=i.length;o<a;o++)oi(i[o],t,r,!0)}function ai(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function si(e,t,r){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==r?r:0,this}function li(e,t,r){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==r?r:0,this}function ui(e,t){ze.call(this,e,t),this.animationsMap={},this.animationsList=[];var r=this.geometry.morphTargets.length,n=r-1,i=r/1;this.createAnimation("__default",0,n,i),this.setAnimationWeight("__default",1)}function ci(e){ce.call(this),this.material=e,this.render=function(e){}}function hi(e,t,r,n){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==r?r:16711680,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var l=new Ce,u=new Ae(2*a*3,3);l.addAttribute("position",u),Ot.call(this,l,new Ct({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function di(e){ce.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;for(var t=new Ce,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],n=0,i=1;n<32;n++,i++){var o=n/32*Math.PI*2,a=i/32*Math.PI*2;r.push(Math.cos(o),Math.sin(o),1,Math.cos(a),Math.sin(a),1)}t.addAttribute("position",new Ae(r,3));var s=new Ct({fog:!1});this.cone=new Ot(t,s),this.add(this.cone),this.update()}function fi(e){var t=[];e&&e.isBone&&t.push(e);for(var r=0;r<e.children.length;r++)t.push.apply(t,fi(e.children[r]));return t}function pi(e){for(var t=fi(e),r=new Ce,n=[],i=[],o=new q(0,0,1),a=new q(0,1,0),s=0;s<t.length;s++){var l=t[s];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}r.addAttribute("position",new Ae(n,3)),r.addAttribute("color",new Ae(i,3));var u=new Ct({vertexColors:ko,depthTest:!1,depthWrite:!1,transparent:!0});Ot.call(this,r,u),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.onBeforeRender()}function mi(e,t){this.light=e,this.light.updateMatrixWorld();var r=new cr(t,4,2),n=new Ie({wireframe:!0,fog:!1});n.color.copy(this.light.color),ze.call(this,r,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1}function vi(e){ce.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;var t=new Ct({color:e.color}),r=new Ce;r.addAttribute("position",new ge(new Float32Array(15),3)),this.add(new Pt(r,t)),this.update()}function gi(e,t){ce.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;var r=new qt(t);r.rotateY(.5*Math.PI);var n=new Ie({vertexColors:ko,wireframe:!0}),i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.addAttribute("color",new ge(o,3)),this.add(new ze(r,n)),this.update()}function yi(e,t,r,n){e=e||10,t=t||10,r=new q(void 0!==r?r:4473924),n=new q(void 0!==n?n:8947848);for(var i=t/2,o=e/t,a=e/2,s=[],l=[],u=0,c=0,h=-a;u<=t;u++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var d=u===i?r:n;d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3}var f=new Ce;f.addAttribute("position",new Ae(s,3)),f.addAttribute("color",new Ae(l,3));var p=new Ct({vertexColors:ko});Ot.call(this,f,p)}function bi(e,t,r,n,i,o){e=e||10,t=t||16,r=r||8,n=n||64,i=new q(void 0!==i?i:4473924),o=new q(void 0!==o?o:8947848);var a,s,l,u,c,h,d,f=[],p=[];for(u=0;u<=t;u++)l=u/t*(2*Math.PI),a=Math.sin(l)*e,s=Math.cos(l)*e,f.push(0,0,0),f.push(a,0,s),d=1&u?i:o,p.push(d.r,d.g,d.b),p.push(d.r,d.g,d.b);for(u=0;u<=r;u++)for(d=1&u?i:o,h=e-e/r*u,c=0;c<n;c++)l=c/n*(2*Math.PI),a=Math.sin(l)*h,s=Math.cos(l)*h,f.push(a,0,s),p.push(d.r,d.g,d.b),l=(c+1)/n*(2*Math.PI),a=Math.sin(l)*h,s=Math.cos(l)*h,f.push(a,0,s),p.push(d.r,d.g,d.b);var m=new Ce;m.addAttribute("position",new Ae(f,3)),m.addAttribute("color",new Ae(p,3));var v=new Ct({vertexColors:ko});Ot.call(this,m,v)}function _i(e,t,r,n){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==r?r:16776960,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new Ce,u=new Ae(2*a*3,3);l.addAttribute("position",u),Ot.call(this,l,new Ct({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function wi(e,t){ce.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,void 0===t&&(t=1);var r=new Ce;r.addAttribute("position",new Ae([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var n=new Ct({fog:!1});this.add(new Pt(r,n)),r=new Ce,r.addAttribute("position",new Ae([0,0,0,0,0,1],3)),this.add(new Pt(r,n)),this.update()}function xi(e){function t(e,t,n){r(e,n),r(t,n)}function r(e,t){o.push(0,0,0),a.push(t.r,t.g,t.b),void 0===s[e]&&(s[e]=[]),s[e].push(o.length/3-1)}var n=new Ce,i=new Ct({color:16777215,vertexColors:To}),o=[],a=[],s={},l=new q(16755200),u=new q(16711680),c=new q(43775),h=new q(16777215),d=new q(3355443);t("n1","n2",l),t("n2","n4",l),t("n4","n3",l),t("n3","n1",l),t("f1","f2",l),t("f2","f4",l),t("f4","f3",l),t("f3","f1",l),t("n1","f1",l),t("n2","f2",l),t("n3","f3",l),t("n4","f4",l),t("p","n1",u),t("p","n2",u),t("p","n3",u),t("p","n4",u),t("u1","u2",c),t("u2","u3",c),t("u3","u1",c),t("c","t",h),t("p","c",d),t("cn1","cn2",d),t("cn3","cn4",d),t("cf1","cf2",d),t("cf3","cf4",d),n.addAttribute("position",new Ae(o,3)),n.addAttribute("color",new Ae(a,3)),Ot.call(this,n,i),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function Mi(e,t){this.object=e,void 0===t&&(t=16776960);var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new Ce;i.setIndex(new ge(r,1)),i.addAttribute("position",new ge(n,3)),Ot.call(this,i,new Ct({color:t})),this.matrixAutoUpdate=!1,this.update()}function Ei(e,t,r,n,i,o){ce.call(this),void 0===n&&(n=16776960),void 0===r&&(r=1),void 0===i&&(i=.2*r),void 0===o&&(o=.2*i),void 0===il&&(il=new Ce,il.addAttribute("position",new Ae([0,0,0,0,1,0],3)),ol=new br(0,.5,1,5,1),ol.translate(0,-.5,0)),this.position.copy(t),this.line=new Pt(il,new Ct({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ze(ol,new Ie({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,i,o)}function Ai(e){e=e||1;var t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new Ce;n.addAttribute("position",new Ae(t,3)),n.addAttribute("color",new Ae(r,3));var i=new Ct({vertexColors:ko});Ot.call(this,n,i)}function Ti(){function e(e,o,a,s){t=e,r=a,n=-3*e+3*o-2*a-s,i=2*e-2*o+a+s}var t=0,r=0,n=0,i=0;return{initCatmullRom:function(t,r,n,i,o){e(r,n,o*(n-t),o*(i-r))},initNonuniformCatmullRom:function(t,r,n,i,o,a,s){var l=(r-t)/o-(n-t)/(o+a)+(n-r)/a,u=(n-r)/a-(i-r)/(a+s)+(i-n)/s;l*=a,u*=a,e(r,n,l,u)},calc:function(e){var o=e*e;return t+r*e+n*o+i*(o*e)}}}function ki(e){Tn.call(this),e.length<2&&console.warn("THREE.CatmullRomCurve3: Points array needs at least two entries."),this.points=e||[],this.closed=!1}function Si(e,t,r,n){Tn.call(this),this.v0=e,this.v1=t,this.v2=r,this.v3=n}function Ci(e,t,r){Tn.call(this),this.v0=e,this.v1=t,this.v2=r}function Pi(e,t){Tn.call(this),this.v1=e,this.v2=t}function Oi(e,t,r,n,i,o){Cn.call(this,e,t,r,r,n,i,o)}function Ri(e,t,r,n,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new pe(e,t,r,i,o,a)}function Li(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function Ii(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function Bi(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new It(e,t)}function Di(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Et(e)}function ji(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new It(e,t)}function zi(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Lt(e)}function Ni(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Lt(e)}function Ui(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Lt(e)}function Fi(e,t,r){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new c(e,t,r)}function Hi(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new ge(e,t).setDynamic(!0)}function Vi(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new ye(e,t)}function Gi(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new be(e,t)}function Wi(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new _e(e,t)}function Xi(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new we(e,t)}function Yi(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new xe(e,t)}function qi(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Me(e,t)}function Ki(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Ee(e,t)}function Zi(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Ae(e,t)}function Qi(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Te(e,t)}function Ji(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ki.call(this,e),this.type="catmullrom",this.closed=!0}function $i(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ki.call(this,e),this.type="catmullrom"}function eo(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ki.call(this,e),this.type="catmullrom"}function to(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Mi(e,t)}function ro(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ot(new gr(e.geometry),new Ct({color:void 0!==t?t:16777215}))}function no(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ot(new Ut(e.geometry),new Ct({color:void 0!==t?t:16777215}))}function io(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Ir(e)}function oo(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Dr(e)}function ao(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function so(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"WebGLRenderTargetCube",function(){return l}),r.d(t,"WebGLRenderTarget",function(){return s}),r.d(t,"WebGLRenderer",function(){return yt}),r.d(t,"ShaderLib",function(){return Ns}),r.d(t,"UniformsLib",function(){return Ds}),r.d(t,"UniformsUtils",function(){return js}),r.d(t,"ShaderChunk",function(){return zs}),r.d(t,"FogExp2",function(){return bt}),r.d(t,"Fog",function(){return _t}),r.d(t,"Scene",function(){return wt}),r.d(t,"LensFlare",function(){return xt}),r.d(t,"Sprite",function(){return Et}),r.d(t,"LOD",function(){return At}),r.d(t,"SkinnedMesh",function(){return St}),r.d(t,"Skeleton",function(){return Tt}),r.d(t,"Bone",function(){return kt}),r.d(t,"Mesh",function(){return ze}),r.d(t,"LineSegments",function(){return Ot}),r.d(t,"LineLoop",function(){return Rt}),r.d(t,"Line",function(){return Pt}),r.d(t,"Points",function(){return It}),r.d(t,"Group",function(){return Bt}),r.d(t,"VideoTexture",function(){return Dt}),r.d(t,"DataTexture",function(){return d}),r.d(t,"CompressedTexture",function(){return jt}),r.d(t,"CubeTexture",function(){return f}),r.d(t,"CanvasTexture",function(){return zt}),r.d(t,"DepthTexture",function(){return Nt}),r.d(t,"Texture",function(){return o}),r.d(t,"CompressedTextureLoader",function(){return Br}),r.d(t,"DataTextureLoader",function(){return Dr}),r.d(t,"CubeTextureLoader",function(){return zr}),r.d(t,"TextureLoader",function(){return Nr}),r.d(t,"ObjectLoader",function(){return mn}),r.d(t,"MaterialLoader",function(){return hn}),r.d(t,"BufferGeometryLoader",function(){return dn}),r.d(t,"DefaultLoadingManager",function(){return qs}),r.d(t,"LoadingManager",function(){return Lr}),r.d(t,"JSONLoader",function(){return pn}),r.d(t,"ImageLoader",function(){return jr}),r.d(t,"FontLoader",function(){return jn}),r.d(t,"FileLoader",function(){return Ir}),r.d(t,"Loader",function(){return fn}),r.d(t,"Cache",function(){return Ys}),r.d(t,"AudioLoader",function(){return zn}),r.d(t,"SpotLightShadow",function(){return Vr}),r.d(t,"SpotLight",function(){return Gr}),r.d(t,"PointLight",function(){return Wr}),r.d(t,"RectAreaLight",function(){return Kr}),r.d(t,"HemisphereLight",function(){return Fr}),r.d(t,"DirectionalLightShadow",function(){return Xr}),r.d(t,"DirectionalLight",function(){return Yr}),r.d(t,"AmbientLight",function(){return qr}),r.d(t,"LightShadow",function(){return Hr}),r.d(t,"Light",function(){return Ur}),r.d(t,"StereoCamera",function(){return Nn}),r.d(t,"PerspectiveCamera",function(){return fe}),r.d(t,"OrthographicCamera",function(){return de}),r.d(t,"CubeCamera",function(){return Un}),r.d(t,"ArrayCamera",function(){return pt}),r.d(t,"Camera",function(){return he}),r.d(t,"AudioListener",function(){return Fn}),r.d(t,"PositionalAudio",function(){return Vn}),r.d(t,"AudioContext",function(){return nl}),r.d(t,"AudioAnalyser",function(){return Gn}),r.d(t,"Audio",function(){return Hn}),r.d(t,"VectorKeyframeTrack",function(){return tn}),r.d(t,"StringKeyframeTrack",function(){return an}),r.d(t,"QuaternionKeyframeTrack",function(){return nn}),r.d(t,"NumberKeyframeTrack",function(){return on}),r.d(t,"ColorKeyframeTrack",function(){return ln}),r.d(t,"BooleanKeyframeTrack",function(){return sn}),r.d(t,"PropertyMixer",function(){return Wn}),r.d(t,"PropertyBinding",function(){return Yn}),r.d(t,"KeyframeTrack",function(){return un}),r.d(t,"AnimationUtils",function(){return Ks}),r.d(t,"AnimationObjectGroup",function(){return qn}),r.d(t,"AnimationMixer",function(){return Zn}),r.d(t,"AnimationClip",function(){return cn}),r.d(t,"Uniform",function(){return Qn}),r.d(t,"InstancedBufferGeometry",function(){return Jn}),r.d(t,"BufferGeometry",function(){return Ce}),r.d(t,"GeometryIdCount",function(){return me}),r.d(t,"Geometry",function(){return ve}),r.d(t,"InterleavedBufferAttribute",function(){return $n}),r.d(t,"InstancedInterleavedBuffer",function(){return ti}),r.d(t,"InterleavedBuffer",function(){return ei}),r.d(t,"InstancedBufferAttribute",function(){return ri}),r.d(t,"Face3",function(){return pe}),r.d(t,"Object3D",function(){return ce}),r.d(t,"Raycaster",function(){return ni}),r.d(t,"Layers",function(){return ue}),r.d(t,"EventDispatcher",function(){return n}),r.d(t,"Clock",function(){return ai}),r.d(t,"QuaternionLinearInterpolant",function(){return rn}),r.d(t,"LinearInterpolant",function(){return Jr}),r.d(t,"DiscreteInterpolant",function(){return $r}),r.d(t,"CubicInterpolant",function(){return Qr}),r.d(t,"Interpolant",function(){return Zr}),r.d(t,"Triangle",function(){return je}),r.d(t,"Math",function(){return Ts}),r.d(t,"Spherical",function(){return si}),r.d(t,"Cylindrical",function(){return li}),r.d(t,"Plane",function(){return ie}),r.d(t,"Frustum",function(){return oe}),r.d(t,"Sphere",function(){return re}),r.d(t,"Ray",function(){return Be}),r.d(t,"Matrix4",function(){return h}),r.d(t,"Matrix3",function(){return ne}),r.d(t,"Box3",function(){return te}),r.d(t,"Box2",function(){return K}),r.d(t,"Line3",function(){return De}),r.d(t,"Euler",function(){return le}),r.d(t,"Vector4",function(){return a}),r.d(t,"Vector3",function(){return c}),r.d(t,"Vector2",function(){return i}),r.d(t,"Quaternion",function(){return u}),r.d(t,"Color",function(){return q}),r.d(t,"MorphBlendMesh",function(){return ui}),r.d(t,"ImmediateRenderObject",function(){return ci}),r.d(t,"VertexNormalsHelper",function(){return hi}),r.d(t,"SpotLightHelper",function(){return di}),r.d(t,"SkeletonHelper",function(){return pi}),r.d(t,"PointLightHelper",function(){return mi}),r.d(t,"RectAreaLightHelper",function(){return vi}),r.d(t,"HemisphereLightHelper",function(){return gi}),r.d(t,"GridHelper",function(){return yi}),r.d(t,"PolarGridHelper",function(){return bi}),r.d(t,"FaceNormalsHelper",function(){return _i}),r.d(t,"DirectionalLightHelper",function(){return wi}),r.d(t,"CameraHelper",function(){return xi}),r.d(t,"BoxHelper",function(){return Mi}),r.d(t,"ArrowHelper",function(){return Ei}),r.d(t,"AxisHelper",function(){return Ai}),r.d(t,"CatmullRomCurve3",function(){return ki}),r.d(t,"CubicBezierCurve3",function(){return Si}),r.d(t,"QuadraticBezierCurve3",function(){return Ci}),r.d(t,"LineCurve3",function(){return Pi}),r.d(t,"ArcCurve",function(){return Oi}),r.d(t,"EllipseCurve",function(){return Cn}),r.d(t,"SplineCurve",function(){return Pn}),r.d(t,"CubicBezierCurve",function(){return On}),r.d(t,"QuadraticBezierCurve",function(){return Rn}),r.d(t,"LineCurve",function(){return kn}),r.d(t,"Shape",function(){return In}),r.d(t,"Path",function(){return Ln}),r.d(t,"ShapePath",function(){return Bn}),r.d(t,"Font",function(){return Dn}),r.d(t,"CurvePath",function(){return Sn}),r.d(t,"Curve",function(){return Tn}),r.d(t,"ShapeUtils",function(){return Gs}),r.d(t,"SceneUtils",function(){return cl}),r.d(t,"WireframeGeometry",function(){return Ut}),r.d(t,"ParametricGeometry",function(){return Ft}),r.d(t,"ParametricBufferGeometry",function(){return Ht}),r.d(t,"TetrahedronGeometry",function(){return Wt}),r.d(t,"TetrahedronBufferGeometry",function(){return Xt}),r.d(t,"OctahedronGeometry",function(){return Yt}),r.d(t,"OctahedronBufferGeometry",function(){return qt}),r.d(t,"IcosahedronGeometry",function(){return Kt}),r.d(t,"IcosahedronBufferGeometry",function(){return Zt}),r.d(t,"DodecahedronGeometry",function(){return Qt}),r.d(t,"DodecahedronBufferGeometry",function(){return Jt}),r.d(t,"PolyhedronGeometry",function(){return Vt}),r.d(t,"PolyhedronBufferGeometry",function(){return Gt}),r.d(t,"TubeGeometry",function(){return $t}),r.d(t,"TubeBufferGeometry",function(){return er}),r.d(t,"TorusKnotGeometry",function(){return tr}),r.d(t,"TorusKnotBufferGeometry",function(){return rr}),r.d(t,"TorusGeometry",function(){return nr}),r.d(t,"TorusBufferGeometry",function(){return ir}),r.d(t,"TextGeometry",function(){return sr}),r.d(t,"TextBufferGeometry",function(){return lr}),r.d(t,"SphereGeometry",function(){return ur}),r.d(t,"SphereBufferGeometry",function(){return cr}),r.d(t,"RingGeometry",function(){return hr}),r.d(t,"RingBufferGeometry",function(){return dr}),r.d(t,"PlaneGeometry",function(){return Re}),r.d(t,"PlaneBufferGeometry",function(){return Le}),r.d(t,"LatheGeometry",function(){return fr}),r.d(t,"LatheBufferGeometry",function(){return pr}),r.d(t,"ShapeGeometry",function(){return mr}),r.d(t,"ShapeBufferGeometry",function(){return vr}),r.d(t,"ExtrudeGeometry",function(){return or}),r.d(t,"ExtrudeBufferGeometry",function(){return ar}),r.d(t,"EdgesGeometry",function(){return gr}),r.d(t,"ConeGeometry",function(){return _r}),r.d(t,"ConeBufferGeometry",function(){return wr}),r.d(t,"CylinderGeometry",function(){return yr}),r.d(t,"CylinderBufferGeometry",function(){return br}),r.d(t,"CircleGeometry",function(){return xr}),r.d(t,"CircleBufferGeometry",function(){return Mr}),r.d(t,"BoxGeometry",function(){return Pe}),r.d(t,"BoxBufferGeometry",function(){return Oe}),r.d(t,"ShadowMaterial",function(){return Er}),r.d(t,"SpriteMaterial",function(){return Mt}),r.d(t,"RawShaderMaterial",function(){return Ar}),r.d(t,"ShaderMaterial",function(){return $}),r.d(t,"PointsMaterial",function(){return Lt});r.d(t,"MeshPhysicalMaterial",function(){return kr}),r.d(t,"MeshStandardMaterial",function(){return Tr}),r.d(t,"MeshPhongMaterial",function(){return Sr}),r.d(t,"MeshToonMaterial",function(){return Cr}),r.d(t,"MeshNormalMaterial",function(){return Pr}),r.d(t,"MeshLambertMaterial",function(){return Or}),r.d(t,"MeshDepthMaterial",function(){return ee}),r.d(t,"MeshBasicMaterial",function(){return Ie}),r.d(t,"LineDashedMaterial",function(){return Rr}),r.d(t,"LineBasicMaterial",function(){return Ct}),r.d(t,"Material",function(){return J}),r.d(t,"Float64BufferAttribute",function(){return Te}),r.d(t,"Float32BufferAttribute",function(){return Ae}),r.d(t,"Uint32BufferAttribute",function(){return Ee}),r.d(t,"Int32BufferAttribute",function(){return Me}),r.d(t,"Uint16BufferAttribute",function(){return xe}),r.d(t,"Int16BufferAttribute",function(){return we}),r.d(t,"Uint8ClampedBufferAttribute",function(){return _e}),r.d(t,"Uint8BufferAttribute",function(){return be}),r.d(t,"Int8BufferAttribute",function(){return ye}),r.d(t,"BufferAttribute",function(){return ge}),r.d(t,"REVISION",function(){return lo}),r.d(t,"MOUSE",function(){return uo}),r.d(t,"CullFaceNone",function(){return co}),r.d(t,"CullFaceBack",function(){return ho}),r.d(t,"CullFaceFront",function(){return fo}),r.d(t,"CullFaceFrontBack",function(){return po}),r.d(t,"FrontFaceDirectionCW",function(){return mo}),r.d(t,"FrontFaceDirectionCCW",function(){return vo}),r.d(t,"BasicShadowMap",function(){return go}),r.d(t,"PCFShadowMap",function(){return yo}),r.d(t,"PCFSoftShadowMap",function(){return bo}),r.d(t,"FrontSide",function(){return _o}),r.d(t,"BackSide",function(){return wo}),r.d(t,"DoubleSide",function(){return xo}),r.d(t,"FlatShading",function(){return Mo}),r.d(t,"SmoothShading",function(){return Eo}),r.d(t,"NoColors",function(){return Ao}),r.d(t,"FaceColors",function(){return To}),r.d(t,"VertexColors",function(){return ko}),r.d(t,"NoBlending",function(){return So}),r.d(t,"NormalBlending",function(){return Co}),r.d(t,"AdditiveBlending",function(){return Po}),r.d(t,"SubtractiveBlending",function(){return Oo}),r.d(t,"MultiplyBlending",function(){return Ro}),r.d(t,"CustomBlending",function(){return Lo}),r.d(t,"AddEquation",function(){return Io}),r.d(t,"SubtractEquation",function(){return Bo}),r.d(t,"ReverseSubtractEquation",function(){return Do}),r.d(t,"MinEquation",function(){return jo}),r.d(t,"MaxEquation",function(){return zo}),r.d(t,"ZeroFactor",function(){return No}),r.d(t,"OneFactor",function(){return Uo}),r.d(t,"SrcColorFactor",function(){return Fo}),r.d(t,"OneMinusSrcColorFactor",function(){return Ho}),r.d(t,"SrcAlphaFactor",function(){return Vo}),r.d(t,"OneMinusSrcAlphaFactor",function(){return Go}),r.d(t,"DstAlphaFactor",function(){return Wo}),r.d(t,"OneMinusDstAlphaFactor",function(){return Xo}),r.d(t,"DstColorFactor",function(){return Yo}),r.d(t,"OneMinusDstColorFactor",function(){return qo}),r.d(t,"SrcAlphaSaturateFactor",function(){return Ko}),r.d(t,"NeverDepth",function(){return Zo}),r.d(t,"AlwaysDepth",function(){return Qo}),r.d(t,"LessDepth",function(){return Jo}),r.d(t,"LessEqualDepth",function(){return $o}),r.d(t,"EqualDepth",function(){return ea}),r.d(t,"GreaterEqualDepth",function(){return ta}),r.d(t,"GreaterDepth",function(){return ra}),r.d(t,"NotEqualDepth",function(){return na}),r.d(t,"MultiplyOperation",function(){return ia}),r.d(t,"MixOperation",function(){return oa}),r.d(t,"AddOperation",function(){return aa}),r.d(t,"NoToneMapping",function(){return sa}),r.d(t,"LinearToneMapping",function(){return la}),r.d(t,"ReinhardToneMapping",function(){return ua}),r.d(t,"Uncharted2ToneMapping",function(){return ca}),r.d(t,"CineonToneMapping",function(){return ha}),r.d(t,"UVMapping",function(){return da}),r.d(t,"CubeReflectionMapping",function(){return fa}),r.d(t,"CubeRefractionMapping",function(){return pa}),r.d(t,"EquirectangularReflectionMapping",function(){return ma}),r.d(t,"EquirectangularRefractionMapping",function(){return va}),r.d(t,"SphericalReflectionMapping",function(){return ga}),r.d(t,"CubeUVReflectionMapping",function(){return ya}),r.d(t,"CubeUVRefractionMapping",function(){return ba}),r.d(t,"RepeatWrapping",function(){return _a}),r.d(t,"ClampToEdgeWrapping",function(){return wa}),r.d(t,"MirroredRepeatWrapping",function(){return xa}),r.d(t,"NearestFilter",function(){return Ma}),r.d(t,"NearestMipMapNearestFilter",function(){return Ea}),r.d(t,"NearestMipMapLinearFilter",function(){return Aa}),r.d(t,"LinearFilter",function(){return Ta}),r.d(t,"LinearMipMapNearestFilter",function(){return ka}),r.d(t,"LinearMipMapLinearFilter",function(){return Sa}),r.d(t,"UnsignedByteType",function(){return Ca}),r.d(t,"ByteType",function(){return Pa}),r.d(t,"ShortType",function(){return Oa}),r.d(t,"UnsignedShortType",function(){return Ra}),r.d(t,"IntType",function(){return La}),r.d(t,"UnsignedIntType",function(){return Ia}),r.d(t,"FloatType",function(){return Ba}),r.d(t,"HalfFloatType",function(){return Da}),r.d(t,"UnsignedShort4444Type",function(){return ja}),r.d(t,"UnsignedShort5551Type",function(){return za}),r.d(t,"UnsignedShort565Type",function(){return Na}),r.d(t,"UnsignedInt248Type",function(){return Ua}),r.d(t,"AlphaFormat",function(){return Fa}),r.d(t,"RGBFormat",function(){return Ha}),r.d(t,"RGBAFormat",function(){return Va}),r.d(t,"LuminanceFormat",function(){return Ga}),r.d(t,"LuminanceAlphaFormat",function(){return Wa}),r.d(t,"RGBEFormat",function(){return Xa}),r.d(t,"DepthFormat",function(){return Ya}),r.d(t,"DepthStencilFormat",function(){return qa}),r.d(t,"RGB_S3TC_DXT1_Format",function(){return Ka}),r.d(t,"RGBA_S3TC_DXT1_Format",function(){return Za}),r.d(t,"RGBA_S3TC_DXT3_Format",function(){return Qa}),r.d(t,"RGBA_S3TC_DXT5_Format",function(){return Ja}),r.d(t,"RGB_PVRTC_4BPPV1_Format",function(){return $a}),r.d(t,"RGB_PVRTC_2BPPV1_Format",function(){return es}),r.d(t,"RGBA_PVRTC_4BPPV1_Format",function(){return ts}),r.d(t,"RGBA_PVRTC_2BPPV1_Format",function(){return rs}),r.d(t,"RGB_ETC1_Format",function(){return ns}),r.d(t,"LoopOnce",function(){return is}),r.d(t,"LoopRepeat",function(){return os}),r.d(t,"LoopPingPong",function(){return as}),r.d(t,"InterpolateDiscrete",function(){return ss}),r.d(t,"InterpolateLinear",function(){return ls}),r.d(t,"InterpolateSmooth",function(){return us}),r.d(t,"ZeroCurvatureEnding",function(){return cs}),r.d(t,"ZeroSlopeEnding",function(){return hs}),r.d(t,"WrapAroundEnding",function(){return ds}),r.d(t,"TrianglesDrawMode",function(){return fs}),r.d(t,"TriangleStripDrawMode",function(){return ps}),r.d(t,"TriangleFanDrawMode",function(){return ms}),r.d(t,"LinearEncoding",function(){return vs}),r.d(t,"sRGBEncoding",function(){return gs}),r.d(t,"GammaEncoding",function(){return ys}),r.d(t,"RGBEEncoding",function(){return bs}),r.d(t,"LogLuvEncoding",function(){return _s}),r.d(t,"RGBM7Encoding",function(){return ws}),r.d(t,"RGBM16Encoding",function(){return xs}),r.d(t,"RGBDEncoding",function(){return Ms}),r.d(t,"BasicDepthPacking",function(){return Es}),r.d(t,"RGBADepthPacking",function(){return As}),r.d(t,"CubeGeometry",function(){return Pe}),r.d(t,"Face4",function(){return Ri}),r.d(t,"LineStrip",function(){return hl}),r.d(t,"LinePieces",function(){return dl}),r.d(t,"MeshFaceMaterial",function(){return Li}),r.d(t,"MultiMaterial",function(){return Ii}),r.d(t,"PointCloud",function(){return Bi}),r.d(t,"Particle",function(){return Di}),r.d(t,"ParticleSystem",function(){return ji}),r.d(t,"PointCloudMaterial",function(){return zi}),r.d(t,"ParticleBasicMaterial",function(){return Ni}),r.d(t,"ParticleSystemMaterial",function(){return Ui}),r.d(t,"Vertex",function(){return Fi}),r.d(t,"DynamicBufferAttribute",function(){return Hi}),r.d(t,"Int8Attribute",function(){return Vi}),r.d(t,"Uint8Attribute",function(){return Gi}),r.d(t,"Uint8ClampedAttribute",function(){return Wi}),r.d(t,"Int16Attribute",function(){return Xi}),r.d(t,"Uint16Attribute",function(){return Yi}),r.d(t,"Int32Attribute",function(){return qi}),r.d(t,"Uint32Attribute",function(){return Ki}),r.d(t,"Float32Attribute",function(){return Zi}),r.d(t,"Float64Attribute",function(){return Qi}),r.d(t,"ClosedSplineCurve3",function(){return Ji}),r.d(t,"SplineCurve3",function(){return $i}),r.d(t,"Spline",function(){return eo}),r.d(t,"BoundingBoxHelper",function(){return to}),r.d(t,"EdgesHelper",function(){return ro}),r.d(t,"WireframeHelper",function(){return no}),r.d(t,"XHRLoader",function(){return io}),r.d(t,"BinaryTextureLoader",function(){return oo}),r.d(t,"GeometryUtils",function(){return fl}),r.d(t,"ImageUtils",function(){return pl}),r.d(t,"Projector",function(){return ao}),r.d(t,"CanvasRenderer",function(){return so}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&function(){Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(void 0!==n&&null!==n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}}(),Object.assign(n.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var r=this._listeners,n=r[e];if(void 0!==n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners,r=t[e.type];if(void 0!==r){e.target=this;for(var n=r.slice(0),i=0,o=n.length;i<o;i++)n[i].call(this,e)}}}});var lo="86",uo={LEFT:0,MIDDLE:1,RIGHT:2},co=0,ho=1,fo=2,po=3,mo=0,vo=1,go=0,yo=1,bo=2,_o=0,wo=1,xo=2,Mo=1,Eo=2,Ao=0,To=1,ko=2,So=0,Co=1,Po=2,Oo=3,Ro=4,Lo=5,Io=100,Bo=101,Do=102,jo=103,zo=104,No=200,Uo=201,Fo=202,Ho=203,Vo=204,Go=205,Wo=206,Xo=207,Yo=208,qo=209,Ko=210,Zo=0,Qo=1,Jo=2,$o=3,ea=4,ta=5,ra=6,na=7,ia=0,oa=1,aa=2,sa=0,la=1,ua=2,ca=3,ha=4,da=300,fa=301,pa=302,ma=303,va=304,ga=305,ya=306,ba=307,_a=1e3,wa=1001,xa=1002,Ma=1003,Ea=1004,Aa=1005,Ta=1006,ka=1007,Sa=1008,Ca=1009,Pa=1010,Oa=1011,Ra=1012,La=1013,Ia=1014,Ba=1015,Da=1016,ja=1017,za=1018,Na=1019,Ua=1020,Fa=1021,Ha=1022,Va=1023,Ga=1024,Wa=1025,Xa=Va,Ya=1026,qa=1027,Ka=2001,Za=2002,Qa=2003,Ja=2004,$a=2100,es=2101,ts=2102,rs=2103,ns=2151,is=2200,os=2201,as=2202,ss=2300,ls=2301,us=2302,cs=2400,hs=2401,ds=2402,fs=0,ps=1,ms=2,vs=3e3,gs=3001,ys=3007,bs=3002,_s=3003,ws=3004,xs=3005,Ms=3006,Es=3200,As=3201,Ts={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e,t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=new Array(36),n=0;return function(){for(var i=0;i<36;i++)8===i||13===i||18===i||23===i?r[i]="-":14===i?r[i]="4":(n<=2&&(n=33554432+16777216*Math.random()|0),e=15&n,n>>=4,r[i]=t[19===i?3&e|8:e]);return r.join("")}}(),clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},lerp:function(e,t,r){return(1-r)*e+r*t},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Ts.DEG2RAD},radToDeg:function(e){return e*Ts.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},nearestPowerOfTwo:function(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))},nextPowerOfTwo:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}};Object.defineProperties(i.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(i.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(){var e=new i,t=new i;return function(r,n){return e.set(r,r),t.set(n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},distanceToManhattan:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*r-o*n+e.x,this.y=i*n+o*r+e.y,this}});var ks=0;o.DEFAULT_IMAGE=void 0,o.DEFAULT_MAPPING=da,Object.defineProperty(o.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(o.prototype,n.prototype,{constructor:o,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){if(void 0!==e.textures[this.uuid])return e.textures[this.uuid];var t={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var r=this.image;void 0===r.uuid&&(r.uuid=Ts.generateUUID()),void 0===e.images[r.uuid]&&(e.images[r.uuid]={uuid:r.uuid,url:function(e){var t;return void 0!==e.toDataURL?t=e:(t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0,e.width,e.height)),t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}(r)}),t.image=r.uuid}return e.textures[this.uuid]=t,t},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping===da){if(e.multiply(this.repeat),e.add(this.offset),e.x<0||e.x>1)switch(this.wrapS){case _a:e.x=e.x-Math.floor(e.x);break;case wa:e.x=e.x<0?0:1;break;case xa:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case _a:e.y=e.y-Math.floor(e.y);break;case wa:e.y=e.y<0?0:1;break;case xa:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}}),Object.assign(a.prototype,{isVector4:!0,set:function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*n+o[12]*i,this.y=o[1]*t+o[5]*r+o[9]*n+o[13]*i,this.z=o[2]*t+o[6]*r+o[10]*n+o[14]*i,this.w=o[3]*t+o[7]*r+o[11]*n+o[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,r,n,i,o=e.elements,a=o[0],s=o[4],l=o[8],u=o[1],c=o[5],h=o[9],d=o[2],f=o[6],p=o[10];if(Math.abs(s-u)<.01&&Math.abs(l-d)<.01&&Math.abs(h-f)<.01){if(Math.abs(s+u)<.1&&Math.abs(l+d)<.1&&Math.abs(h+f)<.1&&Math.abs(a+c+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(a+1)/2,v=(c+1)/2,g=(p+1)/2,y=(s+u)/4,b=(l+d)/4,_=(h+f)/4;return m>v&&m>g?m<.01?(r=0,n=.707106781,i=.707106781):(r=Math.sqrt(m),n=y/r,i=b/r):v>g?v<.01?(r=.707106781,n=0,i=.707106781):(n=Math.sqrt(v),r=y/n,i=_/n):g<.01?(r=.707106781,n=.707106781,i=0):(i=Math.sqrt(g),r=b/i,n=_/i),this.set(r,n,i,t),this}var w=Math.sqrt((f-h)*(f-h)+(l-d)*(l-d)+(u-s)*(u-s));return Math.abs(w)<.001&&(w=1),this.x=(f-h)/w,this.y=(l-d)/w,this.z=(u-s)/w,this.w=Math.acos((a+c+p-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(r,n){return void 0===e&&(e=new a,t=new a),e.set(r,r,r,r),t.set(n,n,n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Object.assign(s.prototype,n.prototype,{isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),l.prototype=Object.create(s.prototype),l.prototype.constructor=l,l.prototype.isWebGLRenderTargetCube=!0,Object.assign(u,{slerp:function(e,t,r,n){return r.copy(e).slerp(t,n)},slerpFlat:function(e,t,r,n,i,o,a){var s=r[n+0],l=r[n+1],u=r[n+2],c=r[n+3],h=i[o+0],d=i[o+1],f=i[o+2],p=i[o+3];if(c!==p||s!==h||l!==d||u!==f){var m=1-a,v=s*h+l*d+u*f+c*p,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var b=Math.sqrt(y),_=Math.atan2(b,v*g);m=Math.sin(m*_)/b,a=Math.sin(a*_)/b}var w=a*g;if(s=s*m+h*w,l=l*m+d*w,u=u*m+f*w,c=c*m+p*w,m===1-a){var x=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=x,l*=x,u*=x,c*=x}}e[t]=s,e[t+1]=l,e[t+2]=u,e[t+3]=c}}),Object.defineProperties(u.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(u.prototype,{set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=e._x,n=e._y,i=e._z,o=e.order,a=Math.cos,s=Math.sin,l=a(r/2),u=a(n/2),c=a(i/2),h=s(r/2),d=s(n/2),f=s(i/2);return"XYZ"===o?(this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f):"YXZ"===o?(this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f):"ZXY"===o?(this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f):"ZYX"===o?(this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f):"YZX"===o?(this._x=h*u*c+l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c-h*d*f):"XZY"===o&&(this._x=h*u*c-l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c+h*d*f),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,r=e.elements,n=r[0],i=r[4],o=r[8],a=r[1],s=r[5],l=r[9],u=r[2],c=r[6],h=r[10],d=n+s+h;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(c-l)*t,this._y=(o-u)*t,this._z=(a-i)*t):n>s&&n>h?(t=2*Math.sqrt(1+n-s-h),this._w=(c-l)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(o+u)/t):s>h?(t=2*Math.sqrt(1+s-n-h),this._w=(o-u)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(l+c)/t):(t=2*Math.sqrt(1+h-n-s),this._w=(a-i)/t,this._x=(o+u)/t,this._y=(l+c)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,t=new c;return function(r,n){return void 0===t&&(t=new c),e=r.dot(n)+1,e<1e-6?(e=0,Math.abs(r.x)>Math.abs(r.z)?t.set(-r.y,r.x,0):t.set(0,-r.z,r.y)):t.crossVectors(r,n),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var r=e._x,n=e._y,i=e._z,o=e._w,a=t._x,s=t._y,l=t._z,u=t._w;return this._x=r*u+o*a+n*l-i*s,this._y=n*u+o*s+i*a-r*l,this._z=i*u+o*l+r*s-n*a,this._w=o*u-r*a-n*s-i*l,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var r=this._x,n=this._y,i=this._z,o=this._w,a=o*e._w+r*e._x+n*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=n,this._z=i,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(o+this._w),this._x=.5*(r+this._x),this._y=.5*(n+this._y),this._z=.5*(i+this._z),this;var l=Math.atan2(s,a),u=Math.sin((1-t)*l)/s,c=Math.sin(t*l)/s;return this._w=o*u+this._w*c,this._x=r*u+this._x*c,this._y=n*u+this._y*c,this._z=i*u+this._z*c,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(c.prototype,{isVector3:!0,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e=new u;return function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(e.setFromEuler(t))}}(),applyAxisAngle:function(){var e=new u;return function(t,r){return this.applyQuaternion(e.setFromAxisAngle(t,r))}}(),applyMatrix3:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements,o=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*o,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*o,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*o,this},applyQuaternion:function(e){var t=this.x,r=this.y,n=this.z,i=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*n-a*r,u=s*r+a*t-i*n,c=s*n+i*r-o*t,h=-i*t-o*r-a*n;return this.x=l*s+h*-i+u*-a-c*-o,this.y=u*s+h*-o+c*-i-l*-a,this.z=c*s+h*-a+l*-o-u*-i,this},project:function(){var e=new h;return function(t){return e.multiplyMatrices(t.projectionMatrix,e.getInverse(t.matrixWorld)),this.applyMatrix4(e)}}(),unproject:function(){var e=new h;return function(t){return e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyMatrix4(e)}}(),transformDirection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e=new c,t=new c;return function(r,n){return e.set(r,r,r),t.set(n,n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},cross:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var r=this.x,n=this.y,i=this.z;return this.x=n*e.z-i*e.y,this.y=i*e.x-r*e.z,this.z=r*e.y-n*e.x,this},crossVectors:function(e,t){var r=e.x,n=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=n*s-i*a,this.y=i*o-r*s,this.z=r*a-n*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new c;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new c;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Ts.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n},distanceToManhattan:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;return this.x=t*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=t*Math.cos(e.theta),this},setFromCylindrical:function(e){return this.x=e.radius*Math.sin(e.theta),this.y=e.y,this.z=e.radius*Math.cos(e.theta),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(h.prototype,{isMatrix4:!0,set:function(e,t,r,n,i,o,a,s,l,u,c,h,d,f,p,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=n,v[1]=i,v[5]=o,v[9]=a,v[13]=s,v[2]=l,v[6]=u,v[10]=c,v[14]=h,v[3]=d,v[7]=f,v[11]=p,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new h).fromArray(this.elements)},copy:function(e){var t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this},copyPosition:function(e){var t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this},extractBasis:function(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this},extractRotation:function(){var e=new c;return function(t){var r=this.elements,n=t.elements,i=1/e.setFromMatrixColumn(t,0).length(),o=1/e.setFromMatrixColumn(t,1).length(),a=1/e.setFromMatrixColumn(t,2).length();return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[8]=n[8]*a,r[9]=n[9]*a,r[10]=n[10]*a,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,r=e.x,n=e.y,i=e.z,o=Math.cos(r),a=Math.sin(r),s=Math.cos(n),l=Math.sin(n),u=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var h=o*u,d=o*c,f=a*u,p=a*c;t[0]=s*u,t[4]=-s*c,t[8]=l,t[1]=d+f*l,t[5]=h-p*l,t[9]=-a*s,t[2]=p-h*l,t[6]=f+d*l,t[10]=o*s}else if("YXZ"===e.order){var m=s*u,v=s*c,g=l*u,y=l*c;t[0]=m+y*a,t[4]=g*a-v,t[8]=o*l,t[1]=o*c,t[5]=o*u,t[9]=-a,t[2]=v*a-g,t[6]=y+m*a,t[10]=o*s}else if("ZXY"===e.order){var m=s*u,v=s*c,g=l*u,y=l*c;t[0]=m-y*a,t[4]=-o*c,t[8]=g+v*a,t[1]=v+g*a,t[5]=o*u,t[9]=y-m*a,t[2]=-o*l,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){var h=o*u,d=o*c,f=a*u,p=a*c;t[0]=s*u,t[4]=f*l-d,t[8]=h*l+p,t[1]=s*c,t[5]=p*l+h,t[9]=d*l-f,t[2]=-l,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var b=o*s,_=o*l,w=a*s,x=a*l;t[0]=s*u,t[4]=x-b*c,t[8]=w*c+_,t[1]=c,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=_*c+w,t[10]=b-x*c}else if("XZY"===e.order){var b=o*s,_=o*l,w=a*s,x=a*l;t[0]=s*u,t[4]=-c,t[8]=l*u,t[1]=b*c+x,t[5]=o*u,t[9]=_*c-w,t[2]=w*c-_,t[6]=a*u,t[10]=x*c+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){var t=this.elements,r=e._x,n=e._y,i=e._z,o=e._w,a=r+r,s=n+n,l=i+i,u=r*a,c=r*s,h=r*l,d=n*s,f=n*l,p=i*l,m=o*a,v=o*s,g=o*l;return t[0]=1-(d+p),t[4]=c-g,t[8]=h+v,t[1]=c+g,t[5]=1-(u+p),t[9]=f-m,t[2]=h-v,t[6]=f+m,t[10]=1-(u+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var e=new c,t=new c,r=new c;return function(n,i,o){var a=this.elements;return r.subVectors(n,i),0===r.lengthSq()&&(r.z=1),r.normalize(),e.crossVectors(o,r),0===e.lengthSq()&&(1===Math.abs(o.z)?r.x+=1e-4:r.z+=1e-4,r.normalize(),e.crossVectors(o,r)),e.normalize(),t.crossVectors(r,e),a[0]=e.x,a[4]=t.x,a[8]=r.x,a[1]=e.y,a[5]=t.y,a[9]=r.y,a[2]=e.z,a[6]=t.z,a[10]=r.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],a=r[4],s=r[8],l=r[12],u=r[1],c=r[5],h=r[9],d=r[13],f=r[2],p=r[6],m=r[10],v=r[14],g=r[3],y=r[7],b=r[11],_=r[15],w=n[0],x=n[4],M=n[8],E=n[12],A=n[1],T=n[5],k=n[9],S=n[13],C=n[2],P=n[6],O=n[10],R=n[14],L=n[3],I=n[7],B=n[11],D=n[15];return i[0]=o*w+a*A+s*C+l*L,i[4]=o*x+a*T+s*P+l*I,i[8]=o*M+a*k+s*O+l*B,i[12]=o*E+a*S+s*R+l*D,i[1]=u*w+c*A+h*C+d*L,i[5]=u*x+c*T+h*P+d*I,i[9]=u*M+c*k+h*O+d*B,i[13]=u*E+c*S+h*R+d*D,i[2]=f*w+p*A+m*C+v*L,i[6]=f*x+p*T+m*P+v*I,i[10]=f*M+p*k+m*O+v*B,i[14]=f*E+p*S+m*R+v*D,i[3]=g*w+y*A+b*C+_*L,i[7]=g*x+y*T+b*P+_*I,i[11]=g*M+y*k+b*O+_*B,i[15]=g*E+y*S+b*R+_*D,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new c;return function(t){for(var r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix4(this),t.setXYZ(r,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],o=e[1],a=e[5],s=e[9],l=e[13],u=e[2],c=e[6],h=e[10],d=e[14];return e[3]*(+i*s*c-n*l*c-i*a*h+r*l*h+n*a*d-r*s*d)+e[7]*(+t*s*d-t*l*h+i*o*h-n*o*d+n*l*u-i*s*u)+e[11]*(+t*l*c-t*a*d-i*o*c+r*o*d+i*a*u-r*l*u)+e[15]*(-n*a*u-t*s*c+t*a*h+n*o*c-r*o*h+r*s*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var r=this.elements,n=e.elements,i=n[0],o=n[1],a=n[2],s=n[3],l=n[4],u=n[5],c=n[6],h=n[7],d=n[8],f=n[9],p=n[10],m=n[11],v=n[12],g=n[13],y=n[14],b=n[15],_=f*y*h-g*p*h+g*c*m-u*y*m-f*c*b+u*p*b,w=v*p*h-d*y*h-v*c*m+l*y*m+d*c*b-l*p*b,x=d*g*h-v*f*h+v*u*m-l*g*m-d*u*b+l*f*b,M=v*f*c-d*g*c-v*u*p+l*g*p+d*u*y-l*f*y,E=i*_+o*w+a*x+s*M;if(0===E){var A="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(!0===t)throw new Error(A);return console.warn(A),this.identity()}var T=1/E;return r[0]=_*T,r[1]=(g*p*s-f*y*s-g*a*m+o*y*m+f*a*b-o*p*b)*T,r[2]=(u*y*s-g*c*s+g*a*h-o*y*h-u*a*b+o*c*b)*T,r[3]=(f*c*s-u*p*s-f*a*h+o*p*h+u*a*m-o*c*m)*T,r[4]=w*T,r[5]=(d*y*s-v*p*s+v*a*m-i*y*m-d*a*b+i*p*b)*T,r[6]=(v*c*s-l*y*s-v*a*h+i*y*h+l*a*b-i*c*b)*T,r[7]=(l*p*s-d*c*s+d*a*h-i*p*h-l*a*m+i*c*m)*T,r[8]=x*T,r[9]=(v*f*s-d*g*s-v*o*m+i*g*m+d*o*b-i*f*b)*T,r[10]=(l*g*s-v*u*s+v*o*h-i*g*h-l*o*b+i*u*b)*T,r[11]=(d*u*s-l*f*s-d*o*h+i*f*h+l*o*m-i*u*m)*T,r[12]=M*T,r[13]=(d*g*a-v*f*a+v*o*p-i*g*p-d*o*y+i*f*y)*T,r[14]=(v*u*a-l*g*a-v*o*c+i*g*c+l*o*y-i*u*y)*T,r[15]=(l*f*a-d*u*a+d*o*c-i*f*c-l*o*p+i*u*p)*T,this},scale:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=1-r,o=e.x,a=e.y,s=e.z,l=i*o,u=i*a;return this.set(l*o+r,l*a-n*s,l*s+n*a,0,l*a+n*s,u*a+r,u*s-n*o,0,l*s-n*a,u*s+n*o,i*s*s+r,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},makeShear:function(e,t,r){return this.set(1,t,r,0,e,1,r,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,r){return this.makeRotationFromQuaternion(t),this.scale(r),this.setPosition(e),this},decompose:function(){var e=new c,t=new h;return function(r,n,i){var o=this.elements,a=e.set(o[0],o[1],o[2]).length(),s=e.set(o[4],o[5],o[6]).length(),l=e.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),r.x=o[12],r.y=o[13],r.z=o[14],t.copy(this);var u=1/a,c=1/s,h=1/l;return t.elements[0]*=u,t.elements[1]*=u,t.elements[2]*=u,t.elements[4]*=c,t.elements[5]*=c,t.elements[6]*=c,t.elements[8]*=h,t.elements[9]*=h,t.elements[10]*=h,n.setFromRotationMatrix(t),i.x=a,i.y=s,i.z=l,this}}(),makePerspective:function(e,t,r,n,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),l=2*i/(r-n),u=(t+e)/(t-e),c=(r+n)/(r-n),h=-(o+i)/(o-i),d=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=l,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,r,n,i,o){var a=this.elements,s=1/(t-e),l=1/(r-n),u=1/(o-i),c=(t+e)*s,h=(r+n)*l,d=(o+i)*u;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,r=e.elements,n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;r<16;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}),d.prototype=Object.create(o.prototype),d.prototype.constructor=d,d.prototype.isDataTexture=!0,f.prototype=Object.create(o.prototype),f.prototype.constructor=f,f.prototype.isCubeTexture=!0,Object.defineProperty(f.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var Ss=new o,Cs=new f,Ps=[],Os=[],Rs=new Float32Array(16),Ls=new Float32Array(9);G.prototype.setValue=function(e,t){for(var r=this.seq,n=0,i=r.length;n!==i;++n){var o=r[n];o.setValue(e,t[o.id])}};var Is=/([\w\d_]+)(\])?(\[|\.)?/g;Y.prototype.setValue=function(e,t,r){var n=this.map[t];void 0!==n&&n.setValue(e,r,this.renderer)},Y.prototype.setOptional=function(e,t,r){var n=t[r];void 0!==n&&this.setValue(e,r,n)},Y.upload=function(e,t,r,n){for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=r[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,n)}},Y.seqWithValue=function(e,t){for(var r=[],n=0,i=e.length;n!==i;++n){var o=e[n];o.id in t&&r.push(o)}return r};var Bs={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(q.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,r){return this.r=e,this.g=t,this.b=r,this},setHSL:function(){function e(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+6*(t-e)*(2/3-r):e}return function(t,r,n){if(t=Ts.euclideanModulo(t,1),r=Ts.clamp(r,0,1),n=Ts.clamp(n,0,1),0===r)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+r):n+r-n*r,o=2*n-i;this.r=e(o,i,t+1/3),this.g=e(o,i,t),this.b=e(o,i,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n,i=r[1],o=r[2];switch(i){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,l=parseInt(n[3],10)/100;return t(n[5]),this.setHSL(a,s,l)}}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(e)){var u=r[1],c=u.length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}if(e&&e.length>0){var u=Bs[e];void 0!==u?this.setHex(u):console.warn("THREE.Color: Unknown color "+e)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var r=t>0?1/t:1;return this.r=Math.pow(e.r,r),this.g=Math.pow(e.g,r),this.b=Math.pow(e.b,r),this},convertGammaToLinear:function(){var e=this.r,t=this.g,r=this.b;return this.r=e*e,this.g=t*t,this.b=r*r,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t,r,n=e||{h:0,s:0,l:0},i=this.r,o=this.g,a=this.b,s=Math.max(i,o,a),l=Math.min(i,o,a),u=(l+s)/2;if(l===s)t=0,r=0;else{var c=s-l;switch(r=u<=.5?c/(s+l):c/(2-s-l),s){case i:t=(o-a)/c+(o<a?6:0);break;case o:t=(a-i)/c+2;break;case a:t=(i-o)/c+4}t/=6}return n.h=t,n.s=r,n.l=u,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,r){var n=this.getHSL();return n.h+=e,n.s+=t,n.l+=r,this.setHSL(n.h,n.s,n.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var Ds={common:{diffuse:{value:new q(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new a(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new i(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new q(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new q(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new a(0,0,1,1)}}},js={merge:function(e){for(var t={},r=0;r<e.length;r++){var n=this.clone(e[r]);for(var i in n)t[i]=n[i]}return t},clone:function(e){var t={};for(var r in e){t[r]={};for(var n in e[r]){var i=e[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}}return t}},zs={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\treturn result;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transpose( const in mat3 v ) {\n\tmat3 tmp;\n\ttmp[0] = vec3(v[0].x, v[1].x, v[2].x);\n\ttmp[1] = vec3(v[0].y, v[1].y, v[2].y);\n\ttmp[2] = vec3(v[0].z, v[1].z, v[2].z);\n\treturn tmp;\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = asin( flipNormal * reflectVec.y ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\t\tvec4 t = texture2D( ltcMat, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_flip:"#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",distanceRGBA_vert:"varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0 - getShadowMask() ) );\n}\n",shadow_vert:"#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n"},Ns={basic:{uniforms:js.merge([Ds.common,Ds.aomap,Ds.lightmap,Ds.fog]),vertexShader:zs.meshbasic_vert,fragmentShader:zs.meshbasic_frag},lambert:{uniforms:js.merge([Ds.common,Ds.aomap,Ds.lightmap,Ds.emissivemap,Ds.fog,Ds.lights,{emissive:{value:new q(0)}}]),vertexShader:zs.meshlambert_vert,fragmentShader:zs.meshlambert_frag},phong:{uniforms:js.merge([Ds.common,Ds.aomap,Ds.lightmap,Ds.emissivemap,Ds.bumpmap,Ds.normalmap,Ds.displacementmap,Ds.gradientmap,Ds.fog,Ds.lights,{emissive:{value:new q(0)},specular:{value:new q(1118481)},shininess:{value:30}}]),vertexShader:zs.meshphong_vert,fragmentShader:zs.meshphong_frag},standard:{uniforms:js.merge([Ds.common,Ds.aomap,Ds.lightmap,Ds.emissivemap,Ds.bumpmap,Ds.normalmap,Ds.displacementmap,Ds.roughnessmap,Ds.metalnessmap,Ds.fog,Ds.lights,{emissive:{value:new q(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:zs.meshphysical_vert,fragmentShader:zs.meshphysical_frag},points:{uniforms:js.merge([Ds.points,Ds.fog]),vertexShader:zs.points_vert,fragmentShader:zs.points_frag},dashed:{uniforms:js.merge([Ds.common,Ds.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:zs.linedashed_vert,fragmentShader:zs.linedashed_frag},depth:{uniforms:js.merge([Ds.common,Ds.displacementmap]),vertexShader:zs.depth_vert,fragmentShader:zs.depth_frag},normal:{uniforms:js.merge([Ds.common,Ds.bumpmap,Ds.normalmap,Ds.displacementmap,{opacity:{value:1}}]),vertexShader:zs.normal_vert,fragmentShader:zs.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:zs.cube_vert,fragmentShader:zs.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:zs.equirect_vert,fragmentShader:zs.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new c}},vertexShader:zs.distanceRGBA_vert,fragmentShader:zs.distanceRGBA_frag}};Ns.physical={uniforms:js.merge([Ns.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:zs.meshphysical_vert,fragmentShader:zs.meshphysical_frag},Object.assign(K.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new i;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){var t=e||new i;return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new i;return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return(t||new i).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return(t||new i).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new i;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Us=0;Object.assign(J.prototype,n.prototype,{isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var r=e[t];if(void 0!==r){var n=this[t];void 0!==n?n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]="overdraw"===t?Number(r):r:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){function t(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}var r=void 0===e;r&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Co&&(n.blending=this.blending),this.shading!==Eo&&(n.shading=this.shading),this.side!==_o&&(n.side=this.side),this.vertexColors!==Ao&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),n.skinning=this.skinning,n.morphTargets=this.morphTargets,n.dithering=this.dithering,r){var i=t(e.textures),o=t(e.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.shading=e.shading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,r=null;if(null!==t){var n=t.length;r=new Array(n);for(var i=0;i!==n;++i)r[i]=t[i].clone()}return this.clippingPlanes=r,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),$.prototype=Object.create(J.prototype),$.prototype.constructor=$,$.prototype.isShaderMaterial=!0,$.prototype.copy=function(e){return J.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=js.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},$.prototype.toJSON=function(e){var t=J.prototype.toJSON.call(this,e);return t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},ee.prototype=Object.create(J.prototype),ee.prototype.constructor=ee,ee.prototype.isMeshDepthMaterial=!0,ee.prototype.copy=function(e){return J.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Object.assign(te.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,l=e.length;s<l;s+=3){var u=e[s],c=e[s+1],h=e[s+2];u<t&&(t=u),c<r&&(r=c),h<n&&(n=h),u>i&&(i=u),c>o&&(o=c),h>a&&(a=h)}return this.min.set(t,r,n),this.max.set(i,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,l=e.count;s<l;s++){var u=e.getX(s),c=e.getY(s),h=e.getZ(s);u<t&&(t=u),c<r&&(r=c),h<n&&(n=h),u>i&&(i=u),c>o&&(o=c),h>a&&(a=h)}return this.min.set(t,r,n),this.max.set(i,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new c;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){var t=e||new c;return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new c;return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e=new c;return function(t){var r=this;return t.updateMatrixWorld(!0),t.traverse(function(t){var n,i,o=t.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(n=0,i=a.length;n<i;n++)e.copy(a[n]),e.applyMatrix4(t.matrixWorld),r.expandByPoint(e)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(n=0,i=s.count;n<i;n++)e.fromBufferAttribute(s,n).applyMatrix4(t.matrixWorld),r.expandByPoint(e)}}),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return(t||new c).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(){var e=new c;return function(t){return this.clampPoint(t.center,e),e.distanceToSquared(t.center)<=t.radius*t.radius}}(),intersectsPlane:function(e){var t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=e.constant&&r>=e.constant},clampPoint:function(e,t){return(t||new c).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new c;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new c;return function(t){var r=t||new re;return this.getCenter(r.center),r.radius=.5*this.getSize(e).length(),r}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new c,new c,new c,new c,new c,new c,new c,new c];return function(t){return this.isEmpty()?this:(e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(e),this)}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(re.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new te;return function(t,r){var n=this.center;void 0!==r?n.copy(r):e.setFromPoints(t).getCenter(n);for(var i=0,o=0,a=t.length;o<a;o++)i=Math.max(i,n.distanceToSquared(t[o]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(this.center.dot(e.normal)-e.constant)<=this.radius},clampPoint:function(e,t){var r=this.center.distanceToSquared(e),n=t||new c;return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(e){var t=e||new te;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(ne.prototype,{isMatrix3:!0,set:function(e,t,r,n,i,o,a,s,l){var u=this.elements;return u[0]=e,u[1]=n,u[2]=a,u[3]=t,u[4]=i,u[5]=s,u[6]=r,u[7]=o,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new c;return function(t){for(var r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix3(this),t.setXYZ(r,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],a=r[3],s=r[6],l=r[1],u=r[4],c=r[7],h=r[2],d=r[5],f=r[8],p=n[0],m=n[3],v=n[6],g=n[1],y=n[4],b=n[7],_=n[2],w=n[5],x=n[8];return i[0]=o*p+a*g+s*_,i[3]=o*m+a*y+s*w,i[6]=o*v+a*b+s*x,i[1]=l*p+u*g+c*_,i[4]=l*m+u*y+c*w,i[7]=l*v+u*b+c*x,i[2]=h*p+d*g+f*_,i[5]=h*m+d*y+f*w,i[8]=h*v+d*b+f*x,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-r*i*u+r*a*s+n*i*l-n*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var r=e.elements,n=this.elements,i=r[0],o=r[1],a=r[2],s=r[3],l=r[4],u=r[5],c=r[6],h=r[7],d=r[8],f=d*l-u*h,p=u*c-d*s,m=h*s-l*c,v=i*f+o*p+a*m;if(0===v){var g="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(!0===t)throw new Error(g);return console.warn(g),this.identity()}var y=1/v;return n[0]=f*y,n[1]=(a*h-d*o)*y,n[2]=(u*o-a*l)*y,n[3]=p*y,n[4]=(d*i-a*c)*y,n[5]=(a*s-u*i)*y,n[6]=m*y,n[7]=(o*c-h*i)*y,n[8]=(l*i-o*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},equals:function(e){for(var t=this.elements,r=e.elements,n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;r<9;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}}),Object.assign(ie.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new c,t=new c;return function(r,n,i){var o=e.subVectors(i,n).cross(t.subVectors(r,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var r=this.distanceToPoint(e);return(t||new c).copy(this.normal).multiplyScalar(r)},intersectLine:function(){var e=new c;return function(t,r){var n=r||new c,i=t.delta(e),o=this.normal.dot(i);if(0!==o){var a=-(t.start.dot(this.normal)+this.constant)/o;if(!(a<0||a>1))return n.copy(i).multiplyScalar(a).add(t.start)}else if(0===this.distanceToPoint(t.start))return n.copy(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return(e||new c).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new c,t=new ne;return function(r,n){var i=this.coplanarPoint(e).applyMatrix4(r),o=n||t.getNormalMatrix(r),a=this.normal.applyMatrix3(o).normalize();return this.constant=-i.dot(a),this}}(),translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(oe.prototype,{set:function(e,t,r,n,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(n),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,r=0;r<6;r++)t[r].copy(e.planes[r]);return this},setFromMatrix:function(e){var t=this.planes,r=e.elements,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],l=r[5],u=r[6],c=r[7],h=r[8],d=r[9],f=r[10],p=r[11],m=r[12],v=r[13],g=r[14],y=r[15];return t[0].setComponents(a-n,c-s,p-h,y-m).normalize(),t[1].setComponents(a+n,c+s,p+h,y+m).normalize(),t[2].setComponents(a+i,c+l,p+d,y+v).normalize(),t[3].setComponents(a-i,c-l,p-d,y-v).normalize(),t[4].setComponents(a-o,c-u,p-f,y-g).normalize(),t[5].setComponents(a+o,c+u,p+f,y+g).normalize(),this},intersectsObject:function(){var e=new re;return function(t){var r=t.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),e.copy(r.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var e=new re;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,r=e.center,n=-e.radius,i=0;i<6;i++)if(t[i].distanceToPoint(r)<n)return!1;return!0},intersectsBox:function(){var e=new c,t=new c;return function(r){for(var n=this.planes,i=0;i<6;i++){var o=n[i];e.x=o.normal.x>0?r.min.x:r.max.x,t.x=o.normal.x>0?r.max.x:r.min.x,e.y=o.normal.y>0?r.min.y:r.max.y,t.y=o.normal.y>0?r.max.y:r.min.y,e.z=o.normal.z>0?r.min.z:r.max.z,t.z=o.normal.z>0?r.max.z:r.min.z;var a=o.distanceToPoint(e),s=o.distanceToPoint(t);if(a<0&&s<0)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}}),le.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],le.DefaultOrder="XYZ",Object.defineProperties(le.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(le.prototype,{isEuler:!0,set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,r){var n=Ts.clamp,i=e.elements,o=i[0],a=i[4],s=i[8],l=i[1],u=i[5],c=i[9],h=i[2],d=i[6],f=i[10];return t=t||this._order,"XYZ"===t?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,u),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(s,f),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===t?(this._y=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u))):"YZX"===t?(this._z=Math.asin(n(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,f))):"XZY"===t?(this._z=Math.asin(-n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,u),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-c,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==r&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new h;return function(t,r,n){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,r,n)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new u;return function(t){return e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new c(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(ue.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var Fs=0;ce.DefaultUp=new c(0,1,0),ce.DefaultMatrixAutoUpdate=!0,Object.assign(ce.prototype,n.prototype,{isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new u;return function(t,r){return e.setFromAxisAngle(t,r),this.quaternion.multiply(e),this}}(),rotateX:function(){var e=new c(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new c(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new c(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new c;return function(t,r){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(r)),this}}(),translateX:function(){var e=new c(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new c(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new c(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new h;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new h;return function(t){this.isCamera?e.lookAt(this.position,t,this.up):e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var r=this.children.indexOf(e);return-1!==r&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(r,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r],o=i.getObjectByProperty(e,t);if(void 0!==o)return o}},getWorldPosition:function(e){var t=e||new c;return this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new c,t=new c;return function(r){var n=r||new u;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,n,t),n}}(),getWorldRotation:function(){var e=new u;return function(t){var r=t||new le;return this.getWorldQuaternion(e),r.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new c,t=new u;return function(r){var n=r||new c;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,n),n}}(),getWorldDirection:function(){var e=new u;return function(t){var r=t||new c;return this.getWorldQuaternion(e),r.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)},toJSON:function(e){function t(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}function r(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}var n=void 0===e||""===e,i={};n&&(e={geometries:{},materials:{},textures:{},images:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var o={};if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),"{}"!==JSON.stringify(this.userData)&&(o.userData=this.userData),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),o.matrix=this.matrix.toArray(),void 0!==this.geometry&&(o.geometry=t(e.geometries,this.geometry)),void 0!==this.material)if(Array.isArray(this.material)){for(var a=[],s=0,l=this.material.length;s<l;s++)a.push(t(e.materials,this.material[s]));o.material=a}else o.material=t(e.materials,this.material);if(this.children.length>0){o.children=[];for(var s=0;s<this.children.length;s++)o.children.push(this.children[s].toJSON(e).object)}if(n){var u=r(e.geometries),c=r(e.materials),h=r(e.textures),d=r(e.images);u.length>0&&(i.geometries=u),c.length>0&&(i.materials=c),h.length>0&&(i.textures=h),d.length>0&&(i.images=d)}return i.object=o,i},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var r=0;r<e.children.length;r++){var n=e.children[r];this.add(n.clone())}return this}}),he.prototype=Object.assign(Object.create(ce.prototype),{constructor:he,isCamera:!0,copy:function(e,t){return ce.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:function(){var e=new u;return function(t){var r=t||new c;return this.getWorldQuaternion(e),r.set(0,0,-1).applyQuaternion(e)}}(),updateMatrixWorld:function(e){ce.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),de.prototype=Object.assign(Object.create(he.prototype),{constructor:de,isOrthographicCamera:!0,copy:function(e,t){return he.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,r,n,i,o){this.view={fullWidth:e,fullHeight:t,offsetX:r,offsetY:n,width:i,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-e,o=r+e,a=n+t,s=n-t;if(null!==this.view){var l=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),c=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;i+=c*(this.view.offsetX/l),o=i+c*(this.view.width/l),a-=h*(this.view.offsetY/u),s=a-h*(this.view.height/u)}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far)},toJSON:function(e){var t=ce.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),fe.prototype=Object.assign(Object.create(he.prototype),{constructor:fe,isPerspectiveCamera:!0,copy:function(e,t){return he.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Ts.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Ts.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Ts.RAD2DEG*Math.atan(Math.tan(.5*Ts.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,r,n,i,o){this.aspect=e/t,this.view={fullWidth:e,fullHeight:t,offsetX:r,offsetY:n,width:i,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Ts.DEG2RAD*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n,o=this.view;if(null!==o){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*n/a,t-=o.offsetY*r/s,n*=o.width/a,r*=o.height/s}var l=this.filmOffset;0!==l&&(i+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far)},toJSON:function(e){var t=ce.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),Object.assign(pe.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(var t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var Hs=0;Object.assign(ve.prototype,n.prototype,{isGeometry:!0,applyMatrix:function(e){for(var t=(new ne).getNormalMatrix(e),r=0,n=this.vertices.length;r<n;r++)this.vertices[r].applyMatrix4(e);for(var r=0,n=this.faces.length;r<n;r++){var i=this.faces[r];i.normal.applyMatrix3(t).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new h;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new h;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new h;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new h;return function(t,r,n){return e.makeTranslation(t,r,n),this.applyMatrix(e),this}}(),scale:function(){var e=new h;return function(t,r,n){return e.makeScale(t,r,n),this.applyMatrix(e),this}}(),lookAt:function(){var e=new ce;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(e){function t(e,t,n,i){var o=void 0!==s?[d[e].clone(),d[t].clone(),d[n].clone()]:[],a=void 0!==l?[r.colors[e].clone(),r.colors[t].clone(),r.colors[n].clone()]:[],c=new pe(e,t,n,o,a,i);r.faces.push(c),void 0!==u&&r.faceVertexUvs[0].push([f[e].clone(),f[t].clone(),f[n].clone()]),void 0!==h&&r.faceVertexUvs[1].push([p[e].clone(),p[t].clone(),p[n].clone()])}var r=this,n=null!==e.index?e.index.array:void 0,o=e.attributes,a=o.position.array,s=void 0!==o.normal?o.normal.array:void 0,l=void 0!==o.color?o.color.array:void 0,u=void 0!==o.uv?o.uv.array:void 0,h=void 0!==o.uv2?o.uv2.array:void 0;void 0!==h&&(this.faceVertexUvs[1]=[]);for(var d=[],f=[],p=[],m=0,v=0;m<a.length;m+=3,v+=2)r.vertices.push(new c(a[m],a[m+1],a[m+2])),void 0!==s&&d.push(new c(s[m],s[m+1],s[m+2])),void 0!==l&&r.colors.push(new q(l[m],l[m+1],l[m+2])),void 0!==u&&f.push(new i(u[v],u[v+1])),void 0!==h&&p.push(new i(h[v],h[v+1]));var g=e.groups;if(g.length>0)for(var m=0;m<g.length;m++)for(var y=g[m],b=y.start,_=y.count,v=b,w=b+_;v<w;v+=3)void 0!==n?t(n[v],n[v+1],n[v+2],y.materialIndex):t(v,v+1,v+2,y.materialIndex);else if(void 0!==n)for(var m=0;m<n.length;m+=3)t(n[m],n[m+1],n[m+2]);else for(var m=0;m<a.length/3;m+=3)t(m,m+1,m+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,r=0===t?1:1/t,n=new h;return n.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new c,t=new c,r=0,n=this.faces.length;r<n;r++){var i=this.faces[r],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){void 0===e&&(e=!0);var t,r,n,i,o,a;for(a=new Array(this.vertices.length),t=0,r=this.vertices.length;t<r;t++)a[t]=new c;if(e){var s,l,u,h=new c,d=new c;for(n=0,i=this.faces.length;n<i;n++)o=this.faces[n],s=this.vertices[o.a],l=this.vertices[o.b],u=this.vertices[o.c],h.subVectors(u,l),d.subVectors(s,l),h.cross(d),a[o.a].add(h),a[o.b].add(h),a[o.c].add(h)}else for(this.computeFaceNormals(),n=0,i=this.faces.length;n<i;n++)o=this.faces[n],a[o.a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,r=this.vertices.length;t<r;t++)a[t].normalize();for(n=0,i=this.faces.length;n<i;n++){o=this.faces[n];var f=o.vertexNormals;3===f.length?(f[0].copy(a[o.a]),f[1].copy(a[o.b]),f[2].copy(a[o.c])):(f[0]=a[o.a].clone(),f[1]=a[o.b].clone(),f[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,r;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){r=this.faces[e];var n=r.vertexNormals;3===n.length?(n[0].copy(r.normal),n[1].copy(r.normal),n[2].copy(r.normal)):(n[0]=r.normal.clone(),n[1]=r.normal.clone(),n[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,r,n,i;for(r=0,n=this.faces.length;r<n;r++)for(i=this.faces[r],i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var o=new ve;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a,s,l=this.morphNormals[e].faceNormals,u=this.morphNormals[e].vertexNormals;for(r=0,n=this.faces.length;r<n;r++)a=new c,s={a:new c,b:new c,c:new c},l.push(a),u.push(s)}var h=this.morphNormals[e];o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals();var a,s;for(r=0,n=this.faces.length;r<n;r++)i=this.faces[r],a=h.faceNormals[r],s=h.vertexNormals[r],a.copy(i.normal),s.a.copy(i.vertexNormals[0]),s.b.copy(i.vertexNormals[1]),s.c.copy(i.vertexNormals[2])}for(r=0,n=this.faces.length;r<n;r++)i=this.faces[r],i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeLineDistances:function(){for(var e=0,t=this.vertices,r=0,n=t.length;r<n;r++)r>0&&(e+=t[r].distanceTo(t[r-1])),this.lineDistances[r]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new te),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new re),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,r){if(!e||!e.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);var n,i=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,l=e.faces,u=this.faceVertexUvs[0],c=e.faceVertexUvs[0],h=this.colors,d=e.colors;void 0===r&&(r=0),void 0!==t&&(n=(new ne).getNormalMatrix(t));for(var f=0,p=a.length;f<p;f++){var m=a[f],v=m.clone();void 0!==t&&v.applyMatrix4(t),o.push(v)}for(var f=0,p=d.length;f<p;f++)h.push(d[f].clone());for(f=0,p=l.length;f<p;f++){var g,y,b,_=l[f],w=_.vertexNormals,x=_.vertexColors;g=new pe(_.a+i,_.b+i,_.c+i),g.normal.copy(_.normal),void 0!==n&&g.normal.applyMatrix3(n).normalize();for(var M=0,E=w.length;M<E;M++)y=w[M].clone(),void 0!==n&&y.applyMatrix3(n).normalize(),g.vertexNormals.push(y);g.color.copy(_.color);for(var M=0,E=x.length;M<E;M++)b=x[M],g.vertexColors.push(b.clone());g.materialIndex=_.materialIndex+r,s.push(g)}for(f=0,p=c.length;f<p;f++){var A=c[f],T=[];if(void 0!==A){for(var M=0,E=A.length;M<E;M++)T.push(A[M].clone());u.push(T)}}},mergeMesh:function(e){if(!e||!e.isMesh)return void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)},mergeVertices:function(){var e,t,r,n,i,o,a,s,l={},u=[],c=[],h=Math.pow(10,4);for(r=0,n=this.vertices.length;r<n;r++)e=this.vertices[r],t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h),void 0===l[t]?(l[t]=r,u.push(this.vertices[r]),c[r]=u.length-1):c[r]=c[l[t]];var d=[];for(r=0,n=this.faces.length;r<n;r++){i=this.faces[r],i.a=c[i.a],i.b=c[i.b],i.c=c[i.c],o=[i.a,i.b,i.c];for(var f=0;f<3;f++)if(o[f]===o[(f+1)%3]){d.push(r);break}}for(r=d.length-1;r>=0;r--){var p=d[r];for(this.faces.splice(p,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(p,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},sortFacesByMaterialIndex:function(){function e(e,t){return e.materialIndex-t.materialIndex}for(var t=this.faces,r=t.length,n=0;n<r;n++)t[n]._id=n;t.sort(e);var i,o,a=this.faceVertexUvs[0],s=this.faceVertexUvs[1];a&&a.length===r&&(i=[]),s&&s.length===r&&(o=[]);for(var n=0;n<r;n++){var l=t[n]._id;i&&i.push(a[l]),o&&o.push(s[l])}i&&(this.faceVertexUvs[0]=i),o&&(this.faceVertexUvs[1]=o)},toJSON:function(){function e(e,t,r){return r?e|1<<t:e&~(1<<t)}function t(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==d[t]?d[t]:(d[t]=h.length/3,h.push(e.x,e.y,e.z),d[t])}function r(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==p[t]?p[t]:(p[t]=f.length,f.push(e.getHex()),p[t])}function n(e){var t=e.x.toString()+e.y.toString();return void 0!==v[t]?v[t]:(v[t]=m.length/2,m.push(e.x,e.y),v[t])}var i={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),void 0!==this.parameters){var o=this.parameters;for(var a in o)void 0!==o[a]&&(i[a]=o[a]);return i}for(var s=[],l=0;l<this.vertices.length;l++){var u=this.vertices[l];s.push(u.x,u.y,u.z)}for(var c=[],h=[],d={},f=[],p={},m=[],v={},l=0;l<this.faces.length;l++){var g=this.faces[l],y=void 0!==this.faceVertexUvs[0][l],b=g.normal.length()>0,_=g.vertexNormals.length>0,w=1!==g.color.r||1!==g.color.g||1!==g.color.b,x=g.vertexColors.length>0,M=0;if(M=e(M,0,0),M=e(M,1,!0),M=e(M,2,!1),M=e(M,3,y),M=e(M,4,b),M=e(M,5,_),M=e(M,6,w),M=e(M,7,x),c.push(M),c.push(g.a,g.b,g.c),c.push(g.materialIndex),y){var E=this.faceVertexUvs[0][l];c.push(n(E[0]),n(E[1]),n(E[2]))}if(b&&c.push(t(g.normal)),_){var A=g.vertexNormals;c.push(t(A[0]),t(A[1]),t(A[2]))}if(w&&c.push(r(g.color)),x){var T=g.vertexColors;c.push(r(T[0]),r(T[1]),r(T[2]))}}return i.data={},i.data.vertices=s,i.data.normals=h,f.length>0&&(i.data.colors=f),m.length>0&&(i.data.uvs=[m]),i.data.faces=c,i},clone:function(){return(new ve).copy(this)},copy:function(e){var t,r,n,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,r=s.length;t<r;t++)this.vertices.push(s[t].clone());var l=e.colors;for(t=0,r=l.length;t<r;t++)this.colors.push(l[t].clone());var u=e.faces;for(t=0,r=u.length;t<r;t++)this.faces.push(u[t].clone());for(t=0,r=e.faceVertexUvs.length;t<r;t++){var c=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),n=0,i=c.length;n<i;n++){var h=c[n],d=[];for(o=0,a=h.length;o<a;o++){var f=h[o];d.push(f.clone())}this.faceVertexUvs[t].push(d)}}var p=e.morphTargets;for(t=0,r=p.length;t<r;t++){var m={};if(m.name=p[t].name,void 0!==p[t].vertices)for(m.vertices=[],n=0,i=p[t].vertices.length;n<i;n++)m.vertices.push(p[t].vertices[n].clone());if(void 0!==p[t].normals)for(m.normals=[],n=0,i=p[t].normals.length;n<i;n++)m.normals.push(p[t].normals[n].clone());this.morphTargets.push(m)}var v=e.morphNormals;for(t=0,r=v.length;t<r;t++){var g={};if(void 0!==v[t].vertexNormals)for(g.vertexNormals=[],n=0,i=v[t].vertexNormals.length;n<i;n++){var y=v[t].vertexNormals[n],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),g.vertexNormals.push(b)}if(void 0!==v[t].faceNormals)for(g.faceNormals=[],n=0,i=v[t].faceNormals.length;n<i;n++)g.faceNormals.push(v[t].faceNormals[n].clone());this.morphNormals.push(g)}var _=e.skinWeights;for(t=0,r=_.length;t<r;t++)this.skinWeights.push(_[t].clone());var w=e.skinIndices;for(t=0,r=w.length;t<r;t++)this.skinIndices.push(w[t].clone());var x=e.lineDistances;for(t=0,r=x.length;t<r;t++)this.lineDistances.push(x[t]);var M=e.boundingBox;null!==M&&(this.boundingBox=M.clone());var E=e.boundingSphere;return null!==E&&(this.boundingSphere=E.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(ge.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(ge.prototype,{isBufferAttribute:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.itemSize:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,r){e*=this.itemSize,r*=t.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),o=new q),t[r++]=o.r,t[r++]=o.g,t[r++]=o.b}return this},copyIndicesArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];t[r++]=o.a,t[r++]=o.b,t[r++]=o.c}return this},copyVector2sArray:function(e){for(var t=this.array,r=0,n=0,o=e.length;n<o;n++){var a=e[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),a=new i),t[r++]=a.x,t[r++]=a.y}return this},copyVector3sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new c),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new a),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z,t[r++]=o.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),ye.prototype=Object.create(ge.prototype),ye.prototype.constructor=ye,be.prototype=Object.create(ge.prototype),be.prototype.constructor=be,_e.prototype=Object.create(ge.prototype),_e.prototype.constructor=_e,we.prototype=Object.create(ge.prototype),we.prototype.constructor=we,xe.prototype=Object.create(ge.prototype),xe.prototype.constructor=xe,Me.prototype=Object.create(ge.prototype),Me.prototype.constructor=Me,Ee.prototype=Object.create(ge.prototype),Ee.prototype.constructor=Ee,Ae.prototype=Object.create(ge.prototype),Ae.prototype.constructor=Ae,Te.prototype=Object.create(ge.prototype),Te.prototype.constructor=Te,Object.assign(ke.prototype,{computeGroups:function(e){for(var t,r=[],n=void 0,i=e.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==n&&(n=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,r.push(t)),t={start:3*o,materialIndex:n})}void 0!==t&&(t.count=3*o-t.start,r.push(t)),this.groups=r},fromGeometry:function(e){var t,r=e.faces,n=e.vertices,o=e.faceVertexUvs,a=o[0]&&o[0].length>0,s=o[1]&&o[1].length>0,l=e.morphTargets,u=l.length;if(u>0){t=[];for(var c=0;c<u;c++)t[c]=[];this.morphTargets.position=t}var h,d=e.morphNormals,f=d.length;if(f>0){h=[];for(var c=0;c<f;c++)h[c]=[];this.morphTargets.normal=h}for(var p=e.skinIndices,m=e.skinWeights,v=p.length===n.length,g=m.length===n.length,c=0;c<r.length;c++){var y=r[c];this.vertices.push(n[y.a],n[y.b],n[y.c]);var b=y.vertexNormals;if(3===b.length)this.normals.push(b[0],b[1],b[2]);else{var _=y.normal;this.normals.push(_,_,_)}var w=y.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var x=y.color;this.colors.push(x,x,x)}if(!0===a){var M=o[0][c];void 0!==M?this.uvs.push(M[0],M[1],M[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new i,new i,new i))}if(!0===s){var M=o[1][c];void 0!==M?this.uvs2.push(M[0],M[1],M[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new i,new i,new i))}for(var E=0;E<u;E++){var A=l[E].vertices;t[E].push(A[y.a],A[y.b],A[y.c])}for(var E=0;E<f;E++){var T=d[E].vertexNormals[c];h[E].push(T.a,T.b,T.c)}v&&this.skinIndices.push(p[y.a],p[y.b],p[y.c]),g&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}}),Ce.MaxIndex=65535,Object.assign(Ce.prototype,n.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(Se(e)>65535?Ee:xe)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(t)):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(e,new ge(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var r=this.attributes.normal;return void 0!==r&&((new ne).getNormalMatrix(e).applyToBufferAttribute(r),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new h;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new h;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new h;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new h;return function(t,r,n){return e.makeTranslation(t,r,n),this.applyMatrix(e),this}}(),scale:function(){var e=new h;return function(t,r,n){return e.makeScale(t,r,n),this.applyMatrix(e),this}}(),lookAt:function(){var e=new ce;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var r=new Ae(3*t.vertices.length,3),n=new Ae(3*t.colors.length,3);if(this.addAttribute("position",r.copyVector3sArray(t.vertices)),this.addAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new Ae(t.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},updateFromObject:function(e){var t=e.geometry;if(e.isMesh){var r=t.__directGeometry;if(!0===t.elementsNeedUpdate&&(r=void 0,t.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(t);r.verticesNeedUpdate=t.verticesNeedUpdate,r.normalsNeedUpdate=t.normalsNeedUpdate,r.colorsNeedUpdate=t.colorsNeedUpdate,r.uvsNeedUpdate=t.uvsNeedUpdate,r.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=r}var n;return!0===t.verticesNeedUpdate&&(n=this.attributes.position,void 0!==n&&(n.copyVector3sArray(t.vertices),n.needsUpdate=!0),t.verticesNeedUpdate=!1),!0===t.normalsNeedUpdate&&(n=this.attributes.normal,void 0!==n&&(n.copyVector3sArray(t.normals),n.needsUpdate=!0),t.normalsNeedUpdate=!1),!0===t.colorsNeedUpdate&&(n=this.attributes.color,void 0!==n&&(n.copyColorsArray(t.colors),n.needsUpdate=!0),t.colorsNeedUpdate=!1),t.uvsNeedUpdate&&(n=this.attributes.uv,void 0!==n&&(n.copyVector2sArray(t.uvs),n.needsUpdate=!0),t.uvsNeedUpdate=!1),t.lineDistancesNeedUpdate&&(n=this.attributes.lineDistance,void 0!==n&&(n.copyArray(t.lineDistances),n.needsUpdate=!0),t.lineDistancesNeedUpdate=!1),t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new ke).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new ge(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var r=new Float32Array(3*e.normals.length);this.addAttribute("normal",new ge(r,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var n=new Float32Array(3*e.colors.length);this.addAttribute("color",new ge(n,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new ge(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var o=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new ge(o,2).copyVector2sArray(e.uvs2))}if(e.indices.length>0){var a=Se(e.indices)>65535?Uint32Array:Uint16Array,s=new a(3*e.indices.length);this.setIndex(new ge(s,1).copyIndicesArray(e.indices))}this.groups=e.groups;for(var l in e.morphTargets){for(var u=[],c=e.morphTargets[l],h=0,d=c.length;h<d;h++){var f=c[h],p=new Ae(3*f.length,3);u.push(p.copyVector3sArray(f))}this.morphAttributes[l]=u}if(e.skinIndices.length>0){var m=new Ae(4*e.skinIndices.length,4);this.addAttribute("skinIndex",m.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var v=new Ae(4*e.skinWeights.length,4);this.addAttribute("skinWeight",v.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new te);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var e=new te,t=new c;return function(){null===this.boundingSphere&&(this.boundingSphere=new re);var r=this.attributes.position;if(r){var n=this.boundingSphere.center;e.setFromBufferAttribute(r),e.getCenter(n);for(var i=0,o=0,a=r.count;o<a;o++)t.x=r.getX(o),t.y=r.getY(o),t.z=r.getZ(o),i=Math.max(i,n.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,r=this.groups;if(t.position){var n=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new ge(new Float32Array(n.length),3));else for(var i=t.normal.array,o=0,a=i.length;o<a;o++)i[o]=0;var s,l,u,h=t.normal.array,d=new c,f=new c,p=new c,m=new c,v=new c;if(e){var g=e.array;0===r.length&&this.addGroup(0,g.length);for(var y=0,b=r.length;y<b;++y)for(var _=r[y],w=_.start,x=_.count,o=w,a=w+x;o<a;o+=3)s=3*g[o+0],l=3*g[o+1],u=3*g[o+2],d.fromArray(n,s),f.fromArray(n,l),p.fromArray(n,u),m.subVectors(p,f),v.subVectors(d,f),m.cross(v),h[s]+=m.x,h[s+1]+=m.y,h[s+2]+=m.z,h[l]+=m.x,h[l+1]+=m.y,h[l+2]+=m.z,h[u]+=m.x,h[u+1]+=m.y,h[u+2]+=m.z}else for(var o=0,a=n.length;o<a;o+=9)d.fromArray(n,o),f.fromArray(n,o+3),p.fromArray(n,o+6),m.subVectors(p,f),v.subVectors(d,f),m.cross(v),h[o]=m.x,h[o+1]=m.y,h[o+2]=m.z,h[o+3]=m.x,h[o+4]=m.y,h[o+5]=m.z,h[o+6]=m.x,h[o+7]=m.y,h[o+8]=m.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0);var r=this.attributes;for(var n in r)if(void 0!==e.attributes[n])for(var i=r[n],o=i.array,a=e.attributes[n],s=a.array,l=a.itemSize,u=0,c=l*t;u<s.length;u++,c++)o[c]=s[u];return this},normalizeNormals:function(){for(var e,t,r,n,i=this.attributes.normal,o=0,a=i.count;o<a;o++)e=i.getX(o),t=i.getY(o),r=i.getZ(o),n=1/Math.sqrt(e*e+t*t+r*r),i.setXYZ(o,e*n,t*n,r*n)},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new Ce,t=this.index.array,r=this.attributes;for(var n in r){for(var i=r[n],o=i.array,a=i.itemSize,s=new o.constructor(t.length*a),l=0,u=0,c=0,h=t.length;c<h;c++){l=t[c]*a;for(var d=0;d<a;d++)s[u++]=o[l++]}e.addAttribute(n,new ge(s,a))}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};var n=this.index;if(null!==n){var i=Array.prototype.slice.call(n.array);e.data.index={type:n.array.constructor.name,array:i}}var o=this.attributes;for(var r in o){var a=o[r],i=Array.prototype.slice.call(a.array);e.data.attributes[r]={itemSize:a.itemSize,type:a.array.constructor.name,array:i,normalized:a.normalized}}var s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));var l=this.boundingSphere;return null!==l&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e},clone:function(){return(new Ce).copy(this)},copy:function(e){var t,r,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var o=e.attributes;for(t in o){var a=o[t];this.addAttribute(t,a.clone())}var s=e.morphAttributes;for(t in s){var l=[],u=s[t];for(r=0,n=u.length;r<n;r++)l.push(u[r].clone());this.morphAttributes[t]=l}var c=e.groups;for(r=0,n=c.length;r<n;r++){var h=c[r];this.addGroup(h.start,h.count,h.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var f=e.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Pe.prototype=Object.create(ve.prototype),Pe.prototype.constructor=Pe,Oe.prototype=Object.create(Ce.prototype),Oe.prototype.constructor=Oe,Re.prototype=Object.create(ve.prototype),Re.prototype.constructor=Re,Le.prototype=Object.create(Ce.prototype),Le.prototype.constructor=Le,Ie.prototype=Object.create(J.prototype),Ie.prototype.constructor=Ie,Ie.prototype.isMeshBasicMaterial=!0,Ie.prototype.copy=function(e){return J.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Object.assign(Be.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return(t||new c).copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new c;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var r=t||new c;r.subVectors(e,this.origin);var n=r.dot(this.direction);return n<0?r.copy(this.origin):r.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new c;return function(t){var r=e.subVectors(t,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(r).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:function(){var e=new c,t=new c,r=new c;return function(n,i,o,a){e.copy(n).add(i).multiplyScalar(.5),t.copy(i).sub(n).normalize(),r.copy(this.origin).sub(e);var s,l,u,c,h=.5*n.distanceTo(i),d=-this.direction.dot(t),f=r.dot(this.direction),p=-r.dot(t),m=r.lengthSq(),v=Math.abs(1-d*d);if(v>0)if(s=d*p-f,l=d*f-p,c=h*v,s>=0)if(l>=-c)if(l<=c){var g=1/v;s*=g,l*=g,u=s*(s+d*l+2*f)+l*(d*s+l+2*p)+m}else l=h,s=Math.max(0,-(d*l+f)),u=-s*s+l*(l+2*p)+m;else l=-h,s=Math.max(0,-(d*l+f)),u=-s*s+l*(l+2*p)+m;else l<=-c?(s=Math.max(0,-(-d*h+f)),l=s>0?-h:Math.min(Math.max(-h,-p),h),u=-s*s+l*(l+2*p)+m):l<=c?(s=0,l=Math.min(Math.max(-h,-p),h),u=l*(l+2*p)+m):(s=Math.max(0,-(d*h+f)),l=s>0?h:Math.min(Math.max(-h,-p),h),u=-s*s+l*(l+2*p)+m);else l=d>0?-h:h,s=Math.max(0,-(d*l+f)),u=-s*s+l*(l+2*p)+m;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(t).multiplyScalar(l).add(e),u}}(),intersectSphere:function(){var e=new c;return function(t,r){e.subVectors(t.center,this.origin);var n=e.dot(this.direction),i=e.dot(e)-n*n,o=t.radius*t.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=n-a,l=n+a;return s<0&&l<0?null:s<0?this.at(l,r):this.at(s,r)}}(),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null},intersectPlane:function(e,t){var r=this.distanceToPlane(e);return null===r?null:this.at(r,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var r,n,i,o,a,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(r=(e.min.x-h.x)*l,n=(e.max.x-h.x)*l):(r=(e.max.x-h.x)*l,n=(e.min.x-h.x)*l),u>=0?(i=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(i=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),r>o||i>n?null:((i>r||r!==r)&&(r=i),(o<n||n!==n)&&(n=o),c>=0?(a=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(a=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),r>s||a>n?null:((a>r||r!==r)&&(r=a),(s<n||n!==n)&&(n=s),n<0?null:this.at(r>=0?r:n,t)))},intersectsBox:function(){var e=new c;return function(t){return null!==this.intersectBox(t,e)}}(),intersectTriangle:function(){var e=new c,t=new c,r=new c,n=new c;return function(i,o,a,s,l){t.subVectors(o,i),r.subVectors(a,i),n.crossVectors(t,r);var u,c=this.direction.dot(n);if(c>0){if(s)return null;u=1}else{if(!(c<0))return null;u=-1,c=-c}e.subVectors(this.origin,i);var h=u*this.direction.dot(r.crossVectors(e,r));if(h<0)return null;var d=u*this.direction.dot(t.cross(e));if(d<0)return null;if(h+d>c)return null;var f=-u*e.dot(n);return f<0?null:this.at(f/c,l)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(De.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return(e||new c).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return(e||new c).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var r=t||new c;return this.delta(r).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new c,t=new c;return function(r,n){e.subVectors(r,this.start),t.subVectors(this.end,this.start);var i=t.dot(t),o=t.dot(e),a=o/i;return n&&(a=Ts.clamp(a,0,1)),a}}(),closestPointToPoint:function(e,t,r){var n=this.closestPointToPointParameter(e,t),i=r||new c;return this.delta(i).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Object.assign(je,{normal:function(){var e=new c;return function(t,r,n,i){var o=i||new c;o.subVectors(n,r),e.subVectors(t,r),o.cross(e);var a=o.lengthSq();return a>0?o.multiplyScalar(1/Math.sqrt(a)):o.set(0,0,0)}}(),barycoordFromPoint:function(){var e=new c,t=new c,r=new c;return function(n,i,o,a,s){e.subVectors(a,i),t.subVectors(o,i),r.subVectors(n,i);var l=e.dot(e),u=e.dot(t),h=e.dot(r),d=t.dot(t),f=t.dot(r),p=l*d-u*u,m=s||new c;if(0===p)return m.set(-2,-1,-1);var v=1/p,g=(d*h-u*f)*v,y=(l*f-u*h)*v;return m.set(1-g-y,y,g)}}(),containsPoint:function(){var e=new c;return function(t,r,n,i){var o=je.barycoordFromPoint(t,r,n,i,e);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}()}),Object.assign(je.prototype,{set:function(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this},setFromPointsAndIndices:function(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new c,t=new c;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){return(e||new c).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return je.normal(this.a,this.b,this.c,e)},plane:function(e){return(e||new ie).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return je.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return je.containsPoint(e,this.a,this.b,this.c)},closestPointToPoint:function(){var e=new ie,t=[new De,new De,new De],r=new c,n=new c;return function(i,o){var a=o||new c,s=1/0;if(e.setFromCoplanarPoints(this.a,this.b,this.c),e.projectPoint(i,r),!0===this.containsPoint(r))a.copy(r);else{t[0].set(this.a,this.b),t[1].set(this.b,this.c),t[2].set(this.c,this.a);for(var l=0;l<t.length;l++){t[l].closestPointToPoint(r,!0,n);var u=r.distanceToSquared(n);u<s&&(s=u,a.copy(n))}}return a}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),ze.prototype=Object.assign(Object.create(ce.prototype),{constructor:ze,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return ce.prototype.copy.call(this,e),this.drawMode=e.drawMode,this},updateMorphTargets:function(){var e,t,r,n=this.geometry;if(n.isBufferGeometry){var i=n.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)r=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}}else{var s=n.morphTargets;if(void 0!==s&&s.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)r=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}},raycast:function(){function e(e,t,r,n,i,o,a){return je.barycoordFromPoint(e,t,r,n,y),i.multiplyScalar(y.x),o.multiplyScalar(y.y),a.multiplyScalar(y.z),i.add(o).add(a),i.clone()}function t(e,t,r,n,i,o,a){var s=e.material;if(null===(s.side===wo?r.intersectTriangle(o,i,n,!0,a):r.intersectTriangle(n,i,o,s.side!==xo,a)))return null;_.copy(a),_.applyMatrix4(e.matrixWorld);var l=t.ray.origin.distanceTo(_);return l<t.near||l>t.far?null:{distance:l,point:_.clone(),object:e}}function r(r,n,i,o,a,c,h,d){s.fromBufferAttribute(o,c),l.fromBufferAttribute(o,h),u.fromBufferAttribute(o,d);var f=t(r,n,i,s,l,u,b);return f&&(a&&(m.fromBufferAttribute(a,c),v.fromBufferAttribute(a,h),g.fromBufferAttribute(a,d),f.uv=e(b,s,l,u,m,v,g)),f.face=new pe(c,h,d,je.normal(s,l,u)),f.faceIndex=c),f}var n=new h,o=new Be,a=new re,s=new c,l=new c,u=new c,d=new c,f=new c,p=new c,m=new i,v=new i,g=new i,y=new c,b=new c,_=new c;return function(i,c){var h=this.geometry,y=this.material,_=this.matrixWorld;if(void 0!==y&&(null===h.boundingSphere&&h.computeBoundingSphere(),a.copy(h.boundingSphere),a.applyMatrix4(_),!1!==i.ray.intersectsSphere(a)&&(n.getInverse(_),o.copy(i.ray).applyMatrix4(n),null===h.boundingBox||!1!==o.intersectsBox(h.boundingBox)))){var w;if(h.isBufferGeometry){var x,M,E,A,T,k=h.index,S=h.attributes.position,C=h.attributes.uv;if(null!==k)for(A=0,T=k.count;A<T;A+=3)x=k.getX(A),M=k.getX(A+1),E=k.getX(A+2),(w=r(this,i,o,S,C,x,M,E))&&(w.faceIndex=Math.floor(A/3),c.push(w));else for(A=0,T=S.count;A<T;A+=3)x=A,M=A+1,E=A+2,(w=r(this,i,o,S,C,x,M,E))&&(w.index=x,c.push(w))}else if(h.isGeometry){var P,O,R,L,I=Array.isArray(y),B=h.vertices,D=h.faces,j=h.faceVertexUvs[0];j.length>0&&(L=j);for(var z=0,N=D.length;z<N;z++){var U=D[z],F=I?y[U.materialIndex]:y;if(void 0!==F){if(P=B[U.a],O=B[U.b],R=B[U.c],!0===F.morphTargets){var H=h.morphTargets,V=this.morphTargetInfluences;s.set(0,0,0),l.set(0,0,0),u.set(0,0,0);for(var G=0,W=H.length;G<W;G++){var X=V[G];if(0!==X){var Y=H[G].vertices;s.addScaledVector(d.subVectors(Y[U.a],P),X),l.addScaledVector(f.subVectors(Y[U.b],O),X),u.addScaledVector(p.subVectors(Y[U.c],R),X)}}s.add(P),l.add(O),u.add(R),P=s,O=l,R=u}if(w=t(this,i,o,P,O,R,b)){if(L&&L[z]){var q=L[z];m.copy(q[0]),v.copy(q[1]),g.copy(q[2]),w.uv=e(b,P,O,R,m,v,g)}w.face=U,w.faceIndex=z,c.push(w)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Vs=0;pt.prototype=Object.assign(Object.create(fe.prototype),{constructor:pt,isArrayCamera:!0}),bt.prototype.isFogExp2=!0,bt.prototype.clone=function(){return new bt(this.color.getHex(),this.density)},bt.prototype.toJSON=function(e){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},_t.prototype.isFog=!0,_t.prototype.clone=function(){return new _t(this.color.getHex(),this.near,this.far)},_t.prototype.toJSON=function(e){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},wt.prototype=Object.assign(Object.create(ce.prototype),{constructor:wt,copy:function(e,t){return ce.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=ce.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),xt.prototype=Object.assign(Object.create(ce.prototype),{constructor:xt,isLensFlare:!0,copy:function(e){ce.prototype.copy.call(this,e),this.positionScreen.copy(e.positionScreen),this.customUpdateCallback=e.customUpdateCallback;for(var t=0,r=e.lensFlares.length;t<r;t++)this.lensFlares.push(e.lensFlares[t]);return this},add:function(e,t,r,n,i,o){void 0===t&&(t=-1),void 0===r&&(r=0),void 0===o&&(o=1),void 0===i&&(i=new q(16777215)),void 0===n&&(n=Co),r=Math.min(r,Math.max(0,r)),this.lensFlares.push({texture:e,size:t,distance:r,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:i,blending:n})},updateLensFlares:function(){var e,t,r=this.lensFlares.length,n=2*-this.positionScreen.x,i=2*-this.positionScreen.y;for(e=0;e<r;e++)t=this.lensFlares[e],t.x=this.positionScreen.x+n*t.distance,t.y=this.positionScreen.y+i*t.distance,t.wantedRotation=t.x*Math.PI*.25,t.rotation+=.25*(t.wantedRotation-t.rotation)}}),Mt.prototype=Object.create(J.prototype),Mt.prototype.constructor=Mt,Mt.prototype.isSpriteMaterial=!0,Mt.prototype.copy=function(e){return J.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this},Et.prototype=Object.assign(Object.create(ce.prototype),{constructor:Et,isSprite:!0,raycast:function(){var e=new c,t=new c,r=new c;return function(n,i){t.setFromMatrixPosition(this.matrixWorld),n.ray.closestPointToPoint(t,e),r.setFromMatrixScale(this.matrixWorld);var o=r.x*r.y/4;if(!(t.distanceToSquared(e)>o)){var a=n.ray.origin.distanceTo(e);a<n.near||a>n.far||i.push({distance:a,point:e.clone(),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),At.prototype=Object.assign(Object.create(ce.prototype),{constructor:At,copy:function(e){ce.prototype.copy.call(this,e,!1);for(var t=e.levels,r=0,n=t.length;r<n;r++){var i=t[r];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var r=this.levels,n=0;n<r.length&&!(t<r[n].distance);n++);r.splice(n,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,r=1,n=t.length;r<n&&!(e<t[r].distance);r++);return t[r-1].object},raycast:function(){var e=new c;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(e);this.getObjectForDistance(n).raycast(t,r)}}(),update:function(){var e=new c,t=new c;return function(r){var n=this.levels;if(n.length>1){e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var i=e.distanceTo(t);n[0].object.visible=!0;for(var o=1,a=n.length;o<a&&i>=n[o].distance;o++)n[o-1].object.visible=!1,n[o].object.visible=!0;for(;o<a;o++)n[o].object.visible=!1}}}(),toJSON:function(e){var t=ce.prototype.toJSON.call(this,e);t.object.levels=[];for(var r=this.levels,n=0,i=r.length;n<i;n++){var o=r[n];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),Object.assign(Tt.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var r=new h;this.bones[e]&&r.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(r)}},pose:function(){var e,t,r;for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){var e=new h,t=new h;return function(){for(var r=this.bones,n=this.boneInverses,i=this.boneMatrices,o=this.boneTexture,a=0,s=r.length;a<s;a++){var l=r[a]?r[a].matrixWorld:t;e.multiplyMatrices(l,n[a]),e.toArray(i,16*a)}void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new Tt(this.bones,this.boneInverses)}}),kt.prototype=Object.assign(Object.create(ce.prototype),{constructor:kt,isBone:!0}),St.prototype=Object.assign(Object.create(ze.prototype),{constructor:St,isSkinnedMesh:!0,initBones:function(){var e,t,r,n,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(r=0,n=this.geometry.bones.length;r<n;r++)t=this.geometry.bones[r],e=new kt,i.push(e),e.name=t.name,e.position.fromArray(t.pos),e.quaternion.fromArray(t.rotq),void 0!==t.scl&&e.scale.fromArray(t.scl);for(r=0,n=this.geometry.bones.length;r<n;r++)t=this.geometry.bones[r],-1!==t.parent&&null!==t.parent&&void 0!==i[t.parent]?i[t.parent].add(i[r]):this.add(i[r])}return this.updateMatrixWorld(!0),i},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var r=this.geometry.skinWeights[t];e=1/r.lengthManhattan(),e!==1/0?r.multiplyScalar(e):r.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var n=new a,i=this.geometry.attributes.skinWeight;for(t=0;t<i.count;t++)n.x=i.getX(t),n.y=i.getY(t),n.z=i.getZ(t),n.w=i.getW(t),e=1/n.lengthManhattan(),e!==1/0?n.multiplyScalar(e):n.set(1,0,0,0),i.setXYZW(t,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(e){ze.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ct.prototype=Object.create(J.prototype),Ct.prototype.constructor=Ct,Ct.prototype.isLineBasicMaterial=!0,Ct.prototype.copy=function(e){return J.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},Pt.prototype=Object.assign(Object.create(ce.prototype),{constructor:Pt,isLine:!0,raycast:function(){var e=new h,t=new Be,r=new re;return function(n,i){var o=n.linePrecision,a=o*o,s=this.geometry,l=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),r.copy(s.boundingSphere),r.applyMatrix4(l),!1!==n.ray.intersectsSphere(r)){e.getInverse(l),t.copy(n.ray).applyMatrix4(e);var u=new c,h=new c,d=new c,f=new c,p=this&&this.isLineSegments?2:1;if(s.isBufferGeometry){var m=s.index,v=s.attributes,g=v.position.array;if(null!==m)for(var y=m.array,b=0,_=y.length-1;b<_;b+=p){var w=y[b],x=y[b+1];u.fromArray(g,3*w),h.fromArray(g,3*x);var M=t.distanceSqToSegment(u,h,f,d);if(!(M>a)){f.applyMatrix4(this.matrixWorld);var E=n.ray.origin.distanceTo(f);E<n.near||E>n.far||i.push({distance:E,point:d.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}else for(var b=0,_=g.length/3-1;b<_;b+=p){u.fromArray(g,3*b),h.fromArray(g,3*b+3);var M=t.distanceSqToSegment(u,h,f,d);if(!(M>a)){f.applyMatrix4(this.matrixWorld);var E=n.ray.origin.distanceTo(f);E<n.near||E>n.far||i.push({distance:E,point:d.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}}else if(s.isGeometry)for(var A=s.vertices,T=A.length,b=0;b<T-1;b+=p){var M=t.distanceSqToSegment(A[b],A[b+1],f,d);if(!(M>a)){f.applyMatrix4(this.matrixWorld);var E=n.ray.origin.distanceTo(f);E<n.near||E>n.far||i.push({distance:E,point:d.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ot.prototype=Object.assign(Object.create(Pt.prototype),{constructor:Ot,isLineSegments:!0}),Rt.prototype=Object.assign(Object.create(Pt.prototype),{constructor:Rt,isLineLoop:!0}),Lt.prototype=Object.create(J.prototype),Lt.prototype.constructor=Lt,Lt.prototype.isPointsMaterial=!0,Lt.prototype.copy=function(e){return J.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this},It.prototype=Object.assign(Object.create(ce.prototype),{constructor:It,isPoints:!0,raycast:function(){var e=new h,t=new Be,r=new re;return function(n,i){function o(e,r){var o=t.distanceSqToPoint(e);if(o<d){var s=t.closestPointToPoint(e);s.applyMatrix4(l);var u=n.ray.origin.distanceTo(s);if(u<n.near||u>n.far)return;i.push({distance:u,distanceToRay:Math.sqrt(o),point:s.clone(),index:r,face:null,object:a})}}var a=this,s=this.geometry,l=this.matrixWorld,u=n.params.Points.threshold;if(null===s.boundingSphere&&s.computeBoundingSphere(),r.copy(s.boundingSphere),r.applyMatrix4(l),r.radius+=u,!1!==n.ray.intersectsSphere(r)){e.getInverse(l),t.copy(n.ray).applyMatrix4(e);var h=u/((this.scale.x+this.scale.y+this.scale.z)/3),d=h*h,f=new c;if(s.isBufferGeometry){var p=s.index,m=s.attributes,v=m.position.array;if(null!==p)for(var g=p.array,y=0,b=g.length;y<b;y++){var _=g[y];f.fromArray(v,3*_),o(f,_)}else for(var y=0,w=v.length/3;y<w;y++)f.fromArray(v,3*y),o(f,y)}else for(var x=s.vertices,y=0,w=x.length;y<w;y++)o(x[y],y)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Bt.prototype=Object.assign(Object.create(ce.prototype),{constructor:Bt}),Dt.prototype=Object.create(o.prototype),Dt.prototype.constructor=Dt,jt.prototype=Object.create(o.prototype),jt.prototype.constructor=jt,jt.prototype.isCompressedTexture=!0,zt.prototype=Object.create(o.prototype),zt.prototype.constructor=zt,Nt.prototype=Object.create(o.prototype),Nt.prototype.constructor=Nt,Nt.prototype.isDepthTexture=!0,Ut.prototype=Object.create(Ce.prototype),Ut.prototype.constructor=Ut,Ft.prototype=Object.create(ve.prototype),Ft.prototype.constructor=Ft,Ht.prototype=Object.create(Ce.prototype),Ht.prototype.constructor=Ht,Vt.prototype=Object.create(ve.prototype),Vt.prototype.constructor=Vt,Gt.prototype=Object.create(Ce.prototype),Gt.prototype.constructor=Gt,Wt.prototype=Object.create(ve.prototype),Wt.prototype.constructor=Wt,Xt.prototype=Object.create(Gt.prototype),Xt.prototype.constructor=Xt,Yt.prototype=Object.create(ve.prototype),Yt.prototype.constructor=Yt,qt.prototype=Object.create(Gt.prototype),qt.prototype.constructor=qt,Kt.prototype=Object.create(ve.prototype),Kt.prototype.constructor=Kt,Zt.prototype=Object.create(Gt.prototype),Zt.prototype.constructor=Zt,Qt.prototype=Object.create(ve.prototype),Qt.prototype.constructor=Qt,Jt.prototype=Object.create(Gt.prototype),Jt.prototype.constructor=Jt,$t.prototype=Object.create(ve.prototype),$t.prototype.constructor=$t,er.prototype=Object.create(Ce.prototype),er.prototype.constructor=er,tr.prototype=Object.create(ve.prototype),tr.prototype.constructor=tr,rr.prototype=Object.create(Ce.prototype),rr.prototype.constructor=rr,nr.prototype=Object.create(ve.prototype),nr.prototype.constructor=nr,ir.prototype=Object.create(Ce.prototype),ir.prototype.constructor=ir;var Gs={area:function(e){for(var t=e.length,r=0,n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return.5*r},triangulate:function(){function e(e,t,r,n,i,o){var a,s,l,u,c,h,d,f,p;if(s=e[o[t]].x,l=e[o[t]].y,u=e[o[r]].x,c=e[o[r]].y,h=e[o[n]].x,d=e[o[n]].y,(u-s)*(d-l)-(c-l)*(h-s)<=0)return!1;var m,v,g,y,b,_,w,x,M,E,A,T,k,S,C;for(m=h-u,v=d-c,g=s-h,y=l-d,b=u-s,_=c-l,a=0;a<i;a++)if(f=e[o[a]].x,p=e[o[a]].y,!(f===s&&p===l||f===u&&p===c||f===h&&p===d)&&(w=f-s,x=p-l,M=f-u,E=p-c,A=f-h,T=p-d,C=m*E-v*M,k=b*x-_*w,S=g*T-y*A,C>=-Number.EPSILON&&S>=-Number.EPSILON&&k>=-Number.EPSILON))return!1;return!0}return function(t,r){var n=t.length;if(n<3)return null;var i,o,a,s=[],l=[],u=[];if(Gs.area(t)>0)for(o=0;o<n;o++)l[o]=o;else for(o=0;o<n;o++)l[o]=n-1-o;var c=n,h=2*c;for(o=c-1;c>2;){if(h--<=0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),r?u:s;if(i=o,c<=i&&(i=0),o=i+1,c<=o&&(o=0),a=o+1,c<=a&&(a=0),e(t,i,o,a,c,l)){var d,f,p,m,v;for(d=l[i],f=l[o],p=l[a],s.push([t[d],t[f],t[p]]),u.push([l[i],l[o],l[a]]),m=o,v=o+1;v<c;m++,v++)l[m]=l[v];c--,h=2*c}}return r?u:s}}(),triangulateShape:function(e,t){function r(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function n(e,t,r){return e.x!==t.x?e.x<t.x?e.x<=r.x&&r.x<=t.x:t.x<=r.x&&r.x<=e.x:e.y<t.y?e.y<=r.y&&r.y<=t.y:t.y<=r.y&&r.y<=e.y}function i(e,t,r,i,o){var a=t.x-e.x,s=t.y-e.y,l=i.x-r.x,u=i.y-r.y,c=e.x-r.x,h=e.y-r.y,d=s*l-a*u,f=s*c-a*h;if(Math.abs(d)>Number.EPSILON){var p;if(d>0){if(f<0||f>d)return[];if((p=u*c-l*h)<0||p>d)return[]}else{if(f>0||f<d)return[];if((p=u*c-l*h)>0||p<d)return[]}if(0===p)return!o||0!==f&&f!==d?[e]:[];if(p===d)return!o||0!==f&&f!==d?[t]:[];if(0===f)return[r];if(f===d)return[i];var m=p/d;return[{x:e.x+m*a,y:e.y+m*s}]}if(0!==f||u*c!=l*h)return[];var v=0===a&&0===s,g=0===l&&0===u;if(v&&g)return e.x!==r.x||e.y!==r.y?[]:[e];if(v)return n(r,i,e)?[e]:[];if(g)return n(e,t,r)?[r]:[];var y,b,_,w,x,M,E,A;return 0!==a?(e.x<t.x?(y=e,_=e.x,b=t,w=t.x):(y=t,_=t.x,b=e,w=e.x),r.x<i.x?(x=r,E=r.x,M=i,A=i.x):(x=i,E=i.x,M=r,A=r.x)):(e.y<t.y?(y=e,_=e.y,b=t,w=t.y):(y=t,_=t.y,b=e,w=e.y),r.y<i.y?(x=r,E=r.y,M=i,A=i.y):(x=i,E=i.y,M=r,A=r.y)),_<=E?w<E?[]:w===E?o?[]:[x]:w<=A?[x,b]:[x,M]:_>A?[]:_===A?o?[]:[y]:w<=A?[y,b]:[y,M]}function o(e,t,r,n){var i=t.x-e.x,o=t.y-e.y,a=r.x-e.x,s=r.y-e.y,l=n.x-e.x,u=n.y-e.y,c=i*s-o*a,h=i*u-o*l;if(Math.abs(c)>Number.EPSILON){var d=l*s-u*a;return c>0?h>=0&&d>=0:h>=0||d>=0}return h>0}r(e),t.forEach(r);for(var a,s,l,u,c,h,d={},f=e.concat(),p=0,m=t.length;p<m;p++)Array.prototype.push.apply(f,t[p]);for(a=0,s=f.length;a<s;a++)c=f[a].x+":"+f[a].y,void 0!==d[c]&&console.warn("THREE.ShapeUtils: Duplicate point",c,a),d[c]=a;var v=function(e,t){for(var r,n,a,s,l,u,c,h,d,f,p,m=e.concat(),v=[],g=[],y=0,b=t.length;y<b;y++)v.push(y);for(var _=0,w=2*v.length;v.length>0;){if(--w<0){console.log("Infinite Loop! Holes left:"+v.length+", Probably Hole outside Shape!");break}for(a=_;a<m.length;a++){s=m[a],n=-1;for(var y=0;y<v.length;y++)if(u=v[y],c=s.x+":"+s.y+":"+u,void 0===g[c]){r=t[u];for(var x=0;x<r.length;x++)if(l=r[x],function(e,t){var n=m.length-1,i=e-1;i<0&&(i=n);var a=e+1;a>n&&(a=0);var s=o(m[e],m[i],m[a],r[t]);if(!s)return!1;var l=r.length-1,u=t-1;u<0&&(u=l);var c=t+1;return c>l&&(c=0),!!(s=o(r[t],r[u],r[c],m[e]))}(a,x)&&!function(e,t){var r,n,o;for(r=0;r<m.length;r++)if(n=r+1,n%=m.length,o=i(e,t,m[r],m[n],!0),o.length>0)return!0;return!1}(s,l)&&!function(e,r){var n,o,a,s,l;for(n=0;n<v.length;n++)for(o=t[v[n]],a=0;a<o.length;a++)if(s=a+1,s%=o.length,l=i(e,r,o[a],o[s],!0),l.length>0)return!0;return!1}(s,l)){n=x,v.splice(y,1),h=m.slice(0,a+1),d=m.slice(a),f=r.slice(n),p=r.slice(0,n+1),m=h.concat(f).concat(p).concat(d),_=a;break}if(n>=0)break;g[c]=!0}if(n>=0)break}}return m}(e,t),g=Gs.triangulate(v,!1);for(a=0,s=g.length;a<s;a++)for(u=g[a],l=0;l<3;l++)c=u[l].x+":"+u[l].y,void 0!==(h=d[c])&&(u[l]=h);return g.concat()},isClockWise:function(e){return Gs.area(e)<0}};or.prototype=Object.create(ve.prototype),or.prototype.constructor=or,ar.prototype=Object.create(Ce.prototype),ar.prototype.constructor=ar,ar.prototype.getArrays=function(){var e=this.getAttribute("position"),t=e?Array.prototype.slice.call(e.array):[],r=this.getAttribute("uv"),n=r?Array.prototype.slice.call(r.array):[],i=this.index;return{position:t,uv:n,index:i?Array.prototype.slice.call(i.array):[]}},ar.prototype.addShapeList=function(e,t){var r=e.length;t.arrays=this.getArrays();for(var n=0;n<r;n++){var i=e[n];this.addShape(i,t)}this.setIndex(t.arrays.index),this.addAttribute("position",new Ae(t.arrays.position,3)),this.addAttribute("uv",new Ae(t.arrays.uv,2))},ar.prototype.addShape=function(e,t){function r(e,t,r){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(r).add(e)}function n(e,t,r){var n,o,a,s=e.x-t.x,l=e.y-t.y,u=r.x-e.x,c=r.y-e.y,h=s*s+l*l,d=s*c-l*u;if(Math.abs(d)>Number.EPSILON){var f=Math.sqrt(h),p=Math.sqrt(u*u+c*c),m=t.x-l/f,v=t.y+s/f,g=r.x-c/p,y=r.y+u/p,b=((g-m)*c-(y-v)*u)/(s*c-l*u);n=m+s*b-e.x,o=v+l*b-e.y;var _=n*n+o*o;if(_<=2)return new i(n,o);a=Math.sqrt(_/2)}else{var w=!1;s>Number.EPSILON?u>Number.EPSILON&&(w=!0):s<-Number.EPSILON?u<-Number.EPSILON&&(w=!0):Math.sign(l)===Math.sign(c)&&(w=!0),w?(n=-l,o=s,a=Math.sqrt(h)):(n=s,o=l,a=Math.sqrt(h/2))}return new i(n/a,o/a)}function o(e,t){var r,n;for(Z=e.length;--Z>=0;){r=Z,(n=Z-1)<0&&(n=e.length-1);var i=0,o=S+2*A;for(i=0;i<o;i++){var a=Y*i,s=Y*(i+1);l(t+r+a,t+n+a,t+n+s,t+r+s,e,i,o,r,n)}}}function a(e,t,r){w.push(e),w.push(t),w.push(r)}function s(e,t,r){u(e),u(t),u(r);var n=y.length/3,i=O.generateTopUV(B,y,n-3,n-2,n-1);h(i[0]),h(i[1]),h(i[2])}function l(e,t,r,n,i,o,a,s,l){u(e),u(t),u(n),u(t),u(r),u(n);var c=y.length/3,d=O.generateSideWallUV(B,y,c-6,c-3,c-2,c-1);h(d[0]),h(d[1]),h(d[3]),h(d[1]),h(d[2]),h(d[3])}function u(e){b.push(y.length/3),y.push(w[3*e+0]),y.push(w[3*e+1]),y.push(w[3*e+2])}function h(e){_.push(e.x),_.push(e.y)}var d,f,p,m,v,g=t.arrays?t.arrays:this.getArrays(),y=g.position,b=g.index,_=g.uv,w=[],x=void 0!==t.amount?t.amount:100,M=void 0!==t.bevelThickness?t.bevelThickness:6,E=void 0!==t.bevelSize?t.bevelSize:M-2,A=void 0!==t.bevelSegments?t.bevelSegments:3,T=void 0===t.bevelEnabled||t.bevelEnabled,k=void 0!==t.curveSegments?t.curveSegments:12,S=void 0!==t.steps?t.steps:1,C=t.extrudePath,P=!1,O=void 0!==t.UVGenerator?t.UVGenerator:or.WorldUVGenerator;C&&(d=C.getSpacedPoints(S),P=!0,T=!1,f=void 0!==t.frames?t.frames:C.computeFrenetFrames(S,!1),p=new c,m=new c,v=new c),T||(A=0,M=0,E=0);var R,L,I,B=this,D=e.extractPoints(k),j=D.shape,z=D.holes;if(!Gs.isClockWise(j))for(j=j.reverse(),L=0,I=z.length;L<I;L++)R=z[L],Gs.isClockWise(R)&&(z[L]=R.reverse());var N=Gs.triangulateShape(j,z),U=j;for(L=0,I=z.length;L<I;L++)R=z[L],j=j.concat(R);for(var F,H,V,G,W,X,Y=j.length,q=N.length,K=[],Z=0,Q=U.length,J=Q-1,$=Z+1;Z<Q;Z++,J++,$++)J===Q&&(J=0),$===Q&&($=0),K[Z]=n(U[Z],U[J],U[$]);var ee,te=[],re=K.concat();for(L=0,I=z.length;L<I;L++){for(R=z[L],ee=[],Z=0,Q=R.length,J=Q-1,$=Z+1;Z<Q;Z++,J++,$++)J===Q&&(J=0),$===Q&&($=0),ee[Z]=n(R[Z],R[J],R[$]);te.push(ee),re=re.concat(ee)}for(F=0;F<A;F++){for(V=F/A,G=M*Math.cos(V*Math.PI/2),H=E*Math.sin(V*Math.PI/2),Z=0,Q=U.length;Z<Q;Z++)W=r(U[Z],K[Z],H),a(W.x,W.y,-G);for(L=0,I=z.length;L<I;L++)for(R=z[L],ee=te[L],Z=0,Q=R.length;Z<Q;Z++)W=r(R[Z],ee[Z],H),a(W.x,W.y,-G)}for(H=E,Z=0;Z<Y;Z++)W=T?r(j[Z],re[Z],H):j[Z],P?(m.copy(f.normals[0]).multiplyScalar(W.x),p.copy(f.binormals[0]).multiplyScalar(W.y),v.copy(d[0]).add(m).add(p),a(v.x,v.y,v.z)):a(W.x,W.y,0);var ne;for(ne=1;ne<=S;ne++)for(Z=0;Z<Y;Z++)W=T?r(j[Z],re[Z],H):j[Z],P?(m.copy(f.normals[ne]).multiplyScalar(W.x),p.copy(f.binormals[ne]).multiplyScalar(W.y),v.copy(d[ne]).add(m).add(p),a(v.x,v.y,v.z)):a(W.x,W.y,x/S*ne);for(F=A-1;F>=0;F--){for(V=F/A,G=M*Math.cos(V*Math.PI/2),H=E*Math.sin(V*Math.PI/2),Z=0,Q=U.length;Z<Q;Z++)W=r(U[Z],K[Z],H),a(W.x,W.y,x+G);for(L=0,I=z.length;L<I;L++)for(R=z[L],ee=te[L],Z=0,Q=R.length;Z<Q;Z++)W=r(R[Z],ee[Z],H),P?a(W.x,W.y+d[S-1].y,d[S-1].x+G):a(W.x,W.y,x+G)}!function(){var e=y.length/3;if(T){var r=0,n=Y*r;for(Z=0;Z<q;Z++)X=N[Z],s(X[2]+n,X[1]+n,X[0]+n);for(r=S+2*A,n=Y*r,Z=0;Z<q;Z++)X=N[Z],s(X[0]+n,X[1]+n,X[2]+n)}else{for(Z=0;Z<q;Z++)X=N[Z],s(X[2],X[1],X[0]);for(Z=0;Z<q;Z++)X=N[Z],s(X[0]+Y*S,X[1]+Y*S,X[2]+Y*S)}B.addGroup(e,y.length/3-e,void 0!==t.material?t.material:0)}(),function(){var e=y.length/3,r=0;for(o(U,r),r+=U.length,L=0,I=z.length;L<I;L++)R=z[L],o(R,r),r+=R.length;B.addGroup(e,y.length/3-e,void 0!==t.extrudeMaterial?t.extrudeMaterial:1)}(),t.arrays||(this.setIndex(b),this.addAttribute("position",new Ae(y,3)),this.addAttribute("uv",new Ae(t.arrays.uv,2)))},or.WorldUVGenerator={generateTopUV:function(e,t,r,n,o){var a=t[3*r],s=t[3*r+1],l=t[3*n],u=t[3*n+1],c=t[3*o],h=t[3*o+1];return[new i(a,s),new i(l,u),new i(c,h)]},generateSideWallUV:function(e,t,r,n,o,a){var s=t[3*r],l=t[3*r+1],u=t[3*r+2],c=t[3*n],h=t[3*n+1],d=t[3*n+2],f=t[3*o],p=t[3*o+1],m=t[3*o+2],v=t[3*a],g=t[3*a+1],y=t[3*a+2];return Math.abs(l-h)<.01?[new i(s,1-u),new i(c,1-d),new i(f,1-m),new i(v,1-y)]:[new i(l,1-u),new i(h,1-d),new i(p,1-m),new i(g,1-y)]}},sr.prototype=Object.create(ve.prototype),sr.prototype.constructor=sr,lr.prototype=Object.create(ar.prototype),lr.prototype.constructor=lr,ur.prototype=Object.create(ve.prototype),ur.prototype.constructor=ur,cr.prototype=Object.create(Ce.prototype),cr.prototype.constructor=cr,hr.prototype=Object.create(ve.prototype),hr.prototype.constructor=hr,dr.prototype=Object.create(Ce.prototype),dr.prototype.constructor=dr,fr.prototype=Object.create(ve.prototype),fr.prototype.constructor=fr,pr.prototype=Object.create(Ce.prototype),pr.prototype.constructor=pr,mr.prototype=Object.create(ve.prototype),mr.prototype.constructor=mr,vr.prototype=Object.create(Ce.prototype),vr.prototype.constructor=vr,gr.prototype=Object.create(Ce.prototype),gr.prototype.constructor=gr,yr.prototype=Object.create(ve.prototype),yr.prototype.constructor=yr,br.prototype=Object.create(Ce.prototype),br.prototype.constructor=br,_r.prototype=Object.create(yr.prototype),_r.prototype.constructor=_r,wr.prototype=Object.create(br.prototype),wr.prototype.constructor=wr,xr.prototype=Object.create(ve.prototype),xr.prototype.constructor=xr,Mr.prototype=Object.create(Ce.prototype),Mr.prototype.constructor=Mr;var Ws=Object.freeze({WireframeGeometry:Ut,ParametricGeometry:Ft,ParametricBufferGeometry:Ht,TetrahedronGeometry:Wt,TetrahedronBufferGeometry:Xt,OctahedronGeometry:Yt,OctahedronBufferGeometry:qt,IcosahedronGeometry:Kt,IcosahedronBufferGeometry:Zt,DodecahedronGeometry:Qt,DodecahedronBufferGeometry:Jt,PolyhedronGeometry:Vt,PolyhedronBufferGeometry:Gt,TubeGeometry:$t,TubeBufferGeometry:er,TorusKnotGeometry:tr,TorusKnotBufferGeometry:rr,TorusGeometry:nr,TorusBufferGeometry:ir,TextGeometry:sr,TextBufferGeometry:lr,SphereGeometry:ur,SphereBufferGeometry:cr,RingGeometry:hr,RingBufferGeometry:dr,PlaneGeometry:Re,PlaneBufferGeometry:Le,LatheGeometry:fr,LatheBufferGeometry:pr,ShapeGeometry:mr,ShapeBufferGeometry:vr,ExtrudeGeometry:or,ExtrudeBufferGeometry:ar,EdgesGeometry:gr,ConeGeometry:_r,ConeBufferGeometry:wr,CylinderGeometry:yr,CylinderBufferGeometry:br,CircleGeometry:xr,CircleBufferGeometry:Mr,BoxGeometry:Pe,BoxBufferGeometry:Oe});Er.prototype=Object.create($.prototype),Er.prototype.constructor=Er,Er.prototype.isShadowMaterial=!0,Ar.prototype=Object.create($.prototype),Ar.prototype.constructor=Ar,Ar.prototype.isRawShaderMaterial=!0,Tr.prototype=Object.create(J.prototype),Tr.prototype.constructor=Tr,Tr.prototype.isMeshStandardMaterial=!0,Tr.prototype.copy=function(e){return J.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},kr.prototype=Object.create(Tr.prototype),kr.prototype.constructor=kr,kr.prototype.isMeshPhysicalMaterial=!0,kr.prototype.copy=function(e){return Tr.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},Sr.prototype=Object.create(J.prototype),Sr.prototype.constructor=Sr,Sr.prototype.isMeshPhongMaterial=!0,Sr.prototype.copy=function(e){return J.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Cr.prototype=Object.create(Sr.prototype),Cr.prototype.constructor=Cr,Cr.prototype.isMeshToonMaterial=!0,Cr.prototype.copy=function(e){return Sr.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},Pr.prototype=Object.create(J.prototype),Pr.prototype.constructor=Pr,Pr.prototype.isMeshNormalMaterial=!0,Pr.prototype.copy=function(e){return J.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Or.prototype=Object.create(J.prototype),Or.prototype.constructor=Or,Or.prototype.isMeshLambertMaterial=!0,Or.prototype.copy=function(e){return J.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Rr.prototype=Object.create(J.prototype),Rr.prototype.constructor=Rr,Rr.prototype.isLineDashedMaterial=!0,Rr.prototype.copy=function(e){return J.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Xs=Object.freeze({ShadowMaterial:Er,SpriteMaterial:Mt,RawShaderMaterial:Ar,ShaderMaterial:$,PointsMaterial:Lt,MeshPhysicalMaterial:kr,MeshStandardMaterial:Tr,MeshPhongMaterial:Sr,MeshToonMaterial:Cr,MeshNormalMaterial:Pr,MeshLambertMaterial:Or,MeshDepthMaterial:ee,MeshBasicMaterial:Ie,LineDashedMaterial:Rr,LineBasicMaterial:Ct,Material:J}),Ys={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},qs=new Lr;Object.assign(Ir.prototype,{load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e);var i=this,o=Ys.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;var a=/^data:(.*?)(;base64)?,(.*)$/,s=e.match(a);if(s){var l=s[1],u=!!s[2],c=s[3];c=window.decodeURIComponent(c),u&&(c=window.atob(c));try{var h,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":h=new ArrayBuffer(c.length);for(var f=new Uint8Array(h),p=0;p<c.length;p++)f[p]=c.charCodeAt(p);"blob"===d&&(h=new Blob([h],{type:l}));break;case"document":var m=new DOMParser;h=m.parseFromString(c,l);break;case"json":h=JSON.parse(c);break;default:h=c}window.setTimeout(function(){t&&t(h),i.manager.itemEnd(e)},0)}catch(t){window.setTimeout(function(){n&&n(t),i.manager.itemEnd(e),i.manager.itemError(e)},0)}}else{var v=new XMLHttpRequest;v.open("GET",e,!0),v.addEventListener("load",function(r){var o=r.target.response;Ys.add(e,o),200===this.status?(t&&t(o),i.manager.itemEnd(e)):0===this.status?(console.warn("THREE.FileLoader: HTTP Status 0 received."),t&&t(o),i.manager.itemEnd(e)):(n&&n(r),i.manager.itemEnd(e),i.manager.itemError(e))},!1),void 0!==r&&v.addEventListener("progress",function(e){r(e)},!1),v.addEventListener("error",function(t){n&&n(t),i.manager.itemEnd(e),i.manager.itemError(e)},!1),void 0!==this.responseType&&(v.responseType=this.responseType),void 0!==this.withCredentials&&(v.withCredentials=this.withCredentials),v.overrideMimeType&&v.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(var g in this.requestHeader)v.setRequestHeader(g,this.requestHeader[g]);v.send(null)}return i.manager.itemStart(e),v},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(Br.prototype,{load:function(e,t,r,n){var i=this,o=[],a=new jt;a.image=o;var s=new Ir(this.manager);if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var l=0,u=0,c=e.length;u<c;++u)!function(u){s.load(e[u],function(e){var r=i._parser(e,!0);o[u]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(l+=1)&&(1===r.mipmapCount&&(a.minFilter=Ta),a.format=r.format,a.needsUpdate=!0,t&&t(a))},r,n)}(u);else s.load(e,function(e){var r=i._parser(e,!0);if(r.isCubemap)for(var n=r.mipmaps.length/r.mipmapCount,s=0;s<n;s++){o[s]={mipmaps:[]};for(var l=0;l<r.mipmapCount;l++)o[s].mipmaps.push(r.mipmaps[s*r.mipmapCount+l]),o[s].format=r.format,o[s].width=r.width,o[s].height=r.height}else a.image.width=r.width,a.image.height=r.height,a.mipmaps=r.mipmaps;1===r.mipmapCount&&(a.minFilter=Ta),a.format=r.format,a.needsUpdate=!0,t&&t(a)},r,n);return a},setPath:function(e){return this.path=e,this}}),Object.assign(Dr.prototype,{load:function(e,t,r,n){var i=this,o=new d,a=new Ir(this.manager);return a.setResponseType("arraybuffer"),a.load(e,function(e){var r=i._parser(e);r&&(void 0!==r.image?o.image=r.image:void 0!==r.data&&(o.image.width=r.width,o.image.height=r.height,o.image.data=r.data),o.wrapS=void 0!==r.wrapS?r.wrapS:wa,o.wrapT=void 0!==r.wrapT?r.wrapT:wa,o.magFilter=void 0!==r.magFilter?r.magFilter:Ta,o.minFilter=void 0!==r.minFilter?r.minFilter:Sa,o.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.format&&(o.format=r.format),void 0!==r.type&&(o.type=r.type),void 0!==r.mipmaps&&(o.mipmaps=r.mipmaps),1===r.mipmapCount&&(o.minFilter=Ta),o.needsUpdate=!0,t&&t(o,r))},r,n),o}}),Object.assign(jr.prototype,{load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e);var i=this,o=Ys.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");return a.addEventListener("load",function(){Ys.add(e,this),t&&t(this),i.manager.itemEnd(e)},!1),a.addEventListener("error",function(t){n&&n(t),i.manager.itemEnd(e),i.manager.itemError(e)},!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(zr.prototype,{load:function(e,t,r,n){var i=new f,o=new jr(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);for(var a=0,s=0;s<e.length;++s)!function(r){o.load(e[r],function(e){i.images[r]=e,6==++a&&(i.needsUpdate=!0,t&&t(i))},void 0,n)}(s);return i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Nr.prototype,{load:function(e,t,r,n){var i=new jr(this.manager);i.setCrossOrigin(this.crossOrigin),i.setPath(this.path);var a=new o;return a.image=i.load(e,function(){var r=e.search(/\.(jpg|jpeg)$/)>0||0===e.search(/^data\:image\/jpeg/);a.format=r?Ha:Va,a.needsUpdate=!0,void 0!==t&&t(a)},r,n),a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Ur.prototype=Object.assign(Object.create(ce.prototype),{constructor:Ur,isLight:!0,copy:function(e){return ce.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=ce.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Fr.prototype=Object.assign(Object.create(Ur.prototype),{constructor:Fr,isHemisphereLight:!0,copy:function(e){return Ur.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Hr.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Vr.prototype=Object.assign(Object.create(Hr.prototype),{constructor:Vr,isSpotLightShadow:!0,update:function(e){var t=this.camera,r=2*Ts.RAD2DEG*e.angle,n=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;r===t.fov&&n===t.aspect&&i===t.far||(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix())}}),Gr.prototype=Object.assign(Object.create(Ur.prototype),{constructor:Gr,isSpotLight:!0,copy:function(e){return Ur.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Wr.prototype=Object.assign(Object.create(Ur.prototype),{constructor:Wr,isPointLight:!0,copy:function(e){return Ur.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Xr.prototype=Object.assign(Object.create(Hr.prototype),{constructor:Xr}),Yr.prototype=Object.assign(Object.create(Ur.prototype),{constructor:Yr,isDirectionalLight:!0,copy:function(e){return Ur.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),qr.prototype=Object.assign(Object.create(Ur.prototype),{constructor:qr,isAmbientLight:!0}),Kr.prototype=Object.assign(Object.create(Ur.prototype),{constructor:Kr,isRectAreaLight:!0,copy:function(e){return Ur.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Ur.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}});var Ks={arraySlice:function(e,t,r){return Ks.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==r?r:e.length)):e.slice(t,r)},convertArray:function(e,t,r){return!e||!r&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){function t(t,r){return e[t]-e[r]}for(var r=e.length,n=new Array(r),i=0;i!==r;++i)n[i]=i;return n.sort(t),n},sortedArray:function(e,t,r){for(var n=e.length,i=new e.constructor(n),o=0,a=0;a!==n;++o)for(var s=r[o]*t,l=0;l!==t;++l)i[a++]=e[s+l];return i},flattenJSON:function(e,t,r,n){for(var i=1,o=e[0];void 0!==o&&void 0===o[n];)o=e[i++];if(void 0!==o){var a=o[n];if(void 0!==a)if(Array.isArray(a))do{a=o[n],void 0!==a&&(t.push(o.time),r.push.apply(r,a)),o=e[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{a=o[n],void 0!==a&&(t.push(o.time),a.toArray(r,r.length)),o=e[i++]}while(void 0!==o);else do{a=o[n],void 0!==a&&(t.push(o.time),r.push(a)),o=e[i++]}while(void 0!==o)}}};Object.assign(Zr.prototype,{evaluate:function(e){var t=this.parameterPositions,r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{var o;r:{n:if(!(e<n)){for(var a=r+2;;){if(void 0===n){if(e<i)break n;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,i)}if(r===a)break;if(i=n,n=t[++r],e<n)break t}o=t.length;break r}if(e>=i)break e;var s=t[1];e<s&&(r=2,i=s);for(var a=r-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(r===a)break;if(n=i,i=t[--r-1],e>=i)break t}o=r,r=0}for(;r<o;){var l=r+o>>>1;e<t[l]?o=l:r=l+1}if(n=t[r],void 0===(i=t[r-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,i,e)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n,o=0;o!==n;++o)t[o]=r[i+o];return t},interpolate_:function(e,t,r,n){throw new Error("call to abstract method")},intervalChanged_:function(e,t,r){}}),Object.assign(Zr.prototype,{beforeStart_:Zr.prototype.copySampleValue_,afterEnd_:Zr.prototype.copySampleValue_}),Qr.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Qr,DefaultSettings_:{endingStart:cs,endingEnd:cs},intervalChanged_:function(e,t,r){var n=this.parameterPositions,i=e-2,o=e+1,a=n[i],s=n[o];if(void 0===a)switch(this.getSettings_().endingStart){case hs:i=e,a=2*t-r;break;case ds:i=n.length-2,a=t+n[i]-n[i+1];break;default:i=e,a=r}if(void 0===s)switch(this.getSettings_().endingEnd){case hs:o=e,s=2*r-t;break;case ds:o=1,s=r+n[1]-n[0];break;default:o=e-1,s=t}var l=.5*(r-t),u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(s-r),this._offsetPrev=i*u,this._offsetNext=o*u},interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(r-t)/(n-t),p=f*f,m=p*f,v=-h*m+2*h*p-h*f,g=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,b=d*m-d*p,_=0;_!==a;++_)i[_]=v*o[u+_]+g*o[l+_]+y*o[s+_]+b*o[c+_];return i}}),Jr.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Jr,interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,u=(r-t)/(n-t),c=1-u,h=0;h!==a;++h)i[h]=o[l+h]*c+o[s+h]*u;return i}}),$r.prototype=Object.assign(Object.create(Zr.prototype),{constructor:$r,interpolate_:function(e,t,r,n){return this.copySampleValue_(e-1)}});var Zs;Zs={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:ls,InterpolantFactoryMethodDiscrete:function(e){return new $r(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Jr(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Qr(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case ss:t=this.InterpolantFactoryMethodDiscrete;break;case ls:t=this.InterpolantFactoryMethodLinear;break;case us:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}return void console.warn("THREE.KeyframeTrackPrototype:",r)}this.createInterpolant=t},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ss;case this.InterpolantFactoryMethodLinear:return ls;case this.InterpolantFactoryMethodSmooth:return us}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]*=e;return this},trim:function(e,t){for(var r=this.times,n=r.length,i=0,o=n-1;i!==n&&r[i]<e;)++i;for(;-1!==o&&r[o]>t;)--o;if(++o,0!==i||o!==n){i>=o&&(o=Math.max(o,1),i=o-1);var a=this.getValueSize();this.times=Ks.arraySlice(r,i,o),this.values=Ks.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrackPrototype: Invalid value size in track.",this),e=!1);var r=this.times,n=this.values,i=r.length;0===i&&(console.error("THREE.KeyframeTrackPrototype: Track is empty.",this),e=!1);for(var o=null,a=0;a!==i;a++){var s=r[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrackPrototype: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrackPrototype: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==n&&Ks.isTypedArray(n))for(var a=0,l=n.length;a!==l;++a){var u=n[a];if(isNaN(u)){console.error("THREE.KeyframeTrackPrototype: Value is not a valid number.",this,a,u),e=!1;break}}return e},optimize:function(){for(var e=this.times,t=this.values,r=this.getValueSize(),n=this.getInterpolation()===us,i=1,o=e.length-1,a=1;a<o;++a){var s=!1,l=e[a];if(l!==e[a+1]&&(1!==a||l!==l[0]))if(n)s=!0;else for(var u=a*r,c=u-r,h=u+r,d=0;d!==r;++d){var f=t[u+d];if(f!==t[c+d]||f!==t[h+d]){s=!0;break}}if(s){if(a!==i){e[i]=e[a];for(var p=a*r,m=i*r,d=0;d!==r;++d)t[m+d]=t[p+d]}++i}}if(o>0){e[i]=e[o];for(var p=o*r,m=i*r,d=0;d!==r;++d)t[m+d]=t[p+d];++i}return i!==e.length&&(this.times=Ks.arraySlice(e,0,i),this.values=Ks.arraySlice(t,0,i*r)),this}},tn.prototype=Object.assign(Object.create(Zs),{constructor:tn,ValueTypeName:"vector"}),rn.prototype=Object.assign(Object.create(Zr.prototype),{constructor:rn,interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=(r-t)/(n-t),c=s+a;s!==c;s+=4)u.slerpFlat(i,0,o,s-a,o,s,l);return i}}),nn.prototype=Object.assign(Object.create(Zs),{constructor:nn,ValueTypeName:"quaternion",DefaultInterpolation:ls,InterpolantFactoryMethodLinear:function(e){return new rn(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),on.prototype=Object.assign(Object.create(Zs),{constructor:on,ValueTypeName:"number"}),an.prototype=Object.assign(Object.create(Zs),{constructor:an,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:ss,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),sn.prototype=Object.assign(Object.create(Zs),{constructor:sn,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:ss,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ln.prototype=Object.assign(Object.create(Zs),{constructor:ln,ValueTypeName:"color"}),un.prototype=Zs,Zs.constructor=un,Object.assign(un,{parse:function(e){if(void 0===e.type)throw new Error("track type undefined, can not parse");var t=un._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var r=[],n=[];Ks.flattenJSON(e.keys,r,n,"value"),e.times=r,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var t,r=e.constructor;if(void 0!==r.toJSON)t=r.toJSON(e);else{t={name:e.name,times:Ks.convertArray(e.times,Array),values:Ks.convertArray(e.values,Array)};var n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return on;case"vector":case"vector2":case"vector3":case"vector4":return tn;case"color":return ln;case"quaternion":return nn;case"bool":case"boolean":return sn;case"string":return an}throw new Error("Unsupported typeName: "+e)}}),Object.assign(cn,{parse:function(e){for(var t=[],r=e.tracks,n=1/(e.fps||1),i=0,o=r.length;i!==o;++i)t.push(un.parse(r[i]).scale(n));return new cn(e.name,e.duration,t)},toJSON:function(e){for(var t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t},i=0,o=r.length;i!==o;++i)t.push(un.toJSON(r[i]));return n},CreateFromMorphTargetSequence:function(e,t,r,n){for(var i=t.length,o=[],a=0;a<i;a++){var s=[],l=[];s.push((a+i-1)%i,a,(a+1)%i),l.push(0,1,0);var u=Ks.getKeyframeOrder(s);s=Ks.sortedArray(s,1,u),l=Ks.sortedArray(l,1,u),n||0!==s[0]||(s.push(i),l.push(l[0])),o.push(new on(".morphTargetInfluences["+t[a].name+"]",s,l).scale(1/r))}return new cn(e,-1,o)},findByName:function(e,t){var r=e;if(!Array.isArray(e)){var n=e;r=n.geometry&&n.geometry.animations||n.animations}for(var i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,r){for(var n={},i=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],l=s.name.match(i);if(l&&l.length>1){var u=l[1],c=n[u];c||(n[u]=c=[]),c.push(s)}}var h=[];for(var u in n)h.push(cn.CreateFromMorphTargetSequence(u,n[u],t,r));return h},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var r=function(e,t,r,n,i){if(0!==r.length){var o=[],a=[];Ks.flattenJSON(r,o,a,n),0!==o.length&&i.push(new e(t,o,a))}},n=[],i=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],l=0;l<s.length;l++){var u=s[l].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var c={},h=0;h<u.length;h++)if(u[h].morphTargets)for(var d=0;d<u[h].morphTargets.length;d++)c[u[h].morphTargets[d]]=-1;for(var f in c){for(var p=[],m=[],d=0;d!==u[h].morphTargets.length;++d){var v=u[h];p.push(v.time),m.push(v.morphTarget===f?1:0)}n.push(new on(".morphTargetInfluence["+f+"]",p,m))}o=c.length*(a||1)}else{var g=".bones["+t[l].name+"]";r(tn,g+".position",u,"pos",n),r(nn,g+".quaternion",u,"rot",n),r(tn,g+".scale",u,"scl",n)}}return 0===n.length?null:new cn(i,o,n)}}),Object.assign(cn.prototype,{resetDuration:function(){for(var e=this.tracks,t=0,r=0,n=e.length;r!==n;++r){var i=this.tracks[r];t=Math.max(t,i.times[i.times.length-1])}this.duration=t},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(hn.prototype,{load:function(e,t,r,n){var i=this;new Ir(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},setTextures:function(e){this.textures=e},parse:function(e){function t(e){return void 0===r[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),r[e]}var r=this.textures,n=new Xs[e.type];if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&n.specular.setHex(e.specular),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearCoat&&(n.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(n.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.uniforms&&(n.uniforms=e.uniforms),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(n.vertexColors=e.vertexColors),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.shading&&(n.shading=e.shading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.side&&(n.side=e.side),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.skinning&&(n.skinning=e.skinning),void 0!==e.morphTargets&&(n.morphTargets=e.morphTargets),void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=t(e.map)),void 0!==e.alphaMap&&(n.alphaMap=t(e.alphaMap),n.transparent=!0),void 0!==e.bumpMap&&(n.bumpMap=t(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=t(e.normalMap)),void 0!==e.normalScale){var o=e.normalScale;!1===Array.isArray(o)&&(o=[o,o]),n.normalScale=(new i).fromArray(o)}return void 0!==e.displacementMap&&(n.displacementMap=t(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=t(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=t(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=t(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=t(e.specularMap)),void 0!==e.envMap&&(n.envMap=t(e.envMap)),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.lightMap&&(n.lightMap=t(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=t(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=t(e.gradientMap)),n}}),Object.assign(dn.prototype,{load:function(e,t,r,n){var i=this;new Ir(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){var t=new Ce,r=e.data.index;if(void 0!==r){var n=new Qs[r.type](r.array);t.setIndex(new ge(n,1))}var i=e.data.attributes;for(var o in i){var a=i[o],n=new Qs[a.type](a.array);t.addAttribute(o,new ge(n,a.itemSize,a.normalized))}var s=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==s)for(var l=0,u=s.length;l!==u;++l){var h=s[l];t.addGroup(h.start,h.count,h.materialIndex)}var d=e.data.boundingSphere;if(void 0!==d){var f=new c;void 0!==d.center&&f.fromArray(d.center),t.boundingSphere=new re(f,d.radius)}return t}});var Qs={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};fn.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,r=0,n=t.length;r<n;r+=2){var i=t[r],o=t[r+1];if(i.test(e))return o}return null}},Object.assign(fn.prototype,{crossOrigin:void 0,extractUrlBase:function(e){var t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(e,t,r){for(var n=[],i=0;i<e.length;++i)n[i]=this.createMaterial(e[i],t,r);return n},createMaterial:function(){var e={NoBlending:So,NormalBlending:Co,AdditiveBlending:Po,SubtractiveBlending:Oo,MultiplyBlending:Ro,CustomBlending:Lo},t=new q,r=new Nr,n=new hn;return function(i,o,a){function s(e,t,n,i,s){var u,c=o+e,h=fn.Handlers.get(c);null!==h?u=h.load(c):(r.setCrossOrigin(a),u=r.load(c)),void 0!==t&&(u.repeat.fromArray(t),1!==t[0]&&(u.wrapS=_a),1!==t[1]&&(u.wrapT=_a)),void 0!==n&&u.offset.fromArray(n),void 0!==i&&("repeat"===i[0]&&(u.wrapS=_a),"mirror"===i[0]&&(u.wrapS=xa),"repeat"===i[1]&&(u.wrapT=_a),"mirror"===i[1]&&(u.wrapT=xa)),void 0!==s&&(u.anisotropy=s);var d=Ts.generateUUID();return l[d]=u,d}var l={},u={uuid:Ts.generateUUID(),type:"MeshLambertMaterial"};for(var c in i){var h=i[c];switch(c){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":u.name=h;break;case"blending":u.blending=e[h];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",c,"is no longer supported.");break;case"colorDiffuse":u.color=t.fromArray(h).getHex();break;case"colorSpecular":u.specular=t.fromArray(h).getHex();break;case"colorEmissive":u.emissive=t.fromArray(h).getHex();break;case"specularCoef":u.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(u.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(u.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(u.type="MeshStandardMaterial");break;case"mapDiffuse":u.map=s(h,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":u.emissiveMap=s(h,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":u.lightMap=s(h,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":u.aoMap=s(h,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":u.bumpMap=s(h,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":u.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":u.normalMap=s(h,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":u.normalScale=[h,h];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":u.specularMap=s(h,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":u.metalnessMap=s(h,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":u.roughnessMap=s(h,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":u.alphaMap=s(h,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":u.side=wo;break;case"doubleSided":u.side=xo;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),u.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":u[c]=h;break;case"vertexColors":!0===h&&(u.vertexColors=ko),"face"===h&&(u.vertexColors=To);break;default:console.error("THREE.Loader.createMaterial: Unsupported",c,h)}}return"MeshBasicMaterial"===u.type&&delete u.emissive,"MeshPhongMaterial"!==u.type&&delete u.specular,u.opacity<1&&(u.transparent=!0),n.setTextures(l),n.parse(u)}}()}),Object.assign(pn.prototype,{load:function(e,t,r,n){var i=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:fn.prototype.extractUrlBase(e),a=new Ir(this.manager);a.setWithCredentials(this.withCredentials),a.load(e,function(r){var n=JSON.parse(r),a=n.metadata;if(void 0!==a){var s=a.type;if(void 0!==s){if("object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.");if("scene"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.SceneLoader instead.")}}var l=i.parse(n,o);t(l.geometry,l.materials)},r,n)},setTexturePath:function(e){this.texturePath=e},parse:function(){function e(e,t){function r(e,t){return e&1<<t}var n,o,a,s,l,u,h,d,f,p,m,v,g,y,b,_,w,x,M,E,A,T,k,S,C,P,O,R=e.faces,L=e.vertices,I=e.normals,B=e.colors,D=e.scale,j=0;if(void 0!==e.uvs){for(n=0;n<e.uvs.length;n++)e.uvs[n].length&&j++;for(n=0;n<j;n++)t.faceVertexUvs[n]=[]}for(s=0,l=L.length;s<l;)x=new c,x.x=L[s++]*D,x.y=L[s++]*D,x.z=L[s++]*D,t.vertices.push(x);for(s=0,l=R.length;s<l;)if(p=R[s++],m=r(p,0),v=r(p,1),g=r(p,3),y=r(p,4),b=r(p,5),_=r(p,6),w=r(p,7),m){if(E=new pe,E.a=R[s],E.b=R[s+1],E.c=R[s+3],A=new pe,A.a=R[s+1],A.b=R[s+2],A.c=R[s+3],s+=4,v&&(f=R[s++],E.materialIndex=f,A.materialIndex=f),a=t.faces.length,g)for(n=0;n<j;n++)for(S=e.uvs[n],t.faceVertexUvs[n][a]=[],t.faceVertexUvs[n][a+1]=[],o=0;o<4;o++)d=R[s++],P=S[2*d],O=S[2*d+1],C=new i(P,O),2!==o&&t.faceVertexUvs[n][a].push(C),0!==o&&t.faceVertexUvs[n][a+1].push(C);if(y&&(h=3*R[s++],E.normal.set(I[h++],I[h++],I[h]),A.normal.copy(E.normal)),b)for(n=0;n<4;n++)h=3*R[s++],k=new c(I[h++],I[h++],I[h]),2!==n&&E.vertexNormals.push(k),0!==n&&A.vertexNormals.push(k);if(_&&(u=R[s++],T=B[u],E.color.setHex(T),A.color.setHex(T)),w)for(n=0;n<4;n++)u=R[s++],T=B[u],2!==n&&E.vertexColors.push(new q(T)),0!==n&&A.vertexColors.push(new q(T));t.faces.push(E),t.faces.push(A)}else{if(M=new pe,M.a=R[s++],M.b=R[s++],M.c=R[s++],v&&(f=R[s++],M.materialIndex=f),a=t.faces.length,g)for(n=0;n<j;n++)for(S=e.uvs[n],t.faceVertexUvs[n][a]=[],o=0;o<3;o++)d=R[s++],P=S[2*d],O=S[2*d+1],C=new i(P,O),t.faceVertexUvs[n][a].push(C);if(y&&(h=3*R[s++],M.normal.set(I[h++],I[h++],I[h])),b)for(n=0;n<3;n++)h=3*R[s++],k=new c(I[h++],I[h++],I[h]),M.vertexNormals.push(k);if(_&&(u=R[s++],M.color.setHex(B[u])),w)for(n=0;n<3;n++)u=R[s++],M.vertexColors.push(new q(B[u]));t.faces.push(M)}}function t(e,t){var r=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var n=0,i=e.skinWeights.length;n<i;n+=r){var o=e.skinWeights[n],s=r>1?e.skinWeights[n+1]:0,l=r>2?e.skinWeights[n+2]:0,u=r>3?e.skinWeights[n+3]:0;t.skinWeights.push(new a(o,s,l,u))}if(e.skinIndices)for(var n=0,i=e.skinIndices.length;n<i;n+=r){var c=e.skinIndices[n],h=r>1?e.skinIndices[n+1]:0,d=r>2?e.skinIndices[n+2]:0,f=r>3?e.skinIndices[n+3]:0;t.skinIndices.push(new a(c,h,d,f))}t.bones=e.bones,t.bones&&t.bones.length>0&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}function r(e,t){var r=e.scale;if(void 0!==e.morphTargets)for(var n=0,i=e.morphTargets.length;n<i;n++){t.morphTargets[n]={},t.morphTargets[n].name=e.morphTargets[n].name,t.morphTargets[n].vertices=[];for(var o=t.morphTargets[n].vertices,a=e.morphTargets[n].vertices,s=0,l=a.length;s<l;s+=3){var u=new c;u.x=a[s]*r,u.y=a[s+1]*r,u.z=a[s+2]*r,o.push(u)}}if(void 0!==e.morphColors&&e.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var h=t.faces,d=e.morphColors[0].colors,n=0,i=h.length;n<i;n++)h[n].color.fromArray(d,3*n)}}function n(e,t){var r=[],n=[];void 0!==e.animation&&n.push(e.animation),void 0!==e.animations&&(e.animations.length?n=n.concat(e.animations):n.push(e.animations));for(var i=0;i<n.length;i++){var o=cn.parseAnimation(n[i],t.bones);o&&r.push(o)}if(t.morphTargets){var a=cn.CreateClipsFromMorphTargetSequences(t.morphTargets,10);r=r.concat(a)}r.length>0&&(t.animations=r)}return function(i,o){void 0!==i.data&&(i=i.data),void 0!==i.scale?i.scale=1/i.scale:i.scale=1;var a=new ve;return e(i,a),t(i,a),r(i,a),n(i,a),a.computeFaceNormals(),a.computeBoundingSphere(),void 0===i.materials||0===i.materials.length?{geometry:a}:{geometry:a,materials:fn.prototype.initMaterials(i.materials,o,this.crossOrigin)}}}()}),Object.assign(mn.prototype,{load:function(e,t,r,n){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var i=this;new Ir(i.manager).load(e,function(r){var o=null;try{o=JSON.parse(r)}catch(t){return void 0!==n&&n(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var a=o.metadata;if(void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase())return void console.error("THREE.ObjectLoader: Can't load "+e+". Use THREE.JSONLoader instead.");i.parse(o,t)},r,n)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var r=this.parseGeometries(e.geometries),n=this.parseImages(e.images,function(){void 0!==t&&t(a)}),i=this.parseTextures(e.textures,n),o=this.parseMaterials(e.materials,i),a=this.parseObject(e.object,r,o);return e.animations&&(a.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(a),a},parseGeometries:function(e){var t={};if(void 0!==e)for(var r=new pn,n=new dn,i=0,o=e.length;i<o;i++){var a,s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new Ws[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new Ws[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new Ws[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new Ws[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new Ws[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new Ws[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":a=new Ws[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new Ws[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new Ws[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new Ws[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new Ws[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":a=n.parse(s);break;case"Geometry":a=r.parse(s,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),t[s.uuid]=a}return t},parseMaterials:function(e,t){var r={};if(void 0!==e){var n=new hn;n.setTextures(t);for(var i=0,o=e.length;i<o;i++){var a=e[i];if("MultiMaterial"===a.type){for(var s=[],l=0;l<a.materials.length;l++)s.push(n.parse(a.materials[l]));r[a.uuid]=s}else r[a.uuid]=n.parse(a)}}return r},parseAnimations:function(e){for(var t=[],r=0;r<e.length;r++){var n=cn.parse(e[r]);t.push(n)}return t},parseImages:function(e,t){var r=this,n={};if(void 0!==e&&e.length>0){var i=new Lr(t),o=new jr(i);o.setCrossOrigin(this.crossOrigin);for(var a=0,s=e.length;a<s;a++){var l=e[a],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:r.texturePath+l.url;n[l.uuid]=function(e){return r.manager.itemStart(e),o.load(e,function(){r.manager.itemEnd(e)},void 0,function(){r.manager.itemEnd(e),r.manager.itemError(e)})}(u)}}return n},parseTextures:function(e,t){function r(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var n={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var s=e[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var l=new o(t[s.image]);l.needsUpdate=!0,l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.mapping&&(l.mapping=r(s.mapping,Js)),void 0!==s.offset&&l.offset.fromArray(s.offset),void 0!==s.repeat&&l.repeat.fromArray(s.repeat),void 0!==s.wrap&&(l.wrapS=r(s.wrap[0],$s),l.wrapT=r(s.wrap[1],$s)),void 0!==s.minFilter&&(l.minFilter=r(s.minFilter,el)),void 0!==s.magFilter&&(l.magFilter=r(s.magFilter,el)),void 0!==s.anisotropy&&(l.anisotropy=s.anisotropy),void 0!==s.flipY&&(l.flipY=s.flipY),n[s.uuid]=l}return n},parseObject:function(){var e=new h;return function(t,r,n){function i(e){return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),r[e]}function o(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var o=e[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),t.push(n[o])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}var a;switch(t.type){case"Scene":a=new wt,void 0!==t.background&&Number.isInteger(t.background)&&(a.background=new q(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?a.fog=new _t(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(a.fog=new bt(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":a=new fe(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(a.focus=t.focus),void 0!==t.zoom&&(a.zoom=t.zoom),void 0!==t.filmGauge&&(a.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(a.filmOffset=t.filmOffset),void 0!==t.view&&(a.view=Object.assign({},t.view));break;case"OrthographicCamera":a=new de(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":a=new qr(t.color,t.intensity);break;case"DirectionalLight":a=new Yr(t.color,t.intensity);break;case"PointLight":a=new Wr(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":a=new Kr(t.color,t.intensity,t.width,t.height);break;case"SpotLight":a=new Gr(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":a=new Fr(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var s=i(t.geometry),l=o(t.material);a=s.bones&&s.bones.length>0?new St(s,l):new ze(s,l);break;case"LOD":a=new At;break;case"Line":a=new Pt(i(t.geometry),o(t.material),t.mode);break;case"LineLoop":a=new Rt(i(t.geometry),o(t.material));break;case"LineSegments":a=new Ot(i(t.geometry),o(t.material));break;case"PointCloud":case"Points":a=new It(i(t.geometry),o(t.material));break;case"Sprite":a=new Et(o(t.material));break;case"Group":a=new Bt;break;default:a=new ce}if(a.uuid=t.uuid,void 0!==t.name&&(a.name=t.name),void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(a.position,a.quaternion,a.scale)):(void 0!==t.position&&a.position.fromArray(t.position),void 0!==t.rotation&&a.rotation.fromArray(t.rotation),void 0!==t.quaternion&&a.quaternion.fromArray(t.quaternion),void 0!==t.scale&&a.scale.fromArray(t.scale)),void 0!==t.castShadow&&(a.castShadow=t.castShadow),void 0!==t.receiveShadow&&(a.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(a.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(a.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&a.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(a.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(a.visible=t.visible),void 0!==t.userData&&(a.userData=t.userData),void 0!==t.children)for(var u in t.children)a.add(this.parseObject(t.children[u],r,n));if("LOD"===t.type)for(var c=t.levels,h=0;h<c.length;h++){var d=c[h],u=a.getObjectByProperty("uuid",d.object);void 0!==u&&a.addLevel(u,d.distance)}return a}}()});var Js={UVMapping:da,CubeReflectionMapping:fa,CubeRefractionMapping:pa,EquirectangularReflectionMapping:ma,EquirectangularRefractionMapping:va,SphericalReflectionMapping:ga,CubeUVReflectionMapping:ya,CubeUVRefractionMapping:ba},$s={RepeatWrapping:_a,ClampToEdgeWrapping:wa,MirroredRepeatWrapping:xa},el={NearestFilter:Ma,NearestMipMapNearestFilter:Ea,NearestMipMapLinearFilter:Aa,LinearFilter:Ta,LinearMipMapNearestFilter:ka,LinearMipMapLinearFilter:Sa};Object.assign(Tn.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,r,n=[],i=this.getPoint(0),o=0;for(n.push(0),r=1;r<=e;r++)t=this.getPoint(r/e),o+=t.distanceTo(i),n.push(o),i=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var r,n=this.getLengths(),i=0,o=n.length;r=t||e*n[o-1];for(var a,s=0,l=o-1;s<=l;)if(i=Math.floor(s+(l-s)/2),(a=n[i]-r)<0)s=i+1;else{if(!(a>0)){l=i;break}l=i-1}if(i=l,n[i]===r)return i/(o-1);var u=n[i];return(i+(r-u)/(n[i+1]-u))/(o-1)},getTangent:function(e){var t=e-1e-4,r=e+1e-4;t<0&&(t=0),r>1&&(r=1);var n=this.getPoint(t);return this.getPoint(r).clone().sub(n).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var r,n,i,o=new c,a=[],s=[],l=[],u=new c,d=new h;for(r=0;r<=e;r++)n=r/e,a[r]=this.getTangentAt(n),a[r].normalize();s[0]=new c,l[0]=new c;var f=Number.MAX_VALUE,p=Math.abs(a[0].x),m=Math.abs(a[0].y),v=Math.abs(a[0].z);for(p<=f&&(f=p,o.set(1,0,0)),m<=f&&(f=m,o.set(0,1,0)),v<=f&&o.set(0,0,1),u.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],u),l[0].crossVectors(a[0],s[0]),r=1;r<=e;r++)s[r]=s[r-1].clone(),l[r]=l[r-1].clone(),u.crossVectors(a[r-1],a[r]),u.length()>Number.EPSILON&&(u.normalize(),i=Math.acos(Ts.clamp(a[r-1].dot(a[r]),-1,1)),s[r].applyMatrix4(d.makeRotationAxis(u,i))),l[r].crossVectors(a[r],s[r]);if(!0===t)for(i=Math.acos(Ts.clamp(s[0].dot(s[e]),-1,1)),i/=e,a[0].dot(u.crossVectors(s[0],s[e]))>0&&(i=-i),r=1;r<=e;r++)s[r].applyMatrix4(d.makeRotationAxis(a[r],i*r)),l[r].crossVectors(a[r],s[r]);return{tangents:a,normals:s,binormals:l}}}),kn.prototype=Object.create(Tn.prototype),kn.prototype.constructor=kn,kn.prototype.isLineCurve=!0,kn.prototype.getPoint=function(e){if(1===e)return this.v2.clone();var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},kn.prototype.getPointAt=function(e){return this.getPoint(e)},kn.prototype.getTangent=function(e){return this.v2.clone().sub(this.v1).normalize()},Sn.prototype=Object.assign(Object.create(Tn.prototype),{constructor:Sn,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new kn(t,e))},getPoint:function(e){for(var t=e*this.getLength(),r=this.getCurveLengths(),n=0;n<r.length;){if(r[n]>=t){var i=r[n]-t,o=this.curves[n],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}n++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,r=[],n=0,i=this.curves;n<i.length;n++)for(var o=i[n],a=o&&o.isEllipseCurve?2*e:o&&o.isLineCurve?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),l=0;l<s.length;l++){var u=s[l];t&&t.equals(u)||(r.push(u),t=u)}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},createPointsGeometry:function(e){var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){for(var t=new ve,r=0,n=e.length;r<n;r++){var i=e[r];t.vertices.push(new c(i.x,i.y,i.z||0))}return t}}),Cn.prototype=Object.create(Tn.prototype),Cn.prototype.constructor=Cn,Cn.prototype.isEllipseCurve=!0,Cn.prototype.getPoint=function(e){for(var t=2*Math.PI,r=this.aEndAngle-this.aStartAngle,n=Math.abs(r)<Number.EPSILON;r<0;)r+=t;for(;r>t;)r-=t;r<Number.EPSILON&&(r=n?0:t),!0!==this.aClockwise||n||(r===t?r=-t:r-=t);var o=this.aStartAngle+e*r,a=this.aX+this.xRadius*Math.cos(o),s=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var l=Math.cos(this.aRotation),u=Math.sin(this.aRotation),c=a-this.aX,h=s-this.aY;a=c*l-h*u+this.aX,s=c*u+h*l+this.aY}return new i(a,s)},Pn.prototype=Object.create(Tn.prototype),Pn.prototype.constructor=Pn,Pn.prototype.isSplineCurve=!0,Pn.prototype.getPoint=function(e){var t=this.points,r=(t.length-1)*e,n=Math.floor(r),o=r-n,a=t[0===n?n:n-1],s=t[n],l=t[n>t.length-2?t.length-1:n+1],u=t[n>t.length-3?t.length-1:n+2];return new i(vn(o,a.x,s.x,l.x,u.x),vn(o,a.y,s.y,l.y,u.y))},On.prototype=Object.create(Tn.prototype),On.prototype.constructor=On,On.prototype.getPoint=function(e){var t=this.v0,r=this.v1,n=this.v2,o=this.v3;return new i(An(e,t.x,r.x,n.x,o.x),An(e,t.y,r.y,n.y,o.y))},Rn.prototype=Object.create(Tn.prototype),Rn.prototype.constructor=Rn,Rn.prototype.getPoint=function(e){var t=this.v0,r=this.v1,n=this.v2;return new i(_n(e,t.x,r.x,n.x),_n(e,t.y,r.y,n.y))};var tl=Object.assign(Object.create(Sn.prototype),{fromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var r=new kn(this.currentPoint.clone(),new i(e,t));this.curves.push(r),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,r,n){var o=new Rn(this.currentPoint.clone(),new i(e,t),new i(r,n));this.curves.push(o),this.currentPoint.set(r,n)},bezierCurveTo:function(e,t,r,n,o,a){var s=new On(this.currentPoint.clone(),new i(e,t),new i(r,n),new i(o,a));this.curves.push(s),this.currentPoint.set(o,a)},splineThru:function(e){var t=[this.currentPoint.clone()].concat(e),r=new Pn(t);this.curves.push(r),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,r,n,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+a,t+s,r,n,i,o)},absarc:function(e,t,r,n,i,o){this.absellipse(e,t,r,r,n,i,o)},ellipse:function(e,t,r,n,i,o,a,s){var l=this.currentPoint.x,u=this.currentPoint.y;this.absellipse(e+l,t+u,r,n,i,o,a,s)},absellipse:function(e,t,r,n,i,o,a,s){var l=new Cn(e,t,r,n,i,o,a,s);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);this.currentPoint.copy(c)}});Ln.prototype=tl,tl.constructor=Ln,In.prototype=Object.assign(Object.create(tl),{constructor:In,getPointsHoles:function(e){for(var t=[],r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t},extractAllPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},extractPoints:function(e){return this.extractAllPoints(e)}}),Object.assign(Bn.prototype,{moveTo:function(e,t){this.currentPath=new Ln,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,r,n){this.currentPath.quadraticCurveTo(e,t,r,n)},bezierCurveTo:function(e,t,r,n,i,o){this.currentPath.bezierCurveTo(e,t,r,n,i,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function r(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r],o=new In;o.curves=i.curves,t.push(o)}return t}var n=Gs.isClockWise,i=this.subPaths;if(0===i.length)return[];if(!0===t)return r(i);var o,a,s,l=[];if(1===i.length)return a=i[0],s=new In,s.curves=a.curves,l.push(s),l;var u=!n(i[0].getPoints());u=e?!u:u;var c,h=[],d=[],f=[],p=0;d[p]=void 0,f[p]=[];for(var m=0,v=i.length;m<v;m++)a=i[m],c=a.getPoints(),o=n(c),o=e?!o:o,o?(!u&&d[p]&&p++,d[p]={s:new In,p:c},d[p].s.curves=a.curves,u&&p++,f[p]=[]):f[p].push({h:a,p:c[0]});if(!d[0])return r(i);if(d.length>1){for(var g=!1,y=[],b=0,_=d.length;b<_;b++)h[b]=[];for(var b=0,_=d.length;b<_;b++)for(var w=f[b],x=0;x<w.length;x++){for(var M=w[x],E=!0,A=0;A<d.length;A++)(function(e,t){for(var r=t.length,n=!1,i=r-1,o=0;o<r;i=o++){var a=t[i],s=t[o],l=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(a=t[o],l=-l,s=t[i],u=-u),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var c=u*(e.x-a.x)-l*(e.y-a.y);if(0===c)return!0;if(c<0)continue;n=!n}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return n})(M.p,d[A].p)&&(b!==A&&y.push({froms:b,tos:A,hole:x}),E?(E=!1,h[A].push(M)):g=!0);E&&h[b].push(M)}y.length>0&&(g||(f=h))}for(var T,m=0,k=d.length;m<k;m++){s=d[m].s,l.push(s),T=f[m];for(var S=0,C=T.length;S<C;S++)s.holes.push(T[S].h)}return l}}),Object.assign(Dn.prototype,{isFont:!0,generateShapes:function(e,t,r){function n(e,t,n,o){var a=i.glyphs[e]||i.glyphs["?"];if(a){var s,l,u,c,h,d,f,p,m,v,g,y=new Bn,b=[];if(a.o)for(var _=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),w=0,x=_.length;w<x;){var M=_[w++];switch(M){case"m":s=_[w++]*t+n,l=_[w++]*t+o,y.moveTo(s,l);break;case"l":s=_[w++]*t+n,l=_[w++]*t+o,y.lineTo(s,l);break;case"q":if(u=_[w++]*t+n,c=_[w++]*t+o,f=_[w++]*t+n,p=_[w++]*t+o,y.quadraticCurveTo(f,p,u,c),g=b[b.length-1]){h=g.x,d=g.y;for(var E=1;E<=r;E++){var A=E/r;_n(A,h,f,u),_n(A,d,p,c)}}break;case"b":if(u=_[w++]*t+n,c=_[w++]*t+o,f=_[w++]*t+n,p=_[w++]*t+o,m=_[w++]*t+n,v=_[w++]*t+o,y.bezierCurveTo(f,p,m,v,u,c),g=b[b.length-1]){h=g.x,d=g.y;for(var E=1;E<=r;E++){var A=E/r;An(A,h,f,m,u),An(A,d,p,v,c)}}}}return{offsetX:a.ha*t,path:y}}}void 0===t&&(t=100),void 0===r&&(r=4);for(var i=this.data,o=function(e){for(var r=String(e).split(""),o=t/i.resolution,a=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*o,s=0,l=0,u=[],c=0;c<r.length;c++){var h=r[c];if("\n"===h)s=0,l-=a;else{var d=n(h,o,s,l);s+=d.offsetX,u.push(d.path)}}return u}(e),a=[],s=0,l=o.length;s<l;s++)Array.prototype.push.apply(a,o[s].toShapes());return a}}),Object.assign(jn.prototype,{load:function(e,t,r,n){var i=this;new Ir(this.manager).load(e,function(e){var r;try{r=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(e.substring(65,e.length-2))}var n=i.parse(r);t&&t(n)},r,n)},parse:function(e){return new Dn(e)}});var rl,nl={getContext:function(){return void 0===rl&&(rl=new(window.AudioContext||window.webkitAudioContext)),rl},setContext:function(e){rl=e}};Object.assign(zn.prototype,{load:function(e,t,r,n){var i=new Ir(this.manager);i.setResponseType("arraybuffer"),i.load(e,function(e){nl.getContext().decodeAudioData(e,function(e){t(e)})},r,n)}}),Object.assign(Nn.prototype,{update:function(){var e,t,r,n,i,o,a,s,l=new h,u=new h;return function(c){if(e!==this||t!==c.focus||r!==c.fov||n!==c.aspect*this.aspect||i!==c.near||o!==c.far||a!==c.zoom||s!==this.eyeSep){e=this,t=c.focus,r=c.fov,n=c.aspect*this.aspect,i=c.near,o=c.far,a=c.zoom;var h=c.projectionMatrix.clone();s=this.eyeSep/2;var d,f,p=s*i/t,m=i*Math.tan(Ts.DEG2RAD*r*.5)/a;u.elements[12]=-s,l.elements[12]=s,d=-m*n+p,f=m*n+p,h.elements[0]=2*i/(f-d),h.elements[8]=(f+d)/(f-d),this.cameraL.projectionMatrix.copy(h),d=-m*n-p,f=m*n-p,h.elements[0]=2*i/(f-d),h.elements[8]=(f+d)/(f-d),this.cameraR.projectionMatrix.copy(h)}this.cameraL.matrixWorld.copy(c.matrixWorld).multiply(u),this.cameraR.matrixWorld.copy(c.matrixWorld).multiply(l)}}()}),Un.prototype=Object.create(ce.prototype),Un.prototype.constructor=Un,Fn.prototype=Object.assign(Object.create(ce.prototype),{constructor:Fn,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(e){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.value=e},updateMatrixWorld:function(){var e=new c,t=new u,r=new c,n=new c;return function(i){ce.prototype.updateMatrixWorld.call(this,i);var o=this.context.listener,a=this.up;this.matrixWorld.decompose(e,t,r),n.set(0,0,-1).applyQuaternion(t),o.positionX?(o.positionX.setValueAtTime(e.x,this.context.currentTime),o.positionY.setValueAtTime(e.y,this.context.currentTime),o.positionZ.setValueAtTime(e.z,this.context.currentTime),o.forwardX.setValueAtTime(n.x,this.context.currentTime),o.forwardY.setValueAtTime(n.y,this.context.currentTime),o.forwardZ.setValueAtTime(n.z,this.context.currentTime),o.upX.setValueAtTime(a.x,this.context.currentTime),o.upY.setValueAtTime(a.y,this.context.currentTime),o.upZ.setValueAtTime(a.z,this.context.currentTime)):(o.setPosition(e.x,e.y,e.z),o.setOrientation(n.x,n.y,n.z,a.x,a.y,a.z))}}()}),Hn.prototype=Object.assign(Object.create(ce.prototype),{constructor:Hn,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),e.start(0,this.startTime),this.isPlaying=!0,this.source=e,this.connect()},pause:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this)},stop:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=0,this.isPlaying=!1,this)},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this)},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.value=e,this}}),Vn.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Vn,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:function(){var e=new c;return function(t){ce.prototype.updateMatrixWorld.call(this,t),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}()}),Object.assign(Gn.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),r=0;r<t.length;r++)e+=t[r];return e/t.length}}),Object.assign(Wn.prototype,{accumulate:function(e,t){var r=this.buffer,n=this.valueSize,i=e*n+n,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==n;++a)r[i+a]=r[a];o=t}else{o+=t;var s=t/o;this._mixBufferRegion(r,i,0,s,n)}this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*t;this._mixBufferRegion(r,n,a,1-i,t)}for(var s=t,l=t+t;s!==l;++s)if(r[s]!==r[s+t]){o.setValue(r,n);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,r=this.valueSize,n=3*r;e.getValue(t,n);for(var i=r,o=n;i!==o;++i)t[i]=t[n+i%r];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,r,n,i){if(n>=.5)for(var o=0;o!==i;++o)e[t+o]=e[r+o]},_slerp:function(e,t,r,n){u.slerpFlat(e,t,e,t,e,r,n)},_lerp:function(e,t,r,n,i){for(var o=1-n,a=0;a!==i;++a){var s=t+a;e[s]=e[s]*o+e[r+a]*n}}}),Object.assign(Xn.prototype,{getValue:function(e,t){this.bind();var r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}),Object.assign(Yn,{Composite:Xn,create:function(e,t,r){return e&&e.isAnimationObjectGroup?new Yn.Composite(e,t,r):new Yn(e,t,r)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(/[^\w-]/g,"")},parseTrackName:function(){var e=/((?:[\w-]+[\/:])*)/,t=/([\w-\.]+)?/,r=/(?:\.([\w-]+)(?:\[(.+)\])?)?/,n=/\.([\w-]+)(?:\[(.+)\])?/,i=new RegExp("^"+e.source+t.source+r.source+n.source+"$"),o=["material","materials","bones"];return function(e){var t=i.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var a=r.nodeName.substring(n+1);-1!==o.indexOf(a)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=a)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}}(),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var r=function(e){for(var r=0;r<e.bones.length;r++){var n=e.bones[r];if(n.name===t)return n}return null}(e.skeleton);if(r)return r}if(e.children){var n=function(e){for(var r=0;r<e.length;r++){var i=e[r];if(i.name===t||i.uuid===t)return i;var o=n(i.children);if(o)return o}return null},i=n(e.children);if(i)return i}return null}}),Object.assign(Yn.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)e[t++]=r[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.node[this.propertyName]=e[t]},function(e,t){this.node[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.node[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,i=t.propertyIndex;if(e||(e=Yn.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){var o=t.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[n];if(void 0===s){var l=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+n+" but it wasn't found.",e)}var u=this.Versioning.None;void 0!==e.needsUpdate?(u=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e);var c=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(var a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(var a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===i){i=a;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][u]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Yn.prototype,{_getValue_unbound:Yn.prototype.getValue,_setValue_unbound:Yn.prototype.setValue}),Object.assign(qn.prototype,{isAnimationObjectGroup:!0,add:function(e){for(var t=this._objects,r=t.length,n=this.nCachedObjects_,i=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,l=s.length,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],d=h.uuid,f=i[d],p=void 0;if(void 0===f){f=r++,i[d]=f,t.push(h);for(var m=0,v=l;m!==v;++m)s[m].push(new Yn(h,o[m],a[m]))}else if(f<n){p=t[f];var g=--n,y=t[g];i[y.uuid]=f,t[f]=y,i[d]=g,t[g]=h;for(var m=0,v=l;m!==v;++m){var b=s[m],_=b[g],w=b[f];b[f]=_,void 0===w&&(w=new Yn(h,o[m],a[m])),b[g]=w}}else t[f]!==p&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(e){for(var t=this._objects,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var l=arguments[a],u=l.uuid,c=n[u];if(void 0!==c&&c>=r){var h=r++,d=t[h];n[d.uuid]=c,t[c]=d,n[u]=h,t[h]=l;for(var f=0,p=o;f!==p;++f){var m=i[f],v=m[h],g=m[c];m[c]=v,m[h]=g}}}this.nCachedObjects_=r},uncache:function(e){for(var t=this._objects,r=t.length,n=this.nCachedObjects_,i=this._indicesByUUID,o=this._bindings,a=o.length,s=0,l=arguments.length;s!==l;++s){var u=arguments[s],c=u.uuid,h=i[c];if(void 0!==h)if(delete i[c],h<n){var d=--n,f=t[d],p=--r,m=t[p];i[f.uuid]=h,t[h]=f,i[m.uuid]=d,t[d]=m,t.pop();for(var v=0,g=a;v!==g;++v){var y=o[v],b=y[d],_=y[p];y[h]=b,y[d]=_,y.pop()}}else{var p=--r,m=t[p];i[m.uuid]=h,t[h]=m,t.pop();for(var v=0,g=a;v!==g;++v){var y=o[v];y[h]=y[p],y.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var r=this._bindingsIndicesByPath,n=r[e],i=this._bindings;if(void 0!==n)return i[n];var o=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);n=i.length,r[e]=n,o.push(e),a.push(t),i.push(c);for(var h=u,d=s.length;h!==d;++h){var f=s[h];c[h]=new Yn(f,e,t)}return c},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){var n=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=r,o[r]=s,o.pop(),i[r]=i[a],i.pop(),n[r]=n[a],n.pop()}}}),Object.assign(Kn.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){var n=this._clip.duration,i=e._clip.duration,o=i/n,a=n/i;e.warp(1,o,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,r){return e.crossFadeFrom(this,t,r)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,r){var n=this._mixer,i=n.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,l=o.sampleValues;return s[0]=i,s[1]=i+r,l[0]=e/a,l[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,r,n){if(!this.enabled)return void this._updateWeight(e);var i=this._startTime;if(null!==i){var o=(e-i)*r;if(o<0||0===r)return;this._startTime=null,t=r*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var l=this._interpolants,u=this._propertyBindings,c=0,h=l.length;c!==h;++c)l[c].evaluate(a),u[c].accumulate(n,s)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var r=this._weightInterpolant;if(null!==r){var n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var r=this._timeScaleInterpolant;null!==r&&(t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e;if(0===e)return t;var r=this._clip.duration,n=this.loop,i=this._loopCount;if(n===is){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=r)t=r;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{var o=n===as;if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),t>=r||t<0){var a=Math.floor(t/r);t-=r*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?r:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(0===s){var l=e<0;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1==(1&i))return this.time=t,r-t}return this.time=t,t},_setEndings:function(e,t,r){var n=this._interpolantSettings;r?(n.endingStart=hs,n.endingEnd=hs):(n.endingStart=e?this.zeroSlopeAtStart?hs:cs:ds,n.endingEnd=t?this.zeroSlopeAtEnd?hs:cs:ds)},_scheduleFading:function(e,t,r){var n=this._mixer,i=n.time,o=this._weightInterpolant;null===o&&(o=n._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=t,a[1]=i+e,s[1]=r,this}}),Object.assign(Zn.prototype,n.prototype,{_bindAction:function(e,t){var r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,o=e._propertyBindings,a=e._interpolants,s=r.uuid,l=this._bindingsByRootAndName,u=l[s];void 0===u&&(u={},l[s]=u);for(var c=0;c!==i;++c){var h=n[c],d=h.name,f=u[d];if(void 0!==f)o[c]=f;else{if(void 0!==(f=o[c])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,d));continue}var p=t&&t._propertyBindings[c].binding.parsedPath;f=new Wn(Yn.create(r,d,p),h.ValueTypeName,h.getValueSize()),++f.referenceCount,this._addInactiveBinding(f,s,d),o[c]=f}a[c].resultBuffer=f.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,t)}for(var i=e._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,r=0,n=t.length;r!==n;++r){var i=t[r];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,r){var n=this._actions,i=this._actionsByClip,o=i[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=n.length,n.push(e),o.actionByRoot[r]=e},_removeInactiveAction:function(e){var t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,l=s[s.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,s[u]=l,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,r=0,n=t.length;r!==n;++r){var i=t[r];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_takeBackAction:function(e){var t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_addInactiveBinding:function(e,t,r){var n=this._bindingsByRootAndName,i=n[t],o=this._bindings;void 0===i&&(i={},n[t]=i),i[r]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,o=this._bindingsByRootAndName,a=o[n],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete a[i];e:{for(var u in a)break e;delete o[n]}},_lendBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_takeBackBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return void 0===r&&(r=new Jr(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),r.__cacheIndex=t,e[t]=r),r},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n,t[n]=e,i.__cacheIndex=r,t[r]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var r=t||this._root,n=r.uuid,i="string"==typeof e?cn.findByName(r,e):e,o=null!==i?i.uuid:e,a=this._actionsByClip[o],s=null;if(void 0!==a){var l=a.actionByRoot[n];if(void 0!==l)return l;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var u=new Kn(this,i,t);return this._bindAction(u,s),this._addInactiveAction(u,o,n),u},existingAction:function(e,t){var r=t||this._root,n=r.uuid,i="string"==typeof e?cn.findByName(r,e):e,o=i?i.uuid:e,a=this._actionsByClip[o];return void 0!==a?a.actionByRoot[n]||null:null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,r=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==t;++i)e[i].reset();for(var i=0;i!==n;++i)r[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1,a=0;a!==r;++a)t[a]._update(n,e,i,o);for(var s=this._bindings,l=this._nActiveBindings,a=0;a!==l;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var l=o[a];this._deactivateAction(l);var u=l._cacheIndex,c=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,t[u]=c,t.pop(),this._removeInactiveBindingsForAction(l)}delete n[r]}},uncacheRoot:function(e){var t=e.uuid,r=this._actionsByClip;for(var n in r){var i=r[n].actionByRoot,o=i[t];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}var a=this._bindingsByRootAndName,s=a[t];if(void 0!==s)for(var l in s){var u=s[l];u.restoreOriginalState(),this._removeInactiveBinding(u)}},uncacheAction:function(e,t){var r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}),Qn.prototype.clone=function(){return new Qn(void 0===this.value.clone?this.value:this.value.clone())},Jn.prototype=Object.assign(Object.create(Ce.prototype),{constructor:Jn,isInstancedBufferGeometry:!0,addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:r})},copy:function(e){var t=e.index;null!==t&&this.setIndex(t.clone());var r=e.attributes;for(var n in r){var i=r[n];this.addAttribute(n,i.clone())}for(var o=e.groups,a=0,s=o.length;a<s;a++){var l=o[a];this.addGroup(l.start,l.count,l.materialIndex)}return this}}),Object.defineProperties($n.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign($n.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this}}),Object.defineProperty(ei.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(ei.prototype,{isInterleavedBuffer:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.stride:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,r){e*=this.stride,r*=t.stride;for(var n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),ti.prototype=Object.assign(Object.create(ei.prototype),{constructor:ti,isInstancedInterleavedBuffer:!0,copy:function(e){return ei.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),ri.prototype=Object.assign(Object.create(ge.prototype),{constructor:ri,isInstancedBufferAttribute:!0,copy:function(e){return ge.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(ni.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t){var r=[];return oi(e,this,r,t),r.sort(ii),r},intersectObjects:function(e,t){var r=[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var n=0,i=e.length;n<i;n++)oi(e[n],this,r,t);return r.sort(ii),r}}),Object.assign(ai.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),Object.assign(si.prototype,{set:function(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(Ts.clamp(e.y/this.radius,-1,1))),this}}),Object.assign(li.prototype,{set:function(e,t,r){return this.radius=e,this.theta=t,this.y=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.radius=Math.sqrt(e.x*e.x+e.z*e.z),this.theta=Math.atan2(e.x,e.z),this.y=e.y,this}}),ui.prototype=Object.create(ze.prototype),ui.prototype.constructor=ui,ui.prototype.createAnimation=function(e,t,r,n){var i={start:t,end:r,length:r-t+1,fps:n,duration:(r-t)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=i,this.animationsList.push(i)},ui.prototype.autoCreateAnimations=function(e){for(var t,r=/([a-z]+)_?(\d+)/i,n={},i=this.geometry,o=0,a=i.morphTargets.length;o<a;o++){var s=i.morphTargets[o],l=s.name.match(r);if(l&&l.length>1){var u=l[1];n[u]||(n[u]={start:1/0,end:-1/0});var c=n[u];o<c.start&&(c.start=o),o>c.end&&(c.end=o),t||(t=u)}}for(var u in n){var c=n[u];this.createAnimation(u,c.start,c.end,e)}this.firstAnimation=t},ui.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},ui.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},ui.prototype.setAnimationFPS=function(e,t){var r=this.animationsMap[e];r&&(r.fps=t,r.duration=(r.end-r.start)/r.fps)},ui.prototype.setAnimationDuration=function(e,t){var r=this.animationsMap[e];r&&(r.duration=t,r.fps=(r.end-r.start)/r.duration)},ui.prototype.setAnimationWeight=function(e,t){var r=this.animationsMap[e];r&&(r.weight=t)},ui.prototype.setAnimationTime=function(e,t){var r=this.animationsMap[e];r&&(r.time=t)},ui.prototype.getAnimationTime=function(e){var t=0,r=this.animationsMap[e];return r&&(t=r.time),t},ui.prototype.getAnimationDuration=function(e){var t=-1,r=this.animationsMap[e];return r&&(t=r.duration),t},ui.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("THREE.MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},ui.prototype.stopAnimation=function(e){var t=this.animationsMap[e];t&&(t.active=!1)},ui.prototype.update=function(e){for(var t=0,r=this.animationsList.length;t<r;t++){var n=this.animationsList[t];if(n.active){var i=n.duration/n.length;n.time+=n.direction*e,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var o=n.start+Ts.clamp(Math.floor(n.time/i),0,n.length-1),a=n.weight;o!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*a,this.morphTargetInfluences[o]=0,n.lastFrame=n.currentFrame,n.currentFrame=o);var s=n.time%i/i;n.directionBackwards&&(s=1-s),n.currentFrame!==n.lastFrame?(this.morphTargetInfluences[n.currentFrame]=s*a,this.morphTargetInfluences[n.lastFrame]=(1-s)*a):this.morphTargetInfluences[n.currentFrame]=a}}},ci.prototype=Object.create(ce.prototype),ci.prototype.constructor=ci,ci.prototype.isImmediateRenderObject=!0,hi.prototype=Object.create(Ot.prototype),hi.prototype.constructor=hi,hi.prototype.update=function(){var e=new c,t=new c,r=new ne;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,l=a.faces,u=0,c=0,h=l.length;c<h;c++)for(var d=l[c],f=0,p=d.vertexNormals.length;f<p;f++){var m=s[d[n[f]]],v=d.vertexNormals[f];e.copy(m).applyMatrix4(i),t.copy(v).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1}else if(a&&a.isBufferGeometry)for(var g=a.attributes.position,y=a.attributes.normal,u=0,f=0,p=g.count;f<p;f++)e.set(g.getX(f),g.getY(f),g.getZ(f)).applyMatrix4(i),t.set(y.getX(f),y.getY(f),y.getZ(f)),t.applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1;o.needsUpdate=!0}}(),di.prototype=Object.create(ce.prototype),di.prototype.constructor=di,di.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},di.prototype.update=function(){var e=new c,t=new c;return function(){this.light.updateMatrixWorld();var r=this.light.distance?this.light.distance:1e3,n=r*Math.tan(this.light.angle);this.cone.scale.set(n,n,r),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),this.cone.material.color.copy(this.light.color)}}(),pi.prototype=Object.create(Ot.prototype),pi.prototype.constructor=pi,pi.prototype.onBeforeRender=function(){var e=new c,t=new h,r=new h;return function(){var n=this.bones,i=this.geometry,o=i.getAttribute("position");r.getInverse(this.root.matrixWorld);for(var a=0,s=0;a<n.length;a++){var l=n[a];l.parent&&l.parent.isBone&&(t.multiplyMatrices(r,l.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(s,e.x,e.y,e.z),t.multiplyMatrices(r,l.parent.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(s+1,e.x,e.y,e.z),s+=2)}i.getAttribute("position").needsUpdate=!0}}(),mi.prototype=Object.create(ze.prototype),mi.prototype.constructor=mi,mi.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},mi.prototype.update=function(){this.material.color.copy(this.light.color)},vi.prototype=Object.create(ce.prototype),vi.prototype.constructor=vi,vi.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},vi.prototype.update=function(){var e=this.children[0];e.material.color.copy(this.light.color);var t=.5*this.light.width,r=.5*this.light.height,n=e.geometry.attributes.position,i=n.array;i[0]=t,i[1]=-r,i[2]=0,i[3]=t,i[4]=r,i[5]=0,i[6]=-t,i[7]=r,i[8]=0,i[9]=-t,i[10]=-r,i[11]=0,i[12]=t,i[13]=-r,i[14]=0,n.needsUpdate=!0},gi.prototype=Object.create(ce.prototype),gi.prototype.constructor=gi,gi.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},gi.prototype.update=function(){var e=new c,t=new q,r=new q;return function(){var n=this.children[0],i=n.geometry.getAttribute("color");t.copy(this.light.color),r.copy(this.light.groundColor);for(var o=0,a=i.count;o<a;o++){var s=o<a/2?t:r;i.setXYZ(o,s.r,s.g,s.b)}n.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate()),i.needsUpdate=!0}}(),yi.prototype=Object.create(Ot.prototype),yi.prototype.constructor=yi,bi.prototype=Object.create(Ot.prototype),bi.prototype.constructor=bi,_i.prototype=Object.create(Ot.prototype),_i.prototype.constructor=_i,_i.prototype.update=function(){var e=new c,t=new c,r=new ne;return function(){this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,l=0,u=0,c=s.length;u<c;u++){var h=s[u],d=h.normal;e.copy(a[h.a]).add(a[h.b]).add(a[h.c]).divideScalar(3).applyMatrix4(n),t.copy(d).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),i.setXYZ(l,e.x,e.y,e.z),l+=1,i.setXYZ(l,t.x,t.y,t.z),l+=1}i.needsUpdate=!0}}(),wi.prototype=Object.create(ce.prototype),wi.prototype.constructor=wi,wi.prototype.dispose=function(){var e=this.children[0],t=this.children[1];e.geometry.dispose(),e.material.dispose(),t.geometry.dispose(),t.material.dispose()},wi.prototype.update=function(){var e=new c,t=new c,r=new c;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),r.subVectors(t,e);var n=this.children[0],i=this.children[1];n.lookAt(r),n.material.color.copy(this.light.color),i.lookAt(r),i.scale.z=r.length()}}(),xi.prototype=Object.create(Ot.prototype),xi.prototype.constructor=xi,xi.prototype.update=function(){function e(e,o,a,s){n.set(o,a,s).unproject(i);var l=r[e];if(void 0!==l)for(var u=t.getAttribute("position"),c=0,h=l.length;c<h;c++)u.setXYZ(l[c],n.x,n.y,n.z)}var t,r,n=new c,i=new he;return function(){t=this.geometry,r=this.pointMap,i.projectionMatrix.copy(this.camera.projectionMatrix),e("c",0,0,-1),e("t",0,0,1),e("n1",-1,-1,-1),e("n2",1,-1,-1),e("n3",-1,1,-1),e("n4",1,1,-1),e("f1",-1,-1,1),e("f2",1,-1,1),e("f3",-1,1,1),e("f4",1,1,1),e("u1",.7,1.1,-1),e("u2",-.7,1.1,-1),e("u3",0,2,-1),e("cf1",-1,0,1),e("cf2",1,0,1),e("cf3",0,-1,1),e("cf4",0,1,1),e("cn1",-1,0,-1),e("cn2",1,0,-1),e("cn3",0,-1,-1),e("cn4",0,1,-1),t.getAttribute("position").needsUpdate=!0}}(),Mi.prototype=Object.create(Ot.prototype),Mi.prototype.constructor=Mi,Mi.prototype.update=function(){var e=new te;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var r=e.min,n=e.max,i=this.geometry.attributes.position,o=i.array;o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=r.x,o[4]=n.y,o[5]=n.z,o[6]=r.x,o[7]=r.y,o[8]=n.z,o[9]=n.x,o[10]=r.y,o[11]=n.z,o[12]=n.x,o[13]=n.y,o[14]=r.z,o[15]=r.x,o[16]=n.y,o[17]=r.z,o[18]=r.x,o[19]=r.y,o[20]=r.z,o[21]=n.x,o[22]=r.y,o[23]=r.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),Mi.prototype.setFromObject=function(e){return this.object=e,this.update(),this};var il,ol;Ei.prototype=Object.create(ce.prototype),Ei.prototype.constructor=Ei,Ei.prototype.setDirection=function(){var e,t=new c;return function(r){r.y>.99999?this.quaternion.set(0,0,0,1):r.y<-.99999?this.quaternion.set(1,0,0,0):(t.set(r.z,0,-r.x).normalize(),e=Math.acos(r.y),this.quaternion.setFromAxisAngle(t,e))}}(),Ei.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e),void 0===r&&(r=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()},Ei.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},Ai.prototype=Object.create(Ot.prototype),Ai.prototype.constructor=Ai;var al=new c,sl=new Ti,ll=new Ti,ul=new Ti;ki.prototype=Object.create(Tn.prototype),ki.prototype.constructor=ki,ki.prototype.getPoint=function(e){var t=this.points,r=t.length,n=(r-(this.closed?0:1))*e,i=Math.floor(n),o=n-i;this.closed?i+=i>0?0:(Math.floor(Math.abs(i)/t.length)+1)*t.length:0===o&&i===r-1&&(i=r-2,o=1);var a,s,l,u;if(this.closed||i>0?a=t[(i-1)%r]:(al.subVectors(t[0],t[1]).add(t[0]),a=al),s=t[i%r],l=t[(i+1)%r],this.closed||i+2<r?u=t[(i+2)%r]:(al.subVectors(t[r-1],t[r-2]).add(t[r-1]),u=al),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var h="chordal"===this.type?.5:.25,d=Math.pow(a.distanceToSquared(s),h),f=Math.pow(s.distanceToSquared(l),h),p=Math.pow(l.distanceToSquared(u),h);f<1e-4&&(f=1),d<1e-4&&(d=f),p<1e-4&&(p=f),sl.initNonuniformCatmullRom(a.x,s.x,l.x,u.x,d,f,p),ll.initNonuniformCatmullRom(a.y,s.y,l.y,u.y,d,f,p),ul.initNonuniformCatmullRom(a.z,s.z,l.z,u.z,d,f,p)}else if("catmullrom"===this.type){var m=void 0!==this.tension?this.tension:.5;sl.initCatmullRom(a.x,s.x,l.x,u.x,m),ll.initCatmullRom(a.y,s.y,l.y,u.y,m),ul.initCatmullRom(a.z,s.z,l.z,u.z,m)}return new c(sl.calc(o),ll.calc(o),ul.calc(o))},Si.prototype=Object.create(Tn.prototype),Si.prototype.constructor=Si,Si.prototype.getPoint=function(e){var t=this.v0,r=this.v1,n=this.v2,i=this.v3;return new c(An(e,t.x,r.x,n.x,i.x),An(e,t.y,r.y,n.y,i.y),An(e,t.z,r.z,n.z,i.z))},Ci.prototype=Object.create(Tn.prototype),Ci.prototype.constructor=Ci,Ci.prototype.getPoint=function(e){var t=this.v0,r=this.v1,n=this.v2;return new c(_n(e,t.x,r.x,n.x),_n(e,t.y,r.y,n.y),_n(e,t.z,r.z,n.z))},Pi.prototype=Object.create(Tn.prototype),Pi.prototype.constructor=Pi,Pi.prototype.getPoint=function(e){if(1===e)return this.v2.clone();var t=new c;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t},Oi.prototype=Object.create(Cn.prototype),Oi.prototype.constructor=Oi;var cl={createMultiMaterialObject:function(e,t){for(var r=new Bt,n=0,i=t.length;n<i;n++)r.add(new ze(e,t[n]));return r},detach:function(e,t,r){e.applyMatrix(t.matrixWorld),t.remove(e),r.add(e)},attach:function(e,t,r){e.applyMatrix((new h).getInverse(r.matrixWorld)),t.remove(e),r.add(e)}},hl=0,dl=1;Tn.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Tn.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Ji.prototype=Object.create(ki.prototype),$i.prototype=Object.create(ki.prototype),eo.prototype=Object.create(ki.prototype),Object.assign(eo.prototype,{initFromArray:function(e){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(e){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(e){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),yi.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},pi.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(K.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(te.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),De.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Ts.random16=function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},Object.assign(ne.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(e){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e,t,r){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(e,t,r){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(h.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new c),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(e){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e,t,r){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(e,t,r){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,r,n,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,n,r,i,o)}}),ie.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},u.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Be.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(In.prototype,{extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new or(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new mr(this,e)}}),Object.assign(i.prototype,{fromAttribute:function(e,t,r){return console.error("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)}}),Object.assign(c.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,r){return console.error("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)}}),Object.assign(a.prototype,{fromAttribute:function(e,t,r){return console.error("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)}}),ve.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(ce.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)}}),Object.defineProperties(ce.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(At.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Tt.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(Tn.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),fe.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Ur.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(ge.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(Ce.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Ce.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Qn.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(J.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new q}}}),Object.defineProperties(Sr.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties($.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(yt.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(yt.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=e}}}),Object.defineProperties(ae.prototype,{cullFace:{get:function(){return this.renderReverseSided?fo:ho},set:function(e){var t=e!==ho;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+t+"."),this.renderReverseSided=t}}}),Object.defineProperties(s.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Hn.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new zn).load(e,function(e){t.setBuffer(e)}),this},Gn.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()};var fl={merge:function(e,t,r){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var n;t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,t=t.geometry),e.merge(t,n,r)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},pl={crossOrigin:void 0,loadTexture:function(e,t,r,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Nr;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,r,void 0,n);return t&&(o.mapping=t),o},loadTextureCube:function(e,t,r,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new zr;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,r,void 0,n);return t&&(o.mapping=t),o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}}},function(e,t,r){"use strict";function n(e){return"[object Array]"===E.call(e)}function i(e){return"[object ArrayBuffer]"===E.call(e)}function o(e){return"undefined"!=typeof FormData&&e instanceof FormData}function a(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function s(e){return"string"==typeof e}function l(e){return"number"==typeof e}function u(e){return void 0===e}function c(e){return null!==e&&"object"==typeof e}function h(e){return"[object Date]"===E.call(e)}function d(e){return"[object File]"===E.call(e)}function f(e){return"[object Blob]"===E.call(e)}function p(e){return"[object Function]"===E.call(e)}function m(e){return c(e)&&p(e.pipe)}function v(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function g(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function y(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document}function b(e,t){if(null!==e&&void 0!==e)if("object"==typeof e||n(e)||(e=[e]),n(e))for(var r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}function _(){function e(e,r){"object"==typeof t[r]&&"object"==typeof e?t[r]=_(t[r],e):t[r]=e}for(var t={},r=0,n=arguments.length;r<n;r++)b(arguments[r],e);return t}function w(e,t,r){return b(t,function(t,n){e[n]=r&&"function"==typeof t?x(t,r):t}),e}var x=r(21),M=r(69),E=Object.prototype.toString;e.exports={isArray:n,isArrayBuffer:i,isBuffer:M,isFormData:o,isArrayBufferView:a,isString:s,isNumber:l,isObject:c,isUndefined:u,isDate:h,isFile:d,isBlob:f,isFunction:p,isStream:m,isURLSearchParams:v,isStandardBrowserEnv:y,forEach:b,merge:_,extend:w,trim:g}},function(e,t,r){!function(t,n){e.exports=function(e,t){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=106)}([function(t,r){t.exports=e},function(e,t,r){!function(r,n){e.exports=t=function(){var e=e||function(e,t){var r=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),n={},i=n.lib={},o=i.Base=function(){return{extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),a=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var a=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=a<<24-(n+o)%4*8}else for(var o=0;o<i;o+=4)t[n+o>>>2]=r[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r,n=[],i=0;i<t;i+=4){var o=function(t){var t=t,r=987654321,n=4294967295;return function(){r=36969*(65535&r)+(r>>16)&n,t=18e3*(65535&t)+(t>>16)&n;var i=(r<<16)+t&n;return i/=4294967296,(i+=.5)*(e.random()>.5?1:-1)}}(4294967296*(r||e.random()));r=987654071*o(),n.push(4294967296*o()|0)}return new a.init(n,t)}}),s=n.enc={},l=s.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new a.init(r,t/2)}},u=s.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new a.init(r,t)}},c=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},h=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,n=r.words,i=r.sigBytes,o=this.blockSize,s=4*o,l=i/s;l=t?e.ceil(l):e.max((0|l)-this._minBufferSize,0);var u=l*o,c=e.min(4*u,i);if(u){for(var h=0;h<u;h+=o)this._doProcessBlock(n,h);var d=n.splice(0,u);r.sigBytes-=c}return new a.init(d,c)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),d=(i.Hasher=h.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new d.HMAC.init(e,r).finalize(t)}}}),n.algo={});return n}(Math);return e}()}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){e.lib.Cipher||function(t){var r=e,n=r.lib,i=n.Base,o=n.WordArray,a=n.BufferedBlockAlgorithm,s=r.enc,l=(s.Utf8,s.Base64),u=r.algo,c=u.EvpKDF,h=n.Cipher=a.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?M:_}return function(t){return{encrypt:function(r,n,i){return e(n).encrypt(t,r,n,i)},decrypt:function(r,n,i){return e(n).decrypt(t,r,n,i)}}}}()}),d=(n.StreamCipher=h.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),r.mode={}),f=n.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),p=d.CBC=function(){function e(e,r,n){var i=this._iv;if(i){var o=i;this._iv=t}else var o=this._prevBlock;for(var a=0;a<n;a++)e[r+a]^=o[a]}var r=f.extend();return r.Encryptor=r.extend({processBlock:function(t,r){var n=this._cipher,i=n.blockSize;e.call(this,t,r,i),n.encryptBlock(t,r),this._prevBlock=t.slice(r,r+i)}}),r.Decryptor=r.extend({processBlock:function(t,r){var n=this._cipher,i=n.blockSize,o=t.slice(r,r+i);n.decryptBlock(t,r),e.call(this,t,r,i),this._prevBlock=o}}),r}(),m=r.pad={},v=m.Pkcs7={pad:function(e,t){for(var r=4*t,n=r-e.sigBytes%r,i=n<<24|n<<16|n<<8|n,a=[],s=0;s<n;s+=4)a.push(i);var l=o.create(a,n);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},g=(n.BlockCipher=h.extend({cfg:h.cfg.extend({mode:p,padding:v}),reset:function(){h.reset.call(this);var e=this.cfg,t=e.iv,r=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=r.createEncryptor;else{var n=r.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==n?this._mode.init(this,t&&t.words):(this._mode=n.call(r,this,t&&t.words),this._mode.__creator=n)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else{var t=this._process(!0);e.unpad(t)}return t},blockSize:4}),n.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),y=r.format={},b=y.OpenSSL={stringify:function(e){var t=e.ciphertext,r=e.salt;if(r)var n=o.create([1398893684,1701076831]).concat(r).concat(t);else var n=t;return n.toString(l)},parse:function(e){var t=l.parse(e),r=t.words;if(1398893684==r[0]&&1701076831==r[1]){var n=o.create(r.slice(2,4));r.splice(0,4),t.sigBytes-=16}return g.create({ciphertext:t,salt:n})}},_=n.SerializableCipher=i.extend({cfg:i.extend({format:b}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);var i=e.createEncryptor(r,n),o=i.finalize(t),a=i.cfg;return g.create({ciphertext:o,key:r,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(r,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),w=r.kdf={},x=w.OpenSSL={execute:function(e,t,r,n){n||(n=o.random(8));var i=c.create({keySize:t+r}).compute(e,n),a=o.create(i.words.slice(t),4*r);return i.sigBytes=4*t,g.create({key:i,iv:a,salt:n})}},M=n.PasswordBasedCipher=_.extend({cfg:_.cfg.extend({kdf:x}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);var i=n.kdf.execute(r,e.keySize,e.ivSize);n.iv=i.iv;var o=_.encrypt.call(this,e,t,i.key,n);return o.mixIn(i),o},decrypt:function(e,t,r,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var i=n.kdf.execute(r,e.keySize,e.ivSize,t.salt);return n.iv=i.iv,_.decrypt.call(this,e,t,i.key,n)}})}()}(r(1),r(5))}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=function(){function e(t){n(this,e),this.version="1.0.0"}return i(e,null,[{key:"degreeToRadian",value:function(e){return e*(Math.PI/180)}},{key:"radianToDegree",value:function(e){return e*(180/Math.PI)}},{key:"webMercatorXToRadianLog",value:function(t){return t/e.EARTH_RADIUS}},{key:"webMercatorXToDegreeLog",value:function(t){var r=e.webMercatorXToRadianLog(t);return e.radianToDegree(r)}},{key:"webMercatorYToRadianLat",value:function(t){if(isNaN(t))throw{error:"invalid y",detail:"webMercatorYToRadianLat"};var r=t/e.EARTH_RADIUS,n=Math.pow(Math.E,r);return 2*Math.atan(n)-Math.PI/2}},{key:"webMercatorYToDegreeLat",value:function(e){var t=this.webMercatorYToRadianLat(e);return this.radianToDegree(t)}},{key:"getTileWebMercatorEnvelopeByGrid",value:function(t,r,n){var i=e.EQUATOR/2,o=2*i/Math.pow(2,t),a=r*o-i,s=a+o,l=i-n*o;return{minX:a,minY:l-o,maxX:s,maxY:l}}},{key:"webMercatorToDegreeGeographic",value:function(t,r){return[e.webMercatorXToDegreeLog(t),e.webMercatorYToDegreeLat(r)]}},{key:"getTileGeographicEnvelopByGrid",value:function(t,r,n){var i=e.getTileWebMercatorEnvelopeByGrid(t,r,n),o=e.webMercatorToDegreeGeographic(i.minX,i.minY),a=e.webMercatorToDegreeGeographic(i.maxX,i.maxY);return{minLon:o[0],minLat:o[1],maxLon:a[0],maxLat:a[1]}}},{key:"geographicToCartesianCoord",value:function(t,r,n){if(!(t>=-180.001&&t<=180.001))throw console.warn(t),{error:"invalid lon",detail:"geographicToCartesianCoord"};if(!(r>=-90.001&&r<=90.001))throw console.warn(r),{error:"invalid lat",detail:"geographicToCartesianCoord"};var i=e.degreeToRadian(t),o=e.degreeToRadian(r),a=Math.sin(i),s=Math.cos(i),l=Math.sin(o),u=Math.cos(o);return{x:n*a*u,y:n*l,z:n*s*u}}},{key:"geographicToEarthSurface",value:function(t,r,n,i){var a=(new o.Vector3,e.getTileGridByGeographic(t,r,n)),s=a.column,l=a.row,u=e.getTileCartesianEnvelopByGrid(t,s,l,i),c=e.getTileGeographicEnvelopByGrid(t,s,l),h=u,d=c.maxLon-c.minLon,f=c.maxLat-c.minLat,p=r-c.minLon,m=c.maxLon-r,v=c.maxLat-n,g=n-c.minLat,y=h[2].clone().multiplyScalar(m/d).add(h[1].clone().multiplyScalar(p/d)),b=h[3].clone().multiplyScalar(m/d).add(h[0].clone().multiplyScalar(p/d));return y.multiplyScalar(g/f).add(b.multiplyScalar(v/f))}},{key:"geographicToEarthSurfaceByIntersection",value:function(t,r,n,i){var a=e.getTileGridByGeographic(t,r,n),s=a.column,l=a.row,u=e.getTileCartesianEnvelopByGrid(t,s,l,i),c=u[0].clone(),h=u[1].clone(),d=u[2].clone(),f=c.clone().sub(h),p=d.clone().sub(h),m=p.clone().cross(f).normalize(),v=c.clone(),g=v.sub(new o.Vector3(0,0,0)).dot(m),y=-g,b=new o.Plane(m,y),_=e.geographicToCartesianCoord(r,n,1.1*i),w=new o.Line3(new o.Vector3(0,0,0),_);return b.intersectLine(w)}},{key:"getGeoNormalOnEarthSurface",value:function(t,r,n){var i=e.getTileGridByGeographic(t,r,n),a=i.column,s=i.row,l=e.getTileGeographicEnvelopByGrid(t,a,s),u={lat:(l.minLat+l.maxLat)/2,lon:(l.minLon+l.maxLon)/2},c=e.geographicToCartesianCoord(u.lon,u.lat,1);return c=new o.Vector3(c.x,c.y,c.z),c.normalize(),c}},{key:"getLocalSystemOnEarthSurface",value:function(t,r,n,i){var a=e.getTileGridByGeographic(t,r,n),s=a.column,l=a.row,u=e.getTileCartesianEnvelopByGrid(t,s,l,i),c=u[0].clone(),h=u[1].clone(),d=u[2].clone(),f=c.clone().sub(h),p=d.clone().sub(h),m=p.clone().cross(f).normalize(),v=c.clone(),g=v.sub(new o.Vector3(0,0,0)).dot(m),y=-g,b=new o.Plane(m,y),_=e.geographicToCartesianCoord(r,n,1.1*i),w=new o.Line3(new o.Vector3(0,0,0),_),x=(b.intersectLine(w),h.clone().sub(d).normalize()),M=m.clone().cross(x).normalize();return{origin:e.geographicToEarthSurface(t,r,n,i),lng:x,lat:M,alt:m}}},{key:"getTileCartesianEnvelopByGrid",value:function(t,r,n,i){var a=e.getTileGeographicEnvelopByGrid(t,r,n),s=[];s[3]=e.geographicToCartesianCoord(a.minLon,a.minLat,i),s[2]=e.geographicToCartesianCoord(a.minLon,a.maxLat,i),s[1]=e.geographicToCartesianCoord(a.maxLon,a.maxLat,i),s[0]=e.geographicToCartesianCoord(a.maxLon,a.minLat,i);for(var l=0;l<4;l++)s[l]=new o.Vector3(s[l].x,s[l].y,s[l].z);return s}},{key:"getTileCartesianEnvelopOnEarthSurface",value:function(t,r,n,i,a){var s=e.getTileGeographicEnvelopByGrid(t,r,n),l=[];l[3]=e.geographicToEarthSurface(a,s.minLon,s.minLat,i),l[2]=e.geographicToEarthSurface(a,s.minLon,s.maxLat,i),l[1]=e.geographicToEarthSurface(a,s.maxLon,s.maxLat,i),l[0]=e.geographicToEarthSurface(a,s.maxLon,s.minLat,i);for(var u=0;u<4;u++)l[u]=new o.Vector3(l[u].x,l[u].y,l[u].z);return l}},{key:"getTileCartesianGeometryOnEarthSurface",value:function(t,r,n,i,a,s){for(var l=e.getTileWebMercatorEnvelopeByGrid(t,r,n),u=[],c=[],h=[],d=[],f=(l.maxX-l.minX)/a,p=(l.maxY-l.minY)/a,m=1/a,v=[],g=[],y=[],b=[],_=0;_<=a;_++){v.push(l.minX+_*f),g.push(l.minY+_*p);var w=_*m;y.push(w),b.push(w)}for(var x=0;x<=a;x++)for(var M=0;M<=a;M++){var E=v[M],A=g[x],T=e.webMercatorToDegreeGeographic(E,A),k=e.geographicToEarthSurface(s,T[0],T[1],i);u.push(new o.Vector3(k.x,k.y,k.z)),h.push(new o.Vector2(y[M],b[x]))}for(var S=0;S<a;S++)for(var C=0;C<a;C++){var P=(a+1)*S+C,O=(a+1)*(S+1)+C,R=O+1,L=P+1,I=new o.Face3(R,O,P),B=new o.Face3(P,L,R);c.push(I,B),d.push([h[R],h[O],h[P]],[h[P],h[L],h[R]])}d.length!==c.length&&console.warn("unequal uvs and vertices");var D=new o.Geometry;return D.vertices=u,D.faces=c,D.faceVertexUvs[0]=d,D}},{key:"getTileCartesianGeometryByGrid",value:function(t,r,n,i,a){if(!function(){return isNaN(a)&&(console.warn("segment not a number",a),a=1),a=Math.floor(a),a<=0||a>999?(console.warn("segment out of range",a,"level",t),a=1):a<1&&(a=1),!0}())return console.error("getTileCartesianGeometryByGrid has error that cannot proceed"),null;for(var s=e.getTileWebMercatorEnvelopeByGrid(t,r,n),l=[],u=[],c=[],h=[],d=(s.maxX-s.minX)/a,f=(s.maxY-s.minY)/a,p=1/a,m=[],v=[],g=[],y=[],b=0;b<=a;b++){m.push(s.minX+b*d),v.push(s.minY+b*f);var _=b*p;g.push(_),y.push(_)}for(var w=0;w<=a;w++)for(var x=0;x<=a;x++){var M=m[x],E=v[w],A=e.webMercatorToDegreeGeographic(M,E),T=e.geographicToCartesianCoord(A[0],A[1],i);l.push(new o.Vector3(T.x,T.y,T.z)),c.push(new o.Vector2(g[x],y[w]))}for(var k=0;k<a;k++)for(var S=0;S<a;S++){var C=(a+1)*k+S,P=(a+1)*(k+1)+S,O=P+1,R=C+1,L=new o.Face3(O,P,C),I=new o.Face3(C,R,O);u.push(L,I),h.push([c[O],c[P],c[C]],[c[C],c[R],c[O]])}h.length!==u.length&&console.warn("unequal uvs and vertices");var B=new o.Geometry;return B.vertices=l,B.faces=u,B.faceVertexUvs[0]=h,B}},{key:"radianLogToWebMercatorX",value:function(t){if(!(!isNaN(t)&&t<=Math.PI+.001&&t>=-(Math.PI+.001)))throw{detail:"invalid radianLog"};return e.EARTH_RADIUS*t}},{key:"degreeLogToWebMercatorX",value:function(t){if(!(!isNaN(t)&&t<=180.001&&t>=-180.001))throw{detail:"invalid degreeLog"};var r=e.degreeToRadian(t);return e.radianLogToWebMercatorX(r)}},{key:"radianLatToWebMercatorY",value:function(t){if(!(t<=Math.PI/2+.001&&t>=-(Math.PI/2+.001)))throw{detail:"invalid radianLat"};var r=Math.PI/4+t/2,n=Math.tan(r),i=Math.log(n);return e.EARTH_RADIUS*i}},{key:"degreeLatToWebMercatorY",value:function(t){if(!(t<=90.001&&t>=-90.001))throw{detail:"invalid degreeLat"};var r=e.degreeToRadian(t);return e.radianLatToWebMercatorY(r)}},{key:"radianGeographicToWebMercator",value:function(t,r){return[e.radianLogToWebMercatorX(t),e.radianLatToWebMercatorY(r)]}},{key:"degreeGeographicToWebMercator",value:function(t,r){return[e.degreeLogToWebMercatorX(t),e.degreeLatToWebMercatorY(r)]}},{key:"numerationSystemTo10",value:function(e,t){return parseInt(t,e)}},{key:"numerationSystemFrom10",value:function(e,t){return t.toString(e)}},{key:"numerationSystemChange",value:function(t,r,n){var i=e.numerationSystemTo10(t,n);return e.numerationSystemFrom10(r,i)}},{key:"utmToWgs84",value:function(e,t,r){var n=r.split("_");if(2!==n.length)return{};var i=Number(n[0]),o=/[n-z]/i.test(n[1]);!1===o&&(t=1e7-t);var a=6378137,s=.081819191,l=.006739497,u=t/.9996,c=u/(a*(1-Math.pow(s,2)/4-3*Math.pow(s,4)/64-5*Math.pow(s,6)/256)),h=(1-Math.sqrt(1-s*s))/(1+Math.sqrt(1-s*s)),d=3*h/2-27*Math.pow(h,3)/32,f=21*Math.pow(h,2)/16-55*Math.pow(h,4)/32,p=151*Math.pow(h,3)/96,m=1097*Math.pow(h,4)/512,v=c+d*Math.sin(2*c)+f*Math.sin(4*c)+p*Math.sin(6*c)+m*Math.sin(8*c),g=a/Math.pow(1-Math.pow(s*Math.sin(v),2),.5),y=a*(1-s*s)/Math.pow(1-Math.pow(s*Math.sin(v),2),1.5),b=g*Math.tan(v)/y,_=5e5-e,w=_/(.9996*g),x=w*w/2,M=Math.pow(Math.tan(v),2),E=l*Math.pow(Math.cos(v),2),A=(5+3*M+10*E-4*E*E-9*l)*Math.pow(w,4)/24,T=(61+90*M+298*E+45*M*M-252*l-3*E*E)*Math.pow(w,6)/720,k=_/(.9996*g),S=(1+2*M+E)*Math.pow(w,3)/6,C=(5-2*E+28*M-3*Math.pow(E,2)+8*l+24*Math.pow(M,2))*Math.pow(w,5)/120,P=(k-S+C)/Math.cos(v),O=180*P/Math.PI,R=180*(v-b*(x+A+T))/Math.PI;return!1===o&&(R=-R),{latitude:R,longitude:i>0?6*i-183-O:3-O}}},{key:"sphericalToGeographic",value:function(t,r){var n=r,i=Math.PI/2-t;return[e.radianToDegree(n),e.radianToDegree(i)]}},{key:"earthSurfaceToGeographic",value:function(t,r,n){function i(e,t,r){t=t.clone(),r=r.clone().normalize(),e=e.clone(),a&&console.log("distanceTo",t,r,e);var n=t.clone().add(r.multiplyScalar(e.clone().sub(t).dot(r)));return a&&console.log("proj",n),n.distanceTo(e)}var a=!1;a&&console.log("target",r);var s=new o.Spherical;s.setFromVector3(r);var l=e.sphericalToGeographic(s.phi,s.theta),u=e.getTileGridByGeographic(t,l[0],l[1]),c=e.getTileCartesianEnvelopByGrid(t,u.column,u.row,n);a&&console.log("cart",c);var h=c[1].clone().sub(c[2]),d=c[0].clone().sub(c[3]),f=i(r,c[2],h),p=i(r,c[3],d);a&&console.log("dist",f,p);var m=f+p;f/=m,p/=m,a&&console.log("b1",f,"b2",p,"bsum",m);var v=new o.Vector3;v.lerpVectors(c[2],c[3],f);var g=new o.Vector3;g.lerpVectors(c[1],c[0],f);var y=r.distanceTo(v)/g.distanceTo(v);a&&console.log("a1",y);var b=e.getTileGeographicEnvelopByGrid(t,u.column,u.row,n);return{lng:b.minLon+(b.maxLon-b.minLon)*y,lat:b.minLat+(b.maxLat-b.minLat)*(1-f)}}},{key:"getNoneGroundCartesianFromLngLatAlt",value:function(t,r,n,i,a){console.log("getNoneGroundCartesianFromLngLatAlt",t,r,n,i,a);var s=new o.Vector3,l=e.getTileGridByGeographic(t,r,n),u=l.column,c=l.row,h=e.getTileCartesianEnvelopByGrid(t,u,c,a),d=h[0].clone(),f=h[1].clone(),p=h[2].clone(),m=d.clone().sub(f),v=p.clone().sub(f),g=v.clone().cross(m).normalize();console.log("normal",g);var y=e.getTileGeographicEnvelopByGrid(t,u,c),b=h,_=y.maxLon-y.minLon,w=y.maxLat-y.minLat,x=r-y.minLon,M=y.maxLon-r,E=y.maxLat-n,A=n-y.minLat,T=b[2].clone().multiplyScalar(M/_).add(b[1].clone().multiplyScalar(x/_)),k=b[3].clone().multiplyScalar(M/_).add(b[0].clone().multiplyScalar(x/_));s=T.multiplyScalar(A/w).add(k.multiplyScalar(E/w)),console.log("earthPoint",s);var S=s.clone().add(g.multiplyScalar(i*a/e.EARTH_RADIUS));return console.log("out",S),S}},{key:"getLngLatAltFromNoneGroundCartesian",value:function(t,r,n){var i=e.projectCartesianOntoEarthSurface(t,r.clone(),n),o=e.earthSurfaceToGeographic(t,i.clone(),n),a=r.distanceTo(i)/n*e.EARTH_RADIUS;return{lng:o.lng,lat:o.lat,alt:a}}},{key:"projectCartesianOntoEarthSurface",value:function(t,r,n){var i=new o.Spherical;i.setFromVector3(r);var a=e.sphericalToGeographic(i.phi,i.theta),s=e.getTileGridByGeographic(t,a[0],a[1]),l=e.getTileCartesianEnvelopByGrid(t,s.column,s.row,n),u=l[0].clone(),c=l[1].clone(),h=l[2].clone(),d=u.clone().sub(c),f=h.clone().sub(c),p=f.clone().cross(d).normalize();return u.clone().sub(r).projectOnVector(p).add(r)}},{key:"getTileGridByGeographic",value:function(t,r,n){var i=e.degreeGeographicToWebMercator(r,n),o=e.EQUATOR/Math.pow(2,t),a=e.EQUATOR/2;return{column:Math.floor((i[0]+a)/o),row:Math.floor((a-i[1])/o)}}},{key:"EQUATOR",get:function(){return 40075016.686}},{key:"EARTH_RADIUS",get:function(){return 6378137}}]),e}();t.default=a},function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)return void e.set(t.subarray(r,r+n),i);for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,i),i+=o.length;return a}},o={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(n)},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return function(){var t=e,r=t.lib,n=r.Base,i=r.WordArray,o=t.algo,a=o.MD5,s=o.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,n=r.hasher.create(),o=i.create(),a=o.words,s=r.keySize,l=r.iterations;a.length<s;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<l;c++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*s,o}});t.EvpKDF=function(e,t,r){return s.create(r).compute(e,t)}}(),e.EvpKDF}(r(1),r(31),r(30))}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){this.controls=e,this.priority=0,this.interruptible=!0,this.easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}},this.adjustPlane=function(t,r){var n=e.groundPlane;if(null!=e.plane){var i=e.picker.pickPoint(t,r);null!=i&&(null==n&&(n=e.plane.clone()),e.plane.setFromNormalAndCoplanarPoint(e.plane.normal,i))}},this.adjustCenter=function(){var t=e.groundPlane,r=e.domElement.width||e.domElement.clientWidth,n=e.domElement.height||e.domElement.clientHeight,i=e.picker.pickPoint(r/2,n/2);if(null!=i){var o=e.object.position,a=o.clone().sub(e.center),s=o.clone().sub(i),l=Math.atan2(a.x,a.z),u=Math.atan2(s.x,s.z);Math.abs(l-u)<.001&&(null==t&&(t=e.plane.clone()),e.center=i)}}};n.prototype.onMouseDown=function(e,t){},n.prototype.onMouseMove=function(e,t){},n.prototype.onMouseUp=function(){},n.prototype.transformStart=function(e,t){},n.prototype.transform=function(e,t){},n.prototype.transformEnd=function(e,t){},n.prototype.update=function(e,t){},n.prototype.onLimit=function(e){},n.prototype.detach=function(){var e=this.controls;this.type===e.handler.type&&(e.handler=null,e.changed())},n.prototype.constructor=n,t.default=n},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=function(){function e(){n(this,e),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}return i(e,[{key:"setValue",value:function(e,t,r,n,i,o,a,s,l,u,c,h,d,f,p,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=n,v[1]=i,v[5]=o,v[9]=a,v[13]=s,v[2]=l,v[6]=u,v[10]=c,v[14]=h,v[3]=d,v[7]=f,v[11]=p,v[15]=m,this}},{key:"fromArray",value:function(e,t){void 0===t&&(t=0);for(var r=0;r<16;r++)this.elements[r]=e[r+t];return this}},{key:"copy",value:function(e){var t=e.elements;return this.setValue(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15])}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"toThreeMatrix4",value:function(){var e=new o.Matrix4;return e.fromArray(this.elements),e}},{key:"identity",value:function(){return this.setValue(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],a=r[4],s=r[8],l=r[12],u=r[1],c=r[5],h=r[9],d=r[13],f=r[2],p=r[6],m=r[10],v=r[14],g=r[3],y=r[7],b=r[11],_=r[15],w=n[0],x=n[4],M=n[8],E=n[12],A=n[1],T=n[5],k=n[9],S=n[13],C=n[2],P=n[6],O=n[10],R=n[14],L=n[3],I=n[7],B=n[11],D=n[15];return i[0]=o*w+a*A+s*C+l*L,i[4]=o*x+a*T+s*P+l*I,i[8]=o*M+a*k+s*O+l*B,i[12]=o*E+a*S+s*R+l*D,i[1]=u*w+c*A+h*C+d*L,i[5]=u*x+c*T+h*P+d*I,i[9]=u*M+c*k+h*O+d*B,i[13]=u*E+c*S+h*R+d*D,i[2]=f*w+p*A+m*C+v*L,i[6]=f*x+p*T+m*P+v*I,i[10]=f*M+p*k+m*O+v*B,i[14]=f*E+p*S+m*R+v*D,i[3]=g*w+y*A+b*C+_*L,i[7]=g*x+y*T+b*P+_*I,i[11]=g*M+y*k+b*O+_*B,i[15]=g*E+y*S+b*R+_*D,this}},{key:"decompose",value:function(e,t,r){var n,i;void 0===n&&(n=new o.Vector3,i=new o.Matrix4);var a=this.elements,s=n.set(a[0],a[1],a[2]).length(),l=n.set(a[4],a[5],a[6]).length(),u=n.set(a[8],a[9],a[10]).length();this.determinant()<0&&(s=-s),e.x=a[12],e.y=a[13],e.z=a[14],i.elements.set(this.elements);var c=1/s,h=1/l,d=1/u;return i.elements[0]*=c,i.elements[1]*=c,i.elements[2]*=c,i.elements[4]*=h,i.elements[5]*=h,i.elements[6]*=h,i.elements[8]*=d,i.elements[9]*=d,i.elements[10]*=d,t.setFromRotationMatrix(i),r.x=s,r.y=l,r.z=u,this}},{key:"lookAt",value:function(e,t,r){var n,i,a;void 0===n&&(n=new o.Vector3,i=new o.Vector3,a=new o.Vector3);var s=this.elements;return a.subVectors(e,t).normalize(),0===a.lengthSq()&&(a.z=1),n.crossVectors(r,a).normalize(),0===n.lengthSq()&&(a.z+=1e-4,n.crossVectors(r,a).normalize()),i.crossVectors(a,n),s[0]=n.x,s[4]=i.x,s[8]=a.x,s[1]=n.y,s[5]=i.y,s[9]=a.y,s[2]=n.z,s[6]=i.z,s[10]=a.z,this}},{key:"getInverse",value:function(e,t){var r=this.elements,n=e.elements,i=n[0],o=n[1],a=n[2],s=n[3],l=n[4],u=n[5],c=n[6],h=n[7],d=n[8],f=n[9],p=n[10],m=n[11],v=n[12],g=n[13],y=n[14],b=n[15],_=f*y*h-g*p*h+g*c*m-u*y*m-f*c*b+u*p*b,w=v*p*h-d*y*h-v*c*m+l*y*m+d*c*b-l*p*b,x=d*g*h-v*f*h+v*u*m-l*g*m-d*u*b+l*f*b,M=v*f*c-d*g*c-v*u*p+l*g*p+d*u*y-l*f*y,E=i*_+o*w+a*x+s*M;if(0===E){var A="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(!0===t)throw new Error(A);return console.warn(A),this.identity()}var T=1/E;return r[0]=_*T,r[1]=(g*p*s-f*y*s-g*a*m+o*y*m+f*a*b-o*p*b)*T,r[2]=(u*y*s-g*c*s+g*a*h-o*y*h-u*a*b+o*c*b)*T,r[3]=(f*c*s-u*p*s-f*a*h+o*p*h+u*a*m-o*c*m)*T,r[4]=w*T,r[5]=(d*y*s-v*p*s+v*a*m-i*y*m-d*a*b+i*p*b)*T,r[6]=(v*c*s-l*y*s-v*a*h+i*y*h+l*a*b-i*c*b)*T,r[7]=(l*p*s-d*c*s+d*a*h-i*p*h-l*a*m+i*c*m)*T,r[8]=x*T,r[9]=(v*f*s-d*g*s-v*o*m+i*g*m+d*o*b-i*f*b)*T,r[10]=(l*g*s-v*u*s+v*o*h-i*g*h-l*o*b+i*u*b)*T,r[11]=(d*u*s-l*f*s-d*o*h+i*f*h+l*o*m-i*u*m)*T,r[12]=M*T,r[13]=(d*g*a-v*f*a+v*o*p-i*g*p-d*o*y+i*f*y)*T,r[14]=(v*u*a-l*g*a-v*o*c+i*g*c+l*o*y-i*u*y)*T,r[15]=(l*f*a-d*u*a+d*o*c-i*f*c-l*o*p+i*u*p)*T,this}},{key:"compose",value:function(e,t,r){return this.makeRotationFromQuaternion(t),this.scale(r),this.setPosition(e),this}},{key:"makeRotationFromQuaternion",value:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z,o=e.w,a=r+r,s=n+n,l=i+i,u=r*a,c=r*s,h=r*l,d=n*s,f=n*l,p=i*l,m=o*a,v=o*s,g=o*l;return t[0]=1-(d+p),t[4]=c-g,t[8]=h+v,t[1]=c+g,t[5]=1-(u+p),t[9]=f-m,t[2]=h-v,t[6]=f+m,t[10]=1-(u+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"scale",value:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this}},{key:"setPosition",value:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],o=e[1],a=e[5],s=e[9],l=e[13],u=e[2],c=e[6],h=e[10],d=e[14];return e[3]*(+i*s*c-n*l*c-i*a*h+r*l*h+n*a*d-r*s*d)+e[7]*(+t*s*d-t*l*h+i*o*h-n*o*d+n*l*u-i*s*u)+e[11]*(+t*l*c-t*a*d-i*o*c+r*o*d+i*a*u-r*l*u)+e[15]*(-n*a*u-t*s*c+t*a*h+n*o*c-r*o*h+r*s*u)}},{key:"makeBasis",value:function(e,t,r){return this.setValue(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,r){return this.setValue(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}},{key:"makeTranslation",value:function(e,t,r){return this.setValue(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}}]),e}();t.default=a},function(e,t,r){!function(n,i){e.exports=t=function(e){return function(){function t(e,t,r){for(var n=[],o=0,a=0;a<t;a++)if(a%4){var s=r[e.charCodeAt(a-1)]<<a%4*2,l=r[e.charCodeAt(a)]>>>6-a%4*2;n[o>>>2]|=(s|l)<<24-o%4*8,o++}return i.create(n,o)}var r=e,n=r.lib,i=n.WordArray;r.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var i=[],o=0;o<r;o+=3)for(var a=t[o>>>2]>>>24-o%4*8&255,s=t[o+1>>>2]>>>24-(o+1)%4*8&255,l=t[o+2>>>2]>>>24-(o+2)%4*8&255,u=a<<16|s<<8|l,c=0;c<4&&o+.75*c<r;c++)i.push(n.charAt(u>>>6*(3-c)&63));var h=n.charAt(64);if(h)for(;i.length%4;)i.push(h);return i.join("")},parse:function(e){var r=e.length,n=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var o=0;o<n.length;o++)i[n.charCodeAt(o)]=o}var a=n.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(r=s)}return t(e,r,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64}(r(1))}()},function(e,t,r){!function(n,i){e.exports=t=function(e){return function(t){function r(e,t,r,n,i,o,a){var s=e+(t&r|~t&n)+i+a;return(s<<o|s>>>32-o)+t}function n(e,t,r,n,i,o,a){var s=e+(t&n|r&~n)+i+a;return(s<<o|s>>>32-o)+t}function i(e,t,r,n,i,o,a){var s=e+(t^r^n)+i+a;return(s<<o|s>>>32-o)+t}function o(e,t,r,n,i,o,a){var s=e+(r^(t|~n))+i+a;return(s<<o|s>>>32-o)+t}var a=e,s=a.lib,l=s.WordArray,u=s.Hasher,c=a.algo,h=[];!function(){for(var e=0;e<64;e++)h[e]=4294967296*t.abs(t.sin(e+1))|0}();var d=c.MD5=u.extend({_doReset:function(){this._hash=new l.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var a=0;a<16;a++){var s=t+a,l=e[s];e[s]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}var u=this._hash.words,c=e[t+0],d=e[t+1],f=e[t+2],p=e[t+3],m=e[t+4],v=e[t+5],g=e[t+6],y=e[t+7],b=e[t+8],_=e[t+9],w=e[t+10],x=e[t+11],M=e[t+12],E=e[t+13],A=e[t+14],T=e[t+15],k=u[0],S=u[1],C=u[2],P=u[3];k=r(k,S,C,P,c,7,h[0]),P=r(P,k,S,C,d,12,h[1]),C=r(C,P,k,S,f,17,h[2]),S=r(S,C,P,k,p,22,h[3]),k=r(k,S,C,P,m,7,h[4]),P=r(P,k,S,C,v,12,h[5]),C=r(C,P,k,S,g,17,h[6]),S=r(S,C,P,k,y,22,h[7]),k=r(k,S,C,P,b,7,h[8]),P=r(P,k,S,C,_,12,h[9]),C=r(C,P,k,S,w,17,h[10]),S=r(S,C,P,k,x,22,h[11]),k=r(k,S,C,P,M,7,h[12]),P=r(P,k,S,C,E,12,h[13]),C=r(C,P,k,S,A,17,h[14]),S=r(S,C,P,k,T,22,h[15]),k=n(k,S,C,P,d,5,h[16]),P=n(P,k,S,C,g,9,h[17]),C=n(C,P,k,S,x,14,h[18]),S=n(S,C,P,k,c,20,h[19]),k=n(k,S,C,P,v,5,h[20]),P=n(P,k,S,C,w,9,h[21]),C=n(C,P,k,S,T,14,h[22]),S=n(S,C,P,k,m,20,h[23]),k=n(k,S,C,P,_,5,h[24]),P=n(P,k,S,C,A,9,h[25]),C=n(C,P,k,S,p,14,h[26]),S=n(S,C,P,k,b,20,h[27]),k=n(k,S,C,P,E,5,h[28]),P=n(P,k,S,C,f,9,h[29]),C=n(C,P,k,S,y,14,h[30]),S=n(S,C,P,k,M,20,h[31]),k=i(k,S,C,P,v,4,h[32]),P=i(P,k,S,C,b,11,h[33]),C=i(C,P,k,S,x,16,h[34]),S=i(S,C,P,k,A,23,h[35]),k=i(k,S,C,P,d,4,h[36]),P=i(P,k,S,C,m,11,h[37]),C=i(C,P,k,S,y,16,h[38]),S=i(S,C,P,k,w,23,h[39]),k=i(k,S,C,P,E,4,h[40]),P=i(P,k,S,C,c,11,h[41]),C=i(C,P,k,S,p,16,h[42]),S=i(S,C,P,k,g,23,h[43]),k=i(k,S,C,P,_,4,h[44]),P=i(P,k,S,C,M,11,h[45]),C=i(C,P,k,S,T,16,h[46]),S=i(S,C,P,k,f,23,h[47]),k=o(k,S,C,P,c,6,h[48]),P=o(P,k,S,C,y,10,h[49]),C=o(C,P,k,S,A,15,h[50]),S=o(S,C,P,k,v,21,h[51]),k=o(k,S,C,P,M,6,h[52]),P=o(P,k,S,C,p,10,h[53]),C=o(C,P,k,S,w,15,h[54]),S=o(S,C,P,k,d,21,h[55]),k=o(k,S,C,P,b,6,h[56]),P=o(P,k,S,C,T,10,h[57]),C=o(C,P,k,S,g,15,h[58]),S=o(S,C,P,k,E,21,h[59]),k=o(k,S,C,P,m,6,h[60]),P=o(P,k,S,C,x,10,h[61]),C=o(C,P,k,S,f,15,h[62]),S=o(S,C,P,k,_,21,h[63]),u[0]=u[0]+k|0,u[1]=u[1]+S|0,u[2]=u[2]+C|0,u[3]=u[3]+P|0},_doFinalize:function(){var e=this._data,r=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;r[i>>>5]|=128<<24-i%32;var o=t.floor(n/4294967296),a=n;r[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),r[14+(i+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),e.sigBytes=4*(r.length+1),this._process();for(var s=this._hash,l=s.words,u=0;u<4;u++){var c=l[u];l[u]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}return s},clone:function(){var e=u.clone.call(this);return e._hash=this._hash.clone(),e}});a.MD5=u._createHelper(d),a.HmacMD5=u._createHmacHelper(d)}(Math),e.MD5}(r(1))}()},function(e,r){e.exports=t},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=r(7),s=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(){function e(t){n(this,e),this._parent=t,this._node=new o.Object3D,this._node.matrixAutoUpdate=!1,this._children=[],null!==this._parent&&this._parent.addChild(this),this._matrix=new s.default,this._matrixWorld=new s.default,this.matrixWorldNeedsUpdate=!1,this._property={type:"HyperNode"}}return i(e,[{key:"destruct",value:function(){this._property.type="destructed",this.parent&&this.parent.removeChild(this)}},{key:"addChild",value:function(e){return(Array.prototype.indexOf?function(e,t){return-1!==e.indexOf(t)}:function(e,t){for(var r=-1,n=e.length;++r<n;)if(e[r]===t)return!0;return!1})(this._children,e)?(console.warn("Trying to add an exisitng child."),!1):(this._children.push(e),this._node.add(e.sceneNode),!0)}},{key:"removeChild",value:function(e){var t=Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1},r=t(this._children,e);return-1===r?(console.warn("Trying to remove an un-exisitng child."),!1):(this._children.splice(r,1),this._node.remove(e.sceneNode),!0)}},{key:"applyToChildren",value:function(e,t,r,n){for(var i=!0,o=0;o<this._children.length;o++)i=e(this._children[o],t,r,n)&&i;return i}},{key:"traverse",value:function(e,t,r,n){var i=!0;i=i&&t(e,r,n);for(var o=0;o<e._children.length;o++)i=i&&this.traverse(e._children[o],t,r,n);return i}},{key:"setMatrix",value:function(e,t){this._matrix.copy(e),this.matrixWorldNeedsUpdate=!0,this.updateMatrixWorld(!1,t)}},{key:"updateMatrixWorld",value:function(e,t){!0!==this.matrixWorldNeedsUpdate&&!0!==e||(null===this.parent?this._matrixWorld.copy(this._matrix):this._matrixWorld.multiplyMatrices(this.parent.matrixWorld,this._matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var r=this.children,n=0,i=r.length;n<i;n++)r[n].updateMatrixWorld(e,t)}},{key:"sceneUpdated",value:function(e){this.applyToChildren(function(e,t){e.sceneUpdated(t)},e)}},{key:"updateVisibility",value:function(e){this.applyToChildren(function(e,t){e.updateVisibility(t)},e)}},{key:"animate",value:function(e){this.applyToChildren(function(e,t){e.animate(t)},e)}},{key:"initInfo",value:function(){console.warn("HyperNode.initInfo is not implemented")}},{key:"sceneNode",get:function(){return this._node}},{key:"children",get:function(){return this._children}},{key:"parent",get:function(){return this._parent}},{key:"matrix",get:function(){return this._matrix}},{key:"matrixWorld",get:function(){return this._matrixWorld}},{key:"type",get:function(){return this._property.type}},{key:"property",get:function(){return JSON.parse(JSON.stringify(this._property))},set:function(e){this._property=JSON.parse(JSON.stringify(e))}},{key:"JSON",get:function(){for(var e=[],t=0;t<this.children.length;t++)e.push(this.children[t].JSON);return{property:this.property,children:e}}}]),e}();t.default=l},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return e}(r(1),r(14),r(117),r(115),r(8),r(9),r(31),r(53),r(133),r(54),r(135),r(134),r(132),r(30),r(128),r(5),r(2),r(118),r(120),r(119),r(122),r(121),r(123),r(124),r(125),r(127),r(126),r(116),r(114),r(136),r(131),r(130),r(129))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),c=r(47),h=n(c),d=r(3),f=n(d),p=r(83),m=n(p),v=r(46),g=n(v),y=r(7),b=n(y),_=r(25),w=function(e){function t(e,r,n,a,s){function l(){this.geometry.computeBoundingSphere();var e=this.geometry.boundingSphere.center.clone(),t=this.geometry.boundingSphere.radius,r=0===t?1:t;this.matrix.setValue(r,0,0,e.x,0,r,0,e.y,0,0,r,e.z,0,0,0,1)}i(this,t);var c=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n,a,s)),h=c.options.earthRadius;c.envelop={geo:null,cartesian:null,fullCartesian:null};var d=t.EarthResolution,p=Math.pow(2,d),m=Math.pow(2,c.level);m>p?(c.geometry=f.default.getTileCartesianGeometryOnEarthSurface(c.level,c.x,c.y,h,1,d),c.envelop.cartesian=f.default.getTileCartesianEnvelopOnEarthSurface(c.level,c.x,c.y,h,d)):(c.geometry=f.default.getTileCartesianGeometryByGrid(c.level,c.x,c.y,h,p/m),c.envelop.cartesian=f.default.getTileCartesianEnvelopByGrid(c.level,c.x,c.y,h)),c.envelop.geo=f.default.getTileGeographicEnvelopByGrid(c.level,c.x,c.y),c.bbox=(new u.Box3).setFromPoints(c.geometry.vertices),c.boxMesh=s.display_lod?c._bBoxMesh():null;var v={lon:(c.envelop.geo.minLon+c.envelop.geo.maxLon)/2,lat:(c.envelop.geo.minLat+c.envelop.geo.maxLat)/2};c.center={geo:v,cartesian:f.default.geographicToEarthSurface(d,v.lon,v.lat,h)};for(var g=c.geometry.vertices.length,y=Math.sqrt(g),_=[],w=[],x=0;x<y-1;x++)_[x]=c.geometry.vertices[x],w[x]=c.geometry.vertices[g-1-x];for(var M=[],E=[],A=0;A<y-1;A++)M[A]=c.geometry.vertices[g-y-A*y],E[A]=c.geometry.vertices[A*y+y-1];return c.envelop.fullCartesian=_.concat(E,w,M),c.matrix=new b.default,l.bind(c)(),c.meshHolder=new u.Object3D,c.meshHolder.name="meshHolder",c.meshHolder.matrixAutoUpdate=!1,c.meshHolder.matrix.copy(c.matrix.clone().premultiply(c.earthToWorldMatrix)),c}return a(t,e),l(t,null,[{key:"EarthResolution",get:function(){return 6}},{key:"Materials",get:function(){var e=new u.MeshPhongMaterial({color:0,shading:u.FlatShading,vertexColors:u.VertexColors,shininess:0}),t=function(e){var t=new u.DataTexture(Uint8Array.from(e),1,1,u.RGBAFormat,u.UnsignedByteType,u.UVMapping);return t.needsUpdate=!0,t}([0,10,40,255]),r=new _.GroundSelfShaderMaterial;return r.setTexture(t),{gridPatch:e,gridBoundary:new u.LineBasicMaterial({color:6674686,linewidth:3}),atmosphereGround:r}}}]),l(t,[{key:"dispose",value:function(){var e=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this);return this.isInScene()&&this._removeFromSceneGraph(),this.mesh&&this.meshHolder.remove(this.mesh),this.meshHolder=void 0,this.geometry.dispose(),this.envelop.cartesian=void 0,this.envelop.geo=void 0,this.envelop.fullCartesian=void 0,this.envelop=void 0,this.bbox=void 0,this.center.cartesian=void 0,this.center.geo=void 0,this.center=void 0,e}},{key:"updateMatrix",value:function(){return this.meshHolder.matrix.multiplyMatrices(this.earthToWorldMatrix,this.matrix),!0}},{key:"mark",value:function(){this.boxMesh&&(this.boxMesh.visible=!0)}},{key:"unmark",value:function(){this.boxMesh&&(this.boxMesh.visible=!1)}},{key:"onLoaded",value:function(e){var r=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onLoaded",this).call(this,e);return r&&this.meshHolder.add(this.mesh),r}},{key:"isFrontFacing",value:function(e,t){var r=!1;if(this.level<2)return!0;for(var n=this.envelop.cartesian,i=[],o=(new u.Matrix3).getNormalMatrix(e),a=t.getWorldDirection(),s=0;s<n.length;s++)if(i[s]=n[s].clone().normalize().applyMatrix3(o).normalize(),r=a.clone().dot(i[s])<0)return isFinite;return r}},{key:"isInFrustum",value:function(e,t,r,n){var i=this.debug,o=!0,a=void 0!==r?r:this.bbox.clone().applyMatrix4(t);return o=e.intersectsBox(a),i&&console.log("isInFrustum",o),o}},{key:"screenArea",value:function(e,t,r,n){function i(){var e=[],r=c;e[0]=new u.Vector3(r.min.x,r.min.y,r.min.z),e[1]=new u.Vector3(r.max.x,r.min.y,r.min.z),e[2]=new u.Vector3(r.max.x,r.max.y,r.min.z),e[3]=new u.Vector3(r.min.x,r.max.y,r.min.z),e[4]=new u.Vector3(r.min.x,r.min.y,r.max.z),e[5]=new u.Vector3(r.max.x,r.min.y,r.max.z),e[6]=new u.Vector3(r.max.x,r.max.y,r.max.z),e[7]=new u.Vector3(r.min.x,r.max.y,r.max.z);for(var n={front:!1,back:!1},i=0;i<e.length;i++)if(e[i].applyMatrix4(t),e[i].z>1?n.back=!0:e[i].z<1&&(n.front=!0),n.front&&n.back)return o&&console.log("onPlane",a.info()),!0}var o=!1,a=this,s=0;o&&console.log("screenArea",this.info());var l=this.earthToWorldMatrix.toThreeMatrix4(),c=this.bbox.clone().applyMatrix4(l),h=this.isInFrustum(r,l,c,t),d=this.isFrontFacing(l,e);return h&&d?(s=this.level<3?function(){var e=0,r=[],n=c;r[0]=new u.Vector3(n.min.x,n.min.y,n.min.z),r[1]=new u.Vector3(n.max.x,n.min.y,n.min.z),r[2]=new u.Vector3(n.max.x,n.max.y,n.min.z),r[3]=new u.Vector3(n.min.x,n.max.y,n.min.z),r[4]=new u.Vector3(n.min.x,n.min.y,n.max.z),r[5]=new u.Vector3(n.max.x,n.min.y,n.max.z),r[6]=new u.Vector3(n.max.x,n.max.y,n.max.z),r[7]=new u.Vector3(n.min.x,n.max.y,n.max.z);for(var i={front:!1,back:!1},s=0;s<r.length;s++)if(r[s].applyMatrix4(t),r[s].z>1?i.back=!0:r[s].z<1&&(i.front=!0),i.front&&i.back)return o&&console.log("area max"),Number.MAX_VALUE/a.level;for(var l=[[0,1,2,3],[7,6,5,4],[3,2,6,7],[5,6,2,1],[4,5,1,0],[0,3,7,4]],h=0;h<l.length;h++)e+=function(e){if(4!==e.length)return console.error("projecting wrong number of vertices",e),0;var t=[];o&&console.log(JSON.stringify(e));for(var n=0;n<e.length;n++){var i=e[n];t[n]=r[i].clone(),t[n].z=0}o&&console.log(JSON.stringify(t));for(var a=0,s=[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],l=[],u=0;u<t.length;u++)l.push({x:t[u].x,y:t[u].y});return a=g.default.polygonIntersectArea(s,l),a<0&&(a=0),o&&console.log(a),isNaN(a)&&(console.warn("wrong area"),console.warn(JSON.stringify(t))),a}(l[h]);return e}():function(){if(i())return o&&console.log("onPlane"),Number.MAX_VALUE/a.level;for(var e=[],r=0;r<a.envelop.fullCartesian.length;r++)e[r]=a.envelop.fullCartesian[r].clone(),e[r].applyMatrix4(l).applyMatrix4(t);for(var n=0,s=[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],u=[],c=0;c<e.length;c++)u.push({x:e[c].x,y:e[c].y});return o&&console.log("poly",u),n=g.default.polygonIntersectArea(s,u),o&&console.log("area",n),n<0&&(n=0),n}(),o&&console.log("visible area",s),this.setVisibility(!0)):(this.setVisibility(!1),s=0,o&&console.log("inivisible")),s}},{key:"tileLoader",value:function(){var e=this;return this.useTexture?function(){var t=function(t){return void 0===t||"earth"===t?"China"===e.options.countryName?e.level<=8?m.default.getBlueMarbleCNImageUrl(e.level,e.x,e.y):m.default.getGoogleCNImageUrl(e.level,e.x,e.y):e.level<=8?m.default.getBlueMarbleImageUrl(e.level,e.x,e.y):m.default.getGoogleImageUrl(e.level,e.x,e.y):"lunar"===t?m.default.getNasaMoonTrekImageUrl(e.level,e.x,e.y):"mars"===t?m.default.getNasaMarsTrekImageUrl(e.level,e.x,e.y):void 0}(e.planet);return function(e){return new Promise(function(t,r){var n=new u.TextureLoader;n.crossOrigin="",n.load(e,function(e){t(e)},function(e){},function(e){console.warn("An error happened".xhr),r(e)})})}(t).then(function(e){return Promise.resolve(e)})}().then(function(t){return Promise.resolve(e.tileTexturedGrid(t))}):Promise.resolve(e.tileGrid())}},{key:"tileTexturedGrid",value:function(e){e.anisotropy=this.options.maxAnisotropy;var t=this._normlizedGeometry();if(null===t)return null;void 0===this&&console.log("catch undefined this");var r=new _.GroundSelfShaderMaterial;r.setTexture(e);var n=new u.Mesh(t,r);return n.matrixAutoUpdate=!1,void 0===n&&console.warn("undefined mesh"),n}},{key:"tileGrid",value:function(){var e=this.geometry.clone();e.computeBoundingSphere();var r=e.boundingSphere.center.clone(),n=e.boundingSphere.radius,i=0===n?1:1/n,o=new u.Matrix4;if(o.set(i,0,0,-i*r.x,0,i,0,-i*r.y,0,0,i,-i*r.z,0,0,0,1),e.applyMatrix(o),null===e)return null;var a=t.Materials.atmosphereGround,s=new u.Mesh(e,a);return s.matrixAutoUpdate=!1,s}},{key:"_normlizedGeometry",value:function(){var e=this.geometry.clone();e.computeBoundingSphere();var t=e.boundingSphere.center.clone(),r=e.boundingSphere.radius,n=0===r?1:1/r,i=new u.Matrix4;return i.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),e.applyMatrix(i),e}},{key:"_bBoxMesh",value:function(){return new u.BoxHelper(new u.Mesh(this.geometry))}},{key:"_addToSceneGraph",value:function(e){var t=this,r=this.options.debug;void 0===this.mesh?console.warn(JSON.stringify(this.info())+", mesh undefined, cannot add to scene"):void 0===e?console.warn("sceneGraphRoot undefined"):void 0!==this.sceneGraphRoot?console.warn("Twice adding to scene attempt",this.info()):(this.setVisibility(this.visible),e.add(this.meshHolder),null!==this.boxMesh&&e.add(this.boxMesh),t.sceneGraphRoot=e,r&&console.log("add to scene",this.info()))}},{key:"_removeFromSceneGraph",value:function(){var e=this,t=this.options.debug,r=!0;return void 0!==this.sceneGraphRoot&&void 0!==this.mesh?(this.sceneGraphRoot.remove(this.meshHolder),null!==this.boxMesh&&this.sceneGraphRoot.remove(this.boxMesh),e.sceneGraphRoot=void 0,this.mesh.place_holder?this.mesh.visible=!1:this.mesh.visible=!0,t&&console.log("remove scene",this.info()),r):(console.warn("_removeFromSceneGraph fail",this),r=!1)}},{key:"setVisibility",value:function(e){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setVisibility",this).call(this,e),this.isInScene()&&void 0!==this.mesh&&!this.options.fullScene&&(this.mesh.place_holder?this.mesh.visible=!1:this.mesh.visible=e)}},{key:"is404",get:function(){return!(!this.mesh||!this.mesh.place_holder)}},{key:"earthRadius",get:function(){return this.options.earthRadius}},{key:"debug",get:function(){return this.options.debug}},{key:"useColor",get:function(){return this.options.useColor}},{key:"useTexture",get:function(){return this.options.useTexture}},{key:"planet",get:function(){return this.options.planet}},{key:"earthToWorldMatrix",get:function(){return this.options.treeMatrixWorld}}]),t}(h.default);t.default=w},function(e,t,r){!function(n,i){e.exports=t=function(e){return function(t){var r=e,n=r.lib,i=n.Base,o=n.WordArray,a=r.x64={};a.Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),a.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,r=[],n=0;n<t;n++){var i=e[n];r.push(i.high),r.push(i.low)}return o.create(r,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),r=t.length,n=0;n<r;n++)t[n]=t[n].clone();return e}})}(),e}(r(1))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=r(34),c=n(u),h=r(33),d=n(h),f=r(10),p=n(f),m=function(){function e(){var t=this;a(this,e),r.p="/js/";var n=r(150);this.worker=new n,this.callback=null,this.worker.onmessage=function(e){var r=t.callback;r&&r(null,e.data)},this.worker.onError=function(e){for(var t=0;t<1e4;t++)console.warn("Worker runtime error",e.message)}}return s(e,[{key:"terminate",value:function(){if(this.worker)try{this.worker.terminate(),this.callback=void 0}catch(e){return console.error("MaskLoaderThread terminate failed",e),this.callback=void 0,!1}return!0}},{key:"scheduleLoad",value:function(e){var t=this,r=this;return new Promise(function(n,i){var o=function(e,t){e?i(e):n(t)};r.callback=o,t.worker.postMessage(e)})}}]),e}(),v=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.HOST?{HOST:e.HOST}:void 0));return r.manager=e,r.isDebug=!1,r.allowWorker=e.allowWorker,r.worker=void 0,r}return o(t,e),s(t,[{key:"destruct",value:function(){var e=!0;return this.postConfig=void 0,this.allowWorker&&this.worker&&(e=e&&this.worker.terminate(),this.worker=void 0),e}},{key:"getAll",value:function(e,t){var r=this,n={dataset:r.manager.PID,usage:r.manager.usage},i=Date.now();return r.isDebug&&console.log("service get all ...",n),p.default.post(r.baseURL+"/api/mask/get_all",n,r.postConfig).then(function(n){if(r.isDebug){var o=Date.now();console.log("download time",i,"->",o," = ",(o-i)/1e3,"s")}var a=n.data;if(r.isDebug&&console.log("get res data",a),"success"===a.status){var s=a.summary.maskInfos;s.length>0?e&&e(s):(console.warn("download all mask error"),t&&t())}else t&&t()}).catch(function(e){console.warn("Mask Manager download mask summary error",e),t&&t()})}},{key:"getAllWorker",value:function(e,t){var r=this,n=this;if(n.allowWorker)try{n.worker=new m}catch(e){console.error("Cannot initiate web worker",e),n.allowWorker=!1,n.worker=null}if(this.worker){var i=this.baseURL;((function(e,t){return"/"===e.substr(0,"/".length)})(i)||""===i)&&(i=window.location.protocol+"//"+window.location.host+i);var o={dataset:this.manager.PID,usage:this.manager.usage,baseURL:i,maskSize:this.manager.maskSize,isDebug:!1,edit:this.manager.edit};return this.worker.scheduleLoad(o).then(function(i){r.worker.terminate(),r.worker=void 0,n.isDebug&&console.log("get res from worker",i),null!==i.data?e&&e(i.data):t&&t()})}return console.log("worker failed"),this.getAll(e,t)}},{key:"uploadAll",value:function(e,t,r){var n=this,i={dataset:this.manager.PID,usage:this.manager.usage,maskInfos:e,maskBox:{minX:0,minY:0,maxX:1,maxY:1}};return p.default.post(n.baseURL+"/api/mask/update_all",i,n.postConfig).then(function(e){t&&t()}).catch(function(e){console.log("upload error",e),r&&r()})}},{key:"getNormalTex",value:function(e,t){var r=this,n=r.baseURL+"/images/editor/assets/img/waternormals.jpg";this.manager.isDebug&&console.log("service: to download tex",n);var i=new l.TextureLoader;i.crossOrigin="",i.load(n,function(t){e&&e(t)},function(e){console.log("water normal"+e.loaded/e.total*100+"% loaded")},function(e){console.log("Loading water normal error!",e),t&&t()})}},{key:"preProcess",value:function(){var e=this,t={},r=e.baseURL+"/api/mask/update_format";return console.log("preprocess ...",r),p.default.get(r,t,e.postConfig).then(function(e){console.log(e)}).catch(function(e){console.log(e)})}}]),t}(c.default),g=function(){function e(t){a(this,e),this.common=d.default.getInstance(t.dataPath),this.baseURL=t.dataPath,this.manager=t,this.isDebug=!1,this.altizureApi=t.altizureApi,this.altizureApi||console.error("MaskMgrServiceLocal: altizureApi not defined."),this.useAltizureApi=t.useAltizureApi}return s(e,[{key:"destruct",value:function(){}},{key:"getAll",value:function(e,t){var r=this;if(this.useAltizureApi&&this.altizureApi)return r.altizureApi.projectMask({pid:r.manager.PID,usage:r.manager.usage}).then(function(r){var n=r.maskInfos;if(n.length>0){var i=n.map(function(e){var t=e;return{pack_mask:{width:t.width,height:t.height,data:t.data,poly_num:t.polyNum},property:{level:t.level,alpha:t.alpha,color:t.color,wave:t.wave}}});e&&e(i)}else console.warn("api download all mask error"),t&&t()}).catch(function(e){console.warn("api Mask Manager download mask summary error",e),t&&t()});var n=r.baseURL+"/"+r.manager.usage+"_summary.json";r.isDebug&&console.log("to download summary ...",n),(0,p.default)({method:"get",url:n,responseType:"json"}).then(function(t){var i=t.data;r.isDebug&&console.log("local service success",n,"summary",i);var o=i.maskInfos;r.manager.maskInfos=o,r.manager.downloadSucess=!0,e&&e(o)}).catch(function(e){console.error("get mask summary json error",e),t&&t()})}},{key:"uploadAll",value:function(e,t,r){console.warn("Upload summary is not supported in desktop!")}},{key:"getNormalTex",value:function(e,t){var r=new l.TextureLoader;r.crossOrigin="",r.load("img/waternormals.jpg",function(t){e&&e(t)},function(e){console.log("water"+e.loaded/e.total*100+"% loaded")},function(e){console.log("Loading water normal error!",e),t&&t()})}}]),e}(),y=function(){function e(t){a(this,e),this.info=t.info,this.PID=t.PID,this.dataPath=t.dataPath,this.usage=t.usage,this.maskSize=t.maskSize,this.MaskType=t.MaskType,this.maxMaskNum=t.maxMaskNum,this.allowWorker=t.allowWorker,this.edit=t.edit,this.HOST=t.HOST,this.altizureApi=t.altizureApi,this.maskInfos=void 0,this.maskSettings={},this.backupMaskInfos=null,this.nameCnt=0,this.isModified=!1,this.isDebug=!1,this._initService()}return s(e,[{key:"destruct",value:function(){var e=!0;this.service&&(e&=this.service.destruct());for(var t in this.maskSettings)e&=this.maskSettings[t].destruct();return this.backupMaskInfos&&(this.backupMaskInfos=[]),e}},{key:"_initService",value:function(){switch(window.location.protocol){case"http:":case"https:":this.service=new v(this);break;case"file:":var e=this.dataPath.indexOf(":"),t=e>0?this.dataPath.substr(0,e):this.dataPath;"http"!==t&&"https"!==t||(this.useAltizureApi=!0),this.allowWorker=!1,this.service=new g(this);break;default:console.error("Unknown browsing protocol, please report to support@altizure.com ",window.location.protocol)}}},{key:"_defaultMaskOpts",value:function(e){return"string"==typeof e&&(e=Number(e)),{usage:this.usage,maskId:e,maskSize:this.maskSize,info:this.info,PID:this.PID,dataPath:this.dataPath,manager:this,edit:this.edit,isDebug:!1}}},{key:"_backupMaskInfos",value:function(e){this.backupMaskInfos=Object.assign({},e),this.modified=!1}},{key:"_setMaskSettings",value:function(e,t,r){var n=this;n.clearAll(),n.isDebug&&console.log("init masks #",e.length);for(var i=0;i<e.length;++i)!function(i){var o=n._defaultMaskOpts(i),a=new t(o),s=e[i];r&&a.workerInitMask?(a.workerInitMask(s),n.maskSettings[i]=a):a.initMask(s,function(){n.isDebug&&console.log("set mask #poly",a.acumulate_poly_num),n.maskSettings[i]=a})}(i)}},{key:"numSettings",value:function(){return Object.keys(this.maskSettings).length}},{key:"addefaultSetting",value:function(){var e=this,t=Date.now();if(e.numSettings()===e.maxMaskNum)return console.warn("exceed max mask num"),null;for(;e.maskSettings[this.nameCnt];)e.nameCnt+=1;var r=e._defaultMaskOpts(e.nameCnt),n=this.MaskType;e.isDebug&&console.log("add default setting",this.nameCnt,r);var i=new n(r);if(i.resetMask(),e.maskSettings[this.nameCnt]=i,e.nameCnt+=1,e.isDebug){var o=Date.now();console.log("add default time",(o-t)/1e3)}return i}},{key:"_downloadSettings",value:function(e,t,r){var n=this,i=this;this.service.getAll(function(r){i.isDebug&&console.log("get all infos success",r),i._setMaskSettings(r,e),i.nameCnt=r.length,t&&t(),i.edit&&i._backupMaskInfos(r)},function(){if(i.isDebug&&console.log("get all infos error",i.usage),r&&r(),i.edit){var e=i._getMaskInfos();n._backupMaskInfos(e)}})}},{key:"workerDownloadAll",value:function(e){var t=this;this.service.getAllWorker(function(e){t.isDebug&&console.log("worker download all",e),t.nameCnt=e.length,t._setMaskSettings(e,t.MaskType,t.allowWorker),t.edit&&t._backupMaskInfos(e)})}},{key:"_getMaskInfos",value:function(){var e=[];for(var t in this.maskSettings){this.maskSettings[t].updateMaskInfo();var r=this.maskSettings[t].maskInfo;e.push(r)}return e}},{key:"uploadAll",value:function(){var e=this,t=e._getMaskInfos();this.service.uploadAll(t,function(){e._backupMaskInfos(t)})}},{key:"abortAll",value:function(){var e=this,t=[];for(var r in this.backupMaskInfos)t.push(this.backupMaskInfos[r]);e.isDebug&&console.log("abort all",t),t&&(this._setMaskSettings(t,this.MaskType),this.modified=!1)}},{key:"resetAll",value:function(){for(var e in this.maskSettings)this.maskSettings[e].resetMask()}},{key:"clearAll",value:function(){for(var e in this.maskSettings)this.maskSettings[e].remove&&this.maskSettings[e].remove(),this.maskSettings[e].destruct();this.maskSettings={}}},{key:"getSetting",value:function(e){return this.maskSettings[e]}}]),e}();t.default=y},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),s=r(108),l=n(s),u=r(67),c=n(u),h=r(69),d=n(h),f=function(){function e(t){i(this,e),this.maskSize=t.maskSize,this.isDebug=t.isDebug,this.debugVisualize=!1,this.usage=t.usage,this.MaskType=t.MaskType,this.manager=t.manager,this.edit=t.edit,this.maskId=t.maskId,this.info=t.info,this.PID=t.PID,this.dataPath=t.dataPath,this.maskInfo={},this.polygons=[],this.orthoInfo=null,this.acumulate_poly_num=0,this.cut_color_style="rgb(255,0,0)",this.res_color_style="rgb(0,255,0)";var r=Date.now();if(this.edit){this.orthoCanvas=document.createElement("canvas"),this.orthoCanvas.width=this.maskSize,this.orthoCanvas.height=this.maskSize;var n=this.orthoCanvas.getContext("2d"),o=n.getImageData(0,0,this.orthoCanvas.width,this.orthoCanvas.height);n.putImageData(o,0,0),this.curMaskRGB=o.data,this.preMaskRGB=new Uint8ClampedArray(this.curMaskRGB),this.preMaskRGB.set(this.curMaskRGB)}else this.curMaskRGB=new Uint8ClampedArray(this.maskSize*this.maskSize*4);this.curMaskTexture=void 0;var a=void 0;if(this.isDebug&&(a=Date.now(),console.log("create mask time",r,"->",a," = ",(a-r)/1e3,"s"),r=Date.now()),this.downloadSucess=!1,this.updateOrthoInfo(),this.cntWhite=0,this.isDebug){var s=Date.now();console.log("init ortho time",r,"->",s," = ",(s-r)/1e3,"s")}}return o(e,[{key:"destruct",value:function(){this.curMaskRGB=[],this.preMaskRGB=[],this.orthoCanvas=void 0,this.polygons=[],this.orthoInfo=void 0,this.dataPath=void 0,this.maskInfo&&(this.maskInfo.pack_mask&&(this.maskInfo.pack_mask.data=[],this.maskInfo.pack_mask=void 0),this.maskInfo.texData=[],this.maskInfo.rgba=[],this.maskInfo=void 0),this.curMaskTexture&&this.curMaskTexture.dispose(),this.curMaskTexture=void 0;for(var e in this.orthoInfo)this.orthoInfo[e]=void 0;return this.orthoInfo=void 0,!0}},{key:"updateOrthoInfo",value:function(){var e=this.info,t=void 0,r=void 0;e.transformation?(t=e.transformation.getOnloadMatrixRef(),r=e.transformation.getTransBBox(e,!0)):(t=new a.Matrix4,r=[e.min_bound,e.max_bound]);var n=(new a.Matrix4).extractRotation(t.clone());this.isDebug&&console.log("update onload transformation",t),n=n.transpose(),this.orthoInfo={origin:e.origin.clone(),x_dir:new a.Vector3(1,0,0).applyMatrix4(n),y_dir:new a.Vector3(0,1,0).applyMatrix4(n),z_dir:new a.Vector3(0,0,1).applyMatrix4(n),min_bound:r[0],max_bound:r[1],width:r[1].x-r[0].x,height:r[1].z-r[0].z,area:(r[1].x-r[0].x)*(r[1].z-r[0].z)}}},{key:"drawBBox",value:function(e){if(null!=e){console.log("draw bbox");var t=this.info;if(this.orthoInfo){var r=(new a.Vector3).subVectors(t.max_bound,t.min_bound).length()/100;e.add(l.default.drawSphere(this.orthoInfo.min_bound,r,16711680)),e.add(l.default.drawSphere(this.orthoInfo.max_bound,r,255));var n=(new a.Vector3).addVectors(this.orthoInfo.min_bound,this.orthoInfo.max_bound).multiplyScalar(.5);e.add(l.default.drawSphere(n,2*r,16777215)),e.add(l.default.drawSphere(new a.Vector3(0,0,0),2*r,16776960)),console.log("draw bbox center",n);var i=this.orthoInfo.origin,o=this.orthoInfo.x_dir,s=this.orthoInfo.y_dir,u=this.orthoInfo.z_dir;e.add(l.default.drawLine(i,o.clone().multiplyScalar(100*r).add(i),16711680)),e.add(l.default.drawLine(i,s.clone().multiplyScalar(100*r).add(i),65280)),e.add(l.default.drawLine(i,u.clone().multiplyScalar(100*r).add(i),255)),e.add(l.default.drawBoxByPoint(this.orthoInfo.min_bound,this.orthoInfo.max_bound))}}}},{key:"_setMaskFromInfo",value:function(e,t){var r=this,n=Date.now(),i=n,o=e.pack_mask,a=c.default.unpackToImage(o);if(o.width!==r.maskSize){var s=r.maskSize/o.width,l=c.default.downsampleImage(a.rgba,o.width,o.height,s);a.rgba=[],a.rgba=l.rgba,a.cntWhite=l.cntWhite}r.cntWhite=a.cntWhite;var u=a.rgba;if(this.curMaskRGB.set(u),this.edit){this.acumulate_poly_num=o.poly_num,this.preMaskRGB.set(u),this.removePolygons();var h=r.orthoCanvas.getContext("2d"),d=h.createImageData(r.orthoCanvas.width,r.orthoCanvas.height);d.data.set(r.curMaskRGB),h.putImageData(d,0,0)}this.isDebug&&console.log("unpack + create time",(Date.now()-i)/1e3,"s"),t&&t()}},{key:"init",value:function(e,t,r){var n=this;if(n.isDebug&&console.log("init mask info",e),null===e||void 0===e)return void(r&&r());e.pack_mask?(n._setMaskFromInfo(e),n.downloadSucess=!0,t&&t(e),n._debugVisualizeMask()):r&&r()}},{key:"updateMaskInfo",value:function(e){if(e&&e.pack_mask)this.maskInfo.pack_mask=e.packed_mask;else{var t=this.curMaskRGB,r=this.maskSize,n=this.maskSize,i=d.default.getMaskfromImageData(t,r,n,1),o=c.default.pack_boolean(i);o.poly_num=this.acumulate_poly_num,this.maskInfo.pack_mask=o}}},{key:"reset",value:function(e,t){var r=this,n=this.maskSize,i=this.maskSize;r.acumulate_poly_num=0,void 0===t&&(t="white"),r.cntWhite="white"===t?n*i:0,new Promise(function(e){var o=Date.now();if(r.edit){var a=r.orthoCanvas.getContext("2d");a.fillStyle=t,a.fillRect(0,0,n,i);var s=a.getImageData(0,0,n,i);r.curMaskRGB.set(s.data),a.fillStyle="white",a.fillRect(0,0,n,i),s=a.getImageData(0,0,n,i),r.preMaskRGB.set(s.data)}else{var l="white"===t?255:0;r.curMaskRGB.fill(l)}if(r.isDebug){var u=Date.now();console.log("reset preapre time",o,"->",u," = ",(u-o)/1e3,"s")}e(r.curMaskRGB)}).then(function(t){if(r.debugVisualize){var o=l.default.convertFboToImage(t,n,i);l.default.showImage(o)}e&&e(t)}),r.removePolygons()}},{key:"maskToTexture",value:function(e){var t=Date.now(),r=new Uint8Array(e,1);if(this.isDebug){var n=Date.now();console.log("array copy time",(n-t)/1e3)}var i=new a.DataTexture(r,this.maskSize,this.maskSize,a.RGBAFormat,a.UnsignedByteType);if(i.needsUpdate=!0,this.isDebug){var o=Date.now();console.log("mask to tex time",(o-t)/1e3)}return i}},{key:"remove",value:function(){this.removePolygons()}},{key:"removePolygons",value:function(){this.isDebug&&console.log("remove polys",this.polygons);for(var e=this,t=0;t<e.polygons.length;++t)e.polygons[t].remove();e.polygons=[]}},{key:"drawPolygonsInMask",value:function(e){if(!0===this.edit){for(var t=this,r=this.orthoCanvas.width,n=this.orthoCanvas.height,i=this.orthoCanvas.getContext("2d"),o=0;o<e.length;++o){var a=e[o],s=a.is_reserve?this.res_color_style:this.cut_color_style;0===o&&(i.fillStyle=a.is_reserve?"black":"white",i.fillRect(0,0,r,n)),this.orthoCanvas=a.paintToCanvas(this.orthoCanvas,s)}var l=i.getImageData(0,0,r,n);t.cntWhite=0;for(var u=0;u<l.data.length;u+=4)(function(e,r,n){return 255===e[n+1]&&255===r[n+1]?(t.curMaskRGB[n]=0,t.curMaskRGB[n+1]=255,t.curMaskRGB[n+2]=0,!0):(t.curMaskRGB[n]=255,t.curMaskRGB[n+1]=0,t.curMaskRGB[n+2]=0,!1)})(l.data,t.preMaskRGB,u)&&(t.cntWhite+=1);return t._debugVisualizeMask(),this.curMaskRGB}}},{key:"applyPolygon",value:function(e,t){!0===this.edit&&(void 0===e&&(e=this.polygons),this.isDebug&&console.log("apply polygons",e),this.acumulate_poly_num+=e.length,t&&t(),this.removePolygons(),this.preMaskRGB.set(this.curMaskRGB),this.manager.uploadAll(),this._debugVisualizeMask())}},{key:"_debugVisualizeMask",value:function(){if(this.debugVisualize){console.log("draw mask");var e=this.maskSize,t=this.maskSize,r=l.default.convertFboToImage(this.curMaskRGB,e,t);l.default.showImage(r)}}},{key:"getArea",value:function(){return this.cntWhite/(this.maskSize*this.maskSize)*this.orthoInfo.area}}]),e}();t.default=f},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=r(16),c=n(u),h=r(42),d=n(h),f=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.viewer=e.viewer,r.isShown=e.show,r.scene=r.viewer.scene,r.renderer=r.viewer.renderer,r.renderer!==r.viewer.renderer&&(r.renderer.autoClear=!1,r.renderer.autoClearDepth=!1),r.createDefault=e.createDefault,r.normalTex=e.normalTex,r.dynamic_water=null,r.aMeshMirror=null,r.isDebug=!1,r.water_properties={},r._setOrthoProperties(),r.default_properties=e.default_properties?e.default_properties:{level:.5*(r.water_properties.max_level+r.water_properties.min_level),alpha:.9,color:2138762,wave:.2*r.water_properties.max_wave},r.manager.default_properties=r.default_properties,r.setPropoerties(),r._initLighting(),r.card_item=null,r.card_header=null,r.isDebug&&r.drawBBox(r.viewer.scene),r}return a(t,e),s(t,[{key:"_setOrthoProperties",value:function(){this.water_properties.width=this.orthoInfo.max_bound.x-this.orthoInfo.min_bound.x,this.water_properties.height=this.orthoInfo.max_bound.z-this.orthoInfo.min_bound.z,this.water_properties.max_level=this.orthoInfo.max_bound.y,this.water_properties.min_level=this.orthoInfo.min_bound.y,this.water_properties.position=(new l.Vector3).addVectors(this.orthoInfo.min_bound,this.orthoInfo.max_bound).multiplyScalar(.5),this.water_properties.max_wave=Math.max(this.water_properties.width,this.water_properties.height)/100,this.water_properties.min_wave=0,this.water_properties.max_area=this.water_properties.width*this.water_properties.height}},{key:"setPropoerties",value:function(e){e?(this.water_properties.level=e.level,this.water_properties.color=e.color,this.water_properties.alpha=e.alpha,this.water_properties.wave=e.wave):(this.water_properties.level=this.default_properties.level,this.water_properties.color=this.default_properties.color,this.water_properties.alpha=this.default_properties.alpha,this.water_properties.wave=this.default_properties.wave)}},{key:"_initLighting",value:function(){if(this.directionalLight_water)return void console.log("directionalLight_water already initialized");this.directionalLight_water=new l.DirectionalLight(16777045,1);var e=Math.max(this.water_properties.width,this.water_properties.height);if(this.directionalLight_water.position.set(-.2*e,.5*e,.2*e),this.directionalLight_water.position.add(this.water_properties.position),this.isDebug){var t=new l.DirectionalLightHelper(this.directionalLight_water,e/10);this.viewer.scene.add(t)}}},{key:"initMask",value:function(e,t){var r=this,n=function(){r.setPropoerties(e.property),r.createWaterTex(r.curMaskRGB),r.isDebug&&console.log("donwload water property",r.water_properties),t&&t()},i=function(){r.createDefault&&r.resetMask(t)};r.init(e,n,i)}},{key:"createWaterTex",value:function(e){var t=this.maskToTexture(e);this._createWaterMesh(this.normalTex,t)}},{key:"updateWaterTex",value:function(e){var t=this.maskToTexture(e);this.dynamic_water.setMask(t),this.aMeshMirror.material=this.dynamic_water.material,this.show()}},{key:"resetMask",value:function(e){var t=this;this.reset(function(r){t.dynamic_water?t.updateWaterTex(r):t.createWaterTex(r),e&&e(t)},"black")}},{key:"_createWaterMesh",value:function(e,t){var r=this,n=e;n.wrapS=n.wrapT=l.RepeatWrapping;var i={textureWidth:r.mask_size,textureHeight:r.mask_size,waterNormals:n,alpha:r.water_properties.alpha,sunDirection:(new l.Vector3).subVectors(r.directionalLight_water.position,r.water_properties.position).normalize(),sunColor:16777215,waterColor:r.water_properties.color,betaVersion:0,side:l.FrontSide,distortionScale:0,noiseScale:r.water_properties.wave,eye:r.viewer.camera.matrixWorld,cropMask:t,time:10};r.isDebug&&console.log("creater water properties",i),r.dynamic_water=new d.default(r.renderer,r.viewer.camera,r.scene,i),r.aMeshMirror=new l.Mesh(new l.PlaneBufferGeometry(r.water_properties.width,r.water_properties.height,10,10),r.dynamic_water.material),r.aMeshMirror.add(r.dynamic_water),r.aMeshMirror.rotation.x=.5*-Math.PI;var o=this.water_properties.position;o.setY(this.water_properties.level),r.aMeshMirror.position.copy(o),r.scene.add(r.aMeshMirror),r.aMeshMirror.visible=r.isShown,r.dynamic_water.updateMatrixWorld(),r.directionalLight_water.target=r.dynamic_water,r.render()}},{key:"setCamera",value:function(e){console.warn("WaterSetting setCamera",e),this.dynamic_water&&this.dynamic_water.setCamera(e)}},{key:"render",value:function(){var e=this;e.dynamic_water&&e.renderer&&(e.dynamic_water.material.uniforms.time.value+=.1,e.dynamic_water.material.needsUpdate=!0,e.dynamic_water.render())}},{key:"show",value:function(){null!=this.aMeshMirror&&(this.aMeshMirror.visible=!0)}},{key:"hide",value:function(){null!=this.aMeshMirror&&(this.aMeshMirror.visible=!1)}},{key:"apply",value:function(e){var t=this,r=this.polygons;this.applyPolygon(r,function(){t.updateWaterTex(t.curMaskRGB)})}},{key:"updateMaskInfo",value:function(){c.default.prototype.updateMaskInfo.call(this),this.maskInfo.property={level:this.water_properties.level,alpha:this.water_properties.alpha,color:this.water_properties.color,wave:this.water_properties.wave}}},{key:"active",value:function(){this.card_item&&(this.isDebug&&console.log("active ",this.maskId),this.card_item.addClass("water-active"))}},{key:"deactive",value:function(){this.card_item&&(this.isDebug&&console.log("deactive ",this.maskId),this.card_item.removeClass("water-active"))}},{key:"remove",value:function(){c.default.prototype.remove.call(this),this.card_item&&this.card_item.remove(),this.scene.remove(this.aMeshMirror)}},{key:"getWater",value:function(){return this.dynamic_water}},{key:"levelRange",get:function(){return this.water_properties.max_level-this.water_properties.min_level}},{key:"level",set:function(e){this.water_properties.level=e,this.aMeshMirror&&this.aMeshMirror.position.setY(this.water_properties.level)},get:function(){return this.water_properties.level}},{key:"minLevel",get:function(){return this.water_properties.min_level}},{key:"maxLevel",get:function(){return this.water_properties.max_level}},{key:"alpha",set:function(e){this.water_properties.alpha=e,this.dynamic_water&&(this.dynamic_water.material.uniforms.alpha.value=this.water_properties.alpha)},get:function(){return this.water_properties.alpha}},{key:"color",set:function(e){this.isDebug&&console.log("set color",e),this.water_properties.color=e,this.dynamic_water&&(this.dynamic_water.material.uniforms.waterColor.value=new l.Color(e))},get:function(){return this.water_properties.color}},{key:"wave",set:function(e){this.water_properties.wave=e,this.dynamic_water&&(this.dynamic_water.material.uniforms.noiseScale.value=this.water_properties.wave)}},{key:"wavePercent",set:function(e){this.water_properties.wave=e*(this.water_properties.max_wave-this.water_properties.min_wave)+this.water_properties.min_wave,this.dynamic_water&&(this.dynamic_water.material.uniforms.noiseScale.value=this.water_properties.wave),this.isDebug&&console.log("set wave ",this.water_properties.wave)},get:function(){return(this.water_properties.wave-this.water_properties.min_wave)/(this.water_properties.max_wave-this.water_properties.min_wave)}},{key:"center",get:function(){for(var e=0;e<this.polygons.length;++e);}}]),t}(c.default);t.default=f},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(11),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(e,r,o,a){n(this,t);var s=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.TreeType=r,s.TileType=o,s.name="",s.sceneNode.matrixAutoUpdate=!1,s._property.type="HyperEntity",s}return o(t,e),a(t,[{key:"initInfo",value:function(){return Promise.reject("initInfo not impelemented.")}},{key:"box",get:function(){return console.warn("HyperEntity.box is not impelemented"),null}}]),t}(l.default);t.default=u},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(11),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(e){function t(e,r,o){n(this,t);var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.EntityType=r,a.options=o,a._property.type="HyperLayer",a}return o(t,e),a(t,[{key:"startImport",value:function(){for(var e=this.options.dataSeeds,t=[],r=0;r<e.length;r++){var n=this.EntityType,i=new n(this,e[r]),o=this._import(i);t.push(o)}return Promise.all(t)}},{key:"_import",value:function(e){return e.startImport().then(function(){return Promise.resolve(1)}).catch(function(e){return console.error("import error:",e),Promise.resolve(0)})}},{key:"clear",value:function(){console.warn("clear is not implemented")}}]),t}(l.default);t.default=u},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0},u=r(0),c=r(47),h=n(c),d=r(27),f=n(d),p=r(71),m=n(p),v=function(e){function t(e,r,n,a,s,l){i(this,t);var u=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n,s,l));return u.name=f.default.makeTileName(n,e,r),u.size=a,u.boundingBox=u.initBBox(),u.boxMesh=l.showBBox?u._bBoxMesh():null,u.eventQueue=l.eventQueue,u.trial=0,u.maxReloads=2,u.currentDisplayMode=0,u.texture_material=null,u.orthoSelectioinMaterial=null,u.cropConfig=l.cropConfig,u.side=l.side,u}return a(t,e),s(t,[{key:"info",value:function(){return{level:this.level,x:this.x,y:this.y}}},{key:"onError",value:function(e,t){void 0!==this.options.onError?this.options.onError(e,t):console.warn("onError not defined")}},{key:"isInFrustum",value:function(e,t){for(var r=[],n=0;n<this.boundingBox.length;n++){var i=this.boundingBox[n].clone();i.applyMatrix4(t.matrixWorld),r.push(i)}var o=new u.Box3;return o.setFromPoints(r),e.intersectsBox(o)}},{key:"screenArea",value:function(e,t,r,n){function i(e){function r(e,t,r){return e<=t?t:e>=r?r:e}if(4!==e.length)return console.error("projecting wrong number of vertices",e),0;var i=[];o&&console.log(JSON.stringify(e));for(var s={front:!1,back:!1},l=0;l<e.length;l++){var c=e[l];if(i[l]=a.boundingBox[c].clone(),i[l].applyMatrix4(n.matrixWorld),i[l].applyMatrix4(t),i[l].z>1&&(s.back=!0),i[l].z<1&&(s.front=!0),s.front&&s.back)return o&&console.log("area max"),Math.max(.1,1/a.level);i[l].x=r(i[l].x,-1,1),i[l].y=r(i[l].y,-1,1),i[l].z=0}o&&console.log(JSON.stringify(i));var h=0,d=(new u.Vector3).subVectors(i[0],i[2]),f=(new u.Vector3).subVectors(i[0],i[1]),p=(new u.Vector3).subVectors(i[0],i[3]);o&&console.log(d,f,p);var m=f.clone().cross(d),v=d.clone().cross(p);return o&&console.log(m,v),m.z*v.z<0?h=Math.max(m.z,v.z):(h+=.5*m.z,h+=.5*v.z),h<0&&(h=0),o&&console.log(h),isNaN(h)&&(console.warn("wrong area"),console.warn(a.info()),console.warn(JSON.stringify(a.boundingBox)),console.warn(JSON.stringify(i)),console.warn(JSON.stringify(e))),h}var o=!1,a=this,s=0;return this.isInFrustum(r,n)?(o&&console.log("visible"),s=function(){return i([0,1,2,3])}()+function(){return i([7,6,5,4])}()+.8*function(){return i([3,2,6,7])}()+.8*function(){return i([5,6,2,1])}()+.8*function(){return i([4,5,1,0])}()+.8*function(){return i([0,3,7,4])}(),this.setVisibility(!0)):(this.setVisibility(!1),s=0,o&&console.log("inivisible")),s}},{key:"tileLoader",value:function(){return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"tileLoader",this).call(this)}},{key:"dispose",value:function(){var e=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this);return this.orthoSelectioinMaterial&&this.orthoSelectioinMaterial.dispose(),this.size=void 0,this.boundingBox=void 0,e}},{key:"onLoaded",value:function(e){this.loaded&&console.warn("trying to assign mesh to a loaded tile",this,e),this.options.maxAnisotropy&&e.material&&e.material.map&&(e.material.map.anisotropy=this.options.maxAnisotropy),this.mesh=e,this.options.debug&&console.log("onload",JSON.stringify(this.info())),this.initOrthoSelectionMaterial(this.cropConfig.orthoInfo),this.loaded=!0,this.updateBBox()}},{key:"initBBox",value:function(){var e=this.options.info,t=e.x_dir.clone().multiplyScalar(e.min_bound.x+e.x_unit*this.x),r=e.x_dir.clone().multiplyScalar(e.min_bound.x+e.x_unit*(this.x+this.size)),n=e.y_dir.clone().multiplyScalar(e.min_bound.y+e.y_unit*this.y),i=e.y_dir.clone().multiplyScalar(e.min_bound.y+e.y_unit*(this.y+this.size)),o=e.z1,a=e.z2;if(this.parent){var s=this.parent.boundingBox[0].clone();s.sub(e.origin),o=e.z_dir.clone().multiplyScalar(s.dot(e.z_dir));var l=this.parent.boundingBox[4].clone();l.sub(e.origin),a=e.z_dir.clone().multiplyScalar(l.dot(e.z_dir))}var u=[];return u[0]=e.origin.clone().add(t).add(n).add(o),u[1]=e.origin.clone().add(r).add(n).add(o),u[2]=e.origin.clone().add(r).add(i).add(o),u[3]=e.origin.clone().add(t).add(i).add(o),u[4]=e.origin.clone().add(t).add(n).add(a),u[5]=e.origin.clone().add(r).add(n).add(a),u[6]=e.origin.clone().add(r).add(i).add(a),u[7]=e.origin.clone().add(t).add(i).add(a),u}},{key:"updateBBox",value:function(){function e(t,n,i){for(var o=0;o<t.nodes.length;o++){var a=t.nodes[o];if(!a.loaded){var s=a.boundingBox[0].clone();s.sub(r.origin);var l=r.z_dir.clone().multiplyScalar(s.dot(r.z_dir)),u=a.boundingBox[4].clone();u.sub(r.origin);for(var c=r.z_dir.clone().multiplyScalar(u.dot(r.z_dir)),h=0;h<4;h++)a.boundingBox[h].sub(l).add(n);for(var d=4;d<8;d++)a.boundingBox[d].sub(c).add(i);e(a,n,i)}}}var t=this.options.debug,r=this.options.info;if(t&&console.log("updateBBox",this.info()),void 0===this.mesh||null===this.mesh)return console.warn("updateBBox: mesh is not loaded"),this.boundingBox;this.mesh.geometry.computeBoundingBox();var n=this.mesh.geometry.boundingBox,i=n.min.x,o=n.max.x,a=n.min.y,s=n.max.y,l=n.min.z,c=n.max.z,h=[];h[0]=new u.Vector3(i,a,l),h[1]=new u.Vector3(o,a,l),h[2]=new u.Vector3(o,s,l),h[3]=new u.Vector3(i,s,l),h[4]=new u.Vector3(i,a,c),h[5]=new u.Vector3(o,a,c),h[6]=new u.Vector3(o,s,c),h[7]=new u.Vector3(i,s,c);for(var d=0;d<h.length;d++)this.mesh.updateMatrix(),h[d].applyMatrix4(this.mesh.matrix);for(var f=[],p=0;p<h.length;p++){h[p].sub(r.origin);var m=h[p].clone().dot(r.z_dir);f[p]=m}var v=Math.min.apply(null,f),g=Math.max.apply(null,f),y=r.z_dir.clone().multiplyScalar(v),b=r.z_dir.clone().multiplyScalar(g),_=this.boundingBox[0].clone();_.sub(r.origin);var w=r.z_dir.clone().multiplyScalar(_.dot(r.z_dir)),x=this.boundingBox[4].clone();x.sub(r.origin);for(var M=r.z_dir.clone().multiplyScalar(x.dot(r.z_dir)),E=0;E<4;E++)this.boundingBox[E].sub(w).add(y);for(var A=4;A<this.boundingBox.length;A++)this.boundingBox[A].sub(M).add(b);return e(this,y,b),this.isInScene()&&this.boxMesh&&this.sceneGraphRoot.remove(this.boxMesh),this.boxMesh&&(this.boxMesh.geometry.dispose(),this.boxMesh.material.dispose(),this.boxMesh=this._bBoxMesh()),this.isInScene()&&this.boxMesh&&this.sceneGraphRoot.add(this.boxMesh),this.boundingBox}},{key:"_bBoxMesh",value:function(){var e=this,t=new u.BoxGeometry(1,1,1);t.vertices[0]=e.boundingBox[6].clone(),t.vertices[1]=e.boundingBox[2].clone(),t.vertices[2]=e.boundingBox[5].clone(),t.vertices[3]=e.boundingBox[1].clone(),t.vertices[4]=e.boundingBox[3].clone(),t.vertices[5]=e.boundingBox[7].clone(),t.vertices[6]=e.boundingBox[0].clone(),t.vertices[7]=e.boundingBox[4].clone();var r=new u.MeshPhongMaterial({color:function(e){var t=1e4*Math.sin(e++);return 16777215*(t-Math.floor(t))}(e.level+e.x+e.y),wireframe:!0});return new u.Mesh(t,r)}},{key:"updateDisplayMode",value:function(){if(this.isInScene()){if(this.currentDisplayMode===this.options.displayMode)return console.warn("no need to update material",this.currentDisplayMode,this.options.displayMode),!1;if(void 0===this.mesh)return console.error("expected mesh not in scene",this.info()),!1;var e=this.options.displayMode,t=this.options.viewModeType;if(e===t.TEXTURE){if(null===this.texture_material)return console.warn("texture lost",this.info()),!1;this.mesh.material=this.texture_material,this.texture_material=null}else e===t.FLAT?(this.currentDisplayMode===t.TEXTURE&&(this.texture_material=this.mesh.material),this.mesh.material=this.options.materials.flat):e===t.WIREFRAME?(this.currentDisplayMode===t.TEXTURE&&(this.texture_material=this.mesh.material),this.mesh.material=this.options.materials.wireframe):e===t.SELECT?this.displaySelectionOrCrop(!0):e===t.CROP&&this.displaySelectionOrCrop(!1);this.currentDisplayMode=e}return!0}},{key:"displaySelectionOrCrop",value:function(e){this.currentDisplayMode===this.options.viewModeType.TEXTURE&&null===this.texture_material&&(this.texture_material=this.mesh.material),this.initOrthoSelectionMaterial(this.cropConfig.orthoInfo),e?this.setOrthoSelectionMask(this.cropConfig.selectTex,this.cropConfig.cropTex):this.setCropMask(this.cropConfig.cropTex),this.orthoSelectioinMaterial&&(this.orthoSelectioinMaterial.orthoInfo=this.cropConfig.orthoInfo,this.mesh.material=this.orthoSelectioinMaterial.material)}},{key:"initOrthoSelectionMaterial",value:function(e){if(null===e||void 0===e||null===this.mesh||null===this.mesh.material||null!==this.orthoSelectioinMaterial)return!1;var t=this.mesh.material,r={map:t.map,material:t,info:e,decodeMatrix:this.mesh.matrix,side:this.side};return null!==r.toLoadSpaceMatrix&&void 0!==r.decodeMatrix||console.error("get decode matrix",r.toLoadSpaceMatrix),this.orthoSelectioinMaterial=new m.default(r),!0}},{key:"updateOrthoInfo",value:function(e){this.orthoSelectioinMaterial}},{key:"setOrthoSelectionMask",value:function(e,t){return null===e||void 0===e?(console.log("tex undefined sel",e),!1):!!this.orthoSelectioinMaterial&&(this.orthoSelectioinMaterial.maskTexture=e,this.orthoSelectioinMaterial.cropTexture=t,!0)}},{key:"setCropMask",value:function(e){return null!==e&&void 0!==e||console.log("tex undefined cc",e),!!this.orthoSelectioinMaterial&&(this.orthoSelectioinMaterial.maskTexture=e,this.orthoSelectioinMaterial.cropTexture=e,!0)}},{key:"setVisibility",value:function(e){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setVisibility",this).call(this,e),this.isInScene()&&void 0!==this.mesh&&!this.options.fullScene&&(this.mesh.place_holder?this.mesh.visible=!1:this.mesh.visible=e)}},{key:"_addToSceneGraph",value:function(e){var t=this,r=this.options.debug;void 0===this.mesh?console.warn(JSON.stringify(this.info())+", mesh undefined, cannot add to scene"):void 0===e?console.warn("sceneGraphRoot undefined"):void 0!==this.sceneGraphRoot?console.warn("Twice adding to scene attempt",this.info()):(this.setVisibility(this.visible),e.add(this.mesh),null!==this.boxMesh&&e.add(this.boxMesh),t.sceneGraphRoot=e,t.options.displayMode!==this.currentDisplayMode&&t.updateDisplayMode(),r&&console.log("add to scene",this.info()))}},{key:"_removeFromSceneGraph",value:function(){var e=this,t=this.options.debug,r=!0;return void 0!==this.sceneGraphRoot&&void 0!==this.mesh?(this.sceneGraphRoot.remove(this.mesh),null!==this.boxMesh&&this.sceneGraphRoot.remove(this.boxMesh),e.sceneGraphRoot=void 0,this.mesh.place_holder?this.mesh.visible=!1:this.mesh.visible=!0,0!==this.currentDisplayMode&&(this.mesh.material=this.texture_material,this.texture_material=null,this.currentDisplayMode=0),t&&console.log("remove scene",this.info()),r):(console.warn("_removeFromSceneGraph fail",this),r=!1)}}]),t}(h.default);t.default=v},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0},u=r(0),c=r(48),h=n(c),d=r(43),f=n(d),p=r(68),m=n(p),v=function(e){function t(e,r,n,a,s){i(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,s)),c=s.viewModeType;l.displayMode=c.TEXTURE,l.PID=s.PID,l.info=a,l.maxLevel=a.maxLevel,l.minLevel=a.minLevel,l.max_length=Math.max(a.x_tiles,a.y_tiles),a.x_unit=(a.max_bound.x-a.min_bound.x)/a.x_tiles,a.y_unit=(a.max_bound.y-a.min_bound.y)/a.y_tiles,a.z1=a.z_dir.clone().multiplyScalar(a.floor_height),a.z2=a.z_dir.clone().multiplyScalar(a.max_bound.z),l.smart_options.MIN_AREA=.01*(a.isMobile?2:1);var h=Math.min(Math.max(s.quality||60,0),100),d=Math.min(.8*l.MAX_CACHE_SIZE,80);return l.tree_size_limit=Math.min(d+Math.floor(.8*(l.MAX_CACHE_SIZE-d)*h/100-4),450),l.node_options.isMobile=a.isMobile,l.node_options.displayMode=l.displayMode,l.node_options.info=l.info,l.node_options.basepath=n,l.node_options.showBBox=l.smart_options.bbox,l.node_options.fullScene=l.smart_options.fullScene,l.node_options.maxAnisotropy=s.maxAnisotropy,l.node_options.materials={flat:new u.MeshPhongMaterial({color:8947848,specular:8947848,shininess:30,shading:u.FlatShading}),wireframe:new u.MeshBasicMaterial({color:12303291,wireframe:!0})},l.node_options.viewModeType=c,l.node_options.cropConfig={orthoInfo:null,cropTex:null,selectTex:null},l.node_options.side=s.side,l.dataPath=s.dataPath,l.root=new l.Node(0,0,0,l.max_length,null,l.node_options),l.numOfNodes++,l.altizureApi=s.altizureApi,l.crop_options={editMask:s.editMask,HOST:s.HOST},s.viewMode!==c.SELECT&&s.viewMode!==c.CROP||l.initCrop(),l}return a(t,e),s(t,[{key:"destruct",value:function(){var e=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destruct",this).call(this);return this.cropManager&&(e&=this.cropManager.destruct(),this.cropManager=void 0),this.node_options.cropConfig.cropTex&&(this.node_options.cropConfig.cropTex.dispose(),this.node_options.cropConfig.cropTex=void 0),this.node_options.cropConfig.selectTex&&(this.node_options.cropConfig.selectTex.dispose(),this.node_options.cropConfig.selectTex=void 0),e}},{key:"initCrop",value:function(){var e={PID:this.PID,dataPath:this.dataPath,usage:"crop",maskSize:this.node_options.isMobile?512:2048,info:this.info,tree:this,MaskType:f.default,maxMaskNum:1,edit:this.crop_options.editMask,isDebug:!1,allowWorker:!0,HOST:this.crop_options.HOST,altizureApi:this.altizureApi};this.cropManager=new m.default(e),this.cropManager.downloadAll()}},{key:"setDisplayMode",value:function(e){function t(e){for(var r=e.updateDisplayMode(),n=0;n<e.nodes.length;n++)r=t(e.nodes[n])&&r;return r}if(!{0:!0,1:!0,2:!0,3:!0,4:!0}[e.toString()])return void console.warn("Display mode "+e+" is not supported. Using default mode instead...");if(this.smart_options.debug&&(console.log("setDisplayMode",e),console.log("node_options",this.node_options.displayMode)),e!==this.displayMode){if(this.node_options.displayMode=e,void 0===this.root||null===this.root)return void console.warn("no root available");t(this.root)||console.warn("setDisplayMode has problems"),this.displayMode=e}}},{key:"updateOrthoSelectionMask",value:function(e,t,r){r?this.node_options.cropConfig.selectTex=t:this.node_options.cropConfig.cropTex=t,this.node_options.cropConfig.orthoInfo=e,this.setDisplayMode(this.node_options.viewModeType.TEXTURE),r?this.setDisplayMode(this.node_options.viewModeType.SELECT):this.setDisplayMode(this.node_options.viewModeType.CROP)}},{key:"expand",value:function(e){if(e.level>=this.maxLevel)return console.warn(e,"exceed max level",this.maxLevel),!1;if(e.nodes.length>0)return console.warn(e,"children exist"),!1;if(0===e.nodes.length){for(var t=e.x,r=e.y,n=e.size,i=e.level,o=0;o<4;o++){var a=t+o%2*n*.5,s=r+Math.floor(o/2)*n*.5;e.nodes[o]=new this.Node(a,s,i+1,n/2,e,this.node_options),this.numOfNodes++}return!0}return console.warn("unknown giveBirth error"),!1}}]),t}(h.default);t.default=v},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){n(this,e),this._version="0.0.1"}return i(e,null,[{key:"detectIE",value:function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var r=e.indexOf("rv:");return parseInt(e.substring(r+3,e.indexOf(".",r)),10)}var n=e.indexOf("Edge/");return n>0&&parseInt(e.substring(n+5,e.indexOf(".",n)),10)}},{key:"isMobile",value:function(){return/iPhone|iPod|iPad|Android|BlackBerry/.test(navigator.userAgent)}}]),e}();t.default=o},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(10),s=n(a),l=r(12),u=n(l),c=function(){function e(t){i(this,e),this.apiUrl=t.apiUrl,this.key=t.key,this.altitoken=t.altitoken}return o(e,[{key:"destruct",value:function(){}},{key:"project",value:function(e){var t=e.pid,r=e.timeout?e.timeout:1e4,n='{project(id: "'+t+'") { id name owner { id } views date versionControl cloudPath { key dataUrl } geoInfo { mercatorTransform transformed manualAligned autoAligned minLat minLong maxLat maxLong centerLat centerLong } modelTransform { origin xDir yDir zDir minBound maxBound xTiles yTiles zTiles floorHeight onLoadTrans lengthUnitToMeter }}}';return this._request(n,r).then(function(e){return Promise.resolve(e.data.data.project)}).catch(function(e){return console.error("api:project",e),Promise.reject(e)})}},{key:"my",value:function(e){var t=e&&e.timeout?e.timeout:1e4;return this._request("{my{self{ id name email balance company country joined}\n   projects { edges {node { id name owner {id username name} views date versionControl  cloudPath { key dataUrl }  geoInfo { mercatorTransform transformed manualAligned autoAligned minLat minLong maxLat maxLong centerLat centerLong }  modelTransform { origin xDir yDir zDir minBound maxBound xTiles yTiles zTiles floorHeight onLoadTrans lengthUnitToMeter}}}}}}",t).then(function(e){return Promise.resolve(e.data.data.my)}).catch(function(e){return console.error("api:my",e),Promise.reject(e)})}},{key:"allProjects",value:function(e){var t=e.limit,r=e.timeout?e.timeout:2e4,n="{ allProjects (first: "+t+") { edges { node { id name showLocation visibility geoInfo {autoAligned minLat minLong maxLat maxLong centerLat centerLong } cloudPath {key dataUrl} versionControl  modelTransform { origin xDir yDir zDir minBound maxBound xTiles yTiles zTiles floorHeight onLoadTrans lengthUnitToMeter}  views owner {name joined} date  } } } }";return this._request(n,r).then(function(e){for(var t=[],r=e.data.data.allProjects.edges,n=0;n<r.length;n++)t.push(r[n].node);return Promise.resolve(t)}).catch(function(e){return console.error("api:allProjects",e),Promise.reject(e)})}},{key:"getCountryName",value:function(e){e=e||{};var t=e.timeout?e.timeout:1e4;return this._request("{ getGeoIPInfo { countryName } }",t).then(function(e){var t=e.data.data.getGeoIPInfo.countryName;return Promise.resolve(t)}).catch(function(e){return console.warn("api:getGeoIPInfo",e,"set to China"),Promise.resolve("China")})}},{key:"geoNearProjects",value:function(e){var t=e.limit,r=e.center,n=e.span,i=e.timeout?e.timeout:1e4,o=function(e){var t=e[0],r=e[1];return t<-180?t=-180:t>180&&(t=180),r<-90?r=-90:r>90&&(r=90),[t,r]}([r.lng,r.lat]),a="{ latitude: "+o[1]+", longitude:"+o[0]+" }",s="{geoNearProjects(center: "+a+", span:"+n+", limit: "+t+") {id name visibility geoInfo {autoAligned minLat minLong maxLat maxLong centerLat centerLong } cloudPath {key dataUrl} versionControl  modelTransform { origin xDir yDir zDir minBound maxBound xTiles yTiles zTiles floorHeight onLoadTrans lengthUnitToMeter}  views owner {name joined} date }}";return this._request(s,i).then(function(e){var t=e.data.data.geoNearProjects;return Promise.resolve(t)}).catch(function(e){return console.error("api:geoNearProjects",e),Promise.reject(e)})}},{key:"_request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,r={key:this.key};return this.altitoken&&(r.altitoken=this.altitoken),(0,s.default)({method:"post",url:this.apiUrl,timeout:t,headers:r,data:"query="+e,responseType:"json"})}},{key:"cropMask",value:function(e){var t=e.pid,r=e.timeout?e.timeout:1e4,n='{project(id: "'+t+'") { \n      cropMask { \n        usage \n        maskBox { minX minY maxX maxY } \n        maskInfos { polyNum width height data } \n      } \n    }}';return this._request(n,r).then(function(e){return Promise.resolve(e.data.data.project.cropMask)}).catch(function(e){return console.error("api:cropMask",e),Promise.reject(e)})}},{key:"waterMask",value:function(e){var t=e.pid,r=e.timeout?e.timeout:1e4,n='{project(id: "'+t+'"){\n      waterMask {\n        maskInfos { level alpha wave color polyNum width height data }\n        maskBox { minX minY maxX maxY }\n      }\n    }}';return this._request(n,r).then(function(e){return Promise.resolve(e.data.data.project.waterMask)}).catch(function(e){return console.error("api:waterMask",e),Promise.reject(e)})}},{key:"projectMask",value:function(e){var t=e.pid,r=e.usage;return"crop"===r?this.cropMask({pid:t}):"water"===r?this.waterMask({pid:t}):Promise.reject(new Error("Unknown mask usage "+r))}},{key:"solution",value:function(e){var t=e.sid,r=e.timeout?e.timeout:1e4,n='{\n      solution (id: "'+t+'") {\n        id name visibility scene history owner {\n          name\n        }\n      }\n    }';return this._request(n,r).then(function(e){var t=e.data.data.solution;if("string"==typeof t.scene&&t.scene.length>0){var r=u.default.AES.decrypt(decodeURIComponent(t.scene),"altizure-environment").toString(u.default.enc.Utf8);t.scene=r}else console.warn("scene",t);return Promise.resolve(t)}).catch(function(e){return console.error("api:solution",e),Promise.reject(e)})}},{key:"createProjectSolution",value:function(e){var t=e.name,r=e.timeout?e.timeout:1e4,n='mutation{\n      createProjectSolution(name: "'+t+'"){\n        id name scene history owner {\n          id name\n        }\n      }\n    }';return this._request(n,r).then(function(e){return Promise.resolve(e.data.data.createProjectSolution)}).catch(function(e){return console.error("api:createProjectSolution",e),Promise.reject(e)})}},{key:"updateProjectSolution",value:function(e){var t=e.id,r=e.options.data.name,n=u.default.AES.encrypt(e.options.data.scene,"altizure-environment").toString(),i=encodeURIComponent(n),o=void 0!==e.options.preserveScene&&e.options.preserveScene,a=e.timeout?e.timeout:1e4,s='mutation{\n      updateProjectSolution(\n        id: "'+t+'", \n        options: {\n          data: {name: "'+r+'", scene: "'+i+'"}, \n          preserveScene: '+o+"\n        }\n      ){\n        id name scene history owner {\n          id name\n        }\n      }\n    }";return this._request(s,a).then(function(e){return Promise.resolve(e.data.data.updateProjectSolution)}).catch(function(e){return console.error("api:updateProjectSolution",e),Promise.reject(e)})}},{key:"removeProjectSolution",value:function(e){var t=e.id,r=e.timeout?e.timeout:1e4,n='mutation{\n      removeProjectSolution(id: "'+t+'"){\n        id name scene history owner {\n          id name\n        }\n      }\n    }';return this._request(n,r).then(function(e){return Promise.resolve(e.data.data.removeProjectSolution)}).catch(function(e){return console.error("api:createProjectSolution",e),Promise.reject(e)})}},{key:"altitoken",set:function(e){this._altitoken=e},get:function(){return this._altitoken}},{key:"key",set:function(e){this._key=e},get:function(){return this._key}}]),e}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){var e=1,t=new n.Matrix4,r=new n.Matrix4,i=new n.Matrix4;this.objToViewer=function(e){return e.applyMatrix4(r)},this.viewerToObj=function(e){return e.applyMatrix4(i)},this.tileToWorld=function(e){return e.applyMatrix4(t)},this.set=function(o){t=o.onload||t,e=o.scale||e;var a=1/e;r=t.clone().multiply((new n.Matrix4).makeScale(a,a,a)),i=(new n.Matrix4).getInverse(r)},this.getOnloadMatrix=function(){return t.clone()},this.getOnloadMatrixRef=function(){return t},this.getViewerToObjMatrix=function(){return i.clone()},this.getObjToViewerMatrix=function(){return r.clone()},this.profileToWorld=function(e,t,r,n,i){var o=t.clone().multiplyScalar(i.x),a=r.clone().multiplyScalar(i.y),s=n.clone().multiplyScalar(i.z);return e.clone().add(o).add(a).add(s)},this.getBBoxCoord=function(e,t){return[this.profileToWorld(e.origin,e.x_dir,e.y_dir,e.z_dir,e.min_bound),this.profileToWorld(e.origin,e.x_dir,e.y_dir,e.z_dir,e.max_bound)]},this.transBBox=function(e,t,r,i,o,a,s){var l=new Array(8);l[0]=e.clone(),l[1]=new n.Vector3(e.x,t.y,e.z),l[2]=new n.Vector3(t.x,e.y,e.z),l[3]=new n.Vector3(t.x,t.y,e.z);for(var u=0;u<4;++u)l[u+4]=l[u].clone().setZ(t.z);for(var c=new Array(2),h=0;h<8;++h){var d=this.profileToWorld(r,i,o,a,l[h]);s&&d.applyMatrix4(s),0===h?(c[0]=d.clone(),c[1]=d.clone()):(c[0].x=Math.min(c[0].x,d.x),c[0].y=Math.min(c[0].y,d.y),c[0].z=Math.min(c[0].z,d.z),c[1].x=Math.max(c[1].x,d.x),c[1].y=Math.max(c[1].y,d.y),c[1].z=Math.max(c[1].z,d.z))}return c},this.getTransBBox=function(e,r){return this.transBBox(e.min_bound,e.max_bound,e.origin,e.x_dir,e.y_dir,e.z_dir,r?t:null)}};t.default=i},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.AtmosphereSelfShaderMaterial=t.GroundSelfShaderMaterial=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),l={Kr:.0025,Km:.001,ESun:20,g:-.95,innerRadius:.999,outerRadius:1.00505,wavelength:[.65,.57,.475],scaleDepth:.25},u={uniforms:{center:{type:"v3",value:new s.Vector3(0,0,0)},focus:{type:"v3",value:new s.Vector3(0,0,0)},v3InvWavelength:{type:"v3",value:new s.Vector3(1/Math.pow(l.wavelength[0],4),1/Math.pow(l.wavelength[1],4),1/Math.pow(l.wavelength[2],4))},fInnerRadius:{type:"f",value:l.innerRadius},fInnerRadius2:{type:"f",value:l.innerRadius*l.innerRadius},fOuterRadius:{type:"f",value:l.outerRadius},fOuterRadius2:{type:"f",value:l.outerRadius*l.outerRadius},fKrESun:{type:"f",value:l.Kr*l.ESun},fKmESun:{type:"f",value:l.Km*l.ESun},fKr4PI:{type:"f",value:4*l.Kr*Math.PI},fKm4PI:{type:"f",value:4*l.Km*Math.PI},fScale:{type:"f",value:1/(l.outerRadius-l.innerRadius)},fScaleDepth:{type:"f",value:l.scaleDepth},fScaleOverScaleDepth:{type:"f",value:1/(l.outerRadius-l.innerRadius)/l.scaleDepth},g:{type:"f",value:l.g},g2:{type:"f",value:l.g*l.g},nSamples:{type:"i",value:3},fSamples:{type:"f",value:3},fNightScale:{type:"f",value:1},fExposure:{type:"f",value:2}},vertexShader_atmosphere:"\n  //\n  // Atmospheric scattering vertex shader\n  //\n  // Author: Sean O'Neil\n  //\n  // Copyright (c) 2004 Sean O'Neil\n  //\n  uniform vec3 v3InvWavelength; // 1 / pow(wavelength, 4) for the red, green, and blue channels\n  uniform float fOuterRadius;   // The outer (atmosphere) radius\n  uniform float fOuterRadius2;  // fOuterRadius^2\n  uniform float fInnerRadius;   // The inner (planetary) radius\n  uniform float fInnerRadius2;  // fInnerRadius^2\n  uniform float fKrESun;      // Kr * ESun\n  uniform float fKmESun;      // Km * ESun\n  uniform float fKr4PI;     // Kr * 4 * PI\n  uniform float fKm4PI;     // Km * 4 * PI\n  uniform float fScale;     // 1 / (fOuterRadius - fInnerRadius)\n  uniform float fScaleDepth;    // The scale depth (i.e. the altitude at which the atmosphere's average density is found)\n  uniform float fScaleOverScaleDepth; // fScale / fScaleDepth\n\n  uniform vec3 center;\n\n  const int nSamples = 3;\n  const float fSamples = 3.0;\n  varying vec3 v3Direction;\n  varying vec3 c0;\n  varying vec3 c1;\n  varying float depth;\n  varying vec3 v3LightPosition;\n\n  float scale(float fCos)\n  {\n    float x = 1.0 - fCos;\n    return fScaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n  }\n  void main(void)\n  {\n    // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n\n    vec3 modelPos = (modelMatrix * vec4(position, 1.0)).xyz;\n    vec3 translatedPosition = modelPos - center;\n    vec3 translatedCameraPosition = cameraPosition - center;\n\n    float fCameraHeight = max(0.0, length(cameraPosition - center));\n    float fCameraHeight2 = pow(fCameraHeight, 2.0);\n\n    v3LightPosition = normalize(vec3(1e8, 1e8, 1e8));\n\n    vec3 v3Ray = translatedPosition - translatedCameraPosition;\n\n    float fFar = length(v3Ray);\n    v3Ray /= fFar;\n    vec3 v3Start;\n    float fStartOffset;\n    if(fCameraHeight>fOuterRadius){\n      // camera in space\n      // Calculate the closest intersection of the ray with the outer atmosphere (which is the near point of the ray passing through the atmosphere)\n      float B = 2.0 * dot(translatedCameraPosition, v3Ray);\n      float C = fCameraHeight2 - fOuterRadius2;\n      float fDet = max(0.0, B*B - 4.0 * C);\n      float fNear = 0.5 * (-B - sqrt(fDet));\n      // Calculate the ray's starting position, then calculate its scattering offset\n      v3Start = translatedCameraPosition + v3Ray * fNear;\n      fFar -= fNear;\n      float fStartAngle = dot(v3Ray, v3Start) / fOuterRadius;\n      float fStartDepth = exp(-1.0 / fScaleDepth);\n      fStartOffset = fStartDepth * scale(fStartAngle);\n      depth = clamp(fStartOffset, 0.0, 1.0);\n    }else{\n      // camera in atmosphere\n      v3Start = translatedCameraPosition;\n      float fHeight = length(v3Start);\n\n      // float closeSurfaceDiff = min(0.0001 * (fInnerRadius - fOuterRadius), (fInnerRadius - fHeight));\n      float closeSurfaceDiff = min(0.0, (fInnerRadius - fHeight));\n      float fDepth = exp(fScaleOverScaleDepth * closeSurfaceDiff);\n      // float fDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fCameraHeight));\n      \n      float fStartAngle = dot(v3Ray, v3Start) / fHeight;\n      fStartOffset = fDepth*scale(fStartAngle);\n      // float fStartDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fCameraHeight));\n      float fStartDepth = exp(fScaleOverScaleDepth * closeSurfaceDiff);\n      depth = clamp(fStartDepth*scale(fStartAngle),0.0,1.0);\n    }\n    // Initialize the scattering loop variables\n    float fSampleLength = fFar / fSamples;\n    float fScaledLength = fSampleLength * fScale;\n    vec3 v3SampleRay = v3Ray * fSampleLength;\n    vec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;\n    // Now loop through the sample rays\n    vec3 v3FrontColor = vec3(0.0, 0.0, 0.0);\n    for(int i=0; i<nSamples; i++)\n    {\n      float fHeight = length(v3SamplePoint);\n      // float closeSurfaceDiff = min(0.0001 * (fInnerRadius - fOuterRadius), (fInnerRadius - fHeight));\n      // float fDepth = exp(fScaleOverScaleDepth * closeSurfaceDiff);\n      // if (fInnerRadius >= fHeight) break;\n      float fDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fHeight));\n      float fLightAngle = dot(v3LightPosition, v3SamplePoint) / fHeight;\n      float fCameraAngle = dot(v3Ray, v3SamplePoint) / fHeight;\n      float fScatter = (fStartOffset + fDepth * (scale(fLightAngle) - scale(fCameraAngle)));\n      vec3 v3Attenuate = exp(-fScatter * (v3InvWavelength * fKr4PI + fKm4PI));\n      v3FrontColor += v3Attenuate * (fDepth * fScaledLength);\n      v3SamplePoint += v3SampleRay;\n    }\n    // Finally, scale the Mie and Rayleigh colors and set up the varying variables for the pixel shader\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    c0 = v3FrontColor * (v3InvWavelength * fKrESun);\n    c1 = v3FrontColor * fKmESun;\n\n    v3Direction = translatedCameraPosition - translatedPosition;\n  }\n  ",fragmentShader_atmosphere:"\n  //\n  // Atmospheric scattering fragment shader\n  //\n  // Author: Sean O'Neil\n  //\n  // Copyright (c) 2004 Sean O'Neil\n  //\n  uniform float fExposure;\n  varying vec3 v3LightPosition;\n  uniform float g;\n  uniform float g2;\n  uniform float fOuterRadius;   // The outer (atmosphere) radius\n\n  uniform vec3 center;\n\n  varying vec3 v3Direction;\n  varying vec3 c0;\n  varying vec3 c1;\n  varying float depth;\n  // Calculates the Mie phase function\n  float getMiePhase(float fCos, float fCos2, float g, float g2)\n  {\n    return 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + fCos2) / pow(max(0.0, 1.0 + g2 - 2.0 * g * fCos), 1.5);\n  }\n  // Calculates the Rayleigh phase function\n  float getRayleighPhase(float fCos2)\n  {\n    return 0.75 + 0.75 * fCos2;\n  }\n  void main (void)\n  {\n    float fCameraHeight = length(cameraPosition - center);\n\n    float fCos = dot(v3LightPosition, v3Direction) / length(v3Direction);\n    float fCos2 = fCos * fCos;\n    float rayleighPhase = getRayleighPhase(fCos2);\n    float miePhase = getMiePhase(fCos, fCos2, g, g2);\n    float sun = 2.0*((1.0 - 0.2) / (2.0 + 0.2)) * (1.0 + fCos*fCos) / pow(max(0.0, 1.0 + 0.2 - 2.0*(-0.2)*fCos), 1.0);\n    vec3 color = rayleighPhase * c0 +\n            miePhase * c1 +\n            depth * sun * vec3(0.05,0.05,0.1);\n    color = vec3(1.0) - exp(-fExposure*color);\n    float nightmult = clamp(max(color.x, max(color.y, color.z))*1.5,0.0,1.0);\n    gl_FragColor = vec4(color, nightmult);\n    if(fCameraHeight<=fOuterRadius)gl_FragColor.a = nightmult + fOuterRadius - fCameraHeight;\n  }\n  ",vertexShader_ground:"\n  //\n  // Atmospheric scattering vertex shader\n  //\n  // Author: Sean O'Neil\n  //\n  // Copyright (c) 2004 Sean O'Neil\n  //\n  // Ported for use with three.js/WebGL by James Baicoianu\n  varying vec3 v3LightPosition;   // The direction vector to the light source\n  uniform vec3 v3InvWavelength; // 1 / pow(wavelength, 4) for the red, green, and blue channels\n  uniform vec3 focus; // focus point on earth in earth space\n  uniform float fOuterRadius;   // The outer (atmosphere) radius\n  uniform float fOuterRadius2;  // fOuterRadius^2\n  uniform float fInnerRadius;   // The inner (planetary) radius\n  uniform float fInnerRadius2;  // fInnerRadius^2\n  uniform float fKrESun;      // Kr * ESun\n  uniform float fKmESun;      // Km * ESun\n  uniform float fKr4PI;     // Kr * 4 * PI\n  uniform float fKm4PI;     // Km * 4 * PI\n  uniform float fScale;     // 1 / (fOuterRadius - fInnerRadius)\n  uniform float fScaleDepth;    // The scale depth (i.e. the altitude at which the atmosphere's average density is found)\n  uniform float fScaleOverScaleDepth; // fScale / fScaleDepth\n  uniform sampler2D tDiffuse;\n\n  uniform vec3 center;\n\n  varying vec3 v3Direction;\n  varying vec3 c0;\n  varying vec3 c1;\n  varying vec2 vUv;\n  const int nSamples = 3;\n  const float fSamples = 3.0;\n  float scale(float fCos)\n  {\n    float x = 1.0 - fCos;\n    return fScaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n  }\n  void main(void)\n  {\n    // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n    vec3 modelPos = (modelMatrix * vec4(position, 1.0)).xyz;\n    vec3 translatedPosition = modelPos - center;\n    vec3 translatedCameraPosition = cameraPosition - center;\n\n    float fCameraHeight = max(0.0, length(cameraPosition - center));\n    float fCameraHeight2 = pow(fCameraHeight, 2.0);\n    \n    // vec3 focusWorld = (modelMatrix * vec4(focus, 1.0)).xyz - center;\n    // v3LightPosition = normalize(focusWorld);\n    v3LightPosition = normalize(vec3(1e8, 1e8, 1e8));\n\n    vec3 v3Ray = translatedPosition - translatedCameraPosition;\n    float fFar = length(v3Ray);\n    v3Ray /= fFar;\n    vec3 v3Start;\n    if(fCameraHeight>fOuterRadius){\n        // Calculate the closest intersection of the ray with the outer atmosphere (which is the near point of the ray passing through the atmosphere)\n      float B = 2.0 * dot(translatedCameraPosition, v3Ray);\n      float C = fCameraHeight2 - fOuterRadius2;\n      float fDet = max(0.0, B*B - 4.0 * C);\n      float fNear = 0.5 * (-B - sqrt(fDet));\n      // Calculate the ray's starting position, then calculate its scattering offset\n      v3Start = translatedCameraPosition + v3Ray * fNear;\n      fFar -= fNear;\n    }else{\n      v3Start = translatedCameraPosition;\n    }\n    float fDepth = exp((fInnerRadius - fOuterRadius) / fScaleDepth);\n    float fCameraAngle = dot(-v3Ray, translatedPosition) / length(translatedPosition);\n    float fLightAngle = dot(v3LightPosition, translatedPosition) / length(translatedPosition);\n    float fCameraScale = scale(fCameraAngle);\n    float fLightScale = scale(fLightAngle);\n    float fCameraOffset = fDepth*fCameraScale;\n    float fTemp = (fLightScale + fCameraScale);\n    // Initialize the scattering loop variables\n    float fSampleLength = fFar / fSamples;\n    float fScaledLength = fSampleLength * fScale;\n    vec3 v3SampleRay = v3Ray * fSampleLength;\n    vec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;\n    // Now loop through the sample rays\n    vec3 v3FrontColor = vec3(0.0, 0.0, 0.0);\n    vec3 v3Attenuate;\n    for(int i=0; i<nSamples; i++)\n    {\n      float fHeight = length(v3SamplePoint);\n      float closeSurfaceDiff = min(0.6 * (fInnerRadius - fOuterRadius), (fInnerRadius - fHeight));\n      // float closeSurfaceDiff = min(0.0, (fInnerRadius - fHeight));\n      float fDepth = exp(fScaleOverScaleDepth * closeSurfaceDiff);\n      fCameraOffset = clamp(fCameraOffset, -0.1, 0.1);\n      float fScatter = fDepth*fTemp - fCameraOffset;\n      // float fScatter = fDepth*fTemp;\n      // origianlly float fScatter = fDepth*fTemp - fCameraOffset;\n      v3Attenuate = exp(-fScatter * (v3InvWavelength * fKr4PI + fKm4PI));\n      v3FrontColor += v3Attenuate * (fDepth * fScaledLength);\n      v3SamplePoint += v3SampleRay;\n    }\n    // Calculate the attenuation factor for the ground\n    c0 = v3Attenuate;\n    c1 = v3FrontColor * (v3InvWavelength * fKrESun + fKmESun);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    vUv = uv;\n  }\n  ",fragmentShader_ground:"\n  //\n  // Atmospheric scattering fragment shader\n  //\n  // Author: Sean O'Neil\n  //\n  // Copyright (c) 2004 Sean O'Neil\n  //\n  // Ported for use with three.js/WebGL by James Baicoianu\n  uniform float fNightScale;\n  varying vec3 v3LightPosition;\n  uniform sampler2D tDiffuse;\n  varying vec3 c0;\n  varying vec3 c1;\n  varying vec2 vUv;\n  uniform float fExposure;\n\n  uniform vec3 center;\n\n  // void main (void)\n  // {\n  //   vec3 diffuseTex = texture2D( tDiffuse, vUv ).xyz;\n  //   vec3 diffuseNightTex = diffuseTex * 0.1;\n  //   vec3 day = diffuseTex * c0;\n  //   vec3 night = fNightScale * diffuseNightTex * diffuseNightTex * diffuseNightTex * (1.0 - c0);\n  //   vec3 color = c1 + day + night;\n  //   color = 1.0 - exp(-fExposure * color);\n  //   gl_FragColor = vec4(color, 1.0);\n  // }\n\n  void main (void)\n  {\n    vec3 diffuseTex = texture2D( tDiffuse, vUv ).xyz;\n    vec3 diffuseNightTex = diffuseTex * 0.1;\n    vec3 day = diffuseTex * c0;\n    vec3 night = fNightScale * diffuseNightTex * diffuseNightTex * diffuseNightTex * (1.0 - c0);\n    vec3 color = c1 + day + night;\n    color = 1.0 - exp(-fExposure * color);\n    gl_FragColor = vec4(color, 1.0);\n  }\n  "},c=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.uniforms=u.uniforms,r.vertexShader=u.vertexShader_atmosphere,r.fragmentShader=u.fragmentShader_atmosphere,r.transparent=!0,r.extensions.derivatives=!0,r.side=s.BackSide,r.depthWrite=!1,r}return o(t,e),a(t,[{key:"passCameraHeight",value:function(e){this.uniforms.fCameraHeight.value=e,this.uniforms.fCameraHeight2.value=e*e}},{key:"setExposure",value:function(e){this.uniforms.fExposure.value=e}},{key:"setCenter",value:function(e){this.uniforms.center.value=e}},{key:"setFocus",value:function(e){this.uniforms.focus.value=e}}]),t}(s.ShaderMaterial),h=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));r.uniforms={tDiffuse:{type:"t",value:null}};for(var o=Object.keys(u.uniforms),a=0;a<o.length;a++)r.uniforms[o[a]]=u.uniforms[o[a]];return r.vertexShader=u.vertexShader_ground,r.fragmentShader=u.fragmentShader_ground,r.transparent=!1,r.extensions.derivatives=!0,r}return o(t,e),a(t,[{key:"passCameraHeight",value:function(e){this.uniforms.fCameraHeight.value=e,this.uniforms.fCameraHeight2.value=e*e}},{key:"loadGroundTexture",value:function(e){var t=this;(new s.TextureLoader).load(e,function(e){t.uniforms.tDiffuse.value=e,console.log(e)},function(t){console.log(t.loaded/t.total*100+"% loaded "+e)},function(e){console.log("An error happened")})}},{key:"setTexture",value:function(e){this.uniforms.tDiffuse.value=e}},{key:"setExposure",value:function(e){this.uniforms.fExposure.value=e}},{key:"setCenter",value:function(e){this.uniforms.center.value=e}}]),t}(s.ShaderMaterial);t.GroundSelfShaderMaterial=h,t.AtmosphereSelfShaderMaterial=c},function(e,t,r){"use strict";function n(e){this.size=0,this.limit=e,this._keymap={}}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.prototype.put=function(e,t){var r={key:e,value:t};if(this._keymap[e]=r,this.tail?(this.tail.newer=r,r.older=this.tail):this.head=r,this.tail=r,this.size===this.limit)return this.shift();this.size++},n.prototype.shift=function(){var e=this.head;return e&&(this.head.newer?(this.head=this.head.newer,this.head.older=void 0):this.head=void 0,e.newer=e.older=void 0,delete this._keymap[e.key]),e},n.prototype.get=function(e,t){var r=this._keymap[e];if(void 0!==r)return r===this.tail?t?r:r.value:(r.newer&&(r===this.head&&(this.head=r.newer),r.newer.older=r.older),r.older&&(r.older.newer=r.newer),r.newer=void 0,r.older=this.tail,this.tail&&(this.tail.newer=r),this.tail=r,t?r:r.value)},n.prototype.find=function(e){return this._keymap[e]},n.prototype.set=function(e,t){var r,n=this.get(e,!0);return n?(r=n.value,n.value=t):(r=this.put(e,t))&&(r=r.value),r},n.prototype.remove=function(e){var t=this._keymap[e];if(t)return delete this._keymap[t.key],t.newer&&t.older?(t.older.newer=t.newer,t.newer.older=t.older):t.newer?(t.newer.older=void 0,this.head=t.newer):t.older?(t.older.newer=void 0,this.tail=t.older):this.head=this.tail=void 0,this.size--,t.value},n.prototype.removeAll=function(){this.head=this.tail=void 0,this.size=0,this._keymap={}},"function"==typeof Object.keys?n.prototype.keys=function(){return Object.keys(this._keymap)}:n.prototype.keys=function(){var e=[];for(var t in this._keymap)e.push(t);return e},n.prototype.forEach=function(e,t,r){var n;if(!0===t?(r=!0,t=void 0):"object"!==(void 0===t?"undefined":i(t))&&(t=this),r)for(n=this.tail;n;)e.call(t,n.key,n.value,this),n=n.older;else for(n=this.head;n;)e.call(t,n.key,n.value,this),n=n.newer},n.prototype.toJSON=function(){for(var e=[],t=this.head;t;)e.push({key:t.key.toJSON(),value:t.value.toJSON()}),t=t.newer;return e},n.prototype.toString=function(){for(var e="",t=this.head;t;)e+=String(t.key)+":"+t.value,(t=t.newer)&&(e+=" < ");return e},t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={getMeshes:function(e){return e},getTileFromMesh:function(e){return e.parent.parent},makeTileName:function(e,t,r){return e+"_"+t+"_"+r},parseTileName:function(e){var t=e.split("_");return{level:t[0],x:t[1],y:t[2]}},getNumOfFaces:function(e){if(!e.hasOwnProperty("name"))return 0;if(""===e.name)return 0;for(var t=0,r=n.getMeshes(e),i=0;i<r.length;++i)t+=r[i].geometry.getIndex().count/3;return t},getNumOfVertices:function(e){if(!e.hasOwnProperty("name"))return 0;if(""===e.name)return 0;for(var t=0,r=n.getMeshes(e),i=0;i<r.length;++i)t+=r[i].geometry.getAttribute("position").count;return t}};t.default=n},function(e,t,r){"use strict";function n(){var e=[],t=0;this.getLength=function(){return e.length-t},this.isEmpty=function(){return 0===e.length},this.enqueue=function(t){e.push(t)},this.dequeue=function(){if(0!==e.length){var r=e[t];return 2*++t>=e.length&&(e=e.slice(t),t=0),r}},this.peek=function(){return e.length>0?e[t]:void 0},this.clear=function(){e=[],t=0}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};n.isMobile=/iPhone|iPod|iPad|Android|BlackBerry/.test(navigator.userAgent),n.createDiv=function(e,t,r,n){var i=document.createElement("div");return"undefined"!=typeof id&&(i.id=t+"_div"),void 0!==t&&(i.className=t),void 0!==r&&(i.style.cssText=r),void 0!==n&&(i.innerHTML=n),e.appendChild(i),i},t.default=n},function(e,t,r){!function(n,i){e.exports=t=function(e){!function(){var t=e,r=t.lib,n=r.Base,i=t.enc,o=i.Utf8;t.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var r=e.blockSize,n=4*r;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),a=this._iKey=t.clone(),s=i.words,l=a.words,u=0;u<r;u++)s[u]^=1549556828,l[u]^=909522486;i.sigBytes=a.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})}()}(r(1))}()},function(e,t,r){!function(n,i){e.exports=t=function(e){return function(){var t=e,r=t.lib,n=r.WordArray,i=r.Hasher,o=t.algo,a=[],s=o.SHA1=i.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],s=r[3],l=r[4],u=0;u<80;u++){if(u<16)a[u]=0|e[t+u];else{var c=a[u-3]^a[u-8]^a[u-14]^a[u-16];a[u]=c<<1|c>>>31}var h=(n<<5|n>>>27)+l+a[u];h+=u<20?1518500249+(i&o|~i&s):u<40?1859775393+(i^o^s):u<60?(i&o|i&s|o&s)-1894007588:(i^o^s)-899497514,l=s,s=o,o=i<<30|i>>>2,i=n,n=h}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+s|0,r[4]=r[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(n+64>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA1=i._createHelper(s),t.HmacSHA1=i._createHmacHelper(s)}(),e.SHA1}(r(1))}()},function(e,t,r){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(10),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s={},l=function(){function e(t){n(this,e),this.dataPath=t,this.report={content:null,loading:!1,read:!1},this.db={content:null,loading:!1,ready:!1},this.callbacks=[],this.callbacks_db=[]}return i(e,[{key:"_readReport",value:function(e){var t=this.dataPath+"/param.json",r=this.dataPath+"/final_report.json",n=this.report;return(0,a.default)({method:"get",url:t,responseType:"json",timeout:3e4}).then(function(t){var r=t.data;n.content=r,e()}).catch(function(t){return(0,a.default)({method:"get",url:r,responseType:"json",timeout:3e4}).then(function(t){var r=t.data;n.content=r,e()}).catch(function(t){e()})})}},{key:"getReport",value:function(e){var t=this,r=this.report;if(r.read)return void e(r.content);this.callbacks.push(e),r.loading||(r.loading=!0,this._readReport(function(){r.read=!0,r.loading=!1,t.callbacks.map(function(e){e(r.content)}),t.callbacks=[]}))}},{key:"_readDatabase",value:function(e){var t=this.dataPath+"/db.json",r=this.db;(0,a.default)({method:"get",url:t,responseType:"json",timeout:3e4}).then(function(t){var n=t.data;r.content=n,e()}).catch(function(t){e()})}},{key:"getDatabase",value:function(e){var t=this,r=this.db;if(r.ready)return void e(r.content);this.callbacks_db.push(e),r.loading||(r.loading=!0,this._readDatabase(function(){r.ready=!0,r.loading=!1,t.callbacks_db.map(function(e){e(r.content)}),t.callbacks_db=[]}))}}],[{key:"getInstance",value:function(t){var r=t;return s[r]||(s[r]=new e(r)),s[r]}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=r(12),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function e(t){n(this,e);var r={"www.altizure.com":!0,"beta.altizure.com":!0,"www.altizure.cn":!0,"127.0.0.1":!0,localhost:!0},i=void 0;t&&t.HOST&&(i=o.default.AES.decrypt(t.HOST,"altizure-environment").toString(o.default.enc.Utf8),r[i]=!0),i&&"TilesViewerLocal"===i?this.baseURL="https://www.altizure.com":"127.0.0.1"===window.location.hostname?this.baseURL="https://www.altizure.com":this.baseURL=r[window.location.hostname]?window.location.protocol+"//"+window.location.host:"https://www.altizure.com",this.postConfig={headers:{"Content-Type":"application/json; charset=UTF-8"},credentials:"include"}};t.default=a},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(17),u=n(l),c=r(15),h=n(c),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.viewer=e.viewer,r.updateMaskFormat=e.updateMaskFormat,r.normalTex=null,r.downloadSucess=!1,r.isDebug=!1,r}return a(t,e),s(t,[{key:"destruct",value:function(){var e=this;h.default.prototype.destruct.call(this),this.viewer.cameraControls.removeEventListener("changing",e._updateLightDirection),e.directionalLight_water&&e.directionalLight_water.dispose()}},{key:"updateDBFormat",value:function(){this.service.preProcess&&(console.log("0. update db format ...",this.service.preProcess),this.service.preProcess())}},{key:"downloadAll",value:function(){var e=this;this.updateMaskFormat&&e.updateDBFormat(),e.isDebug&&console.log("1. download normal tex ..."),e.service.getNormalTex(function(t){t&&(e.normalTex=t,e.isDebug&&(console.log("normal tex loaded",e.normalTex),console.log("2. download water settings ...")),e._downloadSettings(u.default,function(){}))})}},{key:"_defaultMaskOpts",value:function(e){var t=h.default.prototype._defaultMaskOpts.call(this);return t.viewer=this.viewer,t.show=!0,t.directionalLight_water=this.directionalLight_water,t.normalTex=this.normalTex,t.createDefault=!1,t.maskId=e,t.default_properties=this.default_properties,t}},{key:"renderWaters",value:function(){for(var e in this.maskSettings)this.maskSettings[e].render()}},{key:"removeWater",value:function(e){this.maskSettings[e]&&(this.maskSettings[e].remove(),delete this.maskSettings[e],this.isDebug&&console.log("after delete #",Object.keys(this.maskSettings)),this.nameCnt=0,this.isModified=!0)}},{key:"setCamera",value:function(e){console.warn("WaterManager setCamera");for(var t in this.maskSettings)this.maskSettings[t].setCamera(e)}}]),t}(h.default);t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),s=r(29),l=n(s),u=r(11),c=n(u),h=r(19),d=n(h),f=r(7),p=n(f),m=r(86),v=n(m),g=r(89),y=n(g),b=r(50),_=n(b),w=r(84),x=n(w),M=r(3),E=n(M),A=r(13),T=n(A),k=r(40),S=n(k),C=r(96),P=n(C),O=r(41),R=n(O),L=r(23),I=n(L),B=r(82),D=n(B),j=function(){function e(t,r){function n(){function e(e,t){var r=[];if("private"===e.visibility)console.warn("private project");else for(var n=0;n<e.length;n++){var i=e[n];if(!t||i.showLocation&&void 0!==i.geoInfo&&i.geoInfo.autoAligned&&i.geoInfo.centerLong&&i.geoInfo.minLong)try{var o=new P.default;o.id=i.id,o.name=i.name,o.views=i.views,o.owner={name:i.owner.name||"unknown",joined:i.owner.joined||"unknown"},o.date=i.date,o.geoInfo={autoAligned:i.geoInfo.autoAligned,minLat:i.geoInfo.minLat,minLong:i.geoInfo.minLong,maxLat:i.geoInfo.maxLat,maxLong:i.geoInfo.maxLong,centerLat:i.geoInfo.centerLat,centerLong:i.geoInfo.centerLong},o.cloudPath=i.cloudPath,o.versionControl=i.versionControl||"",o.modelTransform=i.modelTransform,o.valid?r.push(o):console.warn("invalid",i)}catch(e){console.log("response",e)}}return r}var t=m.config.isMobile?20:50,r=[];if(m.config.renderItems.featureInView){var n={promiseFn:function(n){var i=m.control.getFocus(),o={lng:i.geo.lng,lat:i.geo.lat},a=Math.min(Math.max(i.distance/m.scale/1.5*60,.05),89);return m._api.geoNearProjects({limit:t,center:o,span:a}).then(function(t){var n=e(t);return m.addAltizureProjects(r.concat(n))})},timer:2e3,timeout:1e4,debug:!1};w=new R.default(n);var i=0;m.control.addEventListener("change",function(){w.add({message:i}),i++}),m._api.allProjects({limit:t}).then(function(n){var i=e(n,!0);return i.length>t/2&&(i=i.slice(0,Math.floor(t/2)),r=i),m.addAltizureProjects(i)}).catch(function(e){return console.warn("getFeaturedProjects",e),Promise.resolve()})}}function o(e){void 0!==e&&e?s(e):m.updateSceneQueue.add({force:!1})}function s(e){if(m.isInitialized){m.camera.updateMatrix(),m.camera.updateMatrixWorld(!0),m.camera.updateProjectionMatrix();try{m.camera.matrixWorldInverse.getInverse(m.camera.matrixWorld,!0)}catch(e){return console.warn("catch earth",e),!1}var t=(new a.Matrix4).multiplyMatrices(m.camera.projectionMatrix,m.camera.matrixWorldInverse),r=new a.Frustum;r.setFromMatrix((new a.Matrix4).multiplyMatrices(m.camera.projectionMatrix,m.camera.matrixWorldInverse));var n={camera:m.camera,pvmatrix:t,frustum:r,viewportSize:m.renderer.getSize()};if(!function(e){var t=!0,r=e.camera,n=e.pvmatrix;if(isNaN(r.far)||isNaN(r.near))return!1;if(!n||!n.elements)return!1;for(var i=0;i<n.elements.length;i++)t&=!isNaN(n.elements[i]);return t}(n))return!1;for(var i in m.layers)m.layers[i]&&m.layers[i].sceneUpdated(n);new a.Vector3,new a.Quaternion,new a.Vector3}}function u(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];void 0!==e&&e?h():m.updateVisibilityThrottle.add({force:!1})}function h(){if(!m.isInitialized)return!1;var e=m.control.getRadius(),t=m.control.getMinRadius();e-t<=0||(m.camera.near=1e-4*(e-t),m.camera.far=e+Math.min(Math.max(10*(e-t),e),2*e)),m.camera.updateMatrix(),m.camera.updateMatrixWorld(!0),m.camera.updateProjectionMatrix(),m.camera.matrixWorldInverse.getInverse(m.camera.matrixWorld);var r=new a.Frustum;r.setFromMatrix((new a.Matrix4).multiplyMatrices(m.camera.projectionMatrix,m.camera.matrixWorldInverse));var n={frustum:r};for(var i in m.layers)m.layers[i]&&m.layers[i].updateVisibility(n);return!0}function f(){requestAnimationFrame(f);var e=m.clock.getElapsedTime();if(e-g<1.1*b){g=e,m.clock.getElapsedTime(),m.control.update();var t=(new a.Matrix4).multiplyMatrices(m.camera.projectionMatrix,m.camera.matrixWorldInverse),r=new a.Frustum;r.setFromMatrix((new a.Matrix4).multiplyMatrices(m.camera.projectionMatrix,m.camera.matrixWorldInverse));var n={camera:m.camera,pvmatrix:t,frustum:r,viewportSize:m.renderer.getSize(),currentTime:e};m.earthNode.animate(n),p(),m.animate()}else g=e}function p(){m.camera.updateProjectionMatrix(),m.effect?m.effect.render(m.scene,m.camera):m.renderer.render(m.scene,m.camera),m.renderer.context.flush()}i(this,e),r.isMobile=/iPhone|iPod|iPad|Android|BlackBerry/.test(navigator.userAgent);var m=this;this.HOST=r.HOST,this.rootContainer=null,this.config=r,this.config.backgroundColor=r.backgroundColor||855309,this.scale=e.scale,this.options={},this.scaleParams={minDistance:this.scale-this.scale/1e3,maxDistance:4*this.scale,eye:new a.Vector3(0,0,0),NEAR:m.scale/1e3,FAR:6*m.scale,earthPosition:new a.Vector3(0,0,0)},this.threeContainer=null,this.renderer=null,this.scene=null,this.camera=null,this.imaginaryCamera=null,this.effect=null,this.earthNode=new c.default(null),this.earthNode.sceneNode.name="earthNode",this.earthRadius=this.scale,this.earthSurfaceTree=null,this.layers={earth:null,altizureMesh:null,accessory:null},this.control=null,this.clock=new a.Clock;var g=this.clock.getElapsedTime()-20,b=1/60;this.isInitialized=!1,this.layersReady=null;var w=null;this.updateSceneQueue=null,this.updateVisibilityThrottle=null,this._api=new I.default({apiUrl:r.api.API_HOST,key:r.api.API_KEY}),this.layersReady=function(){function n(){function e(){var e={};if(window.location.search.length>0)for(var t=window.location.search.substring(1),r=t.split("&"),n=0;n<r.length;n++){var i=r[n].split("=");try{e[i[0]]=decodeURIComponent(i[1])}catch(e){console.log("Error in decoding ",i[0])}}return e}var t=r.camera;if(t||(t={}),t.flyTo||(console.warn("No flyTo target."),t.flyTo={lat:22.335836,lng:114.263885,alt:1e7,north:6.6,tilt:60}),t.flyTo.alt||(t.alt=1e7),function(t){var r=e();if("lo"in r){var n=parseFloat(r.lo);isNaN(n)||(t.lng=n)}if("la"in r){var i=parseFloat(r.la);isNaN(i)||(t.lat=i)}if("al"in r){var o=parseFloat(r.al);isNaN(o)||(t.alt=o)}if("north"in r){var a=parseFloat(r.north);isNaN(a)||(t.north=a)}if("tilt"in r){var s=parseFloat(r.tilt);isNaN(s)||(t.tilt=s)}}(t.flyTo),!t.poseTo){var n=t.flyTo;t.poseTo={lat:n.lat,lng:n.lng,alt:3e7,north:6.6,tilt:90}}m.control.setCameraGeoPosition(t.poseTo.lng,t.poseTo.lat,t.poseTo.alt),m.control.forceUpdate(),o(!0),m.control.flyToGeoPosition(t.flyTo.lng,t.flyTo.lat,t.flyTo.alt,{speed:.3,northing:t.flyTo.north,tilt:t.flyTo.tilt})}function i(e,t,r,n){var i=["z-index: 2;","position: absolute;","left:0px;","top:0px;","width:100%;","height:100%;","font-size:12pt;","text-align: center;","vertical-align: middle;","text-align: -webkit-center;","vertical-align: -webkit-middle;","background-color: #"+r.toString(16)+";","color: #"+(16777215-r).toString(16)+";","margin:0px;","padding:0px;"].join(""),o=l.default.createDiv(e,"ErrorDiv",i),a=["position: relative;","top:40%;","font-size:12pt;","text-align: center;","vertical-align: middle;","text-align: -webkit-center;","vertical-align: -webkit-middle;","margin:0px;","padding:0px;"].join(""),s=l.default.createDiv(o,"ErrorTextDiv",a);return s.innerHTML=t,n&&(s.innerHTML+='<br><br><a href="'+n+'" class="btn-link">Learn More</a>'),o}return function(){function e(e,t){return void 0===e?(e=t,t):e}var t=r||{};m.config=t,m.config.showOurLogo=e(t.showOurLogo,!0),m.config.i18n=e(t.i18n,{basic:{}}),m.config.projectInfo=e(t.projectInfo,{}),m.config.renderItems=e(t.renderItems,{}),m.config.renderItems.planet=e(t.renderItems.planet,"earth"),m.config.renderItems.earth=e(t.renderItems.earth,!0),m.config.renderItems.earthUseTexture=e(t.renderItems.earthUseTexture,!0),m.config.renderItems.orbitRing=e(t.renderItems.orbitRing,!1),m.config.renderItems.featureInView=e(t.renderItems.featureInView,!0),m.config.renderItems.tileBox=e(t.renderItems.tileBox,!1),m.config.develop=e(t.develop,!1),m.config.control=e(t.control,{}),m.config.control.doubleTap=e(t.control.doubleTap,!0)}(),function(){if(m.rootContainer=document.getElementById(t),!m.rootContainer)return void console.log("Invalid "+t);m.threeContainer=function(e){var t=["z-index: 0;","position: relative;","left:0px;","top:0px;","width:100%;","height:100%;","margin:0px;","overflow: hidden !important;","padding:0px;"].join("");return l.default.createDiv(e,"ThreeDiv",t)}(m.rootContainer)}(),function(){m.scene=new a.Scene;var e=m.threeContainer.clientWidth/m.threeContainer.clientHeight,t=m.scaleParams.NEAR,r=m.scaleParams.FAR;m.camera=new a.PerspectiveCamera(45,e,t,r),m.scene.add(m.camera),m.camera.position.copy(m.scaleParams.eye);var n=new a.AmbientLight(16777215);m.scene.add(n);var o=new a.PointLight(13696511,1.1,0);o.position.set(0,0,0),m.camera.add(o),m.imaginaryCamera=new a.PerspectiveCamera(45,e,t,r);var l=m.scaleParams.earthPosition;if(m.imaginaryCamera.position.set(-l.x,-l.y,-l.z),!_.default.webgl){if(_.default.browser.isWeChat){var u=/iPhone|iPod|iPad/.test(navigator.userAgent)?"Open in Safari":"Open with Browser";return void i(m.rootContainer,'1. Click the button on upper right corner. <br>2. Select "'+u+'".',m.config.backgroundColor)}return void i(m.rootContainer,"No WebGL Support",m.config.backgroundColor,"/support/articles/faq_compatibility")}m.renderer=new a.WebGLRenderer({antialias:!0}),m.renderer.setClearColor(new a.Color(m.config.backgroundColor)),m.renderer.setPixelRatio(void 0!==window.devicePixelRatio?window.devicePixelRatio:1),m.renderer.setSize(m.threeContainer.clientWidth,m.threeContainer.clientHeight),m.threeContainer.appendChild(m.renderer.domElement),m.renderer.context.getExtension("OES_standard_derivatives");var c={promiseFn:function(e){return s(e.force),Promise.resolve()},timer:1250,timeout:1e4,debug:!1};m.updateSceneQueue=new R.default(c);var d={promiseFn:function(e){return e.force,h(),Promise.resolve()},timer:200,timeout:1e4,debug:!1};m.updateVisibilityThrottle=new R.default(d),p()}(),function(){function e(){m.camera.aspect=m.threeContainer.clientWidth/m.threeContainer.clientHeight,m.camera.updateProjectionMatrix(),m.renderer.setSize(m.threeContainer.clientWidth,m.threeContainer.clientHeight),m.effect&&m.effect.setSize(m.threeContainer.clientWidth,m.threeContainer.clientHeight)}function t(e){if(m.config.control.doubleTap){var t={x:0,y:0};void 0!==e.touchEvent?(t.x=e.touchEvent.touches[0].pageX,t.y=e.touchEvent.touches[0].pageY):(t.x=e.clientX,t.y=e.clientY);var r=m.pickProject(t);r?m.control.flyToGeoPosition(r.geoInfo.centerLong,r.geoInfo.centerLat,888):m.control.zoomEvent(e)}}var r={node:m.earthNode,radius:m.scale,camera:m.camera,scene:m.scene,threeContainer:m.threeContainer,layers:m.layers,showContactFocus:m.config.develop,config:m.config.control};m.control=new x.default(m.imaginaryCamera,m.renderer.domElement,r),m.control.minDistance=m.scaleParams.minDistance,m.control.maxDistance=m.scaleParams.maxDistance,m.control.enableDamping=!0,m.control.dampingFactor=.1,m.control.zoomSpeed=3,m.control.gestureRecognizer.addEventListener("double-tap",t,!1),m.control.addEventListener("change",function(){o(!1),u(!1)}),m.control.addEventListener("animationend",function(){o(!1),u(!1)}),m.threeContainer.addEventListener("mouseup",function(){o(!1),u(!1)}),m.threeContainer.addEventListener("touchend",function(e){o(!1),u(!1)}),m.threeContainer.addEventListener("dblclick",t,!1),window.addEventListener("resize",e,!1)}(),m.isInitialized=!0,function(){function t(){var e={debug:!1,maxLevel:m.config.isMobile&&m.config.renderItems.earthUseTexture?10:14,minLevel:0,tree_size_limit:m.config.isMobile?m.config.renderItems.earthUseTexture?120:300:350,MAX_THREADS:m.config.isMobile?3:8,MAX_CACHE_SIZE:m.config.isMobile?m.config.renderItems.earthUseTexture?140:320:400,MIN_AREA:.6,maxAnisotropy:i,allow_worker:!1,display_lod:!1,useColor:!1,planet:m.config.renderItems.planet,useTexture:m.config.renderItems.earthUseTexture,fullScene:!0,earthRadius:m.scale,countryName:a,onError:function(e){console.error(e)},renderItems:{orbitRing:m.config.renderItems.orbitRing},eventHandlers:r.eventHandlers};return Promise.resolve(new d.default(m.earthNode,y.default,{dataSeeds:[e]}))}function n(){var e=[];"China"===a?(e[0]="oss_sz",e[1]="oss_usw",e[2]="local"):(e[0]="oss_usw",e[1]="oss_sz",e[2]="local");var t={debug:!1,useRemoteAltizureServer:"https://www.altizure.com",cloudPriorityList:e,isMobile:m.config.isMobile,onError:function(e){console.warn(e)},earthRadius:m.scale,fullScene:!1,quality:m.config.isMobile?40:60,display_lod:!1,allow_worker:!m.config.isMobile,bbox:m.config.renderItems.tileBox,MAX_THREADS:m.config.isMobile?3:8,MAX_CACHE_SIZE:m.config.isMobile?140:250,ENTITY_CACHE_SIZE:m.config.isMobile?50:150,MIN_AREA:.1,maxAnisotropy:i,HOST:m.HOST};return Promise.resolve(new v.default(m.earthNode,t))}m.scene.add(m.earthNode.sceneNode);var i=m.renderer.getMaxAnisotropy(),a="China";return m._api.getCountryName().then(function(r){a=r;var i=void 0;i=!m.config.renderItems.earth||t().then(function(e){return e.sceneNode.name="earthLayer sceneNode",m.layers.earth=e,e.startImport()}).then(function(){return o(!0),m.control.earthInfo.earthEntity=m.layers.earth.children[0],m.atmosphere=new D.default({earthSceneNode:m.earthNode,camera:m.camera,scale:e.scale}),Promise.resolve()}).catch(function(e){return console.error("earthTask error",e),Promise.reject(e)});var s=n().then(function(e){return e.sceneNode.name="altizureMesh layer scene node",m.layers.altizureMesh=e,Promise.resolve()}),l=[i,s];return Promise.all(l)})}().then(function(e){return n(),Promise.resolve()}).catch(function(e){return console.error("initLayer error",e),Promise.resolve()})}(),this.layersReady.then(function(){n()}),f(),this.attachEffect=function(e,t){return m.threeContainer&&m.renderer?(m.effect=new e(m.renderer,t),m.effect&&m.effect.setSize(m.threeContainer.clientWidth,m.threeContainer.clientHeight),m.effect):(console.error("The renderer has not been initialized"),null)},this.updateScene=o,this.render=p}return o(e,[{key:"addAltizureProjects",value:function(e,t){var r=this;t=t||{eventHandlers:{onEntityCreated:function(){r.updateScene(!1)},onEntityModelInitialized:function(){r.updateScene(!1)},onImportFinished:function(){},onError:function(e){console.error(e)}}};for(var n=[],i=0;i<e.length;i++){var o=void 0;if(e[i]instanceof P.default)o=e[i];else{o=new P.default;var a=e[i];o.id=a.id,o.name=a.name,o.views=a.views,o.owner={name:a.owner.name||"unknown",joined:a.owner.joined||"unknown"},o.date=a.date,o.geoInfo={autoAligned:a.geoInfo.autoAligned,minLat:a.geoInfo.minLat,minLong:a.geoInfo.minLong,maxLat:a.geoInfo.maxLat,maxLong:a.geoInfo.maxLong,centerLat:a.geoInfo.centerLat,centerLong:a.geoInfo.centerLong},o.cloudPath=a.cloudPath,o.versionControl=a.versionControl||"",o.modelTransform={origin:a.modelTransform.origin,xDir:a.modelTransform.xDir,yDir:a.modelTransform.yDir,zDir:a.modelTransform.zDir,minBound:a.modelTransform.minBound,maxBound:a.modelTransform.maxBound,xTiles:a.modelTransform.xTiles,yTiles:a.modelTransform.yTiles,zTiles:a.modelTransform.zTiles,floorHeight:a.modelTransform.floorHeight,onLoadTrans:a.modelTransform.onLoadTrans,lengthUnitToMeter:a.modelTransform.lengthUnitToMeter}}o.valid?n.push(o):console.warn("invalid project info",e[i])}var s={type:"custom",data:n};return this.layersReady.then(function(){return r.layers.altizureMesh.import(s,t)}).then(function(){return Promise.resolve()}).catch(function(e){return console.warn("addAltizureProject failed",e),Promise.resolve()})}},{key:"pickProject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=this.control.pickEarthContactPoint(e);if(r){var n=new a.Vector2(r.lng,r.lat),i=this.visibleAltizureProjects(),o=t,s=void 0;return i.map(function(e){var t=new a.Vector2(e.geoInfo.centerLong,e.geoInfo.centerLat),r=t.distanceTo(n);r<o&&(o=r,s=e)}),s}}},{key:"visibleAltizureProjects",value:function(){return this.layers.altizureMesh.visibleAltizureProjects()}},{key:"animate",value:function(){}},{key:"accessoryLayer",get:function(){return this.layers.accessory}},{key:"earthSceneRoot",get:function(){return this.earthNode}}],[{key:"scale",get:function(){return 1}},{key:"GeoCoord",get:function(){return S.default}},{key:"HyperClasses",get:function(){return{HyperLayer:d.default,HyperNode:c.default,PMatrix:p.default,EarthMath:E.default,CONSTANTS:{EarthResolution:T.default.EarthResolution,scale:e.scale,EARTH_RADIUS:E.default.EARTH_RADIUS,EQUATOR:E.default.EQUATOR}}}}]),e}();t.default=j},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(49),s=n(a),l=r(93),u=n(l),c=r(0),h=function(){function e(t,r){i(this,e),this.FOREST_CAPACITY=t.FOREST_CAPACITY,this.MAX_DOWNLOAD_CONCURRENCY=t.MAX_DOWNLOAD_CONCURRENCY,this.MIN_AREA=t.MIN_AREA,this.MAX_LEVEL=t.MAX_LEVEL,this.allowWorker=t.allowWorker,r=r||{},this.trees=r.trees,this.CACHE_CAPACITY=r.CACHE_CAPACITY,this.CACHE_CAPACITY<this.FOREST_CAPACITY+10&&(this.CACHE_CAPACITY=this.FOREST_CAPACITY+Math.min(100,Math.max(.4*this.FOREST_CAPACITY,10))),this.retriever=new u.default({cacheCapacity:this.CACHE_CAPACITY,dockCapacity:this.MAX_DOWNLOAD_CONCURRENCY,allowWorker:this.allowWorker})}return o(e,[{key:"destruct",value:function(){this.trees=[],this.retriever.destruct(),this.retriever=null}},{key:"clear",value:function(){this.trees=[],this.retriever.clear()}},{key:"add",value:function(e){var t=this._indexOf(e);return-1===t?(this.trees.push(e),!0):(console.warn("tree already exists",e,t),!1)}},{key:"remove",value:function(e){var t=this._indexOf(e);return-1!==t&&(this.trees.splice(t,1),!0)}},{key:"apply",value:function(e,t){for(var r=!0,n=0;n<this.trees.length;n++)r=e(this.trees[n],t)&&r;return r}},{key:"sceneUpdated",value:function(e){if(0===this.trees.length)return!0;var t=this._updateTree(e);return t||console.warn("_updateTree failed"),this._retrieveTiles().then(function(e){return Promise.resolve()}).catch(function(e){return console.error(e),Promise.resolve()}),t}},{key:"_updateTree",value:function(e){function t(e,t){if(!e.sceneGraphRoot||!e.sceneGraphRoot.matrixWorld)return 0;for(var o=0,a=e.sceneGraphRoot.matrixWorld.elements;o<a.length;o++)if(isNaN(a[o]))return 0;var s=t.screenArea(r,n,i,e.sceneGraphRoot);return t.ssArea=s,s}var r=e.camera,n=e.pvmatrix,i=e.frustum,o=!0,a=new s.default(function(e,t){return t.key-e.key});this.apply(function(e){o=e.traverse(e.root,function(e){return e.needsPrune=!0,!0})&&o;var r=e.root,n=t(e,r),i={node:r,tree:e};a.enqueue(n,i)});var l=0;do{if(l>=this.FOREST_CAPACITY)break;var u=a.dequeue(),c=u.key,h=u.value.node,d=u.value.tree;if(c<this.MIN_AREA)break;if(h.needsPrune=!1,h.level<this.MAX_LEVEL&&h.level<d.maxLevel&&!h.is404){0===h.nodes.length&&(o=d.expand(h)&&o);for(var f=0;f<h.nodes.length;f++){var p=h.nodes[f];p.needsPrune=!0;var m=t(d,p);m>0||p.setVisibility(!1),m>=this.MIN_AREA&&a.enqueue(m,{tree:d,node:p})}l+=4}}while(!a.isEmpty());return a.clear(),a=void 0,this.apply(function(e){o=e.traverse(e.root,function(t){return!t.needsPrune||e.prune(t)})&&o}),o}},{key:"_retrieveTiles",value:function(){function e(e,t){function n(e){return e instanceof c.Mesh?void 0!==e.material||(console.warn("[Forest] material/map not ready",e.material),!1):(console.error("[Forest] Invalid mesh",e),!1)}return r.retriever.request(e.PID,t,null).then(function(r){if(!t.expired){if(!t.loaded){if(!n(r))return console.error("request returns unexpected mesh",r),Promise.reject(new Error("Unexpected mesh"));t.setVisibility(t.visible),t.onLoaded(r),t.displayByload(e.sceneGraphRoot),e.flags.modelInitialized||e._onContentInitialized()}return Promise.resolve()}return Promise.resolve()}).catch(function(e){return"[Dock] abortPending"===e.message||"local data"===e||"local data"===e.message||"expired"===e||console.warn("[Network unstable] Forest._retrieveTiles",e),Promise.resolve()})}var t=this.retriever.abortPending(),r=this,n=new s.default(function(e,t){return t.key-e.key}),i=new s.default(function(e,t){return t.key-e.key});this.apply(function(e){var t=e.root.ssArea,r={tree:e,node:e.root};n.enqueue(t,r),i.enqueue(t,r)});for(var o=[];!n.isEmpty();){var a=n.dequeue(),l=a.value.tree,u=a.value.node,h=e(l,u);o.push(h)}for(;!i.isEmpty();)for(var d=i.dequeue(),f=d.value.tree,p=d.value.node,m=p.nodes,v=0;v<m.length;v++){var g=m[v],y=e(f,g);o.push(y),i.enqueue(g.ssArea,{tree:f,node:g})}return t.then(function(){return Promise.all(o)})}},{key:"_indexOf",value:function(e){return(Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1})(this.trees,e)}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=r(12),a=n(o),s=r(20),l=n(s),u=r(94),c=n(u),h=r(105),d=n(h),f="decoding error",p=!1,m=function(e,t,r,n,i,o){l.default.call(this,e,t,r,n,i,o),this.basepath=o.basepath,this.isMobile=o.isMobile,this._file_name=""};m.prototype=Object.create(l.default.prototype),m.prototype.constructor=m,m.prototype.fileName=function(){var e=this.options.info.tile_salt;return""===this._file_name&&(this._file_name=a.default.MD5(this.name+e).toString(a.default.enc.Hex)),this._file_name},m.prototype.tileLoaderTest=function(e){return Promise.resolve(function(e){var t=new i.BoxGeometry(1,1,1);t.vertices[0]=e.boundingBox[6].clone(),t.vertices[1]=e.boundingBox[2].clone(),t.vertices[2]=e.boundingBox[5].clone(),t.vertices[3]=e.boundingBox[1].clone(),t.vertices[4]=e.boundingBox[3].clone(),t.vertices[5]=e.boundingBox[7].clone(),t.vertices[6]=e.boundingBox[0].clone(),t.vertices[7]=e.boundingBox[4].clone();var r=new i.MeshPhongMaterial({color:function(e){var t=1e4*Math.sin(e++);return 16777215*(t-Math.floor(t))}(e.level+e.x+e.y),shading:i.FlatShading});return new i.Mesh(t,r)}(this))},m.prototype.onWorkerLoad=function(e){if(void 0===this.options)return Promise.reject("expired");e.filename!==this.fileName()&&console.error("MeshTile > decode callback mismatch");var t={extendModel:!1,displayMode:0,needNormal:!0,isMobile:this.isMobile};this.trial++;var r=e.status;if(200===r){var n=e.pixels,i=e.width,o=e.height,a=new d.default;return a.parseBundle(n,i,o,{}),this.decodeTile(a,t)}return 404===r||403===r||303===r?Promise.reject("not found"):0===r?(this.onError(10200,e.filename),Promise.reject("local data")):(console.warn(e,r),Promise.reject("cannot load tile"))},m.prototype.tileLoader=function(e){function t(e){return new Promise(function(t,o){r.eventQueue.add(r.tileDecoder,r,{aBuf:e,fn:n,loader_options:i},function(r){e=null,t(r)},function(t){e=null,o(t)},r.isMobile?20:10)})}var r=this,n=this.fileName(),i={extendModel:!1,displayMode:0,needNormal:!0,isMobile:r.isMobile};return function(){return new Promise(function(e,t){function i(e,t){return e.substr(0,t.length)===t}var o=new XMLHttpRequest;o.open("GET",r.basepath+n+".ab",!0),o.timeout=3e4,o.responseType="arraybuffer",o.onreadystatechange=function(n){4===o.readyState&&(404===o.status||303===o.status||403===o.status?t("not found"):200===o.status?e(o.response):0===o.status?(console.warn("timeout or other network problem"),i(r.basepath,"http:")||i(r.basepath,"https:")||(console.log("local file load error"),t("not found")),t("local data")):(console.warn("download tile request fail",o.status),t("cannot load tile")))},o.ontimeout=function(){r.onError(10200,r.basepath+n+".ab"),t("request time out")},o.onerror=function(e){console.warn("request error",e),t("request error")},o.send()})}().then(function(e){return r.trial++,t(e)}).catch(function(e){return e===f&&r.trial<r.maxReloads?r.tileLoader():Promise.reject(e)})},m.prototype.decodeTile=function(e,t){var r=this,n=this.fileName();return new Promise(function(o,a){if(r.expired)return a("expired"),!1;try{var s=e.readJSON(n+".txt");for(var l in s.urls)s.urls.hasOwnProperty(l)&&(function(e,t){return!(e.length<t.length)&&e.substr(-t.length)===t}(l,".aa")?s[l]=decodeURIComponent(escape(e.readText(l))):s[l]=decodeURIComponent(escape(e.readText(l+".aa"))));for(var u in s.materials)if(s.materials.hasOwnProperty(u)){var h=s.materials[u],d=h.map_Kd;d&&(s[d]=e.readImg(d))}e.clearData(),s.decodeParams||(t&&t.decodeParams?s.decodeParams=t.decodeParams:s.decodeParams=DEFAULT_DECODE_PARAMS),s.options=t,(new c.default).decodeModel(s,function(e){var t=e.children[0].children[0];return t.parent.parent.children=[],t.parent.parent=null,t.parent.children=[],t.parent=null,t instanceof i.Mesh?(o(t),!0):(console.warn("unknown mesh type",t),a("unknown mesh type"),!1)},function(e){return console.warn("decoding error",e),a(f),!1})}catch(e){return console.warn("decoding error",e),p=!0,a(f),!1}})},m.prototype.tileDecoder=function(e,t,r){var n=e.aBuf,o=e.fn,a=e.loader_options;return this.expired?(r("expired"),!1):((new d.default).parse(n,{robust:p},function(e){n=null;try{var s=e.readJSON(o+".txt");for(var l in s.urls)s.urls.hasOwnProperty(l)&&(function(e,t){return!(e.length<t.length)&&e.substr(-t.length)===t}(l,".aa")?s[l]=decodeURIComponent(escape(e.readText(l))):s[l]=decodeURIComponent(escape(e.readText(l+".aa"))));for(var u in s.materials)if(s.materials.hasOwnProperty(u)){var h=s.materials[u],d=h.map_Kd;d&&(s[d]=e.readImg(d))}e.clearData(),s.decodeParams||(a&&a.decodeParams?s.decodeParams=a.decodeParams:s.decodeParams=DEFAULT_DECODE_PARAMS),s.options=a,(new c.default).decodeModel(s,function(e){var n=e.children[0].children[0];return n.parent.parent.children=[],n.parent.parent=null,n.parent.children=[],n.parent=null,n instanceof i.Mesh?(t(n),!0):(console.warn("unknown mesh type",n),r("unknown mesh type"),!1)},function(e){return console.warn("decoding error",e),r(f),!1})}catch(e){return console.warn("decoding error",e),p=!0,r(f),!1}}),!1)},t.default=m},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=r(20),a=n(o),s=r(10),l=n(s),u=function(e,t,r,n,i,o){a.default.call(this,e,t,r,n,i,o),this.basepath=o.basepath,this.length_unit_to_meter=o.info.length_unit_to_meter};u.prototype=Object.create(a.default.prototype),u.prototype.constructor=u,u.prototype.getModel=function(){return this.name},u.prototype.getJsName=function(){return this.basepath+this.getModel()+".json"},u.prototype.tileLoader=function(){var e=this;return function(){var t,r={url:e.getJsName(),timeout:3e4};return new Promise(function(n,o){(0,l.default)({method:"get",url:r.url,timeout:r.timeout}).then(function(r){var a=r.data,s=a.length;0===s&&o(new Error("empty"));for(var l=new i.BufferGeometry,u=new Float32Array(3*s),c=new Float32Array(3*s),h=a.length-1;h>=0;h--)for(var d=a[h][0],f=a[h][1],p=0;p<3;p++)u[3*h+p]=d[p]/e.length_unit_to_meter,c[3*h+p]=f[p]/256;l.addAttribute("position",new i.BufferAttribute(u,3)),l.addAttribute("color",new i.BufferAttribute(c,3)),l.boundingSphere=null;var m=new i.PointsMaterial({vertexColors:!0,size:3,sizeAttenuation:!1});t=new i.Points(l,m),t.name=e.name,n(t)}).catch(function(e){console.warn(e),o(e)})})}()},t.default=u},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(3),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(){n(this,e)}return i(e,null,[{key:"longGang",value:function(e,t,r){this.center={lng:0,lat:0},this.bbox={maxLat:0,minLat:0,maxLng:0,minLng:0};var n=a.default.degreeGeographicToWebMercator(e.lng,e.lat),i=[n[0]+t[0],n[1]+t[1]],o=a.default.webMercatorToDegreeGeographic(i[0],i[1]);this.center.lng=o[0],this.center.lat=o[1];var s=a.default.webMercatorXToDegreeLog(i[0]+r.max_bound[0]),l=a.default.webMercatorXToDegreeLog(i[0]+r.min_bound[0]),u=a.default.webMercatorYToDegreeLat(i[1]+r.max_bound[1]),c=a.default.webMercatorYToDegreeLat(i[1]+r.min_bound[1]);return{center:{lng:o[0],lat:o[1]},bbox:{maxLng:s,minLng:l,maxLat:u,minLat:c}}}}]),e}();t.default=s},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t){if(n(this,e),this.promiseFn=t.promiseFn,this.timer=t.timer,this.timeout=t.timeout,void 0===t.promiseFn||void 0===this.timer||void 0===this.timeout)return void console.error("RefreshQueue invalid construction.",t);this.processingTask=null,this.deferredTask=null,this.debug=t.debug||!1,this._running=null}return i(e,[{key:"add",value:function(e){var t=this;null===this.processingTask?(this.processingTask=e,null!==this._running?this._running.then(function(){t._running=t._run()}):this._running=this._run()):null===this.deferredTask?this.deferredTask=e:null!==this.deferredTask?this.deferredTask=e:console.warn("RefreshQueue.add(): unknown condition")}},{key:"_run",value:function(){function e(e){return new Promise(function(t,r){setTimeout(function(){t()},e)})}var t=this.debug;if(null===this.processingTask)return t&&console.log("no processingTask"),this._running=null,Promise.resolve();var r=this;return function(e,t){return Promise.race([e,new Promise(function(e,r){setTimeout(function(){r(new Error("Refresh task time out "+t))},t)})])}(this.promiseFn(this.processingTask),r.timeout).catch(function(e){return t&&console.warn("refresh task failed:",r.processingTask,e),Promise.resolve()}).then(function(){return r.processingTask=r.deferredTask,r.deferredTask=null,e(r.timer)}).then(function(){return r._run()})}}]),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i={uniforms:n.UniformsUtils.merge([n.UniformsLib.fog,{normalSampler:{type:"t",value:null},mirrorSampler:{type:"t",value:null},alpha:{type:"f",value:1},time:{type:"f",value:0},distortionScale:{type:"f",value:20},noiseScale:{type:"f",value:1},textureMatrix:{type:"m4",value:new n.Matrix4},sunColor:{type:"c",value:new n.Color(8355711)},sunDirection:{type:"v3",value:new n.Vector3(.70707,.70707,0)},eye:{type:"v3",value:new n.Vector3(0,0,0)},waterColor:{type:"c",value:new n.Color(5592405)},cropMask:{type:"t",value:null},useMask:{type:"b",value:!1}}]),vertexShader:["uniform mat4 textureMatrix;","uniform float time;","varying vec4 mirrorCoord;","varying vec3 worldPosition;","varying vec3 modelPosition;","varying vec3 surfaceX;","varying vec3 surfaceY;","varying vec3 surfaceZ;","varying vec2 vUv;","void main()","{","  mirrorCoord = modelMatrix * vec4(position, 1.0);","  worldPosition = mirrorCoord.xyz;","  modelPosition = position;","  surfaceX = vec3( modelMatrix[0][0], modelMatrix[0][1], modelMatrix[0][2]);","  surfaceY = vec3( modelMatrix[1][0], modelMatrix[1][1], modelMatrix[1][2]);","  surfaceZ = vec3( modelMatrix[2][0], modelMatrix[2][1], modelMatrix[2][2]);","  vUv = uv;","  mirrorCoord = textureMatrix * mirrorCoord;","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["uniform sampler2D mirrorSampler;","uniform float alpha;","uniform float time;","uniform float distortionScale;","uniform float noiseScale;","uniform sampler2D normalSampler;","uniform vec3 sunColor;","uniform vec3 sunDirection;","uniform vec3 eye;","uniform vec3 waterColor;","varying vec4 mirrorCoord;","varying vec3 worldPosition;","varying vec3 modelPosition;","varying vec3 surfaceX;","varying vec3 surfaceY;","varying vec3 surfaceZ;","varying vec2 vUv;","uniform sampler2D cropMask;","uniform bool useMask;","void sunLight(const vec3 surfaceNormal, const vec3 eyeDirection, in float shiny, in float spec, in float diffuse, inout vec3 diffuseColor, inout vec3 specularColor)","{","  vec3 reflection = normalize(reflect(-sunDirection, surfaceNormal));","  float direction = max(0.0, dot(eyeDirection, reflection));","  specularColor += pow(direction, shiny) * sunColor * spec;","  diffuseColor += max(dot(sunDirection, surfaceNormal), 0.0) * sunColor * diffuse;","}","vec3 getNoise(in vec2 uv)","{","  vec2 uv0 = uv / (103.0 * noiseScale) + vec2(time / 17.0, time / 29.0);","  vec2 uv1 = uv / (107.0 * noiseScale) - vec2(time / -19.0, time / 31.0);","  vec2 uv2 = uv / (vec2(8907.0, 9803.0) * noiseScale) + vec2(time / 101.0, time /   97.0);","  vec2 uv3 = uv / (vec2(1091.0, 1027.0) * noiseScale) - vec2(time / 109.0, time / -113.0);","  vec4 noise = texture2D(normalSampler, uv0) +","    texture2D(normalSampler, uv1) +","    texture2D(normalSampler, uv2) +","    texture2D(normalSampler, uv3);","  return noise.xyz * 0.5 - 1.0;","}",n.ShaderChunk.common,n.ShaderChunk.fog_pars_fragment,"void main()","{","  vec3 worldToEye = eye - worldPosition;","  vec3 eyeDirection = normalize(worldToEye);","  if (useMask) {","    vec2 os_uv = vec2(vUv.x, 1.0 - vUv.y);","    float mask_val = texture2D(cropMask, os_uv).y;","    if(mask_val < 0.05) {","      discard;","    }","  }","  vec3 noise = getNoise(modelPosition.xy * 1.0);","  vec3 distordCoord = noise.x * surfaceX + noise.y * surfaceY;","  vec3 distordNormal = distordCoord + surfaceZ;","  if(dot(eyeDirection, surfaceZ) < 0.0)","    distordNormal = distordNormal * -1.0;","  vec3 diffuseLight = vec3(0.0);","  vec3 specularLight = vec3(0.0);","  sunLight(distordNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight);","  float distance = length(worldToEye);","  vec2 distortion = distordCoord.xy * distortionScale * sqrt(distance) * 0.07;"," vec3 mirrorDistord = mirrorCoord.xyz + vec3(distortion.x, distortion.y, 1.0);"," vec3 reflectionSample = texture2DProj(mirrorSampler, mirrorDistord).xyz;","  float theta = max(dot(eyeDirection, distordNormal), 0.0);","  float reflectance = 0.3 + (1.0 - 0.3) * pow((1.0 - theta), 3.0);","  vec3 scatter = max(0.0, dot(distordNormal, eyeDirection)) * waterColor;","  vec3 albedo = mix(sunColor * diffuseLight * 0.3 + scatter, (vec3(0.1) + reflectionSample * 0.9 + reflectionSample * specularLight), reflectance);"," vec3 outgoingLight = albedo;",n.ShaderChunk.fog_fragment," gl_FragColor = vec4( outgoingLight, alpha );","}"].join("\n")},o=function(e,t,r,o){function a(e,t){return void 0!==e?e:t}n.Object3D.call(this),this.name="water_"+this.id,o=o||{},this.matrixNeedsUpdate=!0;var s=a(o.textureWidth,512),l=a(o.textureHeight,512);this.clipBias=a(o.clipBias,-1e-4),this.alpha=a(o.alpha,1),this.time=a(o.time,0),this.normalSampler=a(o.waterNormals,null),this.sunDirection=a(o.sunDirection,new n.Vector3(.70707,.70707,0)),this.sunColor=new n.Color(a(o.sunColor,16777215)),this.waterColor=new n.Color(a(o.waterColor,8355711)),this.eye=a(o.eye,new n.Vector3(0,0,0)),this.distortionScale=a(o.distortionScale,20),this.noiseScale=a(o.noiseScale,1),this.side=a(o.side,n.FrontSide),this.fog=a(o.fog,!1),this.renderer=e,this.scene=r,this.mirrorPlane=new n.Plane,this.normal=new n.Vector3(0,0,1),this.cameraWorldPosition=new n.Vector3,this.rotationMatrix=new n.Matrix4,this.lookAtPosition=new n.Vector3(0,0,-1),this.clipPlane=new n.Vector4,this.cropMask=a(o.cropMask,null),this.useMask=null!==this.cropMask,t instanceof n.PerspectiveCamera?this.camera=t:(this.camera=new n.PerspectiveCamera,console.log(this.name+": camera is not a Perspective Camera!")),this.textureMatrix=new n.Matrix4,this.mirrorCamera=this.camera.clone(),this.texture=new n.WebGLRenderTarget(s,l),this.tempTexture=new n.WebGLRenderTarget(s,l);var u=i,c=n.UniformsUtils.clone(u.uniforms);this.material=new n.ShaderMaterial({fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,uniforms:c,transparent:!0,side:this.side,fog:this.fog}),this.mesh=new n.Object3D,this.material.uniforms.mirrorSampler.value=this.texture.texture,this.material.uniforms.textureMatrix.value=this.textureMatrix,this.material.uniforms.alpha.value=this.alpha,this.material.uniforms.time.value=this.time,this.material.uniforms.normalSampler.value=this.normalSampler,this.material.uniforms.sunColor.value=this.sunColor,this.material.uniforms.waterColor.value=this.waterColor,this.material.uniforms.sunDirection.value=this.sunDirection,this.material.uniforms.distortionScale.value=this.distortionScale,this.material.uniforms.noiseScale.value=this.noiseScale,this.material.uniforms.eye.value=this.eye,this.material.uniforms.cropMask.value=this.cropMask,this.material.uniforms.useMask.value=this.useMask,n.Math.isPowerOfTwo(s)&&n.Math.isPowerOfTwo(l)||(this.texture.generateMipmaps=!1,this.tempTexture.generateMipmaps=!1)};o.prototype=Object.create(n.Object3D.prototype),o.prototype.setMask=function(e){this.material.uniforms.cropMask.value=e,this.material.uniforms.useMask.value=null!==e},o.prototype.setCamera=function(e){console.warn("Water setCamera"),this.camera=e,this.mirrorCamera=this.camera.clone(),this.updateTextureMatrix()},o.prototype.renderWithMirror=function(e){this.updateTextureMatrix(),this.matrixNeedsUpdate=!1;var t=e.camera;e.camera=this.mirrorCamera,e.render(!0),this.render(),this.matrixNeedsUpdate=!0,e.camera=t,e.updateTextureMatrix()},o.prototype.updateTextureMatrix=function(){function e(e){return e?e<0?-1:1:0}void 0!==this.parent&&(this.mesh=this.parent),this.updateMatrixWorld(),this.camera.updateMatrixWorld(),this.cameraWorldPosition.setFromMatrixPosition(this.camera.matrixWorld),this.rotationMatrix.extractRotation(this.matrixWorld),this.normal=new n.Vector3(0,0,1).applyEuler(this.mesh.rotation);var t=this.camera.position.clone().sub(this.mesh.position);if(this.normal.dot(t)<0){var r=new n.Vector3(0,0,1).applyEuler(this.mesh.rotation);this.normal.reflect(r)}var i=this.mesh.position.clone().sub(this.cameraWorldPosition);i.reflect(this.normal).negate(),i.add(this.mesh.position),this.rotationMatrix.extractRotation(this.camera.matrixWorld),this.lookAtPosition.set(0,0,-1),this.lookAtPosition.applyMatrix4(this.rotationMatrix),this.lookAtPosition.add(this.cameraWorldPosition);var o=this.mesh.position.clone().sub(this.lookAtPosition);o.reflect(this.normal).negate(),o.add(this.mesh.position),this.up.set(0,-1,0),this.up.applyMatrix4(this.rotationMatrix),this.up.reflect(this.normal).negate(),this.mirrorCamera.near=1,this.mirrorCamera.far=1e5,this.mirrorCamera.position.copy(i),this.mirrorCamera.up=this.up,this.mirrorCamera.lookAt(o),this.mirrorCamera.aspect=this.camera.aspect,this.mirrorCamera.updateProjectionMatrix(),this.mirrorCamera.updateMatrixWorld(),this.mirrorCamera.matrixWorldInverse.getInverse(this.mirrorCamera.matrixWorld),this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.mirrorCamera.projectionMatrix),this.textureMatrix.multiply(this.mirrorCamera.matrixWorldInverse),this.mirrorPlane.setFromNormalAndCoplanarPoint(this.normal,this.mesh.position),this.mirrorPlane.applyMatrix4(this.mirrorCamera.matrixWorldInverse),this.clipPlane.set(this.mirrorPlane.normal.x,this.mirrorPlane.normal.y,this.mirrorPlane.normal.z,this.mirrorPlane.constant);var a=new n.Vector4,s=this.mirrorCamera.projectionMatrix;a.x=(e(this.clipPlane.x)+s.elements[8])/s.elements[0],a.y=(e(this.clipPlane.y)+s.elements[9])/s.elements[5],a.z=-1,a.w=(1+s.elements[10])/s.elements[14];var l=new n.Vector4;l=this.clipPlane.multiplyScalar(2/this.clipPlane.dot(a)),s.elements[2]=l.x,s.elements[6]=l.y,s.elements[10]=l.z+1-this.clipBias,s.elements[14]=l.w;var u=new n.Vector3;u.setFromMatrixPosition(this.camera.matrixWorld),this.eye=u,this.material.uniforms.eye.value=this.eye},o.prototype.render=function(e){if(this.matrixNeedsUpdate&&this.updateTextureMatrix(),this.matrixNeedsUpdate=!0,void 0!==this.scene&&this.scene instanceof n.Scene){this.material.visible=!1;var t=void 0!==e&&e?this.tempTexture:this.texture;!0!==this.renderer.autoClear&&this.renderer.clearTarget(t,!0,!0,!0),this.renderer.render(this.scene,this.mirrorCamera,t,!0),this.material.visible=!0,this.material.uniforms.mirrorSampler.value=t.texture}},o.prototype.getMirrorCamera=function(e){var t=void 0!==e&&e?this.tempTexture:this.texture;this.renderer.render(this.scene,this.mirrorCamera,t,!0);var r=this.renderer.getContext(),n=t.width,i=t.height,o=new Uint8Array(n*i*4);r.readPixels(0,0,n,i,r.RGBA,r.UNSIGNED_BYTE,o);var a={mirrorCamera:this.mirrorCamera,renderTexture:t,imgArray:o};return console.log("water res",a),a},t.default=o},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),l=r(16),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.projectTree=e.tree,r}return o(t,e),a(t,[{key:"resetMask",value:function(){var e=this;e.reset(function(t){e.edit&&e.updateSelectioinMask(t,!0),e.updateSelectioinMask(t,!1)},"white")}},{key:"initMask",value:function(e,t){var r=this,n=function(){r.isDebug&&console.log("init crop mask",e),t&&t(),r.update(!0),r.update(!1),r.edit||(r.curMaskRGB=[])},i=function(){t&&t(),console.log("Failed to init crop mask!"),r.edit?r.resetMask():r.curMaskRGB=[]};this.init(e,n,i)}},{key:"workerInitMask",value:function(e){var t=this.maskSize,r=this.maskSize;if(!0===this.edit||void 0!==e.texData&&null!==e.texData){if(this.edit){this.cntWhite=e.cntWhite;var n=e.rgba;void 0===n&&(n=new Uint8ClampedArray(t*r*4).fill(255)),this.curMaskRGB.set(n),this.preMaskRGB.set(n),this.acumulate_poly_num=e.pack_mask.poly_num;var i=this.orthoCanvas.getContext("2d"),o=i.createImageData(t,r);o.data.set(this.curMaskRGB),i.putImageData(o,0,0),this.removePolygons(),this._debugVisualizeMask(),this.updateMaskInfo(e)}if(this.projectTree){var a=new s.DataTexture(e.texData,t,r,s.RGBAFormat,s.UnsignedByteType);a.needsUpdate=!0,this.projectTree.updateOrthoSelectionMask(this.orthoInfo,a,!1),this.edit||(e.texData=[],e.rgb=[],e.pack_mask.data=[],e=void 0)}}}},{key:"updateSelectioinMask",value:function(e,t){if(e&&e.length>0){var r=this;r.updateOrthoInfo();var n=r.maskToTexture(e),i=r.projectTree;i?i.updateOrthoSelectionMask(r.orthoInfo,n,t):console.log("project tree invalid!!!")}else console.log("mask data is not valid")}},{key:"update",value:function(e){e?this.edit&&(this.updateSelectioinMask(this.preMaskRGB,!1),this.updateSelectioinMask(this.curMaskRGB,!0)):(this.edit&&this.updateSelectioinMask(this.curMaskRGB,!0),this.updateSelectioinMask(this.curMaskRGB,!1))}},{key:"apply",value:function(){var e=this,t=this.polygons;this.applyPolygon(t,function(){e.update(!1)})}}]),t}(u.default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e,t){function r(e){y.debug&&e!==y.recognizerState&&console.log("RecognizerState =>",e),y.recognizerState=e}function i(e){return{identifier:e.identifier,pageX:e.pageX,pageY:e.pageY}}function o(e){var t={};t.touches=[];for(var r=0;r<e.touches.length;++r)t.touches.push(i(e.touches[r]));return t.type=e.type,t}function a(e){for(;y.recognizerStateQueue.length>=y.thresholds.gestureQueueLength;)y.recognizerStateQueue.shift();y.recognizerStateQueue.push(e),y.debug&&console.log(y.recognizerStateQueue)}function s(){y.recognizerStateQueue=[]}function l(e){if(y.recognizerStateQueue.length!==y.thresholds.gestureQueueLength)return!1;for(var t=0,r=0;r<y.recognizerStateQueue.length;++r)y.recognizerStateQueue[r]===e&&(t+=1);return t/y.thresholds.gestureQueueLength>=y.thresholds.gestureConsistency}function u(e){if(y.debug&&console.log("onTouchStart"),y.rawTouchDebug&&console.log(e),!1!==y.enabled)switch(!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&e.preventDefault(),y.domElement.addEventListener("touchend",h,!1),y.domElement.addEventListener("touchmove",c,!1),y.debug&&console.log(y.recognizerState),d=0,f=Date.now(),m=o(e),e.touches.length){case 1:r(y.recognizerState===g.TOBETAP?g.TOBEDOUBLETAP:g.TOUCHSTART);break;case 2:if(y.recognizerState===g.NONE)r(g.TOUCHSTART),s();else if(y.recognizerState===g.DRAGGING){r(g.TOUCHSTART),s();var t={};t.type="drag-end",t.touchEvent=e,y.dispatchEvent(t)}}}function c(e){if(y.debug&&console.log("onTouchMove"),y.rawTouchDebug&&console.log(e),!1!==y.enabled){e.preventDefault(),e.stopPropagation(),d+=1;var t=Date.now();if(p>1e3/60)return y.debug&&console.log("skip the events",p),p=0,void(f=t);switch(e.touches.length){case 1:if(y.recognizerState===g.TOUCHSTART){if(a(g.TOBEDRAG),l(g.TOBEDRAG)){r(g.DRAGSTART);var i={};i.type="drag-start",i.touchEvent=null===v?m:v,y.dispatchEvent(i)}}else if(y.recognizerState===g.TOBEDOUBLETAP&&(a(g.TOBEDRAG),l(g.TOBEDRAG))){r(g.DBLTAPDRAGSTART);var s={};s.type="dbltap-drag-start",s.touchEvent=null===v?m:v,y.dispatchEvent(s)}if(y.recognizerState===g.DRAGSTART||y.recognizerState===g.DRAGGING){r(g.DRAGGING);var u={};u.type="drag",u.touchEvent=e,y.dispatchEvent(u)}else if(y.recognizerState===g.DBLTAPDRAGSTART||y.recognizerState===g.DBLTAPDRAGGING){r(g.DBLTAPDRAGGING);var c={};c.type="dbltap-drag",c.touchEvent=e,y.dispatchEvent(c)}break;case 2:if(y.recognizerState===g.TOUCHSTART||y.recognizerState===g.TOBEROTATE||y.recognizerState===g.TOBEPINCH||y.recognizerState===g.TOBETWOFINGERSWEEP){for(var h=[new n.Vector2,new n.Vector2],b=[new n.Vector2,new n.Vector2],_=0;_<2;++_)h[_].set(m.touches[_].pageX,m.touches[_].pageY);for(var w=0;w<2;++w)b[w].set(e.touches[w].pageX,e.touches[w].pageY);for(var x=[new n.Vector2,new n.Vector2],M=0;M<2;++M)x[M].subVectors(b[M],h[M]);var E=[new n.Vector2,new n.Vector2];E[0].subVectors(h[1],h[0]),E[1].subVectors(h[0],h[1]);var A=[new n.Vector2,new n.Vector2];A[0].subVectors(b[1],b[0]),A[1].subVectors(b[0],b[1]);var T=E[0].length()*A[0].length(),k=E[0].dot(A[0])/T,S=new n.Vector3(E[0].x,E[0].y,0),C=new n.Vector3(A[0].x,A[0].y,0),P=S.cross(C).z/T,O=Math.atan2(P,k),R=Math.abs(A[0].length()-E[0].length()),L=Math.abs(E[0].length()*O);if(y.debug&&(console.log("last",h,"current",b,"delta",x),console.log("dir-angle",180*O/Math.PI,"scale-delta",R,"rotate-delta",L)),R-L>y.thresholds.twoFingerSweepTorlerance||R>L&&L>y.thresholds.twoFingerSweepTorlerance){for(var I=R;I>y.thresholds.twoFingerSweepTorlerance;)a(g.TOBEPINCH),I-=y.thresholds.twoFingerSweepTorlerance;if(l(g.TOBEPINCH)){r(g.PINCHSTART),m=null===v?m:v;var B={};B.type="pinch-start",B.scale=1,B.rotation=0;var D=new n.Vector2;D.addVectors(h[0],h[1]),D.multiplyScalar(.5),B.center={pageX:D.x,pageY:D.y},B.deltaTime=1e3/60,B.touchEvent=m,B.deltaX=0,B.deltaY=0,y.dispatchEvent(B),B.type="pinchrotate-start",y.dispatchEvent(B)}}else if(L-R>y.thresholds.twoFingerSweepTorlerance||R<L&&R>y.thresholds.twoFingerSweepTorlerance){for(var j=L;j>y.thresholds.twoFingerSweepTorlerance;)a(g.TOBEROTATE),j-=y.thresholds.twoFingerSweepTorlerance;if(l(g.TOBEROTATE)){r(g.ROTATESTART);var z={};z.type="rotate-start",z.scale=1,z.rotation=0;var N=new n.Vector2;N.addVectors(h[0],h[1]),N.multiplyScalar(.5),z.center={pageX:N.x,pageY:N.y},z.deltaTime=1e3/60,z.touchEvent=m,z.deltaX=0,z.deltaY=0,y.dispatchEvent(z),z.type="pinchrotate-start",y.dispatchEvent(z)}}else if(x[0].y*x[1].y>0&&Math.abs(x[0].y)>y.thresholds.twoFingerSweepOffset&&Math.abs(x[1].y)>y.thresholds.twoFingerSweepOffset){for(var U=.5*(Math.abs(x[0].y)+Math.abs(x[1].y));U>y.thresholds.twoFingerSweepOffset;)a(g.TOBETWOFINGERSWEEP),U-=y.thresholds.twoFingerSweepOffset;if(l(g.TOBETWOFINGERSWEEP)){r(g.TWOFINGERSWEEPSTART);var F={};F.type="twofingersweep-start",F.scale=1,F.rotation=0;var H=new n.Vector2;H.addVectors(h[0],h[1]),H.multiplyScalar(.5),F.center={pageX:H.x,pageY:H.y},F.deltaTime=1e3/60,F.touchEvent=m,F.deltaX=0,F.deltaY=0,y.dispatchEvent(F)}}else a(g.TOUCHSTART)}if(y.recognizerState===g.TWOFINGERSWEEPSTART||y.recognizerState===g.TWOFINGERSWEEP){r(g.TWOFINGERSWEEP);for(var V=[new n.Vector2,new n.Vector2],G=0;G<2;++G)V[G].set(e.touches[G].pageX,e.touches[G].pageY);var W={};W.type="twofingersweep",W.scale=1,W.rotation=0;var X=new n.Vector2;X.addVectors(V[0],V[1]),X.multiplyScalar(.5),W.center={pageX:X.x,pageY:X.y},W.deltaTime=1e3/60,W.touchEvent=e,W.deltaX=0,W.deltaY=0,y.dispatchEvent(W)}else if(y.recognizerState===g.PINCHSTART||y.recognizerState===g.PINCH){for(var Y=[new n.Vector2,new n.Vector2],q=0;q<2;++q)Y[q].set(m.touches[q].pageX,m.touches[q].pageY);r(g.PINCH);for(var K=[new n.Vector2,new n.Vector2],Z=0;Z<2;++Z)K[Z].set(e.touches[Z].pageX,e.touches[Z].pageY);var Q={};Q.type="pinch";var J=new n.Vector2;J.subVectors(Y[1],Y[0]);var $=new n.Vector2;$.subVectors(K[1],K[0]);var ee=J.length(),te=$.length(),re=J.dot($)/(ee*te),ne=new n.Vector3(J.x,J.y,0),ie=new n.Vector3($.x,$.y,0),oe=ne.cross(ie).z/(ee*te);Q.scale=te/ee,Math.abs(ee)<1e-7&&(Q.scale=1),Q.rotation=180*Math.atan2(oe,re)/Math.PI;var ae=new n.Vector2;ae.addVectors(K[0],K[1]),ae.multiplyScalar(.5),Q.center={pageX:ae.x,pageY:ae.y},Q.deltaTime=1e3/60,Q.touchEvent=e,Q.deltaX=0,Q.deltaY=0,y.dispatchEvent(Q),Q.type="pinchrotate",y.dispatchEvent(Q)}else if(y.recognizerState===g.ROTATESTART||y.recognizerState===g.ROTATE){for(var se=[new n.Vector2,new n.Vector2],le=0;le<2;++le)se[le].set(m.touches[le].pageX,m.touches[le].pageY);r(g.ROTATE);for(var ue=[new n.Vector2,new n.Vector2],ce=0;ce<2;++ce)ue[ce].set(e.touches[ce].pageX,e.touches[ce].pageY);var he={};he.type="rotate";var de=new n.Vector2;de.subVectors(se[1],se[0]);var fe=new n.Vector2;fe.subVectors(ue[1],ue[0]);var pe=de.length(),me=fe.length(),ve=de.dot(fe)/(pe*me),ge=new n.Vector3(de.x,de.y,0),ye=new n.Vector3(fe.x,fe.y,0),be=ge.cross(ye).z/(pe*me);he.scale=me/pe,Math.abs(pe)<1e-7&&(he.scale=1),he.rotation=180*Math.atan2(be,ve)/Math.PI;var _e=new n.Vector2;_e.addVectors(ue[0],ue[1]),_e.multiplyScalar(.5),he.center={pageX:_e.x,pageY:_e.y},he.deltaTime=1e3/60,he.touchEvent=e,he.deltaX=0,he.deltaY=0,y.dispatchEvent(he),he.type="pinchrotate",y.dispatchEvent(he)}break;default:y.debug&&console.log(e)}v=o(e),p=Date.now()-t,y.debug&&console.log("touchMove",f,"ms")}}function h(e){if(y.debug&&console.log("onTouchEnd"),y.rawTouchDebug&&console.log(e),!1!==y.enabled){y.debug&&console.log(d),y.debug&&console.log(y.handlers),y.debug&&console.log(e),y.debug&&console.log(m),y.debug&&console.log(y.recognizerState);var t=Date.now();if(y.recognizerState===g.TWOFINGERSWEEP){r(g.NONE),s();var n={};n.type="twofingersweep-end",n.touchEvent=v,y.dispatchEvent(n)}else if(y.recognizerState===g.ROTATE){r(g.NONE),s();var i={};i.type="rotate-end",i.touchEvent=v,y.dispatchEvent(i),i.type="pinchrotate-end",y.dispatchEvent(i)}if(y.recognizerState===g.PINCH){r(g.NONE),s();var o={};o.type="pinch-end",o.touchEvent=v,y.dispatchEvent(o),o.type="pinchrotate-end",y.dispatchEvent(o)}else switch(m.touches.length){case 1:if(0===d){if(t-f>y.thresholds.singleTapTimeout){r(g.NONE),y.debug&&console.log("Cancel a tap because it is hold for too long");break}if(y.recognizerState!==g.TOBEDOUBLETAP)y.debug&&console.log("first Tapping"),r(g.TOBETAP),setTimeout(function(){var e=m;return function(){if(y.recognizerState===g.TOBETAP){r(g.TAP);var t={};t.type="tap",t.touchEvent=e,y.dispatchEvent(t),r(g.NONE)}}}(),y.thresholds.doubleTapTimeout);else{y.debug&&console.log("second Tapping"),r(g.DOUBLETAP);var a={};a.type="double-tap",a.touchEvent=m,y.dispatchEvent(a),r(g.NONE)}}else if(y.recognizerState===g.DRAGGING){r(g.NONE),s();var l={};l.type="drag-end",l.touchEvent=e,y.dispatchEvent(l)}else if(y.recognizerState===g.DBLTAPDRAGGING){r(g.NONE),s();var u={};u.type="dbltap-drag-end",u.touchEvent=e,y.dispatchEvent(u)}}d=-1,m=null,v=null,y.domElement.removeEventListener("touchend",h,!1),y.domElement.removeEventListener("touchmove",c,!1)}}if(void 0===e)return void console.error("Invalid domElement");t=t||{},t.handlers=t.handlers||{},t.thresholds=t.thresholds||{},this.domElement=e,this.enabled=!0,this.debug=t.debug||!1,this.rawTouchDebug=!1,this.handlers={tap:t.handlers.tap||null,"double-tap":t.handlers["double-tap"]||null,"drag-start":t.handlers["drag-start"]||null,drag:t.handlers.drag||null,"drag-end":t.handlers["drag-end"]||null,"pinch-start":t.handlers["pinch-start"]||null,pinch:t.handlers.pinch||null,"pinch-end":t.handlers["pinch-end"]||null,"rotate-start":t.handlers["rotate-start"]||null,rotate:t.handlers.rotate||null,"rotate-end":t.handlers["rotate-end"]||null,"twofingersweep-start":t.handlers["twofingersweep-start"]||null,twofingersweep:t.handlers.twofingersweep||null,"twofingersweep-end":t.handlers["twofingersweep-end"]||null},this.thresholds={doubleTapTimeout:void 0===t.thresholds.doubleTapTimeout?500:t.thresholds.doubleTapTimeout,singleTapTimeout:250,holdTapTimeout:600,twoFingerSweepTorlerance:4,twoFingerSweepOffset:void 0===t.thresholds.twoFingerSweepOffset?2:t.thresholds.twoFingerSweepOffset,gestureQueueLength:void 0===t.thresholds.gestureQueueLength?3:t.thresholds.gestureQueueLength,gestureConsistency:void 0===t.thresholds.gestureConsistency?.66:t.thresholds.gestureConsistency},this.thresholds.twoFingerSweepOffset=Math.max(1,this.thresholds.twoFingerSweepOffset),this.thresholds.twoFingerSweepTorlerance=Math.max(1,this.thresholds.twoFingerSweepTorlerance),this.debug&&console.log("Init recognizer",this.handlers,this.thresholds);var d=-1,f=0,p=0,m=null,v=null,g={NONE:-1,TOUCHSTART:0,TOBETAP:1,TOBEDOUBLETAP:2,TAP:3,DOUBLETAP:4,TOBEDRAG:10,DRAGSTART:11,DRAGGING:12,DRAGEND:13,TOBEPINCH:20,PINCHSTART:21,PINCH:22,PINCHEND:22,TOBEROTATE:30,ROTATESTART:31,ROTATE:32,ROTATEEND:33,TOBETWOFINGERSWEEP:40,TWOFINGERSWEEPSTART:41,TWOFINGERSWEEP:42,TWOFINGERSWEEPEND:43,DBLTAPDRAGSTART:51,DBLTAPDRAGGING:52,DBLTAPDRAGEND:53};this.recognizerState=g.NONE,this.recognizerStateQueue=[];var y=this;y.domElement.addEventListener("touchstart",u,!1)};i.prototype=Object.create(n.EventDispatcher.prototype),i.prototype.constructor=i,t.default=i},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),c=r(88),h=n(c),d=r(38),f=n(d),p=r(3),m=n(p),v=r(13),g=n(v),y=r(7),b=n(y),_=r(46),w=n(_),x=r(87),M=n(x),E=r(24),A=n(E),T=function(e){function t(e,r){function n(){if(!this._apiInfo)return console.warn("createEarthSpaceMarker _apiInfo not available"),null;var e=g.default.EarthResolution,t=this._apiInfo.geoInfo.centerLong,r=this._apiInfo.geoInfo.centerLat,n=m.default.geographicToEarthSurface(e,t,r,this.earthRadius),i=m.default.getGeoNormalOnEarthSurface(e,t,r),o=this.earthRadius/10,a={dir:i,origin:n,earthRadius:this.earthRadius,projInfo:this._apiInfo},s={maxAnisotropy:this.options.maxAnisotropy,color:16109078,length:o};return new M.default(a,s)}i(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,f.default,r)),s=a;a.debug=!1,a.isMobile=r.isMobile,a.earthRadius=r.earthRadius,a.debug&&console.log("AltizureMeshEntity",r),a.options.viewModeType={TEXTURE:0,FLAT:1,WIREFRAME:2,SELECT:3,CROP:4},a.options.viewMode=a.options.viewModeType.CROP,a.options.PID=a.PID,a._onError=r.onError,a._apiInfo=r.apiInfo,a._projectInfo=function(e){function t(e){return e instanceof Array&&3===e.length?new u.Vector3(e[0],e[1],e[2]):e&&e.x&&e.y&&e.z?new u.Vector3(e.x,e.y,e.z):void console.error("objToVec3 invalid obj",e)}var r=s._apiInfo.modelTransform;return{origin:t(r.origin),x_dir:t(r.xDir),y_dir:t(r.yDir),z_dir:t(r.zDir),max_bound:t(r.maxBound),min_bound:t(r.minBound),x_tiles:r.xTiles,y_tiles:r.yTiles,z_tiles:r.zTiles,floor_height:r.floorHeight,length_unit_to_meter:r.lengthUnitToMeter,isMobile:s.isMobile,minLevel:0,maxLevel:function(e,t){for(var r=Math.max(e,t),n=0;r>1;)r/=2,n++;return n}(r.xTiles,r.yTiles),onLoadTrans:r.onLoadTrans}}(a._apiInfo),a.useRemoteAltizureServer=r.useRemoteAltizureServer||"",a._infoImporting=!1,a._infoImported=!1,a.cameraFov=-1,a.tanHalfFov=0,a.markerObject3D=new u.Object3D,a.markerObject3D.matrixAutoUpdate=!1;var l=n.bind(a);return a.marker=l(),null!==a.marker&&(a.sceneNode.add(a.markerObject3D),a.markerObject3D.add(a.marker),a.marker.updateMatrixWorld(!0)),a._tree=null,a.name=a.PID,a.sceneNode.name=a.name,a.treeNode=new u.Object3D,a.sceneNode.add(a.treeNode),a.eventHandlers={onEntityCreated:r.eventHandlers.onEntityCreated,onEntityModelInitialized:r.eventHandlers.onEntityModelInitialized},a.randomSpinOffset=Math.random()*Math.PI*2,a.currentTime=0,a}return a(t,e),l(t,[{key:"startImport",value:function(){function e(){var e=r.earthRadius,n=e/m.default.EARTH_RADIUS,i=g.default.EarthResolution,o={longitude:r._apiInfo.geoInfo.centerLong,latitude:r._apiInfo.geoInfo.centerLat},a=m.default.getLocalSystemOnEarthSurface(i,o.longitude,o.latitude,e),l=new b.default;if(l.makeBasis(a.lng.multiplyScalar(n),a.lat.multiplyScalar(n),a.alt.multiplyScalar(n)),l.setPosition(a.origin),1!==r.projectInfo.length_unit_to_meter){var c=r.projectInfo.length_unit_to_meter,h=(new b.default).makeScale(c,c,c);t&&console.log(c,h),l.multiply(h)}var d=new b.default;d.makeTranslation(-r.projectInfo.origin.x,-r.projectInfo.origin.y,-(r.projectInfo.min_bound.z+r.projectInfo.origin.z)),l.multiply(d),r.setMatrix(l),r.options.eventHandlers={onContentDisposed:function(){return!0},onContentInitialized:function(){return r.marker.fadeOutBox(r.currentTime),r.eventHandlers.onEntityModelInitialized(),!0}};var f=r.projectInfo,p={origin:f.origin.clone(),x_dir:f.x_dir.clone(),y_dir:f.y_dir.clone(),z_dir:f.z_dir.clone(),max_bound:f.max_bound.clone(),min_bound:f.min_bound.clone(),x_tiles:f.x_tiles,y_tiles:f.y_tiles,z_tiles:f.z_tiles,floor_height:f.floorHeight||f.floor_height,length_unit_to_meter:f.lengthUnitToMeter||f.length_unit_to_meter,isMobile:f.isMobile,minLevel:f.minLevel,maxLevel:f.maxLevel,tile_salt:f.tile_salt||r.versionControl,onLoadTrans:f.onLoadTrans};if(void 0===p.transformation){var v=new u.Matrix4;p.onLoadTrans instanceof Array?3===p.onLoadTrans.length?v.makeRotationX(Math.PI*p.onLoadTrans[0]).multiply((new u.Matrix4).makeRotationY(Math.PI*p.onLoadTrans[1])).multiply((new u.Matrix4).makeRotationZ(Math.PI*p.onLoadTrans[2])):16===p.onLoadTrans.length?v.set.apply(v,p.onLoadTrans):console.error("AltizureMeshEntity createTree: incorrect onLoadTrans",p.onLoadTrans):"object"===s(p.onLoadTrans)&&void 0!==p.onLoadTrans.x&&void 0!==p.onLoadTrans.y&&void 0!==p.onLoadTrans.z&&v.makeRotationX(Math.PI*p.onLoadTrans.x).multiply((new u.Matrix4).makeRotationY(Math.PI*p.onLoadTrans.y)).multiply((new u.Matrix4).makeRotationZ(Math.PI*p.onLoadTrans.z));var y=v.multiply((new u.Matrix4).makeTranslation(-p.origin.x,-p.origin.y,-p.origin.z));void 0===p.length_unit_to_meter&&(p.length_unit_to_meter=1),p.transformation=new A.default,p.transformation.set({onload:y,scale:p.length_unit_to_meter})}r.options.dataPath=r.preferredPath,r._tree=new r.TreeType(r.TileType,r.treeNode,r.dataUrl,p,r.options),r._infoImported=!0,r._infoImporting=!1,r.options.forest&&r.options.forest.add(r._tree);try{var _=new b.default;_.getInverse(r.matrix,!0),r.markerObject3D.matrix.copy(_)}catch(e){console.warn("inverse failed")}return!0}var t=!1;this._infoImporting=!0,t&&console.log("startImport",this._apiInfo);var r=this;return Promise.resolve().then(function(){return r._infoImporting?(e(),r.eventHandlers.onEntityCreated(),Promise.resolve()):Promise.reject(new Error("import is stopped (possibly by deport)"))}).catch(function(e){return Promise.reject(e)})}},{key:"deport",value:function(){var e=!0;return this._infoImported=!1,this._infoImporting=!1,this.options.forest&&this.options.forest.remove(this._tree),this._tree&&(e=e&&this._tree.destruct(),this._tree=null),this.debug&&console.log("AltizureMeshEntity deport",this._apiInfo.name,e?"success":"fail"),e}},{key:"detach",value:function(){this.parent.removeEntity(this)}},{key:"sceneUpdated",value:function(e){var t=this,r=this.checkVisibility(e),n=r.area;r.centerInScreen&&n>.01?(new u.Color(65280),this._infoImported||this._infoImporting||(null!==this._tree?console.warn("this._tree exists",this._tree):(this.marker.addBox(),this.startImport().then(function(){return t.debug&&console.log("startImport resolved",t.options),Promise.resolve()}).catch(function(e){return Promise.resolve(e)})))):n>=.005&&n<=.01?new u.Color(16776960):n<.001&&n>=0?(new u.Color(16711680),this._infoImported?this.deport():this._infoImporting&&this.deport()):n<0?(this.marker.visable=!1,new u.Color(16711680)):new u.Color(16776960);var i=t.marker.age<3;return n<=.001&&n>1e-4||i?this.marker.addTag():n<=9e-5&&n>0&&!i&&this.marker.removeTag(),n>.1&&!i?this.marker.hideTag():(n<=.1&&n>1e-4||i)&&this.marker.showTag(),Promise.resolve()}},{key:"updateVisibility",value:function(e){if(null!==this._tree){var t=e.frustum;this._tree.updateVisibility(t)}}},{key:"checkVisibility",value:function(e){function t(t){var r=t.clone();return r.applyMatrix4(o).applyMatrix4(e.pvmatrix),r.x<=1&&r.x>=-1&&r.y<=1&&r.y>=-1&&r.z<=1&&r.z>=-1}var r=this,n={area:0,centerInScreen:!1},i=e.camera.getWorldDirection().normalize(),o=this.parent.matrixWorld.toThreeMatrix4(),a=(new u.Matrix3).getNormalMatrix(o),s=this.normal.clone().applyMatrix3(a).normalize();if(!(i.clone().dot(s)<-.1))return n.centerInScreen=!1,n.area=-1,n;var l=this.CartesianEnvelope,c=function(t){for(var r=[],n={front:!1,back:!1},i=0;i<t.length;i++)if(r[i]=t[i].clone(),r[i].applyMatrix4(o).applyMatrix4(e.pvmatrix),r[i].z>1?n.back=!0:r[i].z<1&&(n.front=!0),n.front&&n.back)return 666;for(var a=0,s=[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],l=[],u=0;u<r.length;u++)l.push({x:r[u].x,y:r[u].y});return a=w.default.polygonIntersectArea(s,l),a<0&&(a=0),a}(l);return n.area=c,n.centerInScreen=!(c<=0)&&function(){return t(r.center)}(),n}},{key:"animate",value:function(e){function t(){var t=this.parent.matrixWorld.toThreeMatrix4(),r=e.camera.position.clone(),n=this.center.applyMatrix4(t),i=r.sub(n).length(),o=Math.min(i/10,this.earthRadius/10);this.marker.setLength(o),this.cameraFov!==e.camera.fov&&(this.cameraFov=e.camera.fov,this.tanHalfFov=Math.tan(.5*e.camera.fov*Math.PI/180));var a=.5*e.viewportSize.height/this.tanHalfFov,s=o/this.earthRadius*15e3*(160/a)*10;if(this.marker.tagHolder.scale.set(s,s,1),this.marker.dropPin.isDropping){var l=this.marker.dropPin;if(null===l.start)l.start=this.currentTime;else{var c=l.span-(this.currentTime-l.start);if(c<=0)l.isDropping=!1,l.start=null,this.marker.position.copy(this.marker.init.origin);else{var h=this._apiInfo.views||1;h=Math.max(h,1)/100;var d=c/l.span/h,f=i*d*d,p=this.marker.init.origin.clone().normalize().multiplyScalar(f);this.marker.position.copy(this.marker.init.origin).add(p)}this.marker.visible=!0}}if(null!==this.marker.box){var m=new u.Quaternion;m.setFromAxisAngle(new u.Vector3(0,1,0),this.randomSpinOffset+5*e.currentTime),this.marker.boxHolder.quaternion.copy(m);var v=Math.min(i/100,this.earthRadius/1e3);if(this.marker.boxHolder.position.set(0,v,0),this.marker.fadingBox.isFading){var g=e.currentTime-this.marker.fadingBox.start;if(g>this.marker.fadingBox.span)this.marker.fadingBox.isFading=!1,this.marker.fadingBox.start=0,this.marker.removeBox();else{var y=g/this.marker.fadingBox.span;this.marker.box.material.opacity=this.marker.box.material.opacity*(1-y*y),this.marker.box.material.needsUpdate=!0}}}}this.currentTime=e.currentTime,t.bind(this)()}},{key:"versionControl",get:function(){return this._apiInfo.versionControl}},{key:"preferredPath",get:function(){for(var e=this.options.cloudPriorityList,t=this._apiInfo.cloudPath,r=0;r<e.length;r++)for(var n=0;n<t.length;n++)if(t[n].key===e[r])return t[n].dataUrl;console.error("preferredPath error",this.projectName,t,e)}},{key:"projectName",get:function(){return this._apiInfo.name}},{key:"projectInfo",get:function(){return this._projectInfo}},{key:"dataUrl",get:function(){var e=this.preferredPath;return e&&e.length>0&&"/"===e[0]&&(e="https://www.altizure.com"+e),e+"/web/"}},{key:"CartesianEnvelope",get:function(){if(!this._apiInfo)return null;var e=g.default.EarthResolution,t=this._apiInfo.geoInfo,r=t.minLong,n=t.maxLong,i=t.minLat,o=t.maxLat,a=[];a[3]=m.default.geographicToEarthSurface(e,r,i,this.earthRadius),a[2]=m.default.geographicToEarthSurface(e,r,o,this.earthRadius),a[1]=m.default.geographicToEarthSurface(e,n,o,this.earthRadius),a[0]=m.default.geographicToEarthSurface(e,n,i,this.earthRadius);for(var s=0;s<4;s++)a[s]=new u.Vector3(a[s].x,a[s].y,a[s].z);return a}},{key:"center",get:function(){var e=g.default.EarthResolution,t=this._apiInfo.geoInfo.centerLong,r=this._apiInfo.geoInfo.centerLat;return m.default.geographicToEarthSurface(e,t,r,this.earthRadius)}},{key:"normal",get:function(){if(!this._apiInfo)return null;var e=this._apiInfo.geoInfo.centerLong,t=this._apiInfo.geoInfo.centerLat,r=m.default.geographicToCartesianCoord(e,t,1);return new u.Vector3(r.x,r.y,r.z).normalize()}}]),t}(h.default);t.default=T},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){n(this,e)}return i(e,null,[{key:"polygonIntersectArea",value:function(e,t){function r(e,t){this.x=e,this.y=t}function n(e,t){this.min=e,this.max=t}function i(e,t){this.mn=e,this.mx=t}function o(){this.x=0,this.y=0}function a(){this.ip=null,this.rx=null,this.ry=null,this.in=0}function s(e,t){for(var r=e.length;r--;)t.min.x=Math.min(t.min.x,e[r].x),t.min.y=Math.min(t.min.y,e[r].y),t.max.x=Math.max(t.max.x,e[r].x),t.max.y=Math.max(t.max.y,e[r].y)}function l(e,t,r){return t.x*r.y-t.y*r.x+e.x*(t.y-r.y)+e.y*(r.x-t.x)}function u(e,t){return e.mn<t.mx&&t.mn<e.mx}function c(e,t,r,n,i){p+=i*(r-e)*(n+t)/2}function h(e,t,r,n){for(var s=e.length,l=s;l--;)t[l]=new a,t[l].ip=new o,t[l].ip.x=-8&Math.floor((e[l].x-n.min.x)*m-g)|r|1&l,t[l].ip.y=-8&Math.floor((e[l].y-n.min.y)*v-g)|r;for(t[0].ip.y+=1&s,t[s]=t[0],l=s;l--;)t[l].rx=t[l].ip.x<t[l+1].ip.x?new i(t[l].ip.x,t[l+1].ip.x):new i(t[l+1].ip.x,t[l].ip.x),t[l].ry=t[l].ip.y<t[l+1].ip.y?new i(t[l].ip.y,t[l+1].ip.y):new i(t[l+1].ip.y,t[l].ip.y),t[l].in=0}function d(e,t,r,n,i,o,a,s){var l=i/(i+o),u=a/(a+s);c(Math.floor(e.ip.x+l*(t.ip.x-e.ip.x)),Math.floor(e.ip.y+l*(t.ip.y-e.ip.y)),t.ip.x,t.ip.y,1),c(n.ip.x,n.ip.y,Math.floor(r.ip.x+u*(n.ip.x-r.ip.x)),Math.floor(r.ip.y+u*(n.ip.y-r.ip.y)),1),++e.in,--r.in}function f(e,t,r,n){for(var i=0,o=n,a=e[0].ip;o--;)if(r[o].rx.mn<a.x&&a.x<r[o].rx.mx){var s=l(a,r[o].ip,r[o+1].ip),u=s>0;i+=u!==r[o].ip.x<r[o+1].ip.x?0:u?-1:1}for(var h=0;h<t;++h)0!==i&&c(e[h].ip.x,e[h].ip.y,e[h+1].ip.x,e[h+1].ip.y,i),i+=e[h].in}var p=0,m=0,v=0,g=25e3;return function(e,t){for(var i=e.length,o=t.length,a=[],c=i+1;c--;)a[c]=null;var g=[];for(c=o+1;c--;)g[c]=null;var y=new n(new r(1/0,1/0),new r(-1/0,-1/0));if(i<3||o<3)return 0;s(e,y),s(t,y);var b=y.max.x-y.min.x;m=5e4/b;var _=y.max.y-y.min.y;v=5e4/_;var w=m*v;h(e,a,0,y),h(t,g,2,y);for(var x=0;x<i;++x)for(var M=0;M<o;++M)if(u(a[x].rx,g[M].rx)&&u(a[x].ry,g[M].ry)){var E=-l(a[x].ip,g[M].ip,g[M+1].ip),A=l(a[x+1].ip,g[M].ip,g[M+1].ip),T=E<0;if(T===A<0){var k=l(g[M].ip,a[x].ip,a[x+1].ip),S=-l(g[M+1].ip,a[x].ip,a[x+1].ip);k<0==S<0&&(T?d(a[x],a[x+1],g[M],g[M+1],E,A,k,S):d(g[M],g[M+1],a[x],a[x+1],k,S,E,A))}}return f(a,i,g,o),f(g,o,a,i),p/w}(e,t)}},{key:"testPolygonIntersectArea",value:function(){function t(e){for(var t=[],r=0;r<e.length;r++)t[r]={x:e[r][0],y:e[r][1]};return t}function r(r,n){r=t(r),n=t(n),console.log("polygons intersect area",e.polygonIntersectArea(r,n),e.polygonIntersectArea(r,r))}var n=[[2,3],[2,3],[2,3],[2,4],[3,3],[2,3],[2,3]],i=[[1,1],[1,4],[4,4],[4,1],[1,1]],o=[[1,7],[4,7],[4,6],[2,6],[2,3],[4,3],[4,2],[1,2]],a=[[3,1],[5,1],[5,4],[3,4],[3,5],[6,5],[6,0],[3,0]],s=[[1,1],[1,2],[2,1],[2,2]],l=[[0,0],[0,4],[4,4],[4,0]],u=[[0,0],[3,0],[3,2],[1,2],[1,1],[2,1],[2,3],[0,3]],c=[[0,0],[0,4],[4,4],[4,0]],h=[[0,0],[1,0],[0,1]],d=[[0,0],[0,1],[1,1],[1,0]],f=[[1,3],[2,3],[2,0],[1,0]],p=[[0,1],[3,1],[3,2],[0,2]],m=[[0,0],[0,2],[2,2],[2,0]],v=[[1,1],[3,1],[3,3],[1,3]],g=[[0,0],[0,4],[4,4],[4,0]],y=[[1,1],[1,2],[2,2],[2,1]];r(n,i),r(o,a),r(s,l),r(u,c),r(h,d),r(f,p),r(m,v),r(g,y)}}]),e}();t.default=o},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t,r,i,o,a){n(this,e),this.x=t,this.y=r,this.level=i,this.options=a,this.loaded=!1,this.loading=!1,this.expired=!1,this.name="SmartTile_"+this.level+"_"+this.x+"_"+this.y,this.mesh=void 0,this.visible=!0,this.sceneGraphRoot=void 0,this.parent=o,this.nodes=[],this.needsPrune=!1}return i(e,[{key:"info",value:function(){return{level:this.level,x:this.x,y:this.y}}},{key:"isInFrustum",value:function(){return console.error("isInFrustum is not implemented."),!1}},{key:"screenArea",value:function(){return console.error("screenArea is not implemented."),0}},{key:"tileLoader",value:function(){return console.warn("tileLoader is not implemented"),Promise.reject("tileLoader is not implemented")}},{key:"onLoaded",value:function(e){var t=!0;return this.loaded?(console.warn("trying to assign mesh to a loaded tile",this,e),t=!1):(this.mesh=e,this.options.debug&&console.log("onload",JSON.stringify(this.info())),this.loaded=!0),t}},{key:"dispose",value:function(){return this.options.debug&&console.log("disposing",JSON.stringify(this.info())),this.isInScene()&&this._removeFromSceneGraph(),this.x=void 0,this.y=void 0,this.level=void 0,this.parent=void 0,this.options=void 0,this.name=void 0,this.visible=void 0,this.mesh=void 0,this.loaded=!1,this.expired=!0,this.sceneGraphRoot=void 0,this.nodes=void 0,!0}},{key:"isInScene",value:function(){return void 0!==this.sceneGraphRoot}},{key:"setVisibility",value:function(e){this.visible=e}},{key:"displayByload",value:function(e){this.options.debug&&console.log("displayByload",JSON.stringify(this.info()));var t=!1;return this.loaded?t=null!==this.parent||this.isInScene()?this._replaceParentAttempt(e)&&t:this._addToSceneAsync(e)&&t:(console.error("not loaded but display atttempt"),t=!1)}},{key:"_replaceParentAttempt",value:function(e){var t=!1;if(!this.loaded)return console.error("not loaded but display atttempt"),t=!1;if(null!==this.parent||this.isInScene()){for(var r=this.parent.nodes,n=!0,i=0;i<r.length&&(n=r[i].loaded&&n);i++);if(n&&this.parent.isInScene()){for(this.parent._removeFromSceneGraph(),i=0;i<r.length;i++)r[i]._addToSceneAsync(e);t=!0}}else this._addToSceneAsync(e),t=!0;return t}},{key:"_addToSceneAsync",value:function(e){return this._addToSceneGraph(e),this._beReplacedAttempt(e),!0}},{key:"_beReplacedAttempt",value:function(e,t){var r=!0;if(!this.loaded)return console.error("not loaded but display atttempt"),r=!1;if(!this.isInScene())return console.error("not in scene but be replaced atttempt"),r=!1;if(0===this.nodes.length)r=!1;else if(4===this.nodes.length){for(var n=!0,i=0;i<this.nodes.length&&(n=this.nodes[i].loaded&&n);i++);if(n){this._removeFromSceneGraph();for(var o=0;o<this.nodes.length;o++)this.nodes[o]._addToSceneAsync(e);r=!0}}else console.error("node with unexpected number of children",this),r=!1;return r}},{key:"displayByPrune",value:function(e){this.options.debug&&console.log("displayByPrune",JSON.stringify(this.info()));var t=!1;if(!this.loaded)return t=!1;if(null===this.parent)this._addToSceneGraph(e),t=!0;else{if(!this.parent.loaded)return t=!1;for(var r=this.parent.nodes,n=!0,i=0;i<r.length&&(n=r[i].loaded&&n);i++);n&&(this.parent.isInScene()||this.isInScene()||function(e){for(var t=e.parent;null!==t;){if(t.isInScene())return t;t=t.parent}}(this)||this._addToSceneGraph(e),t=!0)}return t}},{key:"_addToSceneGraph",value:function(e){var t=this,r=this.options.debug,n=!0;return void 0===this.mesh?(console.warn(JSON.stringify(this.info())+", mesh undefined, cannot add to scene"),n=!1):void 0===e?(console.warn("sceneGraphRoot undefined"),n=!1):void 0!==this.sceneGraphRoot?(console.warn("Twice adding to scene attempt",this.info()),n=!1):(this.setVisibility(this.visible),e.add(this.mesh),t.sceneGraphRoot=e,r&&console.log("add to scene",this.info()),n=n&&!0),n}},{key:"_removeFromSceneGraph",value:function(){var e=this,t=this.options.debug,r=!0;return void 0!==this.sceneGraphRoot&&void 0!==this.mesh?(this.sceneGraphRoot.remove(this.mesh),e.sceneGraphRoot=void 0,this.mesh.place_holder?this.mesh.visible=!1:this.mesh.visible=!0,t&&console.log("remove from scene",this.info()),r):(console.warn("_removeFromSceneGraph fail",this),r=!1)}}],[{key:"releaseMemory",value:function(){return console.warn("releaseMemory is not implemented"),!1}}]),e}();t.default=o},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(102),s=n(a),l=r(28),u=n(l),c=r(107),h=n(c),d=r(49),f=n(d),p=function(){function e(t,r,n){i(this,e),this.MAX_THREADS=n.MAX_THREADS||8,this.MAX_CACHE_SIZE=n.MAX_CACHE_SIZE||100,this.Node=t,this.sceneGraphRoot=r,this.root=null,this.tree_size_limit=1,this.numOfNodes=0,this.maxLevel=0,this.minLevel=0,this.smart_options=n,this.smart_options.loading={session:0,left:0,total:0},this.smart_options.debug&&(console.log("sceneGraphRoot",JSON.stringify(this.sceneGraphRoot.matrixWorld)),console.log("smart option",this.smart_options)),this.eventQueue=new h.default,this.tile_retriever=null,this.node_options={debug:this.smart_options.debug,onError:this.smart_options.onError,eventQueue:this.eventQueue},this.flags={modelInitialized:!1},this.eventHandlers=n.eventHandlers||{onContentDisposed:void 0,onContentInitialized:void 0}}return o(e,[{key:"destruct",value:function(){var e=!0;return e=e&&this.dispose(this.root),this.root=null,this._onContentDisposed(),this.tile_retriever&&(e=e&&this.tile_retriever.destruct(),this.tile_retriever=null),e}},{key:"expand",value:function(e){return console.error("expand is not implemented"),!1}},{key:"dispose",value:function(e){var t=this.smart_options.debug;if(void 0===e)return!1;var r=!0;void 0===e.nodes&&console.warn("inspect",e.info());for(var n=0;n<e.nodes.length;n++)r=this.dispose(e.nodes[n])&&r;return t&&console.log("delete",JSON.stringify(e.info())),r=e.dispose()&&r,e=void 0,this.numOfNodes--,r}},{key:"prune",value:function(e){if(void 0===e)return console.warn("Trying to prune undefined node"),!1;var t=!0;if(e.isInScene()||e.displayByPrune(this.sceneGraphRoot),e.nodes.length>0){for(var r=0;r<e.nodes.length;r++)t=this.dispose(e.nodes[r])&&t;e.nodes=[]}return t}},{key:"updateVisibility",value:function(e){var t=!0;this.smart_options.frustum=e;var r=this.sceneGraphRoot;return r&&(t=this.traverse(this.root,function(t){var n=t.isInFrustum(e,r);return t.setVisibility(n),!0})&&t),t||console.warn("updateVisibility has problems"),t}},{key:"updateView",value:function(e,t,r){var n=!0,i=this.smart_options.debug;return this.smart_options.camera=e,this.smart_options.pvmatrix=t,this.smart_options.frustum=r,this.sceneGraphRoot.updateMatrixWorld(),i&&(console.log("update view"),console.time("rebuild")),n=this.rebuild()&&n,i&&console.timeEnd("rebuild"),i&&console.log("updateView numOfNodes",this.numOfNodes),this.numOfNodes>500&&console.warn("Out of cache capacity",JSON.stringify(e),JSON.stringify(t)),n||console.warn("updateView has problems"),n}},{key:"traverse",value:function(e,t,r,n){var i=!0;i=i&&t(e,r,n);for(var o=0;o<e.nodes.length;o++)i=i&&this.traverse(e.nodes[o],t,r,n);return i}},{key:"rebuild",value:function(){var e=this.smart_options.debug,t=this,r=!0,n=this.smart_options.MIN_AREA;e&&console.log("MIN_AREA",n);var i=new f.default(function(e,t){return t.key-e.key}),o=0;r=this.traverse(this.root,function(e){return e.needsPrune=!0,!0})&&r,r||console.warn("init needsPrune has problems"),i.enqueue(Number.MAX_VALUE,this.root),o++;do{if(o>=this.tree_size_limit){e&&console.warn("tree size limit reached",this.tree_size_limit);break}var a=i.dequeue();void 0===a&&(console.warn("undefined element in priority queue",a),console.log("pq empty",i.isEmpty()));var s=a.key,l=a.value;if(s<n){e&&console.log("min area reached",s,n);break}if(l.needsPrune=!1,e&&console.log("node in tree",l.info()),l.level<this.maxLevel){0===l.nodes.length&&(r=this.expand(l)&&r);for(var u=0;u<l.nodes.length;u++){var c=l.nodes[u];c.needsPrune=!0;var h=c.screenArea(this.smart_options.camera,this.smart_options.pvmatrix,this.smart_options.frustum,this.sceneGraphRoot);h>0||c.setVisibility(!1),h>=n&&i.enqueue(h,c)}o+=4}}while(!i.isEmpty());if(r||console.warn("expand has problems"),i.clear(),r=this.traverse(this.root,function(e){return!e.needsPrune||t.prune(e)})&&r,r||console.warn("prune has problems"),e){var d={size:0,level:0,nodes:[]};this.traverse(this.root,function(e,t){return t.size++,e.level>t.level&&(t.level=e.level),t.nodes.push({x:e.x,y:e.y,level:e.level}),!0},d),console.log("smart tree",d)}return r}},{key:"loadUnloadedTiles",value:function(){function e(t){t.loaded&&o.tile_retriever.request(t,void 0,function(){});for(var r=t.nodes,n=0;n<r.length;n++)e(r[n])}function t(){if(n){console.log("validateScene");var e=o.sceneGraphRoot.children,t=0,r=void 0,i=void 0,a=[];try{for(var s=0;s<e.length;s++){var l=e[s];"EarthSurfaceTree"===o.name&&"meshHolder"===l.name&&(l=l.children[0]),(r=l.debug_info)&&(null===l.geometry&&(console.warn("escaper mesh",l),a.push(l)),i=Math.pow(2,o.maxLevel-r.level),t+=i*i)}var u=Math.pow(2,o.maxLevel);t===u*u?console.log("validated",t):console.warn("validation fail",t,"/",u*u,o.sceneGraphRoot)}catch(e){console.warn("validation exception",e)}}}var r=this,n=this.smart_options.debug,i=new u.default;i.enqueue(this.root);var o=this,a=0;for(null===this.tile_retriever&&(this.tile_retriever=new s.default({debug:this.smart_options.debug,cache_size:this.MAX_CACHE_SIZE,dock_capacity:this.MAX_THREADS,allow_worker:window.Worker&&this.smart_options.allow_worker,display_lod:this.smart_options.display_lod})),this.tile_retriever.clear(),e(this.root),this.smart_options.loading.session++,this.smart_options.loading.total=0,this.smart_options.loading.left=0;!i.isEmpty();){var l;!function(){var e=i.dequeue();if(e.loaded||(a++,r.smart_options.loading.total++,r.smart_options.loading.left++,r.tile_retriever.request(e,r.smart_options.loading.session,function(r,i){e.expired||i!==o.smart_options.loading.session||(e.setVisibility(e.visible),e.onLoaded(r),e.displayByload(o.sceneGraphRoot),o.flags.modelInitialized||o._onContentInitialized(),n&&(r.debug_info=e.info()),i===o.smart_options.loading.session&&0==--o.smart_options.loading.left&&(n||window.dispatchEvent(new CustomEvent("load_complete",{detail:o})),n&&(console.log("loading session",i,"successfully completed"),console.log("TileRetriever info",o.tile_retriever.info()),t())))})),void 0!==e.nodes)for(l=0;l<e.nodes.length;l++)i.enqueue(e.nodes[l])}()}n&&console.log("loadRootTiles node number",a)}},{key:"_onContentInitialized",value:function(){this.flags.modelInitialized=!0,this.eventHandlers.onContentInitialized&&this.eventHandlers.onContentInitialized()}},{key:"_onContentDisposed",value:function(){this.flags.modelInitialized=!1,this.eventHandlers.onContentDisposed&&this.eventHandlers.onContentDisposed()}}]),e}();t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(98),i=function(e){return e&&e.__esModule?e:{default:e}}(n),o=function(e){this.heap=new i.default(e)};o.prototype.constructor=o,o.prototype.enqueue=function(e,t){return this.heap.insert(e,t)},o.prototype.dequeue=function(){return this.heap.extractMinimum()},o.prototype.clear=function(){this.heap.clear()},o.prototype.isEmpty=function(){return this.heap.isEmpty()},t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(e){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,browser:{isWeChat:navigator.userAgent.indexOf("MicroMessenger")>=0,isOpera:!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,isFirefox:"undefined"!=typeof InstallTrigger,isSafari:Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,isChrome:!!window.chrome,isIE:!!document.documentMode},getWebGLErrorMessage:function(){var e=document.createElement("div");return e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.textAlign="center",e.style.background="#eee",e.style.color="#000",e.style.padding="1em",e.style.width="475px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/">here</a>.'].join("\n")),e},addGetWebGLMessage:function(e){var t,r,i;e=e||{},t=void 0!==e.parent?e.parent:document.body,r=void 0!==e.id?e.id:"oldie",i=n.getWebGLErrorMessage(),i.id=r,t.appendChild(i)}};window.Detector=n,n.webgl=n.webgl,n.canvas=n.canvas,t.default=n},function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=Object.keys(e),n=0;n<r.length;n++){var i=r[n],a=t?t+","+i:i;o(e[i],a)}return e.name=t,e}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(){function e(){i(this,e)}return a(e,null,[{key:"sendEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.name)return void console.error("Event not defined",e);if((!t||!u[e.name])&&(u[e.name]=!0,window.ga&&("www.altizure.com"===window.location.hostname||"altizure.com"===window.location.hostname||"beta.altizure.com"===window.location.hostname))){var r=e.name.split(",");ga.apply(void 0,["send","event"].concat(n(r)))}}}]),e}(),l={Control:{Multitouch:{OneFingerDrag:{},OneFingerTap:{},OneFingerDoubleTap:{},OneFingerDoubleTapDrag:{},TwoFingersPinch:{},TwoFingersRotate:{},TwoFingersTransform:{},TwoFingersSweep:{}},Mouse:{MouseScroll:{},MousePan:{},MouseZoom:{},MouseRotate:{}},Click:{Rotate:{},Zoom:{},Ortho:{}}},ViewMode:{click:{Texture:{},Surface:{},Wireframe:{},Earth:{}}},CustomMap:{view:{}},Flight:{view:{},edit:{}},Ruler:{edit:{}},Lights:{click:{}},Locator:{click:{}},Screenshot:{click:{}},Share:{click:{Flight:{},CustomMap:{},Vanilla:{}}},VisImage:{click:{}},Crop:{edit:{}}},u={};s.Events=o(l,null),t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=this,t=null,r=[];this.add=function(n,i,o){if(n)return r.push([n,i,o]),void(1===r.length&&function n(i){t=setTimeout(function(){i=e.add(),r.length&&n(i)},i||0)}(o));var a=r.shift();return a?(a[0].call(a[1]||window),a[2]):0},this.clear=function(){clearTimeout(t),r=[]}};t.default=n},function(e,t,r){!function(n,i){e.exports=t=function(e){return function(t){var r=e,n=r.lib,i=n.WordArray,o=n.Hasher,a=r.algo,s=[],l=[];!function(){function e(e){return 4294967296*(e-(0|e))|0}for(var r=2,n=0;n<64;)(function(e){for(var r=t.sqrt(e),n=2;n<=r;n++)if(!(e%n))return!1;return!0})(r)&&(n<8&&(s[n]=e(t.pow(r,.5))),l[n]=e(t.pow(r,1/3)),n++),r++}();var u=[],c=a.SHA256=o.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],c=r[5],h=r[6],d=r[7],f=0;f<64;f++){if(f<16)u[f]=0|e[t+f];else{var p=u[f-15],m=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,v=u[f-2],g=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;u[f]=m+u[f-7]+g+u[f-16]}var y=s&c^~s&h,b=n&i^n&o^i&o,_=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),w=(s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25),x=d+w+y+l[f]+u[f],M=_+b;d=h,h=c,c=s,s=a+x|0,a=o,o=i,i=n,n=x+M|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+s|0,r[5]=r[5]+c|0,r[6]=r[6]+h|0,r[7]=r[7]+d|0},_doFinalize:function(){var e=this._data,r=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=t.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,e.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});r.SHA256=o._createHelper(c),r.HmacSHA256=o._createHmacHelper(c)}(Math),e.SHA256}(r(1))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return function(){function t(){return a.create.apply(a,arguments)}var r=e,n=r.lib,i=n.Hasher,o=r.x64,a=o.Word,s=o.WordArray,l=r.algo,u=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=t()}();var h=l.SHA512=i.extend({_doReset:function(){this._hash=new s.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],l=r[5],h=r[6],d=r[7],f=n.high,p=n.low,m=i.high,v=i.low,g=o.high,y=o.low,b=a.high,_=a.low,w=s.high,x=s.low,M=l.high,E=l.low,A=h.high,T=h.low,k=d.high,S=d.low,C=f,P=p,O=m,R=v,L=g,I=y,B=b,D=_,j=w,z=x,N=M,U=E,F=A,H=T,V=k,G=S,W=0;W<80;W++){var X=c[W];if(W<16)var Y=X.high=0|e[t+2*W],q=X.low=0|e[t+2*W+1];else{var K=c[W-15],Z=K.high,Q=K.low,J=(Z>>>1|Q<<31)^(Z>>>8|Q<<24)^Z>>>7,$=(Q>>>1|Z<<31)^(Q>>>8|Z<<24)^(Q>>>7|Z<<25),ee=c[W-2],te=ee.high,re=ee.low,ne=(te>>>19|re<<13)^(te<<3|re>>>29)^te>>>6,ie=(re>>>19|te<<13)^(re<<3|te>>>29)^(re>>>6|te<<26),oe=c[W-7],ae=oe.high,se=oe.low,le=c[W-16],ue=le.high,ce=le.low,q=$+se,Y=J+ae+(q>>>0<$>>>0?1:0),q=q+ie,Y=Y+ne+(q>>>0<ie>>>0?1:0),q=q+ce,Y=Y+ue+(q>>>0<ce>>>0?1:0);X.high=Y,X.low=q}var he=j&N^~j&F,de=z&U^~z&H,fe=C&O^C&L^O&L,pe=P&R^P&I^R&I,me=(C>>>28|P<<4)^(C<<30|P>>>2)^(C<<25|P>>>7),ve=(P>>>28|C<<4)^(P<<30|C>>>2)^(P<<25|C>>>7),ge=(j>>>14|z<<18)^(j>>>18|z<<14)^(j<<23|z>>>9),ye=(z>>>14|j<<18)^(z>>>18|j<<14)^(z<<23|j>>>9),be=u[W],_e=be.high,we=be.low,xe=G+ye,Me=V+ge+(xe>>>0<G>>>0?1:0),xe=xe+de,Me=Me+he+(xe>>>0<de>>>0?1:0),xe=xe+we,Me=Me+_e+(xe>>>0<we>>>0?1:0),xe=xe+q,Me=Me+Y+(xe>>>0<q>>>0?1:0),Ee=ve+pe,Ae=me+fe+(Ee>>>0<ve>>>0?1:0);V=F,G=H,F=N,H=U,N=j,U=z,z=D+xe|0,j=B+Me+(z>>>0<D>>>0?1:0)|0,B=L,D=I,L=O,I=R,O=C,R=P,P=xe+Ee|0,C=Me+Ae+(P>>>0<xe>>>0?1:0)|0}p=n.low=p+P,n.high=f+C+(p>>>0<P>>>0?1:0),v=i.low=v+R,i.high=m+O+(v>>>0<R>>>0?1:0),y=o.low=y+I,o.high=g+L+(y>>>0<I>>>0?1:0),_=a.low=_+D,a.high=b+B+(_>>>0<D>>>0?1:0),x=s.low=x+z,s.high=w+j+(x>>>0<z>>>0?1:0),E=l.low=E+U,l.high=M+N+(E>>>0<U>>>0?1:0),T=h.low=T+H,h.high=A+F+(T>>>0<H>>>0?1:0),S=d.low=S+G,d.high=k+V+(S>>>0<G>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(n+128>>>10<<5)]=r,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});r.SHA512=i._createHelper(h),r.HmacSHA512=i._createHmacHelper(h)}(),e.SHA512}(r(1),r(14))}()},function(e,t,r){"use strict";function n(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}var i=r(4),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var s=new i.Buf8(256),l=0;l<256;l++)s[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;s[254]=s[254]=1,t.string2buf=function(e){var t,r,n,o,a,s=e.length,l=0;for(o=0;o<s;o++)r=e.charCodeAt(o),55296==(64512&r)&&o+1<s&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new i.Buf8(l),a=0,o=0;a<l;o++)r=e.charCodeAt(o),55296==(64512&r)&&o+1<s&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|63&r):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|63&r):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|63&r);return t},t.buf2binstring=function(e){return n(e,e.length)},t.binstring2buf=function(e){for(var t=new i.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},t.buf2string=function(e,t){var r,i,o,a,l=t||e.length,u=new Array(2*l);for(i=0,r=0;r<l;)if((o=e[r++])<128)u[i++]=o;else if((a=s[o])>4)u[i++]=65533,r+=a-1;else{for(o&=2===a?31:3===a?15:7;a>1&&r<l;)o=o<<6|63&e[r++],a--;a>1?u[i++]=65533:o<65536?u[i++]=o:(o-=65536,u[i++]=55296|o>>10&1023,u[i++]=56320|1023&o)}return n(u,i)},t.utf8border=function(e,t){var r;for(t=t||e.length,t>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0?t:0===r?t:r+s[e[r]]>t?r:t}},function(e,t,r){"use strict";function n(e,t,r,n){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==r;){a=r>2e3?2e3:r,r-=a;do{i=i+t[n++]|0,o=o+i|0}while(--a);i%=65521,o%=65521}return i|o<<16|0}e.exports=n},function(e,t,r){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,r){"use strict";function n(e,t,r,n){var o=i,a=n+r;e^=-1;for(var s=n;s<a;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}var i=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();e.exports=n},function(e,t,r){"use strict";function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=n},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){var r=window.URL||window.webkitURL;e.exports=function(e,t){try{try{var n;try{var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;n=new i,n.append(e),n=n.getBlob()}catch(t){n=new Blob([e])}return new Worker(r.createObjectURL(n))}catch(t){return new Worker("data:application/javascript,"+encodeURIComponent(e))}}catch(e){if(!t)throw Error("Inline worker is not supported");return new Worker(t)}}},function(e,t,r){e.exports=function(){return r(61)('!function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=9)}([function(t,e,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var i={arraySet:function(t,e,r,n,i){if(e.subarray&&t.subarray)return void t.set(e.subarray(r,r+n),i);for(var a=0;a<n;a++)t[i+a]=e[r+a]},flattenChunks:function(t){var e,r,n,i,a,o;for(n=0,e=0,r=t.length;e<r;e++)n+=t[e].length;for(o=new Uint8Array(n),i=0,e=0,r=t.length;e<r;e++)a=t[e],o.set(a,i),i+=a.length;return o}},a={arraySet:function(t,e,r,n,i){for(var a=0;a<n;a++)t[i+a]=e[r+a]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,i)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,a))},e.setTyped(n)},function(t,e,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,r){"use strict";function n(t,e){if(e<65537&&(t.subarray&&o||!t.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(t,e));for(var r="",n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r}var i=r(0),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(t){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){o=!1}for(var s=new i.Buf8(256),h=0;h<256;h++)s[h]=h>=252?6:h>=248?5:h>=240?4:h>=224?3:h>=192?2:1;s[254]=s[254]=1,e.string2buf=function(t){var e,r,n,a,o,s=t.length,h=0;for(a=0;a<s;a++)r=t.charCodeAt(a),55296==(64512&r)&&a+1<s&&56320==(64512&(n=t.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),h+=r<128?1:r<2048?2:r<65536?3:4;for(e=new i.Buf8(h),o=0,a=0;o<h;a++)r=t.charCodeAt(a),55296==(64512&r)&&a+1<s&&56320==(64512&(n=t.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),r<128?e[o++]=r:r<2048?(e[o++]=192|r>>>6,e[o++]=128|63&r):r<65536?(e[o++]=224|r>>>12,e[o++]=128|r>>>6&63,e[o++]=128|63&r):(e[o++]=240|r>>>18,e[o++]=128|r>>>12&63,e[o++]=128|r>>>6&63,e[o++]=128|63&r);return e},e.buf2binstring=function(t){return n(t,t.length)},e.binstring2buf=function(t){for(var e=new i.Buf8(t.length),r=0,n=e.length;r<n;r++)e[r]=t.charCodeAt(r);return e},e.buf2string=function(t,e){var r,i,a,o,h=e||t.length,f=new Array(2*h);for(i=0,r=0;r<h;)if((a=t[r++])<128)f[i++]=a;else if((o=s[a])>4)f[i++]=65533,r+=o-1;else{for(a&=2===o?31:3===o?15:7;o>1&&r<h;)a=a<<6|63&t[r++],o--;o>1?f[i++]=65533:a<65536?f[i++]=a:(a-=65536,f[i++]=55296|a>>10&1023,f[i++]=56320|1023&a)}return n(f,i)},e.utf8border=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&128==(192&t[r]);)r--;return r<0?e:0===r?e:r+s[t[r]]>e?r:e}},function(t,e,r){"use strict";function n(t,e,r,n){for(var i=65535&t|0,a=t>>>16&65535|0,o=0;0!==r;){o=r>2e3?2e3:r,r-=o;do{i=i+e[n++]|0,a=a+i|0}while(--o);i%=65521,a%=65521}return i|a<<16|0}t.exports=n},function(t,e,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,r){"use strict";function n(t,e,r,n){var a=i,o=n+r;t^=-1;for(var s=n;s<o;s++)t=t>>>8^a[255&(t^e[s])];return-1^t}var i=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();t.exports=n},function(t,e,r){"use strict";function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=n},function(t,e,r){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(t.length!==e.length)return!1;for(var r=t.length;r--;)if(t[r]!==e[r])return!1;return!0}function a(t,e){return(t[e]<<24)+(t[e+1]<<16)+(t[e+2]<<8)+(t[e+3]<<0)}function o(t,e){return t[e]<<0}function s(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e}function h(t){if("string"==typeof t){var e=t;t=new Array(e.length);for(var r=0,n=e.length;r<n;r++)t[r]=e[r].charCodeAt(0)}else{"ArrayBuffer"===g.call(t).slice(8,-1)&&(t=new Uint8Array(t))}this.i=0,this.bytes=t,this.png=new c.default,this.dataChunks=[]}Object.defineProperty(e,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=r(14),l=n(u),d=r(8),c=n(d),_=function(t,e){try{var r=l.default.inflate(t);e(null,r)}catch(t){e(t)}},p=Array.prototype.slice,g=Object.prototype.toString;h.prototype.readBytes=function(t){var e=this.i+t;if(e>this.bytes.length)throw new Error("Unexpectedly reached end of file");var r=p.call(this.bytes,this.i,e);return this.i=e,r},h.prototype.decodeHeader=function(){if(0!==this.i)throw new Error("file pointer should be at 0 to read the header");var t=this.readBytes(8);if(!i(t,[137,80,78,71,13,10,26,10]))throw new Error("invalid PNGReader file (bad signature)");this.header=t},h.prototype.decodeChunk=function(){var t=a(this.readBytes(4),0);if(t<0)throw new Error("Bad chunk length "+(4294967295&t));var e=s(this.readBytes(4)),r=this.readBytes(t),n=this.readBytes(4);switch(e){case"IHDR":this.decodeIHDR(r);break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this.decodeIEND(r)}return{}.crc=n,e},h.prototype.decodeIHDR=function(t){var e=this.png;e.setWidth(a(t,0)),e.setHeight(a(t,4)),e.setBitDepth(o(t,8)),e.setColorType(o(t,9)),e.setCompressionMethod(o(t,10)),e.setFilterMethod(o(t,11)),e.setInterlaceMethod(o(t,12))},h.prototype.decodePLTE=function(t){this.png.setPalette(t)},h.prototype.decodeIDAT=function(t){this.dataChunks.push(t)},h.prototype.decodeIEND=function(){},h.prototype.decodePixels=function(e){var r,n,i,a,o=this.png,s=this,h=0;for(a=this.dataChunks.length;a--;)h+=this.dataChunks[a].length;var f=new t(h);for(r=0,i=0,a=this.dataChunks.length;r<a;r++){var u=this.dataChunks[r];for(n=0;n<u.length;n++)f[i++]=u[n]}_(f,function(t,r){if(t)return e(t);try{0===o.getInterlaceMethod()?s.interlaceNone(r):s.interlaceAdam7(r)}catch(t){return e(t)}e()})},h.prototype.interlaceNone=function(e){for(var r,n=this.png,i=Math.max(1,n.colors*n.bitDepth/8),a=i*n.width,s=new t(i*n.width*n.height),h=0,f=0;f<e.length;f+=a+1){switch(r=p.call(e,f+1,f+a+1),o(e,f)){case 0:this.unFilterNone(r,s,i,h,a);break;case 1:this.unFilterSub(r,s,i,h,a);break;case 2:this.unFilterUp(r,s,i,h,a);break;case 3:this.unFilterAverage(r,s,i,h,a);break;case 4:this.unFilterPaeth(r,s,i,h,a);break;default:throw new Error("unkown filtered scanline")}h+=a}n.pixels=s},h.prototype.interlaceAdam7=function(t){throw new Error("Adam7 interlacing is not implemented yet")},h.prototype.unFilterNone=function(t,e,r,n,i){for(var a=0,o=i;a<o;a++)e[n+a]=t[a]},h.prototype.unFilterSub=function(t,e,r,n,i){for(var a=0;a<r;a++)e[n+a]=t[a];for(;a<i;a++)e[n+a]=t[a]+e[n+a-r]&255},h.prototype.unFilterUp=function(t,e,r,n,i){var a=0;if(n-i<0)for(;a<i;a++)e[n+a]=t[a];else for(;a<i;a++){var o=t[a],s=e[n+a-i];e[n+a]=o+s&255}},h.prototype.unFilterAverage=function(t,e,r,n,i){var a=0;if(n-i<0){for(;a<r;a++)e[n+a]=t[a];for(;a<i;a++)e[n+a]=t[a]+(e[n+a-r]>>1)&255}else{for(;a<r;a++)e[n+a]=t[a]+(e[n-i+a]>>1)&255;for(;a<i;a++){var o=t[a],s=e[n+a-r],h=e[n+a-i];e[n+a]=o+(s+h>>1)&255}}},h.prototype.unFilterPaeth=function(t,e,r,n,i){var a=0;if(n-i<0){for(;a<r;a++)e[n+a]=t[a];for(;a<i;a++)e[n+a]=t[a]+e[n+a-r]&255}else{for(;a<r;a++)e[n+a]=t[a]+e[n+a-i]&255;for(;a<i;a++){var o=t[a],s=e[n+a-r],h=e[n+a-i],f=e[n+a-i-r],u=s+h-f,l=Math.abs(u-s),d=Math.abs(u-h),c=Math.abs(u-f),_=void 0;_=l<=d&&l<=c?s:d<=c?h:f,e[n+a]=o+_&255}}},h.prototype.parse=function(t,e){"function"==typeof t&&(e=t),"object"!==(void 0===t?"undefined":f(t))&&(t={});try{for(this.decodeHeader();this.i<this.bytes.length;){var r=this.decodeChunk();if("IHDR"===r&&!1===t.data||"IEND"===r)break}var n=this.png;this.decodePixels(function(t){e(t,n)})}catch(t){e(t)}},e.default=h}).call(e,r(11).Buffer)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){this.width=0,this.height=0,this.bitDepth=0,this.colorType=0,this.compressionMethod=0,this.filterMethod=0,this.interlaceMethod=0,this.colors=0,this.alpha=!1,this.pixelBits=0,this.palette=null,this.pixels=null};n.prototype.getWidth=function(){return this.width},n.prototype.setWidth=function(t){this.width=t},n.prototype.getHeight=function(){return this.height},n.prototype.setHeight=function(t){this.height=t},n.prototype.getBitDepth=function(){return this.bitDepth},n.prototype.setBitDepth=function(t){if(-1===[2,4,8,16].indexOf(t))throw new Error("invalid bith depth "+t);this.bitDepth=t},n.prototype.getColorType=function(){return this.colorType},n.prototype.setColorType=function(t){var e=0,r=!1;switch(t){case 0:e=1;break;case 2:e=3;break;case 3:e=1;break;case 4:e=2,r=!0;break;case 6:e=4,r=!0;break;default:throw new Error("invalid color type")}this.colors=e,this.alpha=r,this.colorType=t},n.prototype.getCompressionMethod=function(){return this.compressionMethod},n.prototype.setCompressionMethod=function(t){if(0!==t)throw new Error("invalid compression method "+t);this.compressionMethod=t},n.prototype.getFilterMethod=function(){return this.filterMethod},n.prototype.setFilterMethod=function(t){if(0!==t)throw new Error("invalid filter method "+t);this.filterMethod=t},n.prototype.getInterlaceMethod=function(){return this.interlaceMethod},n.prototype.setInterlaceMethod=function(t){if(0!==t&&1!==t)throw new Error("invalid interlace method "+t);this.interlaceMethod=t},n.prototype.setPalette=function(t){if(t.length%3!=0)throw new Error("incorrect PLTE chunk length");if(t.length>3*Math.pow(2,this.bitDepth))throw new Error("palette has more colors than 2^bitdepth");this.palette=t},n.prototype.getPalette=function(){return this.palette},n.prototype.getPixel=function(t,e){if(!this.pixels)throw new Error("pixel data is empty");if(t>=this.width||e>=this.height)throw new Error("x,y position out of bound");var r=this.colors*this.bitDepth/8*(e*this.width+t),n=this.pixels;switch(this.colorType){case 0:return[n[r],n[r],n[r],255];case 2:return[n[r],n[r+1],n[r+2],255];case 3:return[this.palette[3*n[r]+0],this.palette[3*n[r]+1],this.palette[3*n[r]+2],255];case 4:return[n[r],n[r],n[r],n[r+1]];case 6:return[n[r],n[r+1],n[r+2],n[r+3]]}},e.default=n},function(t,e,r){"use strict";var n=r(7),i=function(t){return t&&t.__esModule?t:{default:t}}(n);onmessage=function(t){var e=t.data.path,r=t.data.filename,n=t.data.key,a=new XMLHttpRequest;a.open("GET",e,!0),a.timeout=3e4,a.responseType="arraybuffer",a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status){var t=a.response,e=new i.default(t);e.parse(function(e,i){if(e)throw console.warn("BundleLoader parse error",e),e;var o=i.getWidth(),s=i.getHeight(),h=i.pixels;postMessage({key:n,filename:r,status:a.status,pixels:h,width:o,height:s}),t=null})}else postMessage({key:n,filename:r,status:a.status,data:null})},a.send()},onerror=function(t){throw console.error("BundleLoader error",t),t}},function(t,e,r){"use strict";function n(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function i(t){return 3*t.length/4-n(t)}function a(t){var e,r,i,a,o,s=t.length;a=n(t),o=new l(3*s/4-a),r=a>0?s-4:s;var h=0;for(e=0;e<r;e+=4)i=u[t.charCodeAt(e)]<<18|u[t.charCodeAt(e+1)]<<12|u[t.charCodeAt(e+2)]<<6|u[t.charCodeAt(e+3)],o[h++]=i>>16&255,o[h++]=i>>8&255,o[h++]=255&i;return 2===a?(i=u[t.charCodeAt(e)]<<2|u[t.charCodeAt(e+1)]>>4,o[h++]=255&i):1===a&&(i=u[t.charCodeAt(e)]<<10|u[t.charCodeAt(e+1)]<<4|u[t.charCodeAt(e+2)]>>2,o[h++]=i>>8&255,o[h++]=255&i),o}function o(t){return f[t>>18&63]+f[t>>12&63]+f[t>>6&63]+f[63&t]}function s(t,e,r){for(var n,i=[],a=e;a<r;a+=3)n=(t[a]<<16)+(t[a+1]<<8)+t[a+2],i.push(o(n));return i.join("")}function h(t){for(var e,r=t.length,n=r%3,i="",a=[],o=0,h=r-n;o<h;o+=16383)a.push(s(t,o,o+16383>h?h:o+16383));return 1===n?(e=t[r-1],i+=f[e>>2],i+=f[e<<4&63],i+="=="):2===n&&(e=(t[r-2]<<8)+t[r-1],i+=f[e>>10],i+=f[e>>4&63],i+=f[e<<2&63],i+="="),a.push(i),a.join("")}e.byteLength=i,e.toByteArray=a,e.fromByteArray=h;for(var f=[],u=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,_=d.length;c<_;++c)f[c]=d[c],u[d.charCodeAt(c)]=c;u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},function(t,e,r){"use strict";(function(t){function n(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(t,e){if(n()<e)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=a.prototype):(null===t&&(t=new a(e)),t.length=e),t}function a(t,e,r){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return o(this,t,e,r)}function o(t,e,r,n){if("number"==typeof e)throw new TypeError(\'"value" argument must not be a number\');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?d(t,e,r,n):"string"==typeof e?u(t,e,r):c(t,e)}function s(t){if("number"!=typeof t)throw new TypeError(\'"size" argument must be a number\');if(t<0)throw new RangeError(\'"size" argument must not be negative\')}function h(t,e,r,n){return s(e),e<=0?i(t,e):void 0!==r?"string"==typeof n?i(t,e).fill(r,n):i(t,e).fill(r):i(t,e)}function f(t,e){if(s(e),t=i(t,e<0?0:0|_(e)),!a.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function u(t,e,r){if("string"==typeof r&&""!==r||(r="utf8"),!a.isEncoding(r))throw new TypeError(\'"encoding" must be a valid string encoding\');var n=0|g(e,r);t=i(t,n);var o=t.write(e,r);return o!==n&&(t=t.slice(0,o)),t}function l(t,e){var r=e.length<0?0:0|_(e.length);t=i(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function d(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("\'offset\' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("\'length\' is out of bounds");return e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n),a.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=a.prototype):t=l(t,e),t}function c(t,e){if(a.isBuffer(e)){var r=0|_(e.length);return t=i(t,r),0===t.length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||q(e.length)?i(t,0):l(t,e);if("Buffer"===e.type&&Q(e.data))return l(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function _(t){if(t>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|t}function p(t){return+t!=t&&(t=0),a.alloc(+t)}function g(t,e){if(a.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return W(t).length;default:if(n)return j(t).length;e=(""+e).toLowerCase(),n=!0}}function w(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,e>>>=0,r<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,e,r);case"utf8":case"utf-8":return R(this,e,r);case"ascii":return T(this,e,r);case"latin1":case"binary":return P(this,e,r);case"base64":return z(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function v(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=a.from(e,n)),a.isBuffer(e))return 0===e.length?-1:m(t,e,r,n,i);if("number"==typeof e)return e&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):m(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,r,n,i){function a(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}var o=1,s=t.length,h=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,s/=2,h/=2,r/=2}var f;if(i){var u=-1;for(f=r;f<s;f++)if(a(t,f)===a(e,-1===u?0:f-u)){if(-1===u&&(u=f),f-u+1===h)return u*o}else-1!==u&&(f-=f-u),u=-1}else for(r+h>s&&(r=s-h),f=r;f>=0;f--){for(var l=!0,d=0;d<h;d++)if(a(t,f+d)!==a(e,d)){l=!1;break}if(l)return f}return-1}function y(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var a=e.length;if(a%2!=0)throw new TypeError("Invalid hex string");n>a/2&&(n=a/2);for(var o=0;o<n;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;t[r+o]=s}return o}function k(t,e,r,n){return X(j(e,t.length-r),t,r,n)}function x(t,e,r,n){return X(K(e),t,r,n)}function E(t,e,r,n){return x(t,e,r,n)}function A(t,e,r,n){return X(W(e),t,r,n)}function B(t,e,r,n){return X(G(e,t.length-r),t,r,n)}function z(t,e,r){return 0===e&&r===t.length?V.fromByteArray(t):V.fromByteArray(t.slice(e,r))}function R(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var a=t[i],o=null,s=a>239?4:a>223?3:a>191?2:1;if(i+s<=r){var h,f,u,l;switch(s){case 1:a<128&&(o=a);break;case 2:h=t[i+1],128==(192&h)&&(l=(31&a)<<6|63&h)>127&&(o=l);break;case 3:h=t[i+1],f=t[i+2],128==(192&h)&&128==(192&f)&&(l=(15&a)<<12|(63&h)<<6|63&f)>2047&&(l<55296||l>57343)&&(o=l);break;case 4:h=t[i+1],f=t[i+2],u=t[i+3],128==(192&h)&&128==(192&f)&&128==(192&u)&&(l=(15&a)<<18|(63&h)<<12|(63&f)<<6|63&u)>65535&&l<1114112&&(o=l)}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return S(n)}function S(t){var e=t.length;if(e<=$)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=$));return r}function T(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function P(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function I(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",a=e;a<r;++a)i+=H(t[a]);return i}function U(t,e,r){for(var n=t.slice(e,r),i="",a=0;a<n.length;a+=2)i+=String.fromCharCode(n[a]+256*n[a+1]);return i}function C(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function D(t,e,r,n,i,o){if(!a.isBuffer(t))throw new TypeError(\'"buffer" argument must be a Buffer instance\');if(e>i||e<o)throw new RangeError(\'"value" argument is out of bounds\');if(r+n>t.length)throw new RangeError("Index out of range")}function M(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,a=Math.min(t.length-r,2);i<a;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function O(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,a=Math.min(t.length-r,4);i<a;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function L(t,e,r,n,i,a){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function N(t,e,r,n,i){return i||L(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(t,e,r,n,23,4),r+4}function Y(t,e,r,n,i){return i||L(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(t,e,r,n,52,8),r+8}function Z(t){if(t=F(t).replace(tt,""),t.length<2)return"";for(;t.length%4!=0;)t+="=";return t}function F(t){return t.trim?t.trim():t.replace(/^\\s+|\\s+$/g,"")}function H(t){return t<16?"0"+t.toString(16):t.toString(16)}function j(t,e){e=e||1/0;for(var r,n=t.length,i=null,a=[],o=0;o<n;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;a.push(r)}else if(r<2048){if((e-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function K(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function G(t,e){for(var r,n,i,a=[],o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,i=r%256,a.push(i),a.push(n);return a}function W(t){return V.toByteArray(Z(t))}function X(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function q(t){return t!==t}var V=r(10),J=r(12),Q=r(13);e.Buffer=a,e.SlowBuffer=p,e.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=n(),a.poolSize=8192,a._augment=function(t){return t.__proto__=a.prototype,t},a.from=function(t,e,r){return o(null,t,e,r)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(t,e,r){return h(null,t,e,r)},a.allocUnsafe=function(t){return f(null,t)},a.allocUnsafeSlow=function(t){return f(null,t)},a.isBuffer=function(t){return!(null==t||!t._isBuffer)},a.compare=function(t,e){if(!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!Q(t))throw new TypeError(\'"list" argument must be an Array of Buffers\');if(0===t.length)return a.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=a.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var o=t[r];if(!a.isBuffer(o))throw new TypeError(\'"list" argument must be an Array of Buffers\');o.copy(n,i),i+=o.length}return n},a.byteLength=g,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)b(this,e,e+1);return this},a.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)b(this,e,e+3),b(this,e+1,e+2);return this},a.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)b(this,e,e+7),b(this,e+1,e+6),b(this,e+2,e+5),b(this,e+3,e+4);return this},a.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?R(this,0,t):w.apply(this,arguments)},a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},a.prototype.compare=function(t,e,r,n,i){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(e>>>=0,r>>>=0,n>>>=0,i>>>=0,this===t)return 0;for(var o=i-n,s=r-e,h=Math.min(o,s),f=this.slice(n,i),u=t.slice(e,r),l=0;l<h;++l)if(f[l]!==u[l]){o=f[l],s=u[l];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},a.prototype.indexOf=function(t,e,r){return v(this,t,e,r,!0)},a.prototype.lastIndexOf=function(t,e,r){return v(this,t,e,r,!1)},a.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return y(this,t,e,r);case"utf8":case"utf-8":return k(this,t,e,r);case"ascii":return x(this,t,e,r);case"latin1":case"binary":return E(this,t,e,r);case"base64":return A(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,e,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;a.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n;if(a.TYPED_ARRAY_SUPPORT)n=this.subarray(t,e),n.__proto__=a.prototype;else{var i=e-t;n=new a(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},a.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||C(t,e,this.length);for(var n=this[t],i=1,a=0;++a<e&&(i*=256);)n+=this[t+a]*i;return n},a.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||C(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},a.prototype.readUInt8=function(t,e){return e||C(t,1,this.length),this[t]},a.prototype.readUInt16LE=function(t,e){return e||C(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUInt16BE=function(t,e){return e||C(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUInt32LE=function(t,e){return e||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUInt32BE=function(t,e){return e||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||C(t,e,this.length);for(var n=this[t],i=1,a=0;++a<e&&(i*=256);)n+=this[t+a]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},a.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||C(t,e,this.length);for(var n=e,i=1,a=this[t+--n];n>0&&(i*=256);)a+=this[t+--n]*i;return i*=128,a>=i&&(a-=Math.pow(2,8*e)),a},a.prototype.readInt8=function(t,e){return e||C(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,e){e||C(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(t,e){e||C(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(t,e){return e||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return e||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readFloatLE=function(t,e){return e||C(t,4,this.length),J.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return e||C(t,4,this.length),J.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return e||C(t,8,this.length),J.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return e||C(t,8,this.length),J.read(this,t,!1,52,8)},a.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e|=0,r|=0,!n){D(this,t,e,r,Math.pow(2,8*r)-1,0)}var i=1,a=0;for(this[e]=255&t;++a<r&&(i*=256);)this[e+a]=t/i&255;return e+r},a.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e|=0,r|=0,!n){D(this,t,e,r,Math.pow(2,8*r)-1,0)}var i=r-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+r},a.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,1,255,0),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},a.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},a.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},a.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):O(this,t,e,!0),e+4},a.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):O(this,t,e,!1),e+4},a.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);D(this,t,e,r,i-1,-i)}var a=0,o=1,s=0;for(this[e]=255&t;++a<r&&(o*=256);)t<0&&0===s&&0!==this[e+a-1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+r},a.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);D(this,t,e,r,i-1,-i)}var a=r-1,o=1,s=0;for(this[e+a]=255&t;--a>=0&&(o*=256);)t<0&&0===s&&0!==this[e+a+1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+r},a.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,1,127,-128),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},a.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},a.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},a.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):O(this,t,e,!0),e+4},a.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):O(this,t,e,!1),e+4},a.prototype.writeFloatLE=function(t,e,r){return N(this,t,e,!0,r)},a.prototype.writeFloatBE=function(t,e,r){return N(this,t,e,!1,r)},a.prototype.writeDoubleLE=function(t,e,r){return Y(this,t,e,!0,r)},a.prototype.writeDoubleBE=function(t,e,r){return Y(this,t,e,!1,r)},a.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,o=n-r;if(this===t&&r<e&&e<n)for(i=o-1;i>=0;--i)t[i+e]=this[i+r];else if(o<1e3||!a.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+o),e);return o},a.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0);var o;if("number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{var s=a.isBuffer(t)?t:j(new a(t,n).toString()),h=s.length;for(o=0;o<r-e;++o)this[o+e]=s[o%h]}return this};var tt=/[^+\\/0-9A-Za-z-_]/g}).call(e,r(23))},function(t,e){e.read=function(t,e,r,n,i){var a,o,s=8*i-n-1,h=(1<<s)-1,f=h>>1,u=-7,l=r?i-1:0,d=r?-1:1,c=t[e+l];for(l+=d,a=c&(1<<-u)-1,c>>=-u,u+=s;u>0;a=256*a+t[e+l],l+=d,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=n;u>0;o=256*o+t[e+l],l+=d,u-=8);if(0===a)a=1-f;else{if(a===h)return o?NaN:1/0*(c?-1:1);o+=Math.pow(2,n),a-=f}return(c?-1:1)*o*Math.pow(2,a-n)},e.write=function(t,e,r,n,i,a){var o,s,h,f=8*a-i-1,u=(1<<f)-1,l=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,c=n?0:a-1,_=n?1:-1,p=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),e+=o+l>=1?d/h:d*Math.pow(2,1-l),e*h>=2&&(o++,h/=2),o+l>=u?(s=0,o=u):o+l>=1?(s=(e*h-1)*Math.pow(2,i),o+=l):(s=e*Math.pow(2,l-1)*Math.pow(2,i),o=0));i>=8;t[r+c]=255&s,c+=_,s/=256,i-=8);for(o=o<<i|s,f+=i;f>0;t[r+c]=255&o,c+=_,o/=256,f-=8);t[r+c-_]|=128*p}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e,r){"use strict";var n=r(0).assign,i=r(15),a=r(16),o=r(4),s={};n(s,i,a,o),t.exports=s},function(t,e,r){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.options=h.assign({level:_,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=s.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==c)throw new Error(u[r]);if(e.header&&s.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(i="string"==typeof e.dictionary?f.string2buf(e.dictionary):"[object ArrayBuffer]"===d.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(r=s.deflateSetDictionary(this.strm,i))!==c)throw new Error(u[r]);this._dict_set=!0}}function i(t,e){var r=new n(e);if(r.push(t,!0),r.err)throw r.msg;return r.result}function a(t,e){return e=e||{},e.raw=!0,i(t,e)}function o(t,e){return e=e||{},e.gzip=!0,i(t,e)}var s=r(17),h=r(0),f=r(2),u=r(1),l=r(6),d=Object.prototype.toString,c=0,_=-1,p=0,g=8;n.prototype.push=function(t,e){var r,n,i=this.strm,a=this.options.chunkSize;if(this.ended)return!1;n=e===~~e?e:!0===e?4:0,"string"==typeof t?i.input=f.string2buf(t):"[object ArrayBuffer]"===d.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new h.Buf8(a),i.next_out=0,i.avail_out=a),1!==(r=s.deflate(i,n))&&r!==c)return this.onEnd(r),this.ended=!0,!1;0!==i.avail_out&&(0!==i.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(f.buf2binstring(h.shrinkBuf(i.output,i.next_out))):this.onData(h.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&1!==r);return 4===n?(r=s.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===c):2!==n||(this.onEnd(c),i.avail_out=0,!0)},n.prototype.onData=function(t){this.chunks.push(t)},n.prototype.onEnd=function(t){t===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=h.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=n,e.deflate=i,e.deflateRaw=a,e.gzip=o},function(t,e,r){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=o.inflateInit2(this.strm,e.windowBits);if(r!==f.Z_OK)throw new Error(u[r]);this.header=new d,o.inflateGetHeader(this.strm,this.header)}function i(t,e){var r=new n(e);if(r.push(t,!0),r.err)throw r.msg;return r.result}function a(t,e){return e=e||{},e.raw=!0,i(t,e)}var o=r(20),s=r(0),h=r(2),f=r(4),u=r(1),l=r(6),d=r(18),c=Object.prototype.toString;n.prototype.push=function(t,e){var r,n,i,a,u,l,d=this.strm,_=this.options.chunkSize,p=this.options.dictionary,g=!1;if(this.ended)return!1;n=e===~~e?e:!0===e?f.Z_FINISH:f.Z_NO_FLUSH,"string"==typeof t?d.input=h.binstring2buf(t):"[object ArrayBuffer]"===c.call(t)?d.input=new Uint8Array(t):d.input=t,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new s.Buf8(_),d.next_out=0,d.avail_out=_),r=o.inflate(d,f.Z_NO_FLUSH),r===f.Z_NEED_DICT&&p&&(l="string"==typeof p?h.string2buf(p):"[object ArrayBuffer]"===c.call(p)?new Uint8Array(p):p,r=o.inflateSetDictionary(this.strm,l)),r===f.Z_BUF_ERROR&&!0===g&&(r=f.Z_OK,g=!1),r!==f.Z_STREAM_END&&r!==f.Z_OK)return this.onEnd(r),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&r!==f.Z_STREAM_END&&(0!==d.avail_in||n!==f.Z_FINISH&&n!==f.Z_SYNC_FLUSH)||("string"===this.options.to?(i=h.utf8border(d.output,d.next_out),a=d.next_out-i,u=h.buf2string(d.output,i),d.next_out=a,d.avail_out=_-a,a&&s.arraySet(d.output,d.output,i,a,0),this.onData(u)):this.onData(s.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(g=!0)}while((d.avail_in>0||0===d.avail_out)&&r!==f.Z_STREAM_END);return r===f.Z_STREAM_END&&(n=f.Z_FINISH),n===f.Z_FINISH?(r=o.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===f.Z_OK):n!==f.Z_SYNC_FLUSH||(this.onEnd(f.Z_OK),d.avail_out=0,!0)},n.prototype.onData=function(t){this.chunks.push(t)},n.prototype.onEnd=function(t){t===f.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=n,e.inflate=i,e.inflateRaw=a,e.ungzip=i},function(t,e,r){"use strict";function n(t,e){return t.msg=C[e],e}function i(t){return(t<<1)-(t>4?9:0)}function a(t){for(var e=t.length;--e>=0;)t[e]=0}function o(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(T.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))}function s(t,e){P._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,o(t.strm)}function h(t,e){t.pending_buf[t.pending++]=e}function f(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function u(t,e,r,n){var i=t.avail_in;return i>n&&(i=n),0===i?0:(t.avail_in-=i,T.arraySet(e,t.input,t.next_in,i,r),1===t.state.wrap?t.adler=I(t.adler,e,i,r):2===t.state.wrap&&(t.adler=U(t.adler,e,i,r)),t.next_in+=i,t.total_in+=i,i)}function l(t,e){var r,n,i=t.max_chain_length,a=t.strstart,o=t.prev_length,s=t.nice_match,h=t.strstart>t.w_size-ft?t.strstart-(t.w_size-ft):0,f=t.window,u=t.w_mask,l=t.prev,d=t.strstart+ht,c=f[a+o-1],_=f[a+o];t.prev_length>=t.good_match&&(i>>=2),s>t.lookahead&&(s=t.lookahead);do{if(r=e,f[r+o]===_&&f[r+o-1]===c&&f[r]===f[a]&&f[++r]===f[a+1]){a+=2,r++;do{}while(f[++a]===f[++r]&&f[++a]===f[++r]&&f[++a]===f[++r]&&f[++a]===f[++r]&&f[++a]===f[++r]&&f[++a]===f[++r]&&f[++a]===f[++r]&&f[++a]===f[++r]&&a<d);if(n=ht-(d-a),a=d-ht,n>o){if(t.match_start=e,o=n,n>=s)break;c=f[a+o-1],_=f[a+o]}}}while((e=l[e&u])>h&&0!=--i);return o<=t.lookahead?o:t.lookahead}function d(t){var e,r,n,i,a,o=t.w_size;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=o+(o-ft)){T.arraySet(t.window,t.window,o,o,0),t.match_start-=o,t.strstart-=o,t.block_start-=o,r=t.hash_size,e=r;do{n=t.head[--e],t.head[e]=n>=o?n-o:0}while(--r);r=o,e=r;do{n=t.prev[--e],t.prev[e]=n>=o?n-o:0}while(--r);i+=o}if(0===t.strm.avail_in)break;if(r=u(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=r,t.lookahead+t.insert>=st)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+st-1])&t.hash_mask,t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<st)););}while(t.lookahead<ft&&0!==t.strm.avail_in)}function c(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(d(t),0===t.lookahead&&e===D)return bt;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+r;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,s(t,!1),0===t.strm.avail_out))return bt;if(t.strstart-t.block_start>=t.w_size-ft&&(s(t,!1),0===t.strm.avail_out))return bt}return t.insert=0,e===L?(s(t,!0),0===t.strm.avail_out?mt:yt):(t.strstart>t.block_start&&(s(t,!1),t.strm.avail_out),bt)}function _(t,e){for(var r,n;;){if(t.lookahead<ft){if(d(t),t.lookahead<ft&&e===D)return bt;if(0===t.lookahead)break}if(r=0,t.lookahead>=st&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-ft&&(t.match_length=l(t,r)),t.match_length>=st)if(n=P._tr_tally(t,t.strstart-t.match_start,t.match_length-st),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=st){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=P._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(s(t,!1),0===t.strm.avail_out))return bt}return t.insert=t.strstart<st-1?t.strstart:st-1,e===L?(s(t,!0),0===t.strm.avail_out?mt:yt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?bt:vt}function p(t,e){for(var r,n,i;;){if(t.lookahead<ft){if(d(t),t.lookahead<ft&&e===D)return bt;if(0===t.lookahead)break}if(r=0,t.lookahead>=st&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=st-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-ft&&(t.match_length=l(t,r),t.match_length<=5&&(t.strategy===G||t.match_length===st&&t.strstart-t.match_start>4096)&&(t.match_length=st-1)),t.prev_length>=st&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-st,n=P._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-st),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+st-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=st-1,t.strstart++,n&&(s(t,!1),0===t.strm.avail_out))return bt}else if(t.match_available){if(n=P._tr_tally(t,0,t.window[t.strstart-1]),n&&s(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return bt}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=P._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<st-1?t.strstart:st-1,e===L?(s(t,!0),0===t.strm.avail_out?mt:yt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?bt:vt}function g(t,e){for(var r,n,i,a,o=t.window;;){if(t.lookahead<=ht){if(d(t),t.lookahead<=ht&&e===D)return bt;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=st&&t.strstart>0&&(i=t.strstart-1,(n=o[i])===o[++i]&&n===o[++i]&&n===o[++i])){a=t.strstart+ht;do{}while(n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&i<a);t.match_length=ht-(a-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=st?(r=P._tr_tally(t,1,t.match_length-st),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=P._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(s(t,!1),0===t.strm.avail_out))return bt}return t.insert=0,e===L?(s(t,!0),0===t.strm.avail_out?mt:yt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?bt:vt}function w(t,e){for(var r;;){if(0===t.lookahead&&(d(t),0===t.lookahead)){if(e===D)return bt;break}if(t.match_length=0,r=P._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(s(t,!1),0===t.strm.avail_out))return bt}return t.insert=0,e===L?(s(t,!0),0===t.strm.avail_out?mt:yt):t.last_lit&&(s(t,!1),0===t.strm.avail_out)?bt:vt}function b(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}function v(t){t.window_size=2*t.w_size,a(t.head),t.max_lazy_match=S[t.level].max_lazy,t.good_match=S[t.level].good_length,t.nice_match=S[t.level].nice_length,t.max_chain_length=S[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=st-1,t.match_available=0,t.ins_h=0}function m(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Q,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new T.Buf16(2*at),this.dyn_dtree=new T.Buf16(2*(2*nt+1)),this.bl_tree=new T.Buf16(2*(2*it+1)),a(this.dyn_ltree),a(this.dyn_dtree),a(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new T.Buf16(ot+1),this.heap=new T.Buf16(2*rt+1),a(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new T.Buf16(2*rt+1),a(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function y(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=J,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?lt:gt,t.adler=2===e.wrap?0:1,e.last_flush=D,P._tr_init(e),Y):n(t,F)}function k(t){var e=y(t);return e===Y&&v(t.state),e}function x(t,e){return t&&t.state?2!==t.state.wrap?F:(t.state.gzhead=e,Y):F}function E(t,e,r,i,a,o){if(!t)return F;var s=1;if(e===K&&(e=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),a<1||a>$||r!==Q||i<8||i>15||e<0||e>9||o<0||o>q)return n(t,F);8===i&&(i=9);var h=new m;return t.state=h,h.strm=t,h.wrap=s,h.gzhead=null,h.w_bits=i,h.w_size=1<<h.w_bits,h.w_mask=h.w_size-1,h.hash_bits=a+7,h.hash_size=1<<h.hash_bits,h.hash_mask=h.hash_size-1,h.hash_shift=~~((h.hash_bits+st-1)/st),h.window=new T.Buf8(2*h.w_size),h.head=new T.Buf16(h.hash_size),h.prev=new T.Buf16(h.w_size),h.lit_bufsize=1<<a+6,h.pending_buf_size=4*h.lit_bufsize,h.pending_buf=new T.Buf8(h.pending_buf_size),h.d_buf=1*h.lit_bufsize,h.l_buf=3*h.lit_bufsize,h.level=e,h.strategy=o,h.method=r,k(t)}function A(t,e){return E(t,e,Q,tt,et,V)}function B(t,e){var r,s,u,l;if(!t||!t.state||e>N||e<0)return t?n(t,F):F;if(s=t.state,!t.output||!t.input&&0!==t.avail_in||s.status===wt&&e!==L)return n(t,0===t.avail_out?j:F);if(s.strm=t,r=s.last_flush,s.last_flush=e,s.status===lt)if(2===s.wrap)t.adler=0,h(s,31),h(s,139),h(s,8),s.gzhead?(h(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),h(s,255&s.gzhead.time),h(s,s.gzhead.time>>8&255),h(s,s.gzhead.time>>16&255),h(s,s.gzhead.time>>24&255),h(s,9===s.level?2:s.strategy>=W||s.level<2?4:0),h(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(h(s,255&s.gzhead.extra.length),h(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(t.adler=U(t.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=dt):(h(s,0),h(s,0),h(s,0),h(s,0),h(s,0),h(s,9===s.level?2:s.strategy>=W||s.level<2?4:0),h(s,kt),s.status=gt);else{var d=Q+(s.w_bits-8<<4)<<8,c=-1;c=s.strategy>=W||s.level<2?0:s.level<6?1:6===s.level?2:3,d|=c<<6,0!==s.strstart&&(d|=ut),d+=31-d%31,s.status=gt,f(s,d),0!==s.strstart&&(f(s,t.adler>>>16),f(s,65535&t.adler)),t.adler=1}if(s.status===dt)if(s.gzhead.extra){for(u=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>u&&(t.adler=U(t.adler,s.pending_buf,s.pending-u,u)),o(t),u=s.pending,s.pending!==s.pending_buf_size));)h(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>u&&(t.adler=U(t.adler,s.pending_buf,s.pending-u,u)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=ct)}else s.status=ct;if(s.status===ct)if(s.gzhead.name){u=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>u&&(t.adler=U(t.adler,s.pending_buf,s.pending-u,u)),o(t),u=s.pending,s.pending===s.pending_buf_size)){l=1;break}l=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,h(s,l)}while(0!==l);s.gzhead.hcrc&&s.pending>u&&(t.adler=U(t.adler,s.pending_buf,s.pending-u,u)),0===l&&(s.gzindex=0,s.status=_t)}else s.status=_t;if(s.status===_t)if(s.gzhead.comment){u=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>u&&(t.adler=U(t.adler,s.pending_buf,s.pending-u,u)),o(t),u=s.pending,s.pending===s.pending_buf_size)){l=1;break}l=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,h(s,l)}while(0!==l);s.gzhead.hcrc&&s.pending>u&&(t.adler=U(t.adler,s.pending_buf,s.pending-u,u)),0===l&&(s.status=pt)}else s.status=pt;if(s.status===pt&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&o(t),s.pending+2<=s.pending_buf_size&&(h(s,255&t.adler),h(s,t.adler>>8&255),t.adler=0,s.status=gt)):s.status=gt),0!==s.pending){if(o(t),0===t.avail_out)return s.last_flush=-1,Y}else if(0===t.avail_in&&i(e)<=i(r)&&e!==L)return n(t,j);if(s.status===wt&&0!==t.avail_in)return n(t,j);if(0!==t.avail_in||0!==s.lookahead||e!==D&&s.status!==wt){var _=s.strategy===W?w(s,e):s.strategy===X?g(s,e):S[s.level].func(s,e);if(_!==mt&&_!==yt||(s.status=wt),_===bt||_===mt)return 0===t.avail_out&&(s.last_flush=-1),Y;if(_===vt&&(e===M?P._tr_align(s):e!==N&&(P._tr_stored_block(s,0,0,!1),e===O&&(a(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),o(t),0===t.avail_out))return s.last_flush=-1,Y}return e!==L?Y:s.wrap<=0?Z:(2===s.wrap?(h(s,255&t.adler),h(s,t.adler>>8&255),h(s,t.adler>>16&255),h(s,t.adler>>24&255),h(s,255&t.total_in),h(s,t.total_in>>8&255),h(s,t.total_in>>16&255),h(s,t.total_in>>24&255)):(f(s,t.adler>>>16),f(s,65535&t.adler)),o(t),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?Y:Z)}function z(t){var e;return t&&t.state?(e=t.state.status)!==lt&&e!==dt&&e!==ct&&e!==_t&&e!==pt&&e!==gt&&e!==wt?n(t,F):(t.state=null,e===gt?n(t,H):Y):F}function R(t,e){var r,n,i,o,s,h,f,u,l=e.length;if(!t||!t.state)return F;if(r=t.state,2===(o=r.wrap)||1===o&&r.status!==lt||r.lookahead)return F;for(1===o&&(t.adler=I(t.adler,e,l,0)),r.wrap=0,l>=r.w_size&&(0===o&&(a(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new T.Buf8(r.w_size),T.arraySet(u,e,l-r.w_size,r.w_size,0),e=u,l=r.w_size),s=t.avail_in,h=t.next_in,f=t.input,t.avail_in=l,t.next_in=0,t.input=e,d(r);r.lookahead>=st;){n=r.strstart,i=r.lookahead-(st-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+st-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--i);r.strstart=n,r.lookahead=st-1,d(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=st-1,r.match_available=0,t.next_in=h,t.input=f,t.avail_in=s,r.wrap=o,Y}var S,T=r(0),P=r(22),I=r(3),U=r(5),C=r(1),D=0,M=1,O=3,L=4,N=5,Y=0,Z=1,F=-2,H=-3,j=-5,K=-1,G=1,W=2,X=3,q=4,V=0,J=2,Q=8,$=9,tt=15,et=8,rt=286,nt=30,it=19,at=2*rt+1,ot=15,st=3,ht=258,ft=ht+st+1,ut=32,lt=42,dt=69,ct=73,_t=91,pt=103,gt=113,wt=666,bt=1,vt=2,mt=3,yt=4,kt=3;S=[new b(0,0,0,0,c),new b(4,4,8,4,_),new b(4,5,16,8,_),new b(4,6,32,32,_),new b(4,4,16,16,p),new b(8,16,32,32,p),new b(8,16,128,128,p),new b(8,32,128,256,p),new b(32,128,258,1024,p),new b(32,258,258,4096,p)],e.deflateInit=A,e.deflateInit2=E,e.deflateReset=k,e.deflateResetKeep=y,e.deflateSetHeader=x,e.deflate=B,e.deflateEnd=z,e.deflateSetDictionary=R,e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,r){"use strict";function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=n},function(t,e,r){"use strict";t.exports=function(t,e){var r,n,i,a,o,s,h,f,u,l,d,c,_,p,g,w,b,v,m,y,k,x,E,A,B;r=t.state,n=t.next_in,A=t.input,i=n+(t.avail_in-5),a=t.next_out,B=t.output,o=a-(e-t.avail_out),s=a+(t.avail_out-257),h=r.dmax,f=r.wsize,u=r.whave,l=r.wnext,d=r.window,c=r.hold,_=r.bits,p=r.lencode,g=r.distcode,w=(1<<r.lenbits)-1,b=(1<<r.distbits)-1;t:do{_<15&&(c+=A[n++]<<_,_+=8,c+=A[n++]<<_,_+=8),v=p[c&w];e:for(;;){if(m=v>>>24,c>>>=m,_-=m,0===(m=v>>>16&255))B[a++]=65535&v;else{if(!(16&m)){if(0==(64&m)){v=p[(65535&v)+(c&(1<<m)-1)];continue e}if(32&m){r.mode=12;break t}t.msg="invalid literal/length code",r.mode=30;break t}y=65535&v,m&=15,m&&(_<m&&(c+=A[n++]<<_,_+=8),y+=c&(1<<m)-1,c>>>=m,_-=m),_<15&&(c+=A[n++]<<_,_+=8,c+=A[n++]<<_,_+=8),v=g[c&b];r:for(;;){if(m=v>>>24,c>>>=m,_-=m,!(16&(m=v>>>16&255))){if(0==(64&m)){v=g[(65535&v)+(c&(1<<m)-1)];continue r}t.msg="invalid distance code",r.mode=30;break t}if(k=65535&v,m&=15,_<m&&(c+=A[n++]<<_,(_+=8)<m&&(c+=A[n++]<<_,_+=8)),(k+=c&(1<<m)-1)>h){t.msg="invalid distance too far back",r.mode=30;break t}if(c>>>=m,_-=m,m=a-o,k>m){if((m=k-m)>u&&r.sane){t.msg="invalid distance too far back",r.mode=30;break t}if(x=0,E=d,0===l){if(x+=f-m,m<y){y-=m;do{B[a++]=d[x++]}while(--m);x=a-k,E=B}}else if(l<m){if(x+=f+l-m,(m-=l)<y){y-=m;do{B[a++]=d[x++]}while(--m);if(x=0,l<y){m=l,y-=m;do{B[a++]=d[x++]}while(--m);x=a-k,E=B}}}else if(x+=l-m,m<y){y-=m;do{B[a++]=d[x++]}while(--m);x=a-k,E=B}for(;y>2;)B[a++]=E[x++],B[a++]=E[x++],B[a++]=E[x++],y-=3;y&&(B[a++]=E[x++],y>1&&(B[a++]=E[x++]))}else{x=a-k;do{B[a++]=B[x++],B[a++]=B[x++],B[a++]=B[x++],y-=3}while(y>2);y&&(B[a++]=B[x++],y>1&&(B[a++]=B[x++]))}break}}break}}while(n<i&&a<s);y=_>>3,n-=y,_-=y<<3,c&=(1<<_)-1,t.next_in=n,t.next_out=a,t.avail_in=n<i?i-n+5:5-(n-i),t.avail_out=a<s?s-a+257:257-(a-s),r.hold=c,r.bits=_}},function(t,e,r){"use strict";function n(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function i(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new b.Buf16(320),this.work=new b.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function a(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=O,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new b.Buf32(pt),e.distcode=e.distdyn=new b.Buf32(gt),e.sane=1,e.back=-1,S):I}function o(t){var e;return t&&t.state?(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,a(t)):I}function s(t,e){var r,n;return t&&t.state?(n=t.state,e<0?(r=0,e=-e):(r=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?I:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,o(t))):I}function h(t,e){var r,n;return t?(n=new i,t.state=n,n.window=null,r=s(t,e),r!==S&&(t.state=null),r):I}function f(t){return h(t,wt)}function u(t){if(bt){var e;for(g=new b.Buf32(512),w=new b.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(k(E,t.lens,0,288,g,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;k(A,t.lens,0,32,w,0,t.work,{bits:5}),bt=!1}t.lencode=g,t.lenbits=9,t.distcode=w,t.distbits=5}function l(t,e,r,n){var i,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new b.Buf8(a.wsize)),n>=a.wsize?(b.arraySet(a.window,e,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),b.arraySet(a.window,e,r-n,i,a.wnext),n-=i,n?(b.arraySet(a.window,e,r-n,n,0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0}function d(t,e){var r,i,a,o,s,h,f,d,c,_,p,g,w,pt,gt,wt,bt,vt,mt,yt,kt,xt,Et,At,Bt=0,zt=new b.Buf8(4),Rt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return I;r=t.state,r.mode===X&&(r.mode=q),s=t.next_out,a=t.output,f=t.avail_out,o=t.next_in,i=t.input,h=t.avail_in,d=r.hold,c=r.bits,_=h,p=f,xt=S;t:for(;;)switch(r.mode){case O:if(0===r.wrap){r.mode=q;break}for(;c<16;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}if(2&r.wrap&&35615===d){r.check=0,zt[0]=255&d,zt[1]=d>>>8&255,r.check=m(r.check,zt,2,0),d=0,c=0,r.mode=L;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&d)<<8)+(d>>8))%31){t.msg="incorrect header check",r.mode=dt;break}if((15&d)!==M){t.msg="unknown compression method",r.mode=dt;break}if(d>>>=4,c-=4,kt=8+(15&d),0===r.wbits)r.wbits=kt;else if(kt>r.wbits){t.msg="invalid window size",r.mode=dt;break}r.dmax=1<<kt,t.adler=r.check=1,r.mode=512&d?G:X,d=0,c=0;break;case L:for(;c<16;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}if(r.flags=d,(255&r.flags)!==M){t.msg="unknown compression method",r.mode=dt;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=dt;break}r.head&&(r.head.text=d>>8&1),512&r.flags&&(zt[0]=255&d,zt[1]=d>>>8&255,r.check=m(r.check,zt,2,0)),d=0,c=0,r.mode=N;case N:for(;c<32;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}r.head&&(r.head.time=d),512&r.flags&&(zt[0]=255&d,zt[1]=d>>>8&255,zt[2]=d>>>16&255,zt[3]=d>>>24&255,r.check=m(r.check,zt,4,0)),d=0,c=0,r.mode=Y;case Y:for(;c<16;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}r.head&&(r.head.xflags=255&d,r.head.os=d>>8),512&r.flags&&(zt[0]=255&d,zt[1]=d>>>8&255,r.check=m(r.check,zt,2,0)),d=0,c=0,r.mode=Z;case Z:if(1024&r.flags){for(;c<16;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}r.length=d,r.head&&(r.head.extra_len=d),512&r.flags&&(zt[0]=255&d,zt[1]=d>>>8&255,r.check=m(r.check,zt,2,0)),d=0,c=0}else r.head&&(r.head.extra=null);r.mode=F;case F:if(1024&r.flags&&(g=r.length,g>h&&(g=h),g&&(r.head&&(kt=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),b.arraySet(r.head.extra,i,o,g,kt)),512&r.flags&&(r.check=m(r.check,i,g,o)),h-=g,o+=g,r.length-=g),r.length))break t;r.length=0,r.mode=H;case H:if(2048&r.flags){if(0===h)break t;g=0;do{kt=i[o+g++],r.head&&kt&&r.length<65536&&(r.head.name+=String.fromCharCode(kt))}while(kt&&g<h);if(512&r.flags&&(r.check=m(r.check,i,g,o)),h-=g,o+=g,kt)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=j;case j:if(4096&r.flags){if(0===h)break t;g=0;do{kt=i[o+g++],r.head&&kt&&r.length<65536&&(r.head.comment+=String.fromCharCode(kt))}while(kt&&g<h);if(512&r.flags&&(r.check=m(r.check,i,g,o)),h-=g,o+=g,kt)break t}else r.head&&(r.head.comment=null);r.mode=K;case K:if(512&r.flags){for(;c<16;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}if(d!==(65535&r.check)){t.msg="header crc mismatch",r.mode=dt;break}d=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=X;break;case G:for(;c<32;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}t.adler=r.check=n(d),d=0,c=0,r.mode=W;case W:if(0===r.havedict)return t.next_out=s,t.avail_out=f,t.next_in=o,t.avail_in=h,r.hold=d,r.bits=c,P;t.adler=r.check=1,r.mode=X;case X:if(e===z||e===R)break t;case q:if(r.last){d>>>=7&c,c-=7&c,r.mode=ft;break}for(;c<3;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}switch(r.last=1&d,d>>>=1,c-=1,3&d){case 0:r.mode=V;break;case 1:if(u(r),r.mode=rt,e===R){d>>>=2,c-=2;break t}break;case 2:r.mode=$;break;case 3:t.msg="invalid block type",r.mode=dt}d>>>=2,c-=2;break;case V:for(d>>>=7&c,c-=7&c;c<32;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}if((65535&d)!=(d>>>16^65535)){t.msg="invalid stored block lengths",r.mode=dt;break}if(r.length=65535&d,d=0,c=0,r.mode=J,e===R)break t;case J:r.mode=Q;case Q:if(g=r.length){if(g>h&&(g=h),g>f&&(g=f),0===g)break t;b.arraySet(a,i,o,g,s),h-=g,o+=g,f-=g,s+=g,r.length-=g;break}r.mode=X;break;case $:for(;c<14;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}if(r.nlen=257+(31&d),d>>>=5,c-=5,r.ndist=1+(31&d),d>>>=5,c-=5,r.ncode=4+(15&d),d>>>=4,c-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=dt;break}r.have=0,r.mode=tt;case tt:for(;r.have<r.ncode;){for(;c<3;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}r.lens[Rt[r.have++]]=7&d,d>>>=3,c-=3}for(;r.have<19;)r.lens[Rt[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Et={bits:r.lenbits},xt=k(x,r.lens,0,19,r.lencode,0,r.work,Et),r.lenbits=Et.bits,xt){t.msg="invalid code lengths set",r.mode=dt;break}r.have=0,r.mode=et;case et:for(;r.have<r.nlen+r.ndist;){for(;Bt=r.lencode[d&(1<<r.lenbits)-1],gt=Bt>>>24,wt=Bt>>>16&255,bt=65535&Bt,!(gt<=c);){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}if(bt<16)d>>>=gt,c-=gt,r.lens[r.have++]=bt;else{if(16===bt){for(At=gt+2;c<At;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}if(d>>>=gt,c-=gt,0===r.have){t.msg="invalid bit length repeat",r.mode=dt;break}kt=r.lens[r.have-1],g=3+(3&d),d>>>=2,c-=2}else if(17===bt){for(At=gt+3;c<At;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}d>>>=gt,c-=gt,kt=0,g=3+(7&d),d>>>=3,c-=3}else{for(At=gt+7;c<At;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}d>>>=gt,c-=gt,kt=0,g=11+(127&d),d>>>=7,c-=7}if(r.have+g>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=dt;break}for(;g--;)r.lens[r.have++]=kt}}if(r.mode===dt)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=dt;break}if(r.lenbits=9,Et={bits:r.lenbits},xt=k(E,r.lens,0,r.nlen,r.lencode,0,r.work,Et),r.lenbits=Et.bits,xt){t.msg="invalid literal/lengths set",r.mode=dt;break}if(r.distbits=6,r.distcode=r.distdyn,Et={bits:r.distbits},xt=k(A,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Et),r.distbits=Et.bits,xt){t.msg="invalid distances set",r.mode=dt;break}if(r.mode=rt,e===R)break t;case rt:r.mode=nt;case nt:if(h>=6&&f>=258){t.next_out=s,t.avail_out=f,t.next_in=o,t.avail_in=h,r.hold=d,r.bits=c,y(t,p),s=t.next_out,a=t.output,f=t.avail_out,o=t.next_in,i=t.input,h=t.avail_in,d=r.hold,c=r.bits,r.mode===X&&(r.back=-1);break}for(r.back=0;Bt=r.lencode[d&(1<<r.lenbits)-1],gt=Bt>>>24,wt=Bt>>>16&255,bt=65535&Bt,!(gt<=c);){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}if(wt&&0==(240&wt)){for(vt=gt,mt=wt,yt=bt;Bt=r.lencode[yt+((d&(1<<vt+mt)-1)>>vt)],gt=Bt>>>24,wt=Bt>>>16&255,bt=65535&Bt,!(vt+gt<=c);){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}d>>>=vt,c-=vt,r.back+=vt}if(d>>>=gt,c-=gt,r.back+=gt,r.length=bt,0===wt){r.mode=ht;break}if(32&wt){r.back=-1,r.mode=X;break}if(64&wt){t.msg="invalid literal/length code",r.mode=dt;break}r.extra=15&wt,r.mode=it;case it:if(r.extra){for(At=r.extra;c<At;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=at;case at:for(;Bt=r.distcode[d&(1<<r.distbits)-1],gt=Bt>>>24,wt=Bt>>>16&255,bt=65535&Bt,!(gt<=c);){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}if(0==(240&wt)){for(vt=gt,mt=wt,yt=bt;Bt=r.distcode[yt+((d&(1<<vt+mt)-1)>>vt)],gt=Bt>>>24,wt=Bt>>>16&255,bt=65535&Bt,!(vt+gt<=c);){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}d>>>=vt,c-=vt,r.back+=vt}if(d>>>=gt,c-=gt,r.back+=gt,64&wt){t.msg="invalid distance code",r.mode=dt;break}r.offset=bt,r.extra=15&wt,r.mode=ot;case ot:if(r.extra){for(At=r.extra;c<At;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=dt;break}r.mode=st;case st:if(0===f)break t;if(g=p-f,r.offset>g){if((g=r.offset-g)>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=dt;break}g>r.wnext?(g-=r.wnext,w=r.wsize-g):w=r.wnext-g,g>r.length&&(g=r.length),pt=r.window}else pt=a,w=s-r.offset,g=r.length;g>f&&(g=f),f-=g,r.length-=g;do{a[s++]=pt[w++]}while(--g);0===r.length&&(r.mode=nt);break;case ht:if(0===f)break t;a[s++]=r.length,f--,r.mode=nt;break;case ft:if(r.wrap){for(;c<32;){if(0===h)break t;h--,d|=i[o++]<<c,c+=8}if(p-=f,t.total_out+=p,r.total+=p,p&&(t.adler=r.check=r.flags?m(r.check,a,p,s-p):v(r.check,a,p,s-p)),p=f,(r.flags?d:n(d))!==r.check){t.msg="incorrect data check",r.mode=dt;break}d=0,c=0}r.mode=ut;case ut:if(r.wrap&&r.flags){for(;c<32;){if(0===h)break t;h--,d+=i[o++]<<c,c+=8}if(d!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=dt;break}d=0,c=0}r.mode=lt;case lt:xt=T;break t;case dt:xt=U;break t;case ct:return C;case _t:default:return I}return t.next_out=s,t.avail_out=f,t.next_in=o,t.avail_in=h,r.hold=d,r.bits=c,(r.wsize||p!==t.avail_out&&r.mode<dt&&(r.mode<ft||e!==B))&&l(t,t.output,t.next_out,p-t.avail_out)?(r.mode=ct,C):(_-=t.avail_in,p-=t.avail_out,t.total_in+=_,t.total_out+=p,r.total+=p,r.wrap&&p&&(t.adler=r.check=r.flags?m(r.check,a,p,t.next_out-p):v(r.check,a,p,t.next_out-p)),t.data_type=r.bits+(r.last?64:0)+(r.mode===X?128:0)+(r.mode===rt||r.mode===J?256:0),(0===_&&0===p||e===B)&&xt===S&&(xt=D),xt)}function c(t){if(!t||!t.state)return I;var e=t.state;return e.window&&(e.window=null),t.state=null,S}function _(t,e){var r;return t&&t.state?(r=t.state,0==(2&r.wrap)?I:(r.head=e,e.done=!1,S)):I}function p(t,e){var r,n,i=e.length;return t&&t.state?(r=t.state,0!==r.wrap&&r.mode!==W?I:r.mode===W&&(n=1,(n=v(n,e,i,0))!==r.check)?U:l(t,e,i,i)?(r.mode=ct,C):(r.havedict=1,S)):I}var g,w,b=r(0),v=r(3),m=r(5),y=r(19),k=r(21),x=0,E=1,A=2,B=4,z=5,R=6,S=0,T=1,P=2,I=-2,U=-3,C=-4,D=-5,M=8,O=1,L=2,N=3,Y=4,Z=5,F=6,H=7,j=8,K=9,G=10,W=11,X=12,q=13,V=14,J=15,Q=16,$=17,tt=18,et=19,rt=20,nt=21,it=22,at=23,ot=24,st=25,ht=26,ft=27,ut=28,lt=29,dt=30,ct=31,_t=32,pt=852,gt=592,wt=15,bt=!0;e.inflateReset=o,e.inflateReset2=s,e.inflateResetKeep=a,e.inflateInit=f,e.inflateInit2=h,e.inflate=d,e.inflateEnd=c,e.inflateGetHeader=_,e.inflateSetDictionary=p,e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,r){"use strict";var n=r(0),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,r,h,f,u,l,d){var c,_,p,g,w,b,v,m,y,k=d.bits,x=0,E=0,A=0,B=0,z=0,R=0,S=0,T=0,P=0,I=0,U=null,C=0,D=new n.Buf16(16),M=new n.Buf16(16),O=null,L=0;for(x=0;x<=15;x++)D[x]=0;for(E=0;E<h;E++)D[e[r+E]]++;for(z=k,B=15;B>=1&&0===D[B];B--);if(z>B&&(z=B),0===B)return f[u++]=20971520,f[u++]=20971520,d.bits=1,0;for(A=1;A<B&&0===D[A];A++);for(z<A&&(z=A),T=1,x=1;x<=15;x++)if(T<<=1,(T-=D[x])<0)return-1;if(T>0&&(0===t||1!==B))return-1;for(M[1]=0,x=1;x<15;x++)M[x+1]=M[x]+D[x];for(E=0;E<h;E++)0!==e[r+E]&&(l[M[e[r+E]]++]=E);if(0===t?(U=O=l,b=19):1===t?(U=i,C-=257,O=a,L-=257,b=256):(U=o,O=s,b=-1),I=0,E=0,x=A,w=u,R=z,S=0,p=-1,P=1<<z,g=P-1,1===t&&P>852||2===t&&P>592)return 1;for(var N=0;;){N++,v=x-S,l[E]<b?(m=0,y=l[E]):l[E]>b?(m=O[L+l[E]],y=U[C+l[E]]):(m=96,y=0),c=1<<x-S,_=1<<R,A=_;do{_-=c,f[w+(I>>S)+_]=v<<24|m<<16|y|0}while(0!==_);for(c=1<<x-1;I&c;)c>>=1;if(0!==c?(I&=c-1,I+=c):I=0,E++,0==--D[x]){if(x===B)break;x=e[r+l[E]]}if(x>z&&(I&g)!==p){for(0===S&&(S=z),w+=A,R=x-S,T=1<<R;R+S<B&&!((T-=D[R+S])<=0);)R++,T<<=1;if(P+=1<<R,1===t&&P>852||2===t&&P>592)return 1;p=I&g,f[p]=z<<24|R<<16|w-u|0}}return 0!==I&&(f[w+I]=x-S<<24|64<<16|0),d.bits=z,0}},function(t,e,r){"use strict";function n(t){for(var e=t.length;--e>=0;)t[e]=0}function i(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}function a(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function o(t){return t<256?at[t]:at[256+(t>>>7)]}function s(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function h(t,e,r){t.bi_valid>W-r?(t.bi_buf|=e<<t.bi_valid&65535,s(t,t.bi_buf),t.bi_buf=e>>W-t.bi_valid,t.bi_valid+=r-W):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function f(t,e,r){h(t,r[2*e],r[2*e+1])}function u(t,e){var r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1}function l(t){16===t.bi_valid?(s(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}function d(t,e){var r,n,i,a,o,s,h=e.dyn_tree,f=e.max_code,u=e.stat_desc.static_tree,l=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,c=e.stat_desc.extra_base,_=e.stat_desc.max_length,p=0;for(a=0;a<=G;a++)t.bl_count[a]=0;for(h[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;r<K;r++)n=t.heap[r],a=h[2*h[2*n+1]+1]+1,a>_&&(a=_,p++),h[2*n+1]=a,n>f||(t.bl_count[a]++,o=0,n>=c&&(o=d[n-c]),s=h[2*n],t.opt_len+=s*(a+o),l&&(t.static_len+=s*(u[2*n+1]+o)));if(0!==p){do{for(a=_-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[_]--,p-=2}while(p>0);for(a=_;0!==a;a--)for(n=t.bl_count[a];0!==n;)(i=t.heap[--r])>f||(h[2*i+1]!==a&&(t.opt_len+=(a-h[2*i+1])*h[2*i],h[2*i+1]=a),n--)}}function c(t,e,r){var n,i,a=new Array(G+1),o=0;for(n=1;n<=G;n++)a[n]=o=o+r[n-1]<<1;for(i=0;i<=e;i++){var s=t[2*i+1];0!==s&&(t[2*i]=u(a[s]++,s))}}function _(){var t,e,r,n,a,o=new Array(G+1);for(r=0,n=0;n<Y-1;n++)for(st[n]=r,t=0;t<1<<$[n];t++)ot[r++]=n;for(ot[r-1]=n,a=0,n=0;n<16;n++)for(ht[n]=a,t=0;t<1<<tt[n];t++)at[a++]=n;for(a>>=7;n<H;n++)for(ht[n]=a<<7,t=0;t<1<<tt[n]-7;t++)at[256+a++]=n;for(e=0;e<=G;e++)o[e]=0;for(t=0;t<=143;)nt[2*t+1]=8,t++,o[8]++;for(;t<=255;)nt[2*t+1]=9,t++,o[9]++;for(;t<=279;)nt[2*t+1]=7,t++,o[7]++;for(;t<=287;)nt[2*t+1]=8,t++,o[8]++;for(c(nt,F+1,o),t=0;t<H;t++)it[2*t+1]=5,it[2*t]=u(t,5);ft=new i(nt,$,Z+1,F,G),ut=new i(it,tt,0,H,G),lt=new i(new Array(0),et,0,j,X)}function p(t){var e;for(e=0;e<F;e++)t.dyn_ltree[2*e]=0;for(e=0;e<H;e++)t.dyn_dtree[2*e]=0;for(e=0;e<j;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*q]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function g(t){t.bi_valid>8?s(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function w(t,e,r,n){g(t),n&&(s(t,r),s(t,~r)),I.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}function b(t,e,r,n){var i=2*e,a=2*r;return t[i]<t[a]||t[i]===t[a]&&n[e]<=n[r]}function v(t,e,r){for(var n=t.heap[r],i=r<<1;i<=t.heap_len&&(i<t.heap_len&&b(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!b(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n}function m(t,e,r){var n,i,a,s,u=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*u]<<8|t.pending_buf[t.d_buf+2*u+1],i=t.pending_buf[t.l_buf+u],u++,0===n?f(t,i,e):(a=ot[i],f(t,a+Z+1,e),s=$[a],0!==s&&(i-=st[a],h(t,i,s)),n--,a=o(n),f(t,a,r),0!==(s=tt[a])&&(n-=ht[a],h(t,n,s)))}while(u<t.last_lit);f(t,q,e)}function y(t,e){var r,n,i,a=e.dyn_tree,o=e.stat_desc.static_tree,s=e.stat_desc.has_stree,h=e.stat_desc.elems,f=-1;for(t.heap_len=0,t.heap_max=K,r=0;r<h;r++)0!==a[2*r]?(t.heap[++t.heap_len]=f=r,t.depth[r]=0):a[2*r+1]=0;for(;t.heap_len<2;)i=t.heap[++t.heap_len]=f<2?++f:0,a[2*i]=1,t.depth[i]=0,t.opt_len--,s&&(t.static_len-=o[2*i+1]);for(e.max_code=f,r=t.heap_len>>1;r>=1;r--)v(t,a,r);i=h;do{r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],v(t,a,1),n=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=n,a[2*i]=a[2*r]+a[2*n],t.depth[i]=(t.depth[r]>=t.depth[n]?t.depth[r]:t.depth[n])+1,a[2*r+1]=a[2*n+1]=i,t.heap[1]=i++,v(t,a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],d(t,e),c(a,f,t.bl_count)}function k(t,e,r){var n,i,a=-1,o=e[1],s=0,h=7,f=4;for(0===o&&(h=138,f=3),e[2*(r+1)+1]=65535,n=0;n<=r;n++)i=o,o=e[2*(n+1)+1],++s<h&&i===o||(s<f?t.bl_tree[2*i]+=s:0!==i?(i!==a&&t.bl_tree[2*i]++,t.bl_tree[2*V]++):s<=10?t.bl_tree[2*J]++:t.bl_tree[2*Q]++,s=0,a=i,0===o?(h=138,f=3):i===o?(h=6,f=3):(h=7,f=4))}function x(t,e,r){var n,i,a=-1,o=e[1],s=0,u=7,l=4;for(0===o&&(u=138,l=3),n=0;n<=r;n++)if(i=o,o=e[2*(n+1)+1],!(++s<u&&i===o)){if(s<l)do{f(t,i,t.bl_tree)}while(0!=--s);else 0!==i?(i!==a&&(f(t,i,t.bl_tree),s--),f(t,V,t.bl_tree),h(t,s-3,2)):s<=10?(f(t,J,t.bl_tree),h(t,s-3,3)):(f(t,Q,t.bl_tree),h(t,s-11,7));s=0,a=i,0===o?(u=138,l=3):i===o?(u=6,l=3):(u=7,l=4)}}function E(t){var e;for(k(t,t.dyn_ltree,t.l_desc.max_code),k(t,t.dyn_dtree,t.d_desc.max_code),y(t,t.bl_desc),e=j-1;e>=3&&0===t.bl_tree[2*rt[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}function A(t,e,r,n){var i;for(h(t,e-257,5),h(t,r-1,5),h(t,n-4,4),i=0;i<n;i++)h(t,t.bl_tree[2*rt[i]+1],3);x(t,t.dyn_ltree,e-1),x(t,t.dyn_dtree,r-1)}function B(t){var e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return C;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return D;for(e=32;e<Z;e++)if(0!==t.dyn_ltree[2*e])return D;return C}function z(t){dt||(_(),dt=!0),t.l_desc=new a(t.dyn_ltree,ft),t.d_desc=new a(t.dyn_dtree,ut),t.bl_desc=new a(t.bl_tree,lt),t.bi_buf=0,t.bi_valid=0,p(t)}function R(t,e,r,n){h(t,(O<<1)+(n?1:0),3),w(t,e,r,!0)}function S(t){h(t,L<<1,3),f(t,q,nt),l(t)}function T(t,e,r,n){var i,a,o=0;t.level>0?(t.strm.data_type===M&&(t.strm.data_type=B(t)),y(t,t.l_desc),y(t,t.d_desc),o=E(t),i=t.opt_len+3+7>>>3,(a=t.static_len+3+7>>>3)<=i&&(i=a)):i=a=r+5,r+4<=i&&-1!==e?R(t,e,r,n):t.strategy===U||a===i?(h(t,(L<<1)+(n?1:0),3),m(t,nt,it)):(h(t,(N<<1)+(n?1:0),3),A(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),m(t,t.dyn_ltree,t.dyn_dtree)),p(t),n&&g(t)}function P(t,e,r){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(ot[r]+Z+1)]++,t.dyn_dtree[2*o(e)]++),t.last_lit===t.lit_bufsize-1}var I=r(0),U=4,C=0,D=1,M=2,O=0,L=1,N=2,Y=29,Z=256,F=Z+1+Y,H=30,j=19,K=2*F+1,G=15,W=16,X=7,q=256,V=16,J=17,Q=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],tt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],et=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],rt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],nt=new Array(2*(F+2));n(nt);var it=new Array(2*H);n(it);var at=new Array(512);n(at);var ot=new Array(256);n(ot);var st=new Array(Y);n(st);var ht=new Array(H);n(ht);var ft,ut,lt,dt=!1;e._tr_init=z,e._tr_stored_block=R,e._tr_flush_block=T,e._tr_tally=P,e._tr_align=S},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r}]);\n//# sourceMappingURL=BundleLoader.js.map',r.p+"BundleLoader.js")}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=r(39),a=n(o),s=r(10),l=n(s),u=function(e,t,r,n,i,o){a.default.call(this,e,t,r,n,i,o)};u.prototype=Object.create(a.default.prototype),u.prototype.constructor=u,u.prototype.addCamera=function(e,t,r,n,o){var a,s=new i.Vector3(t[0],t[1],t[2]),l=new i.Vector3(t[3],t[4],t[5]),u=new i.Vector3(t[6],t[7],t[8]);u.normalize().multiplyScalar(e),l.normalize().multiplyScalar(u.length()*t[9]);var c=l.clone().cross(u).normalize().multiplyScalar(l.length()*t[10]),h=new Array(4),d=s.clone().add(u);h[0]=d.clone().sub(l).sub(c),h[1]=d.clone().add(l).sub(c),h[2]=d.clone().add(l).add(c),h[3]=d.clone().sub(l).add(c);var f=[h[0],h[1],h[1],h[2],h[2],h[3],h[3],h[0],s,h[0],s,h[1],s,h[2],s,h[3],d,d.clone().sub(c),d,d.clone().sub(l),d,d.clone().sub(u)],p=[];for(a=0;a<22;a++)a<16?p.push({r:.48,g:.45,b:.89}):a<18?p.push({r:1,g:0,b:0}):a<20?p.push({r:0,g:1,b:0}):a<22&&p.push({r:0,g:0,b:1});for(a=0;a<f.length;a++)r[3*(22*o+a)]=f[a].x,r[3*(22*o+a)+1]=f[a].y,r[3*(22*o+a)+2]=f[a].z,n[3*(22*o+a)]=p[a].r,n[3*(22*o+a)+1]=p[a].g,n[3*(22*o+a)+2]=p[a].b},u.prototype.tileLoader=function(){var e,t,r=this;return new Promise(function(n,o){(0,l.default)({method:"get",url:r.getJsName(),timeout:6e6}).then(function(o){var a,s,l,u=o.data,c=new i.BufferGeometry,h=new i.LineBasicMaterial({vertexColors:i.VertexColors});if(u instanceof Array)for(l=parseFloat(u[0][0])/r.length_unit_to_meter,a=new Float32Array(3*(u.length-1)*22),s=new Float32Array(3*(u.length-1)*22),e=1;e<u.length;e++){var d=u[e];for(t=0;t<3;t++)d[t]=d[t]/r.length_unit_to_meter;r.addCamera(l,d,a,s,e-1)}else{l=parseFloat(u.camera_scale/r.length_unit_to_meter);var f=u.camera_info,p=3*f.length*22;for(a=new Float32Array(p),s=new Float32Array(p),e=0;e<f.length;e++){var m=f[e].display;for(t=0;t<3;t++)m[t]=m[t]/r.length_unit_to_meter;r.addCamera(l,m,a,s,e)}}c.addAttribute("position",new i.BufferAttribute(a,3)),c.addAttribute("color",new i.BufferAttribute(s,3));var v=new i.LineSegments(c,h);v.name=r.name,n(v)}).catch(function(e,t,n){console.warn(e,t,n),"timeout"===t&&r.onError(10200),o(n)})})},t.default=u},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=r(50),a=n(o),s=r(103),l=n(s),u=r(99),c=n(u),h=r(100),d=n(h),f=r(81),p=n(f),m=r(111),v=n(m),g=r(29),y=n(g),b=r(52),_=n(b),w=r(74),x=n(w),M=r(73),E=n(M),A=r(17),T=n(A),k=r(35),S=n(k),C=r(23),P=n(C),O=r(12),R=n(O),L=function(e,t,r,n){function o(e){var t=["z-index: 1;","position: relative;","left:0px;","top:0px;","width:100%;","height:100%;","margin:0px;","overflow: hidden !important;","padding:0px;"].join("");return y.default.createDiv(e,"ThreeDiv",t)}function s(e){var t=y.default.createDiv(w.threeContainer,"alti-viewer-attribution no_select"),r=w.config.i18n.basic,n=w.config.projectInfo,i="<span>"+r.copyrightAltizure+'</span><a href="https://www.altizure.com" target="_blank" class="viewer-logo-essential">Altizure™</a>';i=!1!==e?i:"";var o=n.author,a=n.authorLink,s="<span>"+r.copyrightUser+'</span><a href="'+a+'" target="_blank" class="viewer-logo-essential">©'+o+"</a>";s=o?s:"",t.innerHTML=s+i}function u(e,t,r,n){var i=["z-index: 2;","position: absolute;","left:0px;","top:0px;","width:100%;","height:100%;","font-size:12pt;","text-align: center;","vertical-align: middle;","text-align: -webkit-center;","vertical-align: -webkit-middle;","background-color: #"+r.toString(16)+";","color: #"+(16777215-r).toString(16)+";","margin:0px;","padding:0px;"].join(""),o=y.default.createDiv(e,"ErrorDiv",i),a=["position: relative;","top:40%;","font-size:12pt;","text-align: center;","vertical-align: middle;","text-align: -webkit-center;","vertical-align: -webkit-middle;","margin:0px;","padding:0px;"].join(""),s=y.default.createDiv(o,"ErrorTextDiv",a);return s.innerHTML=t,n&&(s.innerHTML+='<br><br><a href="'+n+'" class="btn-link">Learn More</a>'),o}function h(e){if(w.isInitialized){var t=w.clock.getElapsedTime();if(t-g>=.5){w.camera.updateMatrix(),w.camera.updateMatrixWorld(!0),w.camera.updateProjectionMatrix(),w.camera.matrixWorldInverse.getInverse(w.camera.matrixWorld);var r=(new i.Matrix4).multiplyMatrices(w.camera.projectionMatrix,w.camera.matrixWorldInverse),n=new i.Frustum;n.setFromMatrix((new i.Matrix4).multiplyMatrices(w.camera.projectionMatrix,w.camera.matrixWorldInverse));var o;w.dataManager.data.map(function(t){o=t.tree,o.updateView(w.camera,r,n),e&&o.loadUnloadedTiles()}),g=t,b=t}}}function f(){if(!w.isInitialized)return!1;var e=!0,t=w.clock.getElapsedTime();if(t-b>=.08){w.camera.updateMatrix(),w.camera.updateMatrixWorld(!0),w.camera.updateProjectionMatrix(),w.camera.matrixWorldInverse.getInverse(w.camera.matrixWorld);var r=new i.Frustum;r.setFromMatrix((new i.Matrix4).multiplyMatrices(w.camera.projectionMatrix,w.camera.matrixWorldInverse));var n;w.dataManager.data.map(function(t){n=t.tree,e=n.updateVisibility(r)&&e}),b=t}return e||console.warn("updateTreeVisibility has a problem"),e}function m(e){n.orbit=e.orbit||n.orbit,w.camera.position.set(null===n.camPosition.x?Number(e.camera_pos.x):n.camPosition.x,null===n.camPosition.y?Number(e.camera_pos.y):n.camPosition.y,null===n.camPosition.z?Number(e.camera_pos.z):n.camPosition.z),w.cameraControls.maxPolarAngle=Math.PI/2*(null===n.maxPolarAngle?e.maxPolarAngle:n.maxPolarAngle),!1!==e.clampZoomDistance&&(w.cameraControls.maxDistance=null===n.maxDistance?e.maxDistance:n.maxDistance,w.cameraControls.minDistance=e.minDistance),w.cameraControls.maxOrthoHeight=Math.tan(w.camera.fov*Math.PI/360)*w.cameraControls.maxDistance,w.cameraControls.minOrthoHeight=Math.tan(w.camera.fov*Math.PI/360)*w.cameraControls.minDistance,w.cameraControls.maxPanDistance=e.maxPanDistance,w.cameraControls.center.set(null===n.camViewAt.x?Number(e.center_pos.x):n.camViewAt.x,null===n.camViewAt.y?Number(e.center_pos.y):n.camViewAt.y,null===n.camViewAt.z?Number(e.center_pos.z):n.camViewAt.z),w.cameraControls.centerPan=null==e.centerPan?w.cameraControls.center.clone():new i.Vector3(e.centerPan.x,e.centerPan.y,e.centerPan.z),w.camera.lookAt(w.cameraControls.center),w.camera.far=10*e.max_bound.clone().sub(e.min_bound).length(),w.camera.near=w.camera.far/1e5,w.cameraControls.plane=(new i.Plane).setFromNormalAndCoplanarPoint(new i.Vector3(0,1,0),new i.Vector3(0,0,0))}this.rootContainer=null,this.stats=null,this.monitor=null,this.loadingWidget=null,this.buttons={},this.threeContainer=null,this.renderer=null,this.effect=null,this.scene=null,this.widgetScene=null,this.defaultClippingPlanes=null,this.withWidget=!1,this.camera=null,this.cameraControls=null,this.fpsControls=null,this.config=n,this.dataManager=new p.default(t,r,n.tree_options),this.eventQueue=null,this.PID=null,this.lastFrameTime=1e3/60,this.animateFrameTime=1e3/60,this.staticFrameTime=1e3/30,this.frameTimeTorelance=2,this.isAnimating=!1,this.clock=new i.Clock,this.isInitialized=!1;var g=this.clock.getElapsedTime()-1,b=this.clock.getElapsedTime()-.3,w=this;this.toyManager=new l.default,this.ortho_picker=null,this.waterManager=null;var M=void 0;n.API_HOST?M=R.default.AES.decrypt(n.API_HOST,"altizure-environment").toString(R.default.enc.Utf8):(M="https://api.altizure.com/graphql",console.error("Viewer: API_HOST is not defined"));var A=void 0;n.API_KEY?A=R.default.AES.decrypt(n.API_KEY,"altizure-environment").toString(R.default.enc.Utf8):(A="ToA0NQtp92u58EAqyUyKYg5bVBdPNIuFozRkDuq",console.error("Viewer: API_KEY is not defined")),this._altizureApi=new P.default({apiUrl:M,key:A}),n.altizureApi=this._altizureApi,function(){if(w.rootContainer=document.getElementById(e),!w.rootContainer)return void console.log("Invalid "+e);w.threeContainer=o(w.rootContainer),s(w.config.showOurLogo),w.eventQueue=new _.default,w.scene=new i.Scene,w.widgetScene=new i.Scene,w.camera=new i.PerspectiveCamera(30,null,1,1e4),w.camera.lookAt(w.scene.position),w.camera.updateProjectionMatrix(),w.scene.add(w.camera);var t=new i.AmbientLight(8421504);w.widgetScene.add(t);var r=new i.PointLight(16777215);if(w.camera.add(r),(new i.TextureLoader).load("/images/editor/assets/img/waternormals.jpg",function(e){var t=e;t.wrapS=t.wrapT=i.RepeatWrapping},function(e){console.log("water normal"+e.loaded/e.total*100+"% loaded")},function(e){console.log("Loading water normal error!")}),!a.default.webgl){if(a.default.browser.isWeChat){var l=/iPhone|iPod|iPad/.test(navigator.userAgent)?"Open in Safari":"Open with Browser";return void u(w.rootContainer,'1. Click the button on upper right corner. <br>2. Select "'+l+'".',w.config.backgroundColor)}return void u(w.rootContainer,"No WebGL Support",w.config.backgroundColor,"/support/articles/faq_compatibility")}w.renderer=new i.WebGLRenderer({antialias:!0}),w.renderer.setClearColor(new i.Color(w.config.backgroundColor)),w.renderer.setPixelRatio(void 0!==window.devicePixelRatio?window.devicePixelRatio:1),w.threeContainer.appendChild(w.renderer.domElement),w.renderer.context.getExtension("OES_standard_derivatives"),w.renderer.autoClear=!0,w.renderer.autoClearDepth=!0,w.picker=new v.default(w.camera,w.renderer,w.scene),w.ortho_picker=new v.default(w.camera,w.renderer,new i.Plane(new i.Vector3(0,1,0),0)),w.cameraControls=new x.default(w.camera,w.threeContainer,w.picker),w.cameraControls.userPanSpeed=100,w.cameraControls.userZoomSpeed=1,1===n.ui.control_mode&&(w.fpsControls=new E.default(w.camera,w.scene,w.threeContainer),w.fpsControls.addEventListener("changed",function(){h(!0),w.isAnimating=!1,w.threeContainer.dispatchEvent(new CustomEvent("changed"))}),w.fpsControls.addEventListener("changing",function(){f(),w.isAnimating=!1,w.threeContainer.dispatchEvent(new CustomEvent("changing"))}));var p=w.config.isMobile;w.cameraControls.addEventListener("changed",function(){h(!0),w.isAnimating=!1,w.threeContainer.dispatchEvent(new CustomEvent("changed"))}),w.cameraControls.addEventListener("changing",function(){f(),w.isAnimating=!0,w.threeContainer.dispatchEvent(new CustomEvent("changing"))}),w.cameraControls.addEventListener("animating",function(){w.isAnimating=!0,w.threeContainer.dispatchEvent(new CustomEvent("changing"))}),w.threeContainer.addEventListener("resize",function(){w.resize(),h(!0)}),window.addEventListener("resize",function(){w.threeContainer.dispatchEvent(new CustomEvent("resize"))}),window.addEventListener("load_complete",function(e){e.detail===w.dataManager.getTreeByType()&&(w.config.orbit?(w.config.orbit=!1,w.cameraControls.animateOrbit()):w.config.cameraMotion&&(w.config.cameraMotion=!1,w.cameraControls.animateViewpoint()))}),w.threeContainer.addEventListener("dblclick",function(){w.cameraControls.enabled&&w.cameraControls.animateZoomIn()}),p&&!1!==w.config.ui.interact&&(w.cameraControls.userRotateSpeed=3,document.body.style.overflow="hidden");var g=function(){w.dataManager.constructSmartTrees(w.scene,w.renderer,n,w.PID);var e=w.dataManager.getDataByType();if(e&&(m(e.info),w.loadingWidget=new c.default(e.tree,16777215-n.backgroundColor),w.threeContainer.appendChild(w.loadingWidget.domElement),w.config.showFPS&&(w.stats=new Stats,w.stats.domElement.style.position="absolute",w.stats.domElement.style.top="0px",w.stats.domElement.style.zIndex=100,w.threeContainer.appendChild(w.stats.domElement),w.monitor=new d.default(e.sceneGraphRoot,e.tree,w.renderer),w.monitor.domElement.style.position="absolute",w.monitor.domElement.style.right="0px",w.monitor.domElement.style.top="0px",w.monitor.domElement.style.zIndex=100,w.threeContainer.appendChild(w.monitor.domElement),w.threeContainer.addEventListener("click",function(e){var t=w.picker.pickTile(e.clientX,e.clientY);w.monitor.updateTileName(t)}))),w.isInitialized=!0,w.camera.updateMatrix(),w.camera.updateMatrixWorld(),w.camera.updateProjectionMatrix(),w.camera.matrixWorldInverse.getInverse(w.camera.matrixWorld),w.config.waterMode){var t={PID:w.PID,viewer:w,dataPath:""+w.config.dataPath,usage:"water",MaskType:T.default,maskSize:512,info:w.dataManager.getInfoByType(),maxMaskNum:3,updateMaskFormat:w.config.updateMaskFormat,isDebug:!1,edit:w.config.editMask,HOST:w.config.HOST,altizureApi:w._altizureApi},r=t.info.transformation.getTransBBox(t.info,!0);w.ortho_picker=new v.default(w.camera,w.renderer,new i.Plane(new i.Vector3(0,1,0),(r[0].y+r[1].y)/2)),w.waterManager=new S.default(t),w.waterManager.downloadAll()}w.threeContainer.dispatchEvent(new CustomEvent("resize")),w.threeContainer.dispatchEvent(new CustomEvent("initialized")),w.timeLast=1e3*w.clock.getElapsedTime(),w.animate()},y=function(){u(w.rootContainer,"No data",n.backgroundColor),w.isInitialized=!1};w.dataManager.loadInfo(w.config,g,y)}(),this.render=function(){if(w.renderer.clearStencil(),w.renderer.clearColor(),w.renderer.clearDepth(),w.withWidget){w.renderer.render(w.scene,w.camera);var e=w.renderer.clippingPlanes;w.defaultClippingPlanes&&(w.renderer.clippingPlanes=w.defaultClippingPlanes),w.renderer.render(w.widgetScene,w.camera),w.renderer.clippingPlanes=e}else w.waterManager&&w.waterManager.renderWaters(),w.effect?w.effect.render(w.scene,w.camera):w.renderer.render(w.scene,w.camera);w.renderer.context.flush()},this.updateOrthoPicker=function(e){var t=new i.Plane(new i.Vector3(0,1,0),e);w.ortho_picker?w.ortho_picker.updateSgr(t):w.ortho_picker=new v.default(w.camera,w.renderer,t)}};L.prototype.constructor=L,L.prototype.resize=function(){if(this.threeContainer&&this.isInitialized){var e=this.threeContainer.clientWidth,t=this.threeContainer.clientHeight;this.renderer.setSize(e,t),this.camera.aspect=e/t,this.camera instanceof i.OrthographicCamera&&(this.camera.right=this.camera.top*this.camera.aspect,this.camera.left=-this.camera.right),this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t),this.effect&&this.effect.setSize(e,t),this.threeContainer.dispatchEvent(new CustomEvent("changed"))}},L.prototype.animate=function(){var e=this;if(e.isInitialized){var t=1e3*e.clock.getElapsedTime(),r=this.isAnimating?this.animateFrameTime:this.staticFrameTime;t-e.timeLast>Math.min(Math.max(r,1.2*e.lastFrameTime),200)-e.frameTimeTorelance&&(this.toyManager.update(),e.render(),e.update(),e.lastFrameTime=1e3*e.clock.getElapsedTime()-t,e.timeLast=t),this.renderFrameid=requestAnimationFrame(function(){e.animate()})}},L.prototype.stop=function(){if(this.renderFrameid&&cancelAnimationFrame(this.renderFrameid),this.rootContainer)for(;this.rootContainer.firstChild;)this.rootContainer.removeChild(this.rootContainer.firstChild)},L.prototype.attachEffect=function(e,t){return this.threeContainer&&this.renderer?(this.effect=new e(this.renderer,t),this.effect&&this.effect.setSize(this.threeContainer.clientWidth,this.threeContainer.clientHeight),this.effect):(console.error("The renderer has not been initialized"),null)},L.prototype.update=function(){if(1===this.config.ui.control_mode&&null!==this.fpsControls)this.fpsControls.update();else if(this.cameraControls.update(),1===this.camera.up.y);else{var e=this.camera.up.clone(),t=new i.Vector3(0,1,0),r=e.clone().cross(t).normalize(),n=e.angleTo(t);Math.abs(n)<=.01?this.camera.up.set(0,1,0):(e.applyAxisAngle(r,.01*Math.sign(n)),this.camera.up.copy(e))}this.loadingWidget&&this.loadingWidget.update(),this.config.showFPS&&this.stats&&this.monitor&&(this.stats.update(),this.monitor.update())},t.default=L},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=r(36),l=n(s),u=r(12),c=n(u),h=function(e){function t(e,r,n){i(this,t);var a={op0:"op0"};if(n=n||{},n.camera)a.camera=n.camera;else{var s=114.263885,l=22.335836,u=1e7,h=6.6,d=60;n.altlonglat&&(void 0!==n.altlonglat.longitude&&(s=n.altlonglat.longitude),void 0!==n.altlonglat.latitude&&(l=n.altlonglat.latitude),void 0!==n.altlonglat.altitude&&(u=n.altlonglat.altitude)),n.orientation&&(void 0!==n.orientation.northing&&(h=n.orientation.northing),void 0!==n.orientation.tilt&&(d=n.orientation.tilt)),a.camera={flyTo:{lng:s,lat:l,alt:u,north:h,tilt:d}}}a.renderItems=n.renderItems,a.develop=n.develop,a.eventHandlers=n.eventHandlers,a.control=n.control,a.HOST=n.AUTHORIZED_HOST;var f=void 0,p=void 0;return n.api?(n.api.API_HOST?f=c.default.AES.decrypt(n.api.API_HOST,"altizure-environment").toString(c.default.enc.Utf8):(f="https://api.altizure.com/graphql",console.warn("Earth: API_HOST")),n.api.API_KEY?p=c.default.AES.decrypt(n.api.API_KEY,"altizure-environment").toString(c.default.enc.Utf8):(p="ToA0NQtp92u58EAqyUyKYg5bVBdPNIuFozRkDuq",console.warn("Earth: API_KEY"))):(console.warn("Earth: api"),f="https://api.altizure.com/graphql",p="ToA0NQtp92u58EAqyUyKYg5bVBdPNIuFozRkDuq"),a.api={API_HOST:f,API_KEY:p},o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a))}return a(t,e),t}(l.default);t.default=h},function(e,t,r){"use strict";e.exports=r(137).polyfill()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={decodeNumMat:function(e){for(var t=e.width,r=e.height,n=e.data,i=this.decodeNumArray(n),o=0,a=[],s=0;s<t;s++){a[s]=[];for(var l=0;l<r;l++)a[s][l]=i[o],o++}return a},encodeNumMat:function(e){for(var t=e.length,r=e[0].length,n=[],i=0;i<t;i++)for(var o=0;o<r;o++)n.push(e[i][o]);return{width:t,height:r,data:this.encodeNumArray(n)}},_firstChar:48,decodeNumArray:function(e){var t,r=[],n=[];for(t=0;t<e.length;t+=3){var i=e.charAt(t).charCodeAt()-this._firstChar,o=e.charAt(t+1).charCodeAt()-this._firstChar,a=e.charAt(t+2).charCodeAt()-this._firstChar;n.push(i>>2&63),n.push((3&i)<<4|o>>4&15),n.push((15&o)<<2|a>>6&3),n.push(63&a)}for(t=0;t<n.length;t++)63!==n[t]&&r.push(n[t]);return r},encodeNumArray:function(e){for(var t=[],r=0;r<e.length;r+=4){var n=e[r],i=r+1<e.length?e[r+1]:63,o=r+2<e.length?e[r+2]:63,a=r+3<e.length?e[r+3]:63;this.encodeSet(n,i,o,a,t)}return this.stringFromArray(t)},stringFromArray:function(e){for(var t="",r=0;r<e.length;r++)t+=e[r];return t},encodeSet:function(e,t,r,n,i){var o=(63&e)<<2|t>>4&3,a=(15&t)<<4|r>>2&15,s=(3&r)<<6|63&n;i.push(String.fromCharCode(o+this._firstChar)),i.push(String.fromCharCode(a+this._firstChar)),i.push(String.fromCharCode(s+this._firstChar))},pack_boolean:function(e){for(var t={width:e.length,height:e[0].length,data:[]},r=0,n=0,i=0,o=0,a=0,s=0,l=!1,u=0;u<e.length;u++)for(var c=0;c<e[u].length;c++)e[u][c]===l?(r++,o++):e[u][c]===!l?(t.data.push(r),n+=r,l=!l,r=1,a++):(console.warn("Error: unknown entry ["+u+","+c+"]="+e[u][c]),s++),i++;return t.data.push(r),n+=r,t},unpack_boolean:function(e){for(var t=e.width,r=e.height,n=e.data,i=[],o=r;o--;)i[o]=[];var a=!1;o=0;for(var s=0,l=0;l<n.length;l+=16)for(var u=0;u<16;++u){var c=n[u+l],h=function(e,r,n,o){for(var a=n,s=e,l=r;a--;)i[s][l]=o,++l===t&&(s++,l=0);return{row:s,col:l}}(o,s,c,a);o=h.row,s=h.col,a=!a}return i},unpackToImage:function(e){for(var t=e.width,r=e.height,n=e.data,i=new Uint8ClampedArray(t*r*4),o=0,a=!1,s=0,l=0,u=0;u<n.length;u+=16)for(var c=0;c<16;++c){var h=n[c+u],d=function(e,r,n,o){for(var a=n,s=e,l=r,u=4*(s*t+l);a--;)i[u]=i[u+1]=i[u+2]=i[u+3]=o,u+=4,++l===t&&(s++,l=0);return{row:s,col:l}}(s,l,h,a?255:0);s=d.row,l=d.col,o+=!0===a?1:0,a=!a}return{rgba:i,cntWhite:o}},downsampleImage:function(e,t,r,n){for(var i=Math.floor(t*n),o=Math.floor(r*n),a=i*o*4,s=new Uint8ClampedArray(a),l=0,u=0,c=0,h=0;h<o;++h)for(var d=0;d<i;++d)u=4*(h*i+d),c=4*(h/n*t+d/n),s[u]=e[c],s[u+1]=e[c+1],s[u+2]=e[c+2],s[u+3]=e[c+3],l+=0!==s[u]?1:0;return{rgba:s,cntWhite:l}}};t.default=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(43),u=n(l),c=r(15),h=n(c),d=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.projectTree=e.tree,r}return a(t,e),s(t,[{key:"_defaultMaskOpts",value:function(e){var t=h.default.prototype._defaultMaskOpts.call(this);return t.tree=this.projectTree,t.isDebug=this.isDebug,t}},{key:"downloadAll",value:function(){if(this.allowWorker)this.workerDownloadAll();else{var e=this;this._downloadSettings(u.default,function(){},function(){e.addefaultSetting()})}}}]),t}(h.default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={getMaskfromImageData:function(e,t,r,n){for(var i=[],o=r;o--;)i.push([]);for(var a=0,s=0,l=0;l<r;l++)for(var u=0;u<t;u++){var c=4*(l*t+u);0!==e[c+n]?(i[l][u]=!0,s++):(i[l][u]=!1,a++)}return i},isEqual:function(e,t){if(e.length!==t.length)return console.warn("Un identical row length :"+e.length+", "+t.length),!1;for(var r=0;r<e.length;r++){if(e[r].length!==t[r].length)return console.warn("Un identical col length :"+e[r].length+", "+t[r].length),!1;for(var n=0;n<e[r].length;n++)if(e[r][n]!==t[r][n])return!1}return!0},boolMaskToImageData:function(e){for(var t=e.length,r=e[0].length,n=new Uint8ClampedArray(r*t*4),i=0,o=0;o<t;++o)for(var a=0;a<r;++a){var s=4*(o*r+a);e[o][a]?(n[s]=n[s+1]=n[s+2]=255,n[s+3]=255,i++):(n[s]=n[s+1]=n[s+2]=0,n[s+3]=0)}return{rgb:n,cntWhite:i}}};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i={uniforms:{ambient:{type:"v3",value:new n.Vector3},diffuse:{type:"v3",value:new n.Vector3},lightDirection:{type:"v3",value:new n.Vector3},modelTexture:{type:"t",value:null},orthoMask:{type:"t",value:null},cropMask:{type:"t",value:null},ortho_origin:{type:"v3",value:new n.Vector3},ortho_x_dir:{type:"v3",value:new n.Vector3},ortho_y_dir:{type:"v3",value:new n.Vector3},ortho_z_dir:{type:"v3",value:new n.Vector3},ortho_min_bound:{type:"v3",value:new n.Vector3},ortho_max_bound:{type:"v3",value:new n.Vector3},decodeMatrix:{type:"m4",value:new n.Matrix4},transformMatrix:{type:"m4",value:new n.Matrix4}},vertexShader:["uniform vec3 ortho_origin;","uniform vec3 ortho_x_dir;","uniform vec3 ortho_y_dir;","uniform vec3 ortho_z_dir;","uniform vec3 ortho_min_bound;","uniform vec3 ortho_max_bound;","varying vec3 vNormal;","varying vec2 vUv;","varying vec2 vMaskUv;","uniform mat4 decodeMatrix;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","vUv = uv;","vec4 vtrans = decodeMatrix * vec4(position, 1);","vec3 vori = vtrans.xyz - ortho_origin;","vec3 vViewPosition = vec3(dot(vori, ortho_x_dir), dot(vori, ortho_y_dir), dot(vori, ortho_z_dir));","vMaskUv = ((vViewPosition - ortho_min_bound)/(ortho_max_bound - ortho_min_bound)).xz;","}"].join("\n"),fragmentShader:["uniform sampler2D modelTexture;","uniform sampler2D orthoMask;","uniform sampler2D cropMask;","uniform vec3 ambient;","uniform vec3 diffuse;","uniform vec3 lightDirection;","varying vec3 vNormal;","varying vec2 vUv;","varying vec2 vMaskUv;","void main() {","vec4 lDirection = viewMatrix * vec4( lightDirection, 0.0 );","vec3 lVector = normalize( lDirection.xyz );","vec3 normal = normalize( vNormal );","float lambert = max(dot( normal, lVector ), 0.0);","vec2 os_uv = vMaskUv;","float os_val = max(texture2D(orthoMask, os_uv).y, 0.3) * texture2D(cropMask, os_uv).y;","if(os_val < 0.05) {","discard;","}","gl_FragColor = vec4(os_val * texture2D(modelTexture, vUv).xyz, 1.0);","}"].join("\n")};t.default=i},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=r(70),s=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(){function e(t){n(this,e),this._modelTexture=t.map,this._ambient=t.ambient||new o.Vector3(.3,.3,.3),this._diffuse=t.diffuse||new o.Vector3(.6,.6,.6),this._lightDirection=t.lightDirection||new o.Vector3(200,0,200),this._mask=null;for(var r=t.info,i=new Uint8Array(16),a=new Uint8Array(16),l=0;l<16;l++)i[l]=255,a[l]=128;this._light_texture=new o.DataTexture(i,2,2,o.RGBAFormat,o.UnsignedByteType),this._dim_texture=new o.DataTexture(a,2,2,o.RGBAFormat,o.UnsignedByteType),this._select_texture=this._dim_texture,this.dtex=this._light_texture,this.dtex.needsUpdate=!0,this.cropTex=this._light_texture,this.cropTex.needsUpdate=!0,this._material=function(e,t,r,n,i,a,l,u){var c={uniforms:o.UniformsUtils.clone(s.default.uniforms),vertexShader:s.default.vertexShader,fragmentShader:s.default.fragmentShader,side:void 0===t.side?o.FrontSide:t.side},h=new o.ShaderMaterial(c);return h.uniforms.ambient.value=r,h.uniforms.diffuse.value=n,h.uniforms.lightDirection.value=i,h.uniforms.modelTexture.value=a,h.uniforms.ortho_origin.value=e.origin,h.uniforms.ortho_x_dir.value=e.x_dir,h.uniforms.ortho_y_dir.value=e.y_dir,h.uniforms.ortho_z_dir.value=e.z_dir,h.uniforms.ortho_min_bound.value=e.min_bound,h.uniforms.ortho_max_bound.value=e.max_bound,h.uniforms.decodeMatrix.value=t.decodeMatrix,h.uniforms.transformMatrix.value=e.transformMatrix,h.uniforms.orthoMask.value=l,h.uniforms.cropMask.value=u,h.needsUpdate=!0,h}(r,t,this._ambient,this._diffuse,this._lightDirection,this._modelTexture,this.dtex,this.cropTex)}return i(e,[{key:"dispose",value:function(){this.dtex.dispose(),this.dtex=void 0,this.cropTex.dispose(),this.cropTex=void 0,this._dim_texture.dispose(),this._light_texture.dispose(),this._material.dispose(),this._material=void 0}},{key:"dim",value:function(){this.dtex=this._select_texture,this.dtex.needsUpdate=!0,this._material.uniforms.orthoMask.value=this.dtex}},{key:"clear",value:function(){this._select_texture=this._dim_texture,this.dtex=this._select_texture,this._material.uniforms.orthoMask.value=this.dtex}},{key:"light",value:function(){this.dtex=this._light_texture,this.dtex.needsUpdate=!0,this._material.uniforms.orthoMask.value=this.dtex}},{key:"orthoInfo",set:function(e){var t=e;this._material.uniforms.ortho_origin.value=t.origin,this._material.uniforms.ortho_x_dir.value=t.x_dir,this._material.uniforms.ortho_y_dir.value=t.y_dir,this._material.uniforms.ortho_z_dir.value=t.z_dir,this._material.uniforms.ortho_min_bound.value=t.min_bound,this._material.uniforms.ortho_max_bound.value=t.max_bound}},{key:"decodeMatrix",set:function(e){this._material.uniforms.decodeMatrix.value=e}},{key:"maskTexture",set:function(e){this._select_texture=e,this.dtex=this._select_texture,this._material.uniforms.orthoMask.value=this.dtex,this.dtex.needsUpdate=!0}},{key:"cropTexture",set:function(e){this.cropTex=e,this._material.uniforms.cropMask.value=this.cropTex}},{key:"material",get:function(){return this._material}}]),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CameraSwitcherConsts=void 0;var n=r(0),i=r(6),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(e,t){o.default.call(this,e),this.type="switch",this.priority=500,this.needRefresh=!0,this.loop=!0;var r,i,a=new n.Clock,l=s.easing,u=t.cameras||[],c=0,h=a.getElapsedTime(),d=this;this.update=function(t){var n=u.length;if(!(n<1)){r=a.getElapsedTime(),null==i&&(i=r);var o=r-i,s=u[c].duration,f=u[c].easing;if(o>s){if(!1===this.loop&&c>=n-2)return void d.detach();c=(c+1)%n,o-=s,s=u[c].duration,i=r}var p=u[c].position,m=u[(c+1)%n].position,v=u[c].target,g=u[(c+1)%n].target,y=u[c].quaternion,b=u[(c+1)%n].quaternion,_=o/s;f===l.IN?_=d.easing.Quadratic.In(_):f===l.OUT?_=d.easing.Quadratic.Out(_):f===l.INOUT&&(_=d.easing.Quadratic.InOut(_));var w=v.clone().sub(p).normalize(),x=g.clone().sub(m).normalize(),M=e.object.up;y&&b&&(w.cross(M).lengthSq()<1e-5||x.cross(M).lengthSq()<1e-5)&&(t.quaternion=y.clone().slerp(b,_));var E=p.clone().lerp(m,_),A=v.clone().lerp(g,_);t.position=E,t.center=A,Math.abs(h-r)>4&&(t.refresh=!0,h=r)}},this.generateRandomCameras=function(e,t,r){for(var i=0;i<e;i++){var o=new n.Vector3((Math.random()-.5)*r[0],Math.random()*r[1],(Math.random()-.5)*r[2]),a=(new n.Vector3).addVectors(t,o);u.push({position:a,target:t.clone(),duration:8})}}},s={easing:{NONE:"linear",IN:"easein",OUT:"easeout",INOUT:"easeinout"}};a.prototype.constructor=a,a.prototype=Object.create(o.default.prototype),t.default=a,t.CameraSwitcherConsts=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(78),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(e,t,r,i){function a(){if(A&&console.log("startFPS"),!M){A&&console.log("camera rotation",w.object.rotation),l.initRotation(w.object.rotation),w.object.rotation.set(0,0,0),A&&console.log("camera position",w.object.position);var e=w.object.position;l.getObject().position.set(e.x,e.y,e.z),w.object.position.set(0,0,0),A&&console.log("cacmera scale",w.object.scale),w.object.updateMatrix(),M=!0}h.style.display="none";var t=document.body;if(t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,/Firefox/i.test(navigator.userAgent)){var r=function e(){document.fullscreenElement!==t&&document.mozFullscreenElement!==t&&document.mozFullScreenElement!==t||(document.removeEventListener("fullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),t.requestPointerLock())};document.addEventListener("fullscreenchange",r,!1),document.addEventListener("mozfullscreenchange",r,!1),t.requestFullscreen=t.requestFullscreen||t.mozRequestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullscreen,t.requestFullscreen()}else t.requestPointerLock()}this.object=e,this.scene=t,this.domElement=void 0!==r?r:document,this.enabled=!1;var s,l,u,c,h,d={height:1,weight:10,jump_height:30},f=!1,p=!1,m=!1,v=!1,g=!1,y=!1,b=null,_=new n.Vector3(0,0,0),w=this,x={type:"changed"},M=!1,E=i||{},A=E.debug;!function(){var e=["<span style='font-size:40px'>Press Enter to play</span>","<br />","(W, A, S, D = Move, SPACE = Jump, MOUSE = Look around)"].join("\n");c=document.createElement("div"),c.id="blocker",c.style.position="absolute",c.style.top="0",c.style.left="0",c.style.width="100%",c.style.height="100%",c.style.background="rgba(0,0,0,0.5)",h=document.createElement("div"),h.id="instructions",h.style.width="100%",h.style.height="100%",h.style.display="-webkit-box",h.style.display="-moz-box",h.style.display="box",h.style["-webkit-box-orient"]="horizontal",h.style["-moz-box-orient"]="horizontal",h.style["box-orient"]="horizontal",h.style["-webkit-box-pack"]="center",h.style["-moz-box-pack"]="center",h.style["box-pack"]="center",h.style["-webkit-box-align"]="center",h.style["-moz-box-align"]="center",h.style["box-align"]="center",h.style.color="#ffffff",h.innerHTML=e,c.appendChild(h),w.domElement.appendChild(c)}(),function(){if("pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document){A&&console.log("have pointer lock");var e=document.body,t=function(t){A&&console.log("pointerlockchange"),document.pointerLockElement===e||document.mozPointerLockElement===e||document.webkitPointerLockElement===e?(f=!0,l.enabled=!0,c.style.display="none"):(l.enabled=!1,c.style.display="-webkit-box",c.style.display="-moz-box",c.style.display="box",h.style.display="")},r=function(e){console.warn("pointerlockerror",e),h.style.display=""};document.addEventListener("pointerlockchange",t,!1),document.addEventListener("mozpointerlockchange",t,!1),document.addEventListener("webkitpointerlockchange",t,!1),document.addEventListener("pointerlockerror",r,!1),document.addEventListener("mozpointerlockerror",r,!1),document.addEventListener("webkitpointerlockerror",r,!1)}else h.innerHTML="Your browser doesn't seem to support Pointer Lock API"}(),function(){var e={onMove:function(){console.log("onMove"),w.dispatchEvent(x)}};l=new o.default(w.object,e),w.scene.add(l.getObject());var t=function(e){switch(e.keyCode){case 38:case 87:p=!0;break;case 37:case 65:v=!0;break;case 40:case 83:m=!0;break;case 39:case 68:g=!0;break;case 32:!0===y&&(_.y+=d.jump_height),y=!1;break;case 13:w.enabled=!0,a()}},r=function(e){switch(e.keyCode){case 38:case 87:p=!1,w.dispatchEvent(x);break;case 37:case 65:v=!1,w.dispatchEvent(x);break;case 40:case 83:m=!1,w.dispatchEvent(x);break;case 39:case 68:g=!1,w.dispatchEvent(x);break;case 27:p=!1,v=!1,m=!1,g=!1,w.enabled=!1,w.dispatchEvent(x)}};document.addEventListener("keydown",t,!1),document.addEventListener("keyup",r,!1),u=new n.Raycaster(new n.Vector3,new n.Vector3(0,-1,0))}(),this.update=function(){if(f&&l.enabled&&w.enabled){null===b&&(b=(performance||Date).now());var e=(performance||Date).now(),t=(e-b)/1e3;_.x-=10*_.x*t,_.z-=10*_.z*t,p&&(_.z-=400*t),m&&(_.z+=400*t),v&&(_.x-=400*t),g&&(_.x+=400*t),u.ray.origin.copy(l.getObject().position);var r=void 0;1===w.scene.children.length?r=w.scene.children[0].children:2===w.scene.children.length?r=w.scene.children[1].children:3===w.scene.children.length&&(r=w.scene.children[2].children);var i=u.intersectObjects(r),o=i.length>0;o?(_.y-=9.8*d.weight*t,s=i[0].point.clone()):_.y=0;var a=new n.Vector3(0,0,1);a=l.getDirection(a),a.multiplyScalar(_.z*t);var c=new n.Vector3(1,0,0);c=l.getDirection(c),c.multiplyScalar(_.x*t);var h=new n.Vector3(0,1,0);h.multiplyScalar(_.y*t);var x=a.add(c).add(h),M=d.height;o&&l.getObject().position.y+x.y<s.y+M&&(_.y=0,x.y=0,l.getObject().position.y=s.y+M,y=!0),l.getObject().translateX(x.x),l.getObject().translateY(x.y),l.getObject().translateZ(x.z),b=e}}};a.prototype=Object.create(n.EventDispatcher.prototype),a.prototype.constructor=a,t.default=a},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=r(79),a=n(o),s=r(80),l=n(s),u=r(77),c=n(u),h=r(76),d=n(h),f=r(75),p=n(f),m=r(72),v=n(m),g=r(51),y=n(g),b=r(44),_=n(b),w=function(e,t,r){function n(e,t){var r;switch(e){case"rotate":r=a.default;break;case"zoom":r=l.default;break;case"pan":r=c.default;break;case"ortho":r=d.default;break;case"orbit":r=p.default;break;case"switch":r=v.default;break;default:throw new Error("Control handler "+e+" is not implemented.")}if(L.handler&&!L.handler.interruptible)return!1;if(!L.handler||L.handler.type!==e){var n=new r(L,t);if(L.handler&&L.handler.priority>n.priority)return!1;L.handler&&L.handler.detach(),L.handler=n}return!0}function o(e){if(!1!==L.enabled&&!1!==L.userRotate&&(!1!==L.enableActions.pan||0!==e.button)&&!(!1===L.enableActions.zoom&&1===e.button||!1===L.enableActions.rotate&&2===e.button)){if(e.preventDefault(),!U){var t=!1;0===e.button?t=n("pan"):1===e.button?t=n("zoom"):2===e.button&&(t=n("rotate")),t&&(U=!0,L.handler.onMouseDown(e.clientX,e.clientY))}var r=0===e.button?y.default.Events.Control.Mouse.MousePan:1===e.button?y.default.Events.Control.Mouse.MouseZoom:y.default.Events.Control.Mouse.MouseRotate;y.default.sendEvent(r,!0),document.addEventListener("mousemove",s,!1),document.addEventListener("mouseup",u,!1)}}function s(e){!1!==L.enabled&&(!1===L.enableActions.pan&&0===e.button||!1===L.enableActions.zoom&&1===e.button||!1===L.enableActions.rotate&&2===e.button||(e.preventDefault(),L.handler&&L.handler.onMouseMove(e.clientX,e.clientY)))}function u(e){!1!==L.enabled&&!1!==L.userRotate&&(!1===L.enableActions.pan&&0===e.button||!1===L.enableActions.zoom&&1===e.button||!1===L.enableActions.rotate&&2===e.button||(document.removeEventListener("mousemove",s,!1),document.removeEventListener("mouseup",u,!1),U=!1,L.handler&&L.handler.onMouseUp()))}function h(e){if(!1===L.enabled)return!1;if(!1===L.userZoom)return!0;if(!U&&!1!==L.enableActions.zoom){if(e.preventDefault(),F=!0,!0===n("zoom",{wheel:!0})){var t=40*-e.deltaY;L.handler.onMouseWheel(t)}y.default.sendEvent(y.default.Events.Control.Mouse.MouseScroll,!0),H&&clearTimeout(H),F&&(H=setTimeout(function(){F=!1},1e3))}}function f(e){}function m(e){L.animateZoomIn()}function g(e){L.dragStart(e.touchEvent.touches[0].pageX*window.devicePixelRatio,e.touchEvent.touches[0].pageY*window.devicePixelRatio)}function b(e){L.dragMove(e.touchEvent.touches[0].pageX*window.devicePixelRatio,e.touchEvent.touches[0].pageY*window.devicePixelRatio)}function w(e){L.dragEnd()}function x(e){L.transformStart(e.scale,e.rotation,e.deltaTime,e.center.pageX,e.center.pageY)}function M(e){L.transform(e.scale,e.rotation,e.deltaTime,e.center.pageX,e.center.pageY,e)}function E(e){L.transformEnd()}function A(e){L.transformStart(1,e.rotation,e.deltaTime,0,0)}function T(e){L.transform(1,e.rotation,e.deltaTime,0,0,e)}function k(e){L.transformEnd()}function S(e){L.transformStart(e.scale,0,e.deltaTime,0,0)}function C(e){L.transform(e.scale,0,e.deltaTime,0,0,e)}function P(e){L.transformEnd()}this.object=e,this.domElement=void 0!==t?t:document,this.picker=r,this.handler=null,this.plane=null,this.centerPan=new i.Vector3,this.maxPanDistance=2e3,this.minOrthoHeight=0,this.maxOrthoHeight=1/0,this.enabled=!0,this.enableActions={zoom:!0,rotate:!0,pan:!0},this.center=new i.Vector3,this.userZoom=!0,this.userZoomSpeed=1,this.userRotate=!0,this.userRotateSpeed=1,this.userPan=!0,this.userPanSpeed=2,this.autoRotateSpeed=.8,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minDistance=0,this.maxDistance=1/0,this.orthoCamera=!1,this.changeEventThreshold=.001,this.groundPlane=null,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40,ROTATE:65,ZOOM:83,PAN:68};var O={debug:!1};this.gestureRecognizer=new _.default(this.domElement,O),this.gestureRecognizer.addEventListener("tap",f,!1),this.gestureRecognizer.addEventListener("double-tap",m,!1),this.gestureRecognizer.addEventListener("drag-start",g,!1),this.gestureRecognizer.addEventListener("drag",b,!1),this.gestureRecognizer.addEventListener("drag-end",w,!1),this.gestureRecognizer.addEventListener("pinch-start",S,!1),this.gestureRecognizer.addEventListener("pinch",C,!1),this.gestureRecognizer.addEventListener("pinch-end",P,!1),this.gestureRecognizer.addEventListener("rotate-start",A,!1),this.gestureRecognizer.addEventListener("rotate",T,!1),this.gestureRecognizer.addEventListener("rotate-end",k,!1),this.gestureRecognizer.addEventListener("twofingersweep-start",x,!1),this.gestureRecognizer.addEventListener("twofingersweep",M,!1),this.gestureRecognizer.addEventListener("twofingersweep-end",E,!1);var R,L=this,I=new i.Vector3,B=!0,D=!1,j=null,z=0,N=0,U=!1,F=!1,H=null,V={type:"changed"},G={type:"changing"},W={type:"animating"};this.animateZoomIn=function(){!0===n("zoom")&&L.handler.animateZoomIn()},this.animateZoomOut=function(){!0===n("zoom")&&L.handler.animateZoomOut()},this.animateRotateLeft=function(){!0===n("rotate")&&L.handler.animateRotateLeft()},this.animateRotateRight=function(){!0===n("rotate")&&L.handler.animateRotateRight()},this.animateRotateUp=function(){!0===n("rotate")&&L.handler.animateRotateUp(B)},this.animateRotateToTop=function(e){!0===n("rotate")&&L.handler.animateRotateToTop(e)},this.animateRotateToBottom=function(){!0===n("rotate")&&L.handler.animateRotateToBottom()},this.animateRotateAngle=function(e,t,r){!0===n("rotate")&&L.handler.animateRotateAngle(e,t,r)},this.animateToPerspective=function(e,t){if("number"!=typeof e){if(!this.orthoCamera)return;var r=e,o=this.domElement.clientWidth/this.domElement.clientHeight,a=this.object.near,s=this.object.far,l=this.object.position,u=this.object.top,c=l.clone().sub(this.center),h=1/Math.tan(10*Math.PI/360)*u;r.camera=new i.PerspectiveCamera(10,o,a,s),r.camera.position.copy(this.center).add(c.normalize().multiplyScalar(h)),r.camera.lookAt(this.center),r.camera.updateProjectionMatrix(),this.object=r.camera,this.orthoCamera=!1,this.changeEventThreshold=.001,this.maxPolarAngle=R,r.picker.camera=r.camera;var d=this,f=function(){d.animateRotateUp()};this.animateToPerspective(u,f)}else{var p=e;B=!1,!0===n("ortho")&&L.handler.animateToPerspective(p,this.object.fov,t)}},this.animateToOrtho=function(e,t){if("number"!=typeof e&&void 0===t){if(this.orthoCamera)return;var r,o,a,s,l,u=e,c=this.object.near,h=this.object.far,d=this,f=function(){l=d.plane.distanceToPoint(d.object.position),r=Math.tan(d.object.fov*Math.PI/360)*l*2,o=r*d.object.aspect,a=d.object.position.clone(),s=d.object.rotation.clone();var e=function(){u.camera=new i.OrthographicCamera(-o/2,o/2,r/2,-r/2,c,h),u.camera.position.set(a.x,a.y,a.z),u.camera.rotation.copy(s),u.camera.lookAt(d.center),u.camera.updateProjectionMatrix(),d.object=u.camera,d.orthoCamera=!0,d.changeEventThreshold=1e-5,R=d.maxPolarAngle,d.maxPolarAngle=0,u.picker.camera=u.camera,u.camera.updateMatrix(),u.camera.updateMatrixWorld(),u.camera.matrixWorldInverse.getInverse(u.camera.matrixWorld)};d.animateToOrtho(r/2,e)};this.animateRotateToTop(f)}else{var p=e;!0===n("ortho")&&L.handler.animateToOrtho(p,this.object.fov,t)}},this.animatePanTo=function(e){var t=e.clone().sub(L.center),r=t.dot(L.plane.normal),i=e.clone().sub(L.plane.normal.clone().multiplyScalar(r));i.clone().sub(this.center).length()<L.changeEventThreshold||!0===n("pan")&&L.handler.animatePanTo(this.center,i)},this.animateFlyTo=function(e,t){var r=[];r.push({position:L.object.position.clone(),target:L.center.clone(),duration:1}),r.push({position:e.clone(),target:t.clone(),duration:1}),!0===n("switch",{cameras:r})&&(L.handler.loop=!1)},this.animateOrbit=function(){n("orbit")},this.animateViewpoint=function(e){e=e||[],!0===n("switch",{cameras:e})&&(L.handler.loop=!0)},this.dragStart=function(e,t){!1!==L.enabled&&!1!==L.userPan&&!1!==L.enableActions.pan&&(!0===n("pan")&&(D=!0,L.handler.onMouseDown(e,t)),y.default.sendEvent(y.default.Events.Control.Multitouch.OneFingerDrag,!0))},this.dragMove=function(e,t){!1!==L.enabled&&!1!==L.userPan&&D&&L.handler.onMouseMove(e,t)},this.dragEnd=function(){!1!==L.enabled&&!1!==L.userPan&&D&&(D=!1,L.handler.onMouseUp())},this.transformStart=function(e,t,r,n,i){!1!==L.enabled&&(z=t,N=i,j=null,y.default.sendEvent(y.default.Events.Control.Multitouch.TwoFingersTransform,!0))},this.transformEnd=function(){!1!==L.enabled&&(L.handler&&("tilt"===j?L.handler.onMouseUp():L.handler.transformEnd()),j=null)},this.transform=function(e,t,r,i,o,a){if(!1!==L.enabled)if(j)"tilt"===j?L.handler.onMouseMove(0,o):L.handler.transform(e,t);else{var s=100*(Math.abs(e-1)-.08),l=Math.abs(t-z)-1,u=.5*(Math.abs(o-N)-1);a.deltaX*a.deltaY<0&&(u=0),s>0&&s>l&&s>u&&!0===L.enableActions.zoom?!0===n("zoom")&&(L.handler.transformStart(),j="pinch"):l>0&&l>u?!0===n("rotate")&&(L.handler.transformStart(e,t),j="rotate"):u>0&&!0===n("rotate")&&(L.handler.onMouseDown(0,o),j="tilt")}},this.changed=function(){L.dispatchEvent(V)},this.update=function(){if(this.handler){var e;if("switch"===this.handler.type)return e={},this.handler.update(e),e.position&&(e.quaternion||e.center)&&(this.object.position.copy(e.position),e.quaternion?this.object.quaternion.copy(e.quaternion):(this.center.copy(e.center),this.object.lookAt(this.center)),this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.updateProjectionMatrix()),void(!0===e.refresh?this.dispatchEvent(V):this.dispatchEvent(W));var t=this.object.position,r=t.clone().sub(this.center),n=Math.atan2(r.x,r.z),o=Math.atan2(Math.sqrt(r.x*r.x+r.z*r.z),r.y),a=r.length();e={scale:1,panVector:new i.Vector3,thetaDelta:0,phiDelta:0,fov:this.object.fov};var s={radius:this.orthoCamera?this.object.right:a},l=L.handler.needRefresh;this.handler.update(e,s),a*=e.scale,n+=e.thetaDelta,o+=e.phiDelta,this.object.fov=e.fov;var u=e.scale;L.orthoCamera&&(Math.abs(this.object.top*u)>this.minOrthoHeight&&Math.abs(this.object.top*u)<this.maxOrthoHeight?(this.object.left*=u,this.object.right*=u,this.object.top*=u,this.object.bottom*=u):this.handler&&this.handler.onLimit("radius")),o>=this.maxPolarAngle-Math.PI/1800&&(B=!0),o<=this.minPolarAngle+Math.PI/1800&&(B=!1),o=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,o)),o=Math.max(1e-6,Math.min(Math.PI-1e-6,o)),this.center.clone().add(e.panVector).sub(this.centerPan).length()>this.maxPanDistance&&e.panVector.multiplyScalar(0);var c=this.minDistance,h=this.maxDistance;if(L.groundPlane){var d=new i.Ray(t.clone(),r.clone().normalize().negate()),f=d.intersectPlane(L.groundPlane);if(f){var p=t.clone().sub(f),m=p.length()-r.length();c-=Math.max(m,0),h-=Math.max(m,0)}}a=Math.max(c,Math.min(h,a)),(a<=c||a>=h)&&this.handler&&this.handler.onLimit("radius"),r.x=a*Math.sin(o)*Math.sin(n),r.y=a*Math.cos(o),r.z=a*Math.sin(o)*Math.cos(n),this.center.add(e.panVector),t.copy(this.center).add(r),this.object.lookAt(this.center),I.distanceTo(this.object.position)>L.changeEventThreshold&&(!0===e.refresh?this.dispatchEvent(V):!0===l?this.dispatchEvent(W):this.dispatchEvent(G),I.copy(this.object.position)),this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.updateProjectionMatrix(),e.callback&&e.callback()}},this.getRadius=function(){return L.orthoCamera?L.object.right:L.object.position.clone().sub(L.center).length()},this.getPhi=function(){var e=this.object.position.clone().sub(this.center);return Math.atan2(Math.sqrt(e.x*e.x+e.z*e.z),e.y)},this.getUserScrolled=function(){return F},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",o,!1),function(e,t,r){var n="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"MozMousePixelScroll";e.addEventListener(n,"wheel"===n?t:function(e){!e&&(e=window.event);var r={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"===e.type?0:1,deltaX:0,deltaY:0,deltaZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};"mousewheel"===n?(r.deltaY=-.025*e.wheelDelta,e.wheelDeltaX&&(r.deltaX=-.025*e.wheelDeltaX)):r.deltaY=e.detail,t(r)},!1)}(this.domElement,h)};w.prototype=Object.create(i.EventDispatcher.prototype),w.prototype.constructor=w,t.default=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(6),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(e){o.default.call(this,e),this.type="orbit",this.priority=100,this.needRefresh=!0;var t=new n.Clock,r=t.getElapsedTime();this.update=function(e){var n=t.getElapsedTime();e.thetaDelta=2*Math.PI/60/60*.4,Math.abs(r-n)>4&&(e.refresh=!0,r=n)}};a.prototype.constructor=a,a.prototype=Object.create(o.default.prototype),t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(6),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(e){o.default.call(this,e),this.type="ortho",this.priority=2e3,this.interruptible=!1;var t,r,i,a,s,l,u,c,h=new n.Clock,d=this;this.animateToOrtho=function(n,i,o){s=10,a=i,l=n,u=e.maxDistance,e.maxDistance=1/0,t=h.getElapsedTime(),r=t+.5,c=o},this.animateToPerspective=function(n,i,o){s=30,a=i,l=n,u=e.maxDistance,e.maxDistance=1/0,t=h.getElapsedTime(),r=t+.5,c=o},this.update=function(n,o){i=h.getElapsedTime();var f=o.radius;if(Math.abs(n.fov-s)<.05)n.callback=c,c=null,e.maxDistance=u,d.detach();else{var p=d.easing.Quadratic.Out((i-t)/(r-t));p=i>r?1:p,n.fov=a+p*(s-a);var m=1/Math.tan(n.fov*Math.PI/360)*l;n.scale=m/f,Math.abs(n.fov-s)<.05&&(n.callback=c,c=null,e.maxDistance=u,d.detach())}},this.detach=function(){null!=u&&(e.maxDistance=u,u=null),o.default.prototype.detach.call(this)}};a.prototype.constructor=a,a.prototype=Object.create(o.default.prototype),t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(6),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(e){function t(e,t,r){var i=v.controls.plane,o=v.controls.picker;if(null!=i){var a=o.getRay(e.x,e.y).direction,s=a.angleTo(i.normal),l=s-.5*Math.PI,u=15/180*Math.PI;if(Math.abs(l)<u){var c=v.controls.object.position.clone().sub(v.controls.center).normalize(),h=i.normal,d=h.clone().cross(c),f=l<=0?-(l+u):u-l,p=(new n.Matrix4).makeRotationAxis(d,f);i=i.clone().applyMatrix4(p)}var m=o.sceneGraphRoot;o.sceneGraphRoot=i;var g=o.pickPoint(e.x,e.y),y=o.pickPoint(t.x,t.y);if(o.sceneGraphRoot=m,null==g||null==y){var b=o.getRay(e.x,e.y).clone();if(b.direction.negate(),y=b.intersectPlane(i),b=o.getRay(t.x,t.y).clone(),b.direction.negate(),null==(g=b.intersectPlane(i))||null==y)return}var _=(new n.Vector3).subVectors(g,y);r.panVector=_}}o.default.call(this,e),this.type="pan",this.priority=900;var r,i,a,s=new n.Clock,l=!1,u=!1,c=new n.Vector2,h=new n.Vector2,d=new n.Vector2,f=new n.Vector2,p=new n.Vector3,m=new n.Vector3,v=this;this.animatePanTo=function(e,t){u=!0,p.copy(e),m.copy(t),a=r=s.getElapsedTime(),i=r+1},this.update=function(e){a=s.getElapsedTime();var n;if(u){var o=m.clone().sub(p);if(a>i)e.panVector=o,v.detach();else{n=v.easing.Quadratic.InOut((a-r)/(i-r)),n=a>i?1:n;var g=o.multiplyScalar(n);p.add(g),e.panVector=g}}else{n=(a-r)/(i-r)*4,n=1-Math.pow(2,-n);var y=h.clone();h=c.clone().add(d.clone().sub(c).multiplyScalar(n)),f.subVectors(h,y),l&&f.length()<.5?(l=!1,v.detach()):t(y,h,e)}},this.onMouseDown=function(e,t){u&&(u=!1),l=!1,c.set(e,t),d.set(e,t),h.set(e,t),a=r=s.getElapsedTime(),i=r+.05,v.adjustPlane(e,t),v.adjustCenter()},this.onMouseMove=function(e,t){u||(c.copy(h),d.set(e,t),a=r=s.getElapsedTime(),i=r+.05)},this.onMouseUp=function(){if(!u){f=d.clone().sub(h);var e=f.length();e>=1?(l=!0,e>3&&(d=h.clone().add(f.multiplyScalar(3)),r=s.getElapsedTime(),i=r+.2,c.set(h.x,h.y))):v.detach()}}};a.prototype.constructor=a,a.prototype=Object.create(o.default.prototype),t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e,t){var r=this;e.rotation.set(0,0,0),e.updateMatrix();var i=new n.Object3D;i.add(e);var o=new n.Object3D;o.position.y=10,o.add(i);var a=new n.Object3D;a.add(o);var s=Math.PI/2,l=t.onMove,u=function(e){if(!1!==r.enabled){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,n=e.movementY||e.mozMovementY||e.webkitMovementY||0;o.rotation.y-=.002*t,i.rotation.x-=.002*n,i.rotation.x=Math.max(-s,Math.min(s,i.rotation.x)),l&&l()}};this.dispose=function(){document.removeEventListener("mousemove",u,!1)},document.addEventListener("mousemove",u,!1),this.enabled=!1,this.getObject=function(){return a},this.initRotation=function(e){o.rotation.y=e.y,i.rotation.x=e.x},this.getDirection=function(e){var t=e.clone(),r=new n.Euler(0,0,0,"YXZ");return r.set(i.rotation.x,o.rotation.y,0),t.applyEuler(r),t}};i.prototype.constructor=i,t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(6),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(e){function t(e,t){void 0===e&&(e=i()),t.thetaDelta-=e}function r(e,t){void 0===e&&(e=i()),t.phiDelta-=e}function i(){return 2*Math.PI/60/60*e.autoRotateSpeed}o.default.call(this,e),this.type="rotate",this.priority=900;var a,s,l,u,c=new n.Clock,h=!1,d=!1,f=!1,p=new n.Vector2,m=new n.Vector2,v=new n.Vector2,g=new n.Vector2,y=new n.Vector2,b=new n.Vector2,_=0,w=0,x=0,M=this;this.animateRotateLeft=function(){d=!0,y.set(0,0),b.set(Math.PI/3,0),l=a=c.getElapsedTime(),s=a+1,M.adjustCenter()},this.animateRotateRight=function(){d=!0,y.set(0,0),b.set(-Math.PI/3,0),l=a=c.getElapsedTime(),s=a+1,M.adjustCenter()},this.animateRotateUp=function(e){d=!0,y.set(0,0),M.adjustCenter(),l=a=c.getElapsedTime(),s=a+1,e?b.set(0,Math.PI/9):b.set(0,-Math.PI/9)},this.animateRotateToTop=function(t){t&&(this.interruptible=!1),d=!0,y.set(0,0),b.set(0,e.getPhi()),l=a=c.getElapsedTime(),s=a+1,u=t},this.animateRotateAngle=function(e,t,r){e&&(this.interruptible=!1),d=!0,y.set(0,0),b.set(t,r),l=a=c.getElapsedTime(),s=a+1,u=e},this.animateRotateToBottom=function(){d=!0;var t=e.getPhi(),r=e.maxPolarAngle;t>r&&(e.maxPolarAngle=Math.PI,u=function(){e.maxPolarAngle=r}),y.set(0,0),b.set(0,t-r),l=a=c.getElapsedTime(),s=a+1},this.update=function(n){l=c.getElapsedTime();var i;if(d)if(Math.abs(b.x-y.x)<Math.PI/180&&Math.abs(y.y-b.y)<Math.PI/180)u&&(n.callback=u,u=null,this.interruptible=!0),M.detach();else{i=M.easing.Quadratic.InOut((l-a)/(s-a)),i=l>s?1:i;var o=b.clone().sub(y).multiplyScalar(i);t(o.x,n),r(o.y,n),y.add(o)}else if(f){h&&Math.abs(x-w)<.01&&M.detach(),i=(l-a)/(s-a)*4,i=1-Math.pow(2,-i);var E=w;w=_+i*(x-_),t(Math.PI*(E-w)/180,n)}else{i=(l-a)/(s-a)*4,i=1-Math.pow(2,-i);var A=m.clone();m=p.clone().add(v.clone().sub(p).multiplyScalar(i)),g.subVectors(m,A),h&&g.length()<.5?M.detach():(t(2*Math.PI*g.x/1800*e.userRotateSpeed,n),r(2*Math.PI*g.y/1800*e.userRotateSpeed,n))}},this.onMouseDown=function(e,t){d&&(d=!1),f=!1,h=!1,p.set(e,t),v.set(e,t),m.set(e,t),l=a=c.getElapsedTime(),s=a+.05,M.adjustCenter()},this.onMouseMove=function(e,t){d||(p.copy(m),v.set(e,t),l=a=c.getElapsedTime(),s=a+.05)},this.onMouseUp=function(){d||(g=v.clone().sub(m),g.length()>=1?(h=!0,v=m.clone().add(g.multiplyScalar(3)),a=c.getElapsedTime(),s=a+.2,p.set(m.x,m.y)):M.detach())},this.transformStart=function(e,t){f=!0,h=!1,_=t,x=t,w=t,a=c.getElapsedTime(),s=a+.05,M.adjustCenter()},this.transform=function(e,t){for(_=w,x=t;_>180;)_-=360;for(;_<-180;)_+=360;for(;x-_>180;)x-=360;for(;x-_<-180;)x+=360;a=c.getElapsedTime(),s=a+.05},this.transformEnd=function(){var e=Math.abs(x-w);if(e>.01){for(h=!0,_=w,e>2&&(x+=2*(x-w));x-_>180;)x-=360;for(;x-_<-180;)x+=360;a=c.getElapsedTime(),s=a+.2}else M.detach()}};a.prototype.constructor=a,a.prototype=Object.create(o.default.prototype),t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(6),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(e,t){function r(){E.adjustCenter(),x=e.getRadius(),b=.001*x}function i(e){void 0===e&&(e=s()),_/=e,x*=_}function a(e){void 0===e&&(e=s()),_*=e,x*=_}function s(){return Math.pow(.95,e.userZoomSpeed)}o.default.call(this,e),this.type="zoom",this.priority=900;var l,u,c,h=new n.Clock,d=!1,f=!1,p=!1,m=new n.Vector2,v=new n.Vector2,g=new n.Vector2,y=new n.Vector2,b=1,_=1,w=0,x=0,M=0,E=this;!function(){t=t||{},f=!0===t.wheel,r()}(),this.animateZoomIn=function(){p=!0,d=!0,x=.75*e.getRadius(),w=e.getRadius(),c=l=h.getElapsedTime(),u=l+.2},this.animateZoomOut=function(){p=!0,d=!0,x=1.5*e.getRadius(),w=e.getRadius(),c=l=h.getElapsedTime(),u=l+.2},this.update=function(e,t){var r=t.radius;c=h.getElapsedTime();var n=(c-l)/(u-l)*4;n=1-Math.pow(2,-n),f&&c>u&&(d=!0),Math.abs(r*_-x)<b&&d?E.detach():e.scale=(w+n*(x-w))/r,_=1},this.onMouseDown=function(t,n){p&&(p=!1),m.set(t,n),g.set(t,n),v.set(t,n),r(),w=e.getRadius(),c=l=h.getElapsedTime(),u=l+.1,d=!1},this.onMouseMove=function(t,r){p||(m.copy(v),g.set(t,r),y.subVectors(g,m),w=e.getRadius(),y.y>0?i():a(),c=l=h.getElapsedTime(),u=l+.1)},this.onMouseUp=function(){p||(w=e.getRadius(),l=h.getElapsedTime(),u=l+.3,d=!0)},this.onMouseWheel=function(t){if(p&&(p=!1),!((c=h.getElapsedTime())-l<.04)){l=h.getElapsedTime(),u=l+.5,w=e.getRadius();var r;if(t>0){for(t=Math.max(t,10),r=.95;t/10>=1;)r*=.95,t/=10;a(r)}else{for(t=Math.max(-t,10),r=.95;t/10>=1;)r*=.95,t/=10;i(r)}d=!1}},this.transformStart=function(){r(),M=x,w=x,l=h.getElapsedTime(),u=l+.1,d=!1},this.transform=function(t){var r=t;w=e.getRadius(),x=M/r,l=h.getElapsedTime(),u=l+.1},this.transformEnd=function(){w=e.getRadius(),l=h.getElapsedTime(),u=l+.3,d=!0},this.onLimit=function(e){"radius"===e&&E.detach()}};a.prototype.constructor=a,a.prototype=Object.create(o.default.prototype),t.default=a},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),s=r(21),l=n(s),u=r(104),c=n(u),h=function(){function e(t,r,n){i(this,e),this.data=[],this.trash=[];for(var o=0;o<t.length;o++)this.data.push({path:t[o],type:r[o],tree_options:n[o],info:null,tree:null,sceneGraphRoot:null})}return o(e,[{key:"loadInfo",value:function(e,t,r){var n=this,i=0;this.data.map(function(o){o.info=new c.default(o.path,e.isMobile,e.versionControl),o.info.load(o.path,function(e){i+=1;var r=new a.Object3D;r.applyMatrix(e.transformation.getOnloadMatrix()),r.updateMatrixWorld(),o.sceneGraphRoot=r,i===n.data.length&&t()},r)})}},{key:"constructSmartTrees",value:function(e,t,r,n){this.data.map(function(i){var o=i.info,s=i.path,u=i.type,c=i.tree_options||{};c.display_lod=r.debugMode,c.bbox=r.bbox,c.quality=r.quality,c.onError=r.errorFunction,c.MAX_CACHE_SIZE=o.lru_size,c.maxAnisotropy=t.getMaxAnisotropy(),c.viewModeType=r.viewModeType,c.viewMode=r.viewMode,c.PID=n,c.dataPath=r.dataPath,c.editMask=r.editMask,c.side=r.waterMode?a.DoubleSide:a.FrontSide,c.eventHandlers=r.eventHandlers,c.HOST=r.HOST,c.altizureApi=r.altizureApi;var h=i.sceneGraphRoot;e.add(h),h.name=s,i.tree=new l.default(u,h,s,o,c)})}},{key:"removeTree",value:function(e){var t=null;this.data.map(function(r,n){if(r.type===e){var i=r.sceneGraphRoot;i&&i.parent&&i.parent.remove(i),t=n}}),null!=t&&(this.trash.push(this.data[t]),this.data.splice(t,1))}},{key:"restoreTree",value:function(e,t){var r=null;this.trash.map(function(n,i){if(n.type===e){var o=n.sceneGraphRoot;o&&t.add(o),r=i}}),null!=r&&(this.data.push(this.trash[r]),this.trash.splice(r,1))}},{key:"getDataByType",value:function(e){if(!e)return this.data[0];var t=null;return this.data.map(function(r){r.type===e&&(t=r)}),t}},{key:"getTreeByType",value:function(e){var t=this.getDataByType(e);return t?t.tree:null}},{key:"getInfoByType",value:function(e){var t=this.getDataByType(e);return t?t.info:null}},{key:"getSceneGraphRootByType",value:function(e){var t=this.getDataByType(e);return t?t.sceneGraphRoot:null}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(11),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=r(25),c=r(0),h=function(e){function t(e){n(this,t);var r=e.earthSceneNode,o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r));o._camera=e.camera;var a=e.scale,s=new c.SphereBufferGeometry(1.00505*a,512,512);return o.material=new u.AtmosphereSelfShaderMaterial,o.mesh=new c.Mesh(s,o.material),o.mesh.name="Atmosphere mesh",o.sceneNode.name="Atmosphere Class",o.sceneNode.add(o.mesh),o.height=0,o}return o(t,e),a(t,[{key:"destruct",value:function(){this.mesh.geometry.dispose(),this.mesh.material.map&&this.mesh.material.map.dispose(),this.mesh.material.dispose(),this.mesh=null}},{key:"animate",value:function(e){var t=new c.Vector3;t.setFromMatrixPosition(this.matrixWorld),this.material.setCenter(t.clone())}},{key:"_XYZ",value:function(){function e(e,r,n,i){var o,a=new c.Geometry;return o=i?new c.LineDashedMaterial({linewidth:1,color:n,dashSize:t/1e3,gapSize:t/300}):new c.LineBasicMaterial({linewidth:1,color:n}),a.vertices.push(e.clone()),a.vertices.push(r.clone()),a.computeLineDistances(),new c.LineSegments(a,o)}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001;return function(t){var r=new c.Object3D;return r.add(e(new c.Vector3(0,0,0),new c.Vector3(t,0,0),16711680,!1)),r.add(e(new c.Vector3(0,0,0),new c.Vector3(-t,0,0),16711680,!0)),r.add(e(new c.Vector3(0,0,0),new c.Vector3(0,t,0),65280,!1)),r.add(e(new c.Vector3(0,0,0),new c.Vector3(0,-t,0),65280,!0)),r.add(e(new c.Vector3(0,0,0),new c.Vector3(0,0,t),255,!1)),r.add(e(new c.Vector3(0,0,0),new c.Vector3(0,0,-t),255,!0)),r}(t)}},{key:"updateMatrixWorld",value:function(e){if(!0!==this.matrixWorldNeedsUpdate&&!0!==e||(null===this.parent?this._matrixWorld.copy(this._matrix):this._matrixWorld.multiplyMatrices(this.parent.matrixWorld,this._matrix),this.matrixWorldNeedsUpdate=!1,e=!0),e){var t=this.matrixWorld.elements;this.sceneNode.matrix.set(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],1)}}}]),t}(l.default);t.default=h},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(3),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(){n(this,e)}return i(e,null,[{key:"getBlueMarbleCNImageUrl",value:function(e,t,r){return"https://cdn-china.altizure.cn/bluemarble/wtb200401/"+e+"/"+t+"/"+r+".jpg"}},{key:"getBlueMarbleImageUrl",value:function(e,t,r){return"https://cdn-inter.altizure.com/bluemarble/wtb200401/"+e+"/"+t+"/"+r+".jpg"}},{key:"getOSMImageUrl",value:function(e,t,r){return"http://"+["a","b","c"][(e+r+t)%3]+".tile.openstreetmap.org/"+e+"/"+t+"/"+r+".png"}},{key:"getBingImageUrl",value:function(e,t,r){var n,i=t,o=r,s=a.default.numerationSystemFrom10(2,i),l=a.default.numerationSystemFrom10(2,o),u=s.length-l.length;if(u>0)for(n=0;n<u;n++)l="0"+l;else if(u<0)for(u=-u,n=0;n<u;n++)s="0"+s;var c="";for(n=0;n<l.length;n++)c+=l[n]+s[n];var h=a.default.numerationSystemChange(2,4,c);if(h.length<e)for(u=e-h.length,n=0;n<u;n++)h="0"+h;return"//ecn.t"+(e+r+t)%8+".tiles.virtualearth.net/tiles/h"+h+".jpeg?g=1239&mkt=en-us"}},{key:"getCartoImageUrl",value:function(e,t,r){return"//cartodb-basemaps-c.global.ssl.fastly.net/light_all/"+e+"/"+t+"/"+r+".png"}},{key:"getGoogleCNImageUrl",value:function(e,t,r){return"http://mt"+["0","1","2","3"][(e+r+t)%4]+".google.cn/vt/lyrs=s&x="+t+"&y="+r+"&z="+e}},{key:"getGoogleImageUrl",value:function(e,t,r){return"https://mts"+["1","2","3","0"][(e+r+t)%4]+".google.com/vt/lyrs=s&x="+t+"&y="+r+"&z="+e}},{key:"getGaodeImageUrl",value:function(e,t,r){return"https://wprd0"+["1","2","3","4"][(e+r+t)%4]+".is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=6&x="+t+"&y="+r+"&z="+e}},{key:"getTencentImageUrl",value:function(e,t,r){var n=e+r+t,i=n%4,o=["0","1","2","3"][i],a=t,s=Math.pow(2,e)-1-r;return"http://p"+o+".map.gtimg.com/sateTiles/"+e+"/"+Math.floor(a/16)+"/"+Math.floor(s/16)+"/"+a+"_"+s+".jpg?version=117"}},{key:"getOpenCycleImageUrl",value:function(e,t,r){return"https://"+["a","b","c"][(e+r+t)%3]+".tile.opencyclemap.org/cycle/"+e+"/"+t+"/"+r+".png"}},{key:"getGoogleMoonImageUrl",value:function(e,t,r){return r=Math.pow(2,e)-1-r,"https://crossorigin.me/http://mw"+["1","2"][(e+r+t)%2]+".google.com/mw-planetary/lunar/lunarmaps_v1/clem_bw/"+e+"/"+t+"/"+r+".jpg"}},{key:"getHiriseMarsVisibleImageUrl",value:function(e,t,r){return r=Math.pow(2,e)-1-r,"https://crossorigin.me/http://gmaps-bkup.uahirise.org/mars/visible/"+e+"/"+t+"/"+r+".jpg"}},{key:"getNasaMarsTrekImageUrl",value:function(e,t,r){return"https://trektiles.jpl.nasa.gov/trektiles/Mars/EQ/Mars_Viking_MDIM21_ClrMosaic_global_232m/1.0.0//default/default028mm/"+e+"/"+r+"/"+t+".png"}},{key:"getNasaMoonTrekImageUrl",value:function(e,t,r){return"https://moontrek.jpl.nasa.gov/trektiles/Moon/EQ/LRO_WAC_Mosaic_Global_303ppd_v02/1.0.0//default/default028mm/"+e+"/"+r+"/"+t+".jpg"}},{key:"getEsriLunarImageUrl",value:function(e,t,r){return"https://crossorigin.me/https://webgis2.wr.usgs.gov/Lunar_Global_GIS/ESRI.ArcGIS.ADF.Web.DataSources.ArcGISServer.TileHandler.ashx?tile=c2d7c76d558f4dfb8ffde861c9229b2e&level="+e+"&column="+t+"&row="+r}}]),e}();t.default=s},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=r(7),a=n(o),s=r(13),l=n(s),u=r(3),c=n(u),h=r(44),d=n(h),f=r(51),p=n(f),m=function(e,t,r){function n(e){for(var t=e.phi;t<0;)t+=2*Math.PI;for(;t>Math.PI;)t-=2*Math.PI;for(t>Math.PI&&(e.phi=2*Math.PI-t,e.theta=e.theta-Math.PI),t=e.theta;t<-Math.PI;)t+=2*Math.PI;for(;t>Math.PI;)t-=2*Math.PI;return e.theta=t,e}function o(e,t){var r=new i.Vector3,n=new i.Vector3,o=new i.Vector3;return t||(t=new i.Vector3(0,1,0)),n.copy(e).normalize(),0===n.lengthSq()&&(n.z=1),r.crossVectors(t,n).normalize(),0===r.lengthSq()&&(n.z+=1e-4,r.crossVectors(t,n).normalize()),o.crossVectors(r,n),{x:r,y:n,z:o}}function s(e,t){var r=c.default.sphericalToGeographic(e.phi,e.theta);return c.default.geographicToEarthSurface(l.default.EarthResolution,r[0],r[1],t)}function u(e){var t=e.theta-Se.theta;t<-Math.PI?t=2*Math.PI+t:t>Math.PI&&(t-=2*Math.PI);var r=e.phi-Se.phi;Se.theta+=t*Q.dampingFactor*se,Se.theta<-Math.PI?Se.theta=2*Math.PI+Se.theta:Se.theta>Math.PI&&(Se.theta=Se.theta-2*Math.PI),Se.phi+=r*Q.dampingFactor*se,Math.abs(t)*Q.dampingFactor<1e-4&&Math.abs(r)*Q.dampingFactor<1e-4&&(ie=null,Q.dispatchEvent(te))}function h(e){if(Q.enableDoubleTap){var t={x:0,y:0};void 0!==e.touchEvent?(t.x=e.touchEvent.touches[0].pageX,t.y=e.touchEvent.touches[0].pageY):(t.x=e.clientX,t.y=e.clientY);var r=Q.pickEarthContactPoint(t),n=Q.cameraGeoPosition(),i=.2*n.altitude;Q.flyToGeoPosition(r.lng,r.lat,i),p.default.sendEvent(p.default.Events.Control.Multitouch.OneFingerDoubleTap)}}function f(e){var t=e.touchEvent;q(!0),L(t.touches[0].pageX,t.touches[0].pageY),p.default.sendEvent(p.default.Events.Control.Multitouch.OneFingerDrag)}function m(e){var t=e.touchEvent;U({clientX:t.touches[0].pageX,clientY:t.touches[0].pageY})}function v(e){q(!1)}function g(e){Te.set(e.touchEvent.touches[0].pageX,e.touchEvent.touches[0].pageY),p.default.sendEvent(p.default.Events.Control.Multitouch.OneFingerDoubleTapDrag)}function y(e){e.touchEvent.touches[0].pageY-Te.y>0?Q.dolly(.99):e.touchEvent.touches[0].pageY-Te.y<0&&Q.dolly(1.01),Te.set(e.touchEvent.touches[0].pageX,e.touchEvent.touches[0].pageY)}function b(e){}function _(e){var t={};t.touches=e.touchEvent.touches,t.center=e.center,X(t,{rotate:!1,zoom:!1,tilt:!0}),p.default.sendEvent(p.default.Events.Control.Multitouch.TwoFingersSweep)}function w(e){var t={};t.touches=e.touchEvent.touches,t.center=e.center,Y(t,!1,{rotate:!1,zoom:!1,tilt:!0})}function x(e){}function M(e){var t={};t.touches=e.touchEvent.touches,t.center=e.center,X(t,{rotate:!1,zoom:!0,tilt:!1,pan:!0}),p.default.sendEvent(p.default.Events.Control.Multitouch.TwoFingersPinch)}function E(e){var t={};t.touches=e.touchEvent.touches,t.center=e.center,Y(t,!1,{rotate:!1,zoom:!0,tilt:!1,pan:!0})}function A(e){}function T(e){var t={};t.touches=e.touchEvent.touches,t.center=e.center,X(t,{rotate:!0,zoom:!1,tilt:!0}),p.default.sendEvent(p.default.Events.Control.Multitouch.TwoFingersRotate)}function k(e){var t={};t.touches=e.touchEvent.touches,t.center=e.center,Y(t,!1,{rotate:!0,zoom:!1,tilt:!0})}function S(e){}function C(e){if(!1!==Q.enabled){e.preventDefault();var t=null;if(e.button===Q.mouseButtons.ORBIT){if(!1===Q.enableRotate)return;j(e),ne=re.ROTATE,t=p.default.Events.Control.Mouse.MousePan}else if(e.button===Q.mouseButtons.ZOOM){if(!1===Q.enableZoom)return;z(e),ne=re.DOLLY,t=p.default.Events.Control.Mouse.MouseZoom}else if(e.button===Q.mouseButtons.LOCALROTATE){if(!1===Q.enableLocalRotate)return;N(e),ne=re.LOCAL_ROTATE,t=p.default.Events.Control.Mouse.MouseRotate}ne!==re.NONE&&(Q.domElement.addEventListener("mousemove",P,!1),Q.domElement.addEventListener("mouseup",O,!1),Q.domElement.addEventListener("mouseout",O,!1),Q.dispatchEvent($),t&&p.default.sendEvent(t))}}function P(e){if(!1!==Q.enabled)if(e.preventDefault(),ne===re.ROTATE){if(!1===Q.enableRotate)return;U(e)}else if(ne===re.DOLLY){if(!1===Q.enableZoom)return;F(e)}else if(ne===re.LOCAL_ROTATE){if(!1===Q.enableLocalRotate)return;H(e)}}function O(e){!1!==Q.enabled&&(V(e),Q.domElement.removeEventListener("mousemove",P,!1),Q.domElement.removeEventListener("mouseup",O,!1),Q.domElement.removeEventListener("mouseout",O,!1),Q.dispatchEvent(ee),ne=re.NONE)}function R(e){!1===Q.enabled||!1===Q.enableZoom||ne!==re.NONE&&ne!==re.ROTATE||(e.preventDefault(),e.stopPropagation(),G(e),Q.dispatchEvent($),Q.dispatchEvent(ee),p.default.sendEvent(p.default.Events.Control.Mouse.MouseScroll))}function L(e,t){de.set(e,t)}function I(e,t,r){fe.set(e,t),pe.subVectors(fe,de);var n=Q.domElement===document?Q.domElement.body:Q.domElement,i=n.clientHeight,o=Math.tan(.5*Q.object.fov)*(le.radius-Q.earthInfo.radius)*2;o>2*Q.earthInfo.radius&&(i=n.clientHeight*(2*Q.earthInfo.radius/o)),0!==Math.abs(ue.theta)&&(ue.theta*=.1),B(Math.PI*pe.x/i*Q.rotateSpeed),0!==Math.abs(ue.phi)&&(ue.phi*=.1),D(Math.PI*pe.y/i*Q.rotateSpeed),de.copy(fe),r&&Q.update()}function B(e){ue.theta-=e}function D(e){ue.phi-=e}function j(e){q(!0),L(e.clientX,e.clientY),U(e)}function z(e){me.set(e.clientX,e.clientY)}function N(e){q(!0),we.set(e.clientX,e.clientY),H(e,!0)}function U(e){I(e.clientX,e.clientY,!0);var t=e.clientX-_e.left,n=e.clientY-_e.top;t=t/r.threeContainer.clientWidth*2-1,n=-n/r.threeContainer.clientHeight*2+1,K(t,n)}function F(e){ve.set(e.clientX,e.clientY),ge.subVectors(ve,me),ge.y>0?Q.dollyIn(W()):ge.y<0&&Q.dollyOut(W()),me.copy(ve),Q.update()}function H(e,t){var n=e.clientX-_e.left,i=e.clientY-_e.top;if(n=n/r.threeContainer.clientWidth*2-1,i=-i/r.threeContainer.clientHeight*2+1,t)return K(n,i);K(n,i),xe.set(e.clientX,e.clientY),Me.subVectors(xe,we);var o=Q.domElement===document?Q.domElement.body:Q.domElement,a=2*Math.PI*Me.x/o.clientWidth*.3;Ce.theta=-a;var s=2*Math.PI*Me.y/o.clientHeight*.3;Ce.phi=-s,we.copy(xe),Q.update()}function V(e){q(!1)}function G(e){var t=!1;null===Q.lastMouseWheelEventTime?t=!0:e.timeStamp-Q.lastMouseWheelEventTime>Q.mouseWheelUpdateInternalMs&&(t=!0);var r=0;void 0!==e.wheelDelta?r=e.wheelDelta:void 0!==e.detail&&(r=-e.detail),t&&(r>0?Q.dollyOut(W()):r<0&&Q.dollyIn(W()),Q.lastMouseWheelEventTime=e.timeStamp,Q.update())}function W(){return ne===re.TOUCH_DOLLY?.98:.95}function X(e,t){t=t||{},t.rotate=void 0===t.rotate||t.rotate,t.zoom=void 0===t.zoom||t.zoom,t.tilt=void 0===t.tilt||t.tilt,t.pan=void 0!==t.pan&&t.pan,L(e.center.pageX,e.center.pageY);var r=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(r*r+n*n);me.set(0,i),Ee[0].set(e.touches[0].pageX,e.touches[0].pageY),Ee[1].set(e.touches[1].pageX,e.touches[1].pageY),Y(e,!0,t)}function Y(e,t,r){r=r||{},r.rotate=void 0===r.rotate||r.rotate,r.zoom=void 0===r.zoom||r.zoom,r.tilt=void 0===r.tilt||r.tilt,r.pan=void 0!==r.pan&&r.pan;var n=Q.domElement===document?Q.domElement.body:Q.domElement;r.pan&&I(e.center.pageX,e.center.pageY,!1);var o=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);if(t);else{Ae[0].set(e.touches[0].pageX,e.touches[0].pageY),Ae[1].set(e.touches[1].pageX,e.touches[1].pageY);var s=new i.Vector2(o,a),l=new i.Vector2;l.addVectors(Ee[0],Ee[1]),l.multiplyScalar(.5);var u=new i.Vector2;u.subVectors(s,l);var c=new i.Vector3;c.set(Ae[1].x-Ae[0].x,Ae[1].y-Ae[0].y,0),c.normalize();var h=new i.Vector3;h.set(Ee[1].x-Ee[0].x,Ee[1].y-Ee[0].y,0),h.normalize();var d=new i.Vector3;d.crossVectors(h,c);var f=h.dot(c),p=.8*Math.atan2(d.z,f),m=2*Math.PI*u.y/n.clientHeight*.2;Math.abs(p)>Math.abs(m)?r.rotate&&(0!==Math.abs(Ce.theta)&&(Ce.theta*=.1),Ce.theta+=p):r.tilt&&(0!==Math.abs(Ce.phi)&&(Ce.phi*=.5),Ce.phi-=m),Ee[0].copy(Ae[0]),Ee[1].copy(Ae[1]);var v=e.touches[0].pageX-e.touches[1].pageX,g=e.touches[0].pageY-e.touches[1].pageY,y=Math.sqrt(v*v+g*g);ve.set(0,y),ge.subVectors(ve,me),r.zoom&&(ge.y>0?0!==ve.y?Q.dollyOut(Math.sqrt(Math.sqrt(me.y/ve.y))):Q.dollyOut(W()):ge.y<0&&(0!==me.y?Q.dollyIn(Math.sqrt(Math.sqrt(ve.y/me.y))):Q.dollyIn(W()))),me.copy(ve),Q.update()}}function q(e){e=e&&Q.earthInfo.showContactFocus,Q.earthInfo.earthEntity&&(Q.earthInfo.earthEntity.contactPoint.visible=e,Q.earthInfo.earthEntity.focusPoint.visible=e)}function K(e,t){function n(e,t){ye.setFromCamera(new i.Vector2(e,t),r.camera);var n=ye.intersectObject(be,!1);if(n.length>0){var o=n[0].point,a=n[0].point.clone();if(Q.earthInfo.earthEntity){var s=new i.Matrix4;try{return s.getInverse(be.matrix.clone(),!0),a.applyMatrix4(s),{world:o,earth:a}}catch(e){return void console.warn("getInverse error",e,s)}}}}be.matrix.identity(),be.applyMatrix(Q.node.matrixWorld.toThreeMatrix4()),be.applyMatrix(Q.node.sceneNode.matrixWorld),be.updateMatrixWorld();var o=r.camera.position,a=n(e,t),s=Q.earthInfo.radius;if(a&&Q.earthInfo.earthEntity){var l=o.clone().distanceTo(a.world),u=l/s/500;Q.earthInfo.earthEntity.contactPoint.position.copy(a.earth),Q.earthInfo.earthEntity.contactPoint.scale.set(u,u,u)}var c=n(0,0);if(c&&Q.earthInfo.earthEntity){var h=o.clone().distanceTo(c.world),d=h/s/500;Q.earthInfo.earthEntity.focusPoint.position.copy(c.earth),Q.earthInfo.earthEntity.focusPoint.scale.set(d,d,d)}return{contact:a,center:c}}function Z(e,t,n){function o(e,t){ye.setFromCamera(new i.Vector2(e,t),r.camera);var n=ye.intersectObjects(l,!0);if(n.length>0){var o=n[0].point,a=n[0].point.clone();if(Q.earthInfo.earthEntity){var s=new i.Matrix4;try{return s.getInverse(Q.node.matrixWorld.clone(),!0),a.applyMatrix4(s),{world:o,earth:a}}catch(e){return void console.warn("getInverse error",e,s)}}}}var a=n||"altizureMesh",s=r.layers[a];if(s){var l=function(e){for(var t=[],r=0;r<e.children.length;r++){var n=e.children[r].treeNode;n&&t.push(n)}return t}(s),u=o(e,t),c=r.camera.position,h=Q.earthInfo.radius;if(u&&Q.earthInfo.earthEntity){var d=c.clone().distanceTo(u.world),f=d/h/500;Q.earthInfo.earthEntity.contactPoint.position.copy(u.earth),Q.earthInfo.earthEntity.contactPoint.scale.set(f,f,f)}var p=o(0,0);if(p&&Q.earthInfo.earthEntity){var m=c.clone().distanceTo(p.world),v=m/h/500;Q.earthInfo.earthEntity.focusPoint.position.copy(p.earth),Q.earthInfo.earthEntity.focusPoint.scale.set(v,v,v)}return{contact:u,center:p}}}this.object=e,void 0===t&&console.warn("domElement undefined"),this.domElement=t,this.node=r.node,this.enabled=!0,this.enableDoubleTap=r.config.doubleTap,this.target=new i.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minPolarAngleVert=10/180*Math.PI,this.maxPolarAngleVert=170/180*Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minTiltRadian=0,this.maxTiltRadian=80/180*Math.PI,this.minAltitude=.1/c.default.EARTH_RADIUS*r.radius,this.maxAltitude=10*r.radius,this.enableDamping=!1,this.dampingFactor=.2,this.enableZoom=!0,this.zoomSpeed=1,this.mouseWheelUpdateInternalMs=33,this.lastMouseWheelEventTime=null,this.enableRotate=!0,this.normalRotateSpeed=1,this.rotateSpeed=this.normalRotateSpeed,this.enablePan=!0,this.keyPanSpeed=7,this.enableLocalRotate=!0,this.localRotateSpeed=1,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:i.MOUSE.LEFT,ZOOM:i.MOUSE.MIDDLE,PAN:i.MOUSE.RIGHT,LOCALROTATE:i.MOUSE.RIGHT,YAWPITCH:i.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.gestureRecognizer=new d.default(this.domElement,{debug:!1}),this.reset=function(){Q.target.copy(Q.target0),Q.object.position.copy(Q.position0),Q.object.zoom=Q.zoom0,Q.object.updateProjectionMatrix(),Q.dispatchEvent(J),Q.update(),ne=re.NONE},this.cameraPose=function(){var e=Q.cameraGeoPosition();return{lng:e.longitude,lat:e.latitude,alt:e.altitude,north:e.northing,tilt:e.tilt}},this.setCameraPose=function(e){var t=e.lng,r=e.lat,n=e.alt,i=e.north,o=e.tilt,a=Q.cameraPose();void 0===t&&void 0===r&&void 0===n||(void 0===t&&(t=a.lng),void 0===r&&(r=a.lat),void 0===n&&(n=a.alt),Q.setCameraGeoPosition(t,r,n)),void 0===i&&void 0===o||(void 0===i&&(i=a.north),void 0===o&&(o=a.tilt),function(e,t){Q.stopFlying(),ie=Se.clone(),ie.theta=e/180*Math.PI,ie.phi=t/180*Math.PI,Q.forceUpdate()}(i,o))},this.flyToPose=function(e,t){var r=e.lng,n=e.lat,i=e.alt,o=e.north,a=e.tilt;if(void 0!==r||void 0!==n||void 0!==i||void 0!==o||void 0!==a){var s=Q.cameraPose();return void 0===r&&(r=s.lng),void 0===n&&(n=s.lat),void 0===i&&(i=s.alt),void 0===o&&(o=s.north),void 0===a&&(a=s.tilt),Q.flyToGeoPosition(r,n,i,{speed:t,northing:o,tilt:a})}},this.tiltRange=function(e){var t=e.max,r=e.min;return void 0!==r&&(r=r/180*Math.PI,r<=Q.maxTiltRadian?Q.minTiltRadian=r:(console.warn("tiltRange(min, max)",r,Q.maxTiltRadian),Q.minTiltRadian=r,Q.maxTiltRadian=r)),void 0!==t&&(t=t/180*Math.PI,t>=Q.minTiltRadian?Q.maxTiltRadian=t:(console.warn("tiltRange(min, max)",Q.minTiltRadian,t),Q.minTiltRadian=t,Q.maxTiltRadian=t)),{max:Q.maxTiltRadian,min:Q.minTiltRadian}},this.altRange=function(e){var t=e.max,n=e.min;return void 0!==n&&(n=n/c.default.EARTH_RADIUS*r.radius,n<=Q.maxAltitude?Q.minAltitude=n:(console.warn("altRange",n,Q.maxAltitude),Q.minAltitude=n,Q.maxAltitude=n)),void 0!==t&&(t=t/c.default.EARTH_RADIUS*r.radius,t>=Q.minAltitude?Q.maxAltitude=t:(console.warn("altRange",t,Q.minAltitude),Q.minAltitude=t,Q.maxAltitude=t)),{max:Q.maxTiltRadian,min:Q.minTiltRadian}},this.getRadius=function(){return le.radius},this.getMinRadius=function(){return Pe?Pe.length():Q.minDistance},this.getFocus=function(){var e={distance:null,geo:null,earth:null,world:null},t=ke.clone();if(t){var r=Q.earthInfo.radius,n=l.default.EarthResolution,o=new i.Spherical;o.setFromVector3(t);var a=s(o,r),u=a.length();e.distance=o.radius-u,e.geo=c.default.earthSurfaceToGeographic(n,a,r),e.earth=a}return e},this.setCameraGeoPosition=function(e,t,r){Q.stopFlying();var n=c.default.EARTH_RADIUS;r=void 0===r?3*n:r,t=Math.max(-85,Math.min(85,t));var i=c.default.geographicToEarthSurface(l.default.EarthResolution,e,t,Q.earthInfo.radius),o=c.default.geographicToCartesianCoord(e,t,i.length()+r/c.default.EARTH_RADIUS*Q.earthInfo.radius);return ke.set(o.x,o.y,o.z),Q.position0=ke.clone(),Q.zoom0=Q.object.zoom,Q.forceUpdate(),0},this.cameraGeoPosition=function(){var e=c.default.EARTH_RADIUS,t=new i.Spherical;t.setFromVector3(ke.clone());var r=new i.Spherical;return r.setFromVector3(Pe.clone()),{altitude:(t.radius-r.radius)/Q.earthInfo.radius*e,longitude:180*t.theta/Math.PI,latitude:90-180*t.phi/Math.PI,northing:180*Se.theta/Math.PI,tilt:180*Se.phi/Math.PI}},this.cameraNorth=function(){return Se.theta},this.cameraNorthDegree=function(){return 180*Se.theta/Math.PI},this.stopFlying=function(){ie=null,oe=null},this.flyToGeoPosition=function(e,t,r,n){n=n||{},n.speed=void 0===n.speed?1:n.speed,n.lookDown=void 0!==n.lookDown&&n.lookDown,se=n.speed,se=Math.max(.001,se);var o=c.default.EARTH_RADIUS;r=void 0===r?3*o:r;var a=(r+o)/o*Q.earthInfo.radius;return t=Math.max(-89.999,Math.min(89.999,t)),oe=new i.Spherical,oe.theta=c.default.degreeToRadian(e),oe.phi=Math.PI/2-c.default.degreeToRadian(t),oe.radius=a,ie=new i.Spherical,ie.theta=Se.theta,ie.phi=Se.phi,void 0!==n.northing&&(ie.theta=n.northing*Math.PI/180),void 0!==n.tilt&&(ie.phi=n.tilt*Math.PI/180),Q.forceUpdate(),0},this.resetNorth=function(e){return Q.stopFlying(),ie=new i.Spherical,ie.phi=Se.phi,ie.theta=0,e&&(ie.phi=0),Q.forceUpdate(),0},this.rotate=function(e,t){Ce.theta=e*Math.PI/180,Ce.phi=t?t*Math.PI/180:0,Q.forceUpdate()},this.update=function(){var t=Q.earthInfo.radius,r=1!==Math.abs(he)||0!==Math.abs(ue.theta)||0!==Math.abs(ue.phi)||0!==Math.abs(Ce.theta)||0!==Math.abs(Ce.phi)||Q.rotateSpeed===Q.normalRotateSpeed;null!==ie&&u(ie),null!==oe&&function(e,t,r){var n=e.clone();r=.0618*Math.min(Math.max(r,1e-7),.9);var o=new i.Spherical;o.setFromVector3(ke.clone());var a=new i.Spherical;a.setFromVector3(Pe.clone());var s=n.radius-t,l=a.radius+s;n.radius=l;var u=new i.Spherical;u.radius=o.radius+(n.radius-o.radius)*r,u.phi=o.phi+(n.phi-o.phi)*r,u.theta=o.theta+(n.theta-o.theta)*r;var c=new i.Vector3;c.setFromSpherical(u);var h=new i.Vector3;if(h.subVectors(c,ke),ke.copy(c),ae&&h.length()<5e-10){var d=new i.Vector3;return d.setFromSpherical(n),d.radius=l,ke.copy(d),oe=null,Q.forceUpdate(),(new i.Spherical).setFromVector3(ke.clone()),Q.dispatchEvent(te),0}ae=h.clone()}(oe,t,se);var l=new i.Vector3,c=(new i.Quaternion).setFromUnitVectors(e.up,new i.Vector3(0,1,0)),h=c.clone().inverse();null===ke&&(ke=Q.object.position.clone());var d=ke;l.copy(d).sub(Q.target),l.applyQuaternion(c),le.setFromVector3(l),le.theta+=ue.theta,le.phi+=ue.phi,le.theta=Math.max(Q.minAzimuthAngle,Math.min(Q.maxAzimuthAngle,le.theta)),le.phi=Math.max(Q.minPolarAngle,Math.min(Q.maxPolarAngle,le.phi)),le.makeSafe();var f=new i.Spherical;f.setFromVector3(ke.clone()),Pe=s(f,t);var p=Pe.length(),m=Math.abs(le.radius-p)*he;m=Math.max(Math.min(Q.maxAltitude,m),Q.minAltitude),le.radius=m+p,le.radius=Math.min(Q.maxDistance,le.radius),l.setFromSpherical(le),l.applyQuaternion(h),d.copy(Q.target).add(l);var v=d.clone().normalize(),g=new i.Spherical;g.setFromVector3(v),g.phi<Q.minPolarAngleVert?(g.phi=Q.minPolarAngleVert,v.setFromSpherical(g),v.multiplyScalar(d.length()),d.copy(v)):g.phi>Q.maxPolarAngleVert&&(g.phi=Q.maxPolarAngleVert,v.setFromSpherical(g),v.multiplyScalar(d.length()),d.copy(v));var y=new i.Spherical;y.setFromVector3(ke.clone()),Pe=s(y,t);var b=Pe.length(),_=o(ke),w=Math.max(ke.length()-b,0);Se.theta+=Ce.theta,Se.phi+=Ce.phi,n(Se),Se.radius=w,Se.phi=Math.min(Se.phi,Q.maxTiltRadian),Se.phi=Math.max(Se.phi,Q.minTiltRadian);var x=new i.Spherical(Se.radius,Se.phi,Se.theta),M=Math.max(0,le.radius-b),E=Q.maxDistance-b,A=(E-M)/E*Q.maxTiltRadian;x.phi>A&&(x.phi=A);var T=new i.Vector3,k=new i.Vector3;x.makeSafe(),k.setFromSpherical(x),T=_.x.clone().multiplyScalar(k.x).clone(),T.add(_.y.clone().multiplyScalar(k.y)),T.add(_.z.clone().multiplyScalar(k.z)),Q.object.position.copy(Pe).add(T);var S=_.z.clone().negate();S.applyAxisAngle(_.y.clone(),x.theta),Q.object.up.copy(S);var C=new a.default;C.lookAt(Q.object.position,Pe,Q.object.up),Q.object.quaternion.setFromRotationMatrix(C),Q.object.updateMatrixWorld();var P=new a.default;P.compose(Q.object.position,Q.object.quaternion,Q.object.scale);try{var O=(new a.default).getInverse(P,!0)}catch(e){return console.warn("catch orbit",e),!1}var R=O;Q.node.setMatrix(R);var L=Pe.length();return ce=Math.abs(Math.atan(.5*Math.abs(le.radius-L)/L)/1e3),!0===Q.enableDamping?r&&null===oe&&(ue.theta*=1-Q.dampingFactor,ue.phi*=1-Q.dampingFactor,Ce.theta*=1-2*Q.dampingFactor,Ce.phi*=1-2*Q.dampingFactor,he=1-(1-he)*(1-2*Q.dampingFactor),Math.abs(he-1)<.001?he=1:he<=0&&(console.warn("scale smaller than zero",he),he=1),Math.abs(ue.theta)<ce&&(ue.theta=0),Math.abs(ue.phi)<ce&&(ue.phi=0),Math.abs(Ce.theta)<.001&&(Ce.theta=0),Math.abs(Ce.phi)<.001&&(Ce.phi=0),1===he&&0===ue.theta&&0===ue.phi&&0===Ce.theta&&0===Ce.phi&&Q.dispatchEvent(te)):(ue.set(0,0,0),Ce.set(0,0,0),he=1),Q.minDistance>0&&Q.maxDistance!==1/0&&(Q.rotateSpeed=Q.normalRotateSpeed*(Math.atan(.5*Math.abs(le.radius-L)/L)/Math.PI)),!(!r&&null===ie&&null===oe||(Q.dispatchEvent(J),Oe.copy(Q.object.position),Re.copy(Q.object.quaternion),0))},this.forceUpdate=function(){Q.rotateSpeed=Q.normalRotateSpeed,this.update()},this.dispose=function(){Q.domElement.removeEventListener("mousedown",C,!1),Q.domElement.removeEventListener("mousewheel",R,!1),Q.domElement.removeEventListener("MozMousePixelScroll",R,!1),Q.domElement.removeEventListener("mousemove",P,!1),Q.domElement.removeEventListener("mouseup",O,!1),Q.domElement.removeEventListener("mouseout",O,!1)},this.dolly=function(e){he/=e},this.dollyIn=function(e){Q.dolly(e)},this.dollyOut=function(e){Q.dolly(1/e)},this.pickEarthContactPoint=function(e){var t=Q.earthInfo.radius,n=e.x-_e.left,i=e.y-_e.top;n=n/r.threeContainer.clientWidth*2-1,i=-i/r.threeContainer.clientHeight*2+1;var o=K(n,i);if(o&&o.contact&&o.contact.earth){var a=o.contact.earth.clone(),s=c.default.earthSurfaceToGeographic(l.default.EarthResolution,a,t);return{lng:s.lng,lat:s.lat,alt:0}}},this.pickProjectContactPoint=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"entity",n=Q.earthInfo.radius,i=e.x-_e.left,o=e.y-_e.top;i=i/r.threeContainer.clientWidth*2-1,o=-o/r.threeContainer.clientHeight*2+1;var a=Z(i,o,t);if(a&&a.contact&&a.contact.earth){var s=a.contact.earth.clone();return c.default.getLngLatAltFromNoneGroundCartesian(l.default.EarthResolution,s,n)}},this.zoomEvent=function(e){h(e)};var Q=this,J={type:"change"},$={type:"start"},ee={type:"end"},te={type:"animationend"},re={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5,LOCAL_ROTATE:6,TOUCH_LOCAL_ROTATE:7},ne=re.NONE,ie=null,oe=null,ae=null,se=1,le=new i.Spherical(1,0,0),ue=new i.Spherical(1,0,0),ce=0,he=1,de=new i.Vector2(0,0),fe=new i.Vector2(0,0),pe=new i.Vector2(0,0),me=new i.Vector2(0,0),ve=new i.Vector2(0,0),ge=new i.Vector2(0,0);this.earthInfo=r;var ye=new i.Raycaster,be=function(){var e=r.radius,t=c.default.getTileCartesianGeometryByGrid(0,0,0,e,Math.pow(2,l.default.EarthResolution));return new i.Mesh(t)}(),_e=function(){var e=Q.domElement.getBoundingClientRect();return{left:e.left,top:e.top}}(),we=new i.Vector2(0,0),xe=new i.Vector2(0,0),Me=new i.Vector2(0,0),Ee=[new i.Vector2(0,0),new i.Vector2(0,0)],Ae=[new i.Vector2(0,0),new i.Vector2(0,0)],Te=new i.Vector2(0,0),ke=null,Se=new i.Spherical(1,0,0),Ce=new i.Spherical(1,0,0),Pe=null,Oe=new i.Vector3,Re=new i.Quaternion;Q.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),Q.domElement.addEventListener("mousedown",C,!1),Q.domElement.addEventListener("mousewheel",R,!1),Q.domElement.addEventListener("MozMousePixelScroll",R,!1),Q.domElement.addEventListener("contextmenu",Q.stopFlying,!1),Q.domElement.addEventListener("touchstart",Q.stopFlying,!1),Q.domElement.addEventListener("mousedown",Q.stopFlying,!1),Q.domElement.addEventListener("mousewheel",Q.stopFlying,!1),Q.domElement.addEventListener("MozMousePixelScroll",Q.stopFlying,!1),Q.gestureRecognizer.addEventListener("drag-start",f,!1),Q.gestureRecognizer.addEventListener("drag",m,!1),Q.gestureRecognizer.addEventListener("drag-end",v,!1),Q.gestureRecognizer.addEventListener("dbltap-drag-start",g,!1),Q.gestureRecognizer.addEventListener("dbltap-drag",y,!1),Q.gestureRecognizer.addEventListener("dbltap-drag-end",b,!1),Q.gestureRecognizer.addEventListener("twofingersweep-start",_,!1),Q.gestureRecognizer.addEventListener("twofingersweep",w,!1),Q.gestureRecognizer.addEventListener("twofingersweep-end",x,!1),Q.gestureRecognizer.addEventListener("pinch-start",M,!1),Q.gestureRecognizer.addEventListener("pinch",E,!1),Q.gestureRecognizer.addEventListener("pinch-end",A,!1),Q.gestureRecognizer.addEventListener("rotate-start",T,!1),Q.gestureRecognizer.addEventListener("rotate",k,!1),Q.gestureRecognizer.addEventListener("rotate-end",S,!1),this.update()};m.prototype=Object.create(i.EventDispatcher.prototype),m.prototype.constructor=m,t.default=m},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(48),u=n(l),c=r(7),h=n(c),d=function(e){function t(e,r,n){i(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return a.maxLevel=n.maxLevel,a.minLevel=n.minLevel,a.tree_size_limit=n.tree_size_limit,a.node_options.earthRadius=n.earthRadius,a.node_options.useColor=n.useColor,a.node_options.planet=n.planet,a.node_options.useTexture=n.useTexture,a.node_options.maxAnisotropy=n.maxAnisotropy,a.node_options.fullScene=n.fullScene,a.node_options.countryName=n.countryName,a.node_options.treeMatrix=new h.default,a.node_options.treeMatrixWorld=new h.default,a.name="EarthSurfaceTree",a.root=new a.Node(0,0,0,null,a.node_options),a.numOfNodes++,a}return a(t,e),s(t,[{key:"expand",value:function(e){if(e.level>=this.maxLevel)return console.warn(e,"exceed max level",this.maxLevel),!1;if(e.nodes.length>0)return console.warn(e,"children exist"),!1;if(0===e.nodes.length){var t=e.x,r=e.y,n=e.level;return e.nodes[0]=new this.Node(2*t,2*r,n+1,e,this.node_options),e.nodes[1]=new this.Node(2*t,2*r+1,n+1,e,this.node_options),e.nodes[2]=new this.Node(2*t+1,2*r,n+1,e,this.node_options),e.nodes[3]=new this.Node(2*t+1,2*r+1,n+1,e,this.node_options),this.numOfNodes+=4,!0}return console.warn("unknown giveBirth error"),!1}},{key:"updateMatrix",value:function(e){function t(e){e.updateMatrix();for(var r=0;r<e.nodes.length;r++)t(e.nodes[r])}this.matrixWorld.multiplyMatrices(e,this.matrix),t(this.root)}},{key:"matrix",get:function(){return this.node_options.treeMatrix}},{key:"matrixWorld",get:function(){return this.node_options.treeMatrixWorld}}]),t}(u.default);t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0},u=r(19),c=n(u),h=r(45),d=n(h),f=r(95),p=n(f),m=r(37),v=n(m),g=function(e){function t(e,r){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default,r)),a=r.isMobile;n.featuredProjects={status:"empty",skip:0};var s={FOREST_CAPACITY:a?110:280,MAX_DOWNLOAD_CONCURRENCY:a?4:10,MIN_AREA:a?.1:.01,MAX_LEVEL:a?10:12,allowWorker:!0},l={trees:[],CACHE_CAPACITY:a?140:350};return n.forest=new v.default(s,l),n.entityCache=new p.default(r.ENTITY_CACHE_SIZE),n._visibleAltizureProjects=[],n}return a(t,e),s(t,[{key:"destruct",value:function(){}},{key:"import",value:function(e,t){var r=e.type,n=[];if("custom"===r){for(var i=e.data,o=0;o<i.length;o++){var a=i[o];a.id&&n.push({id:a.id,name:a.name,geoInfo:{centerLat:a.geoInfo.centerLat,centerLong:a.geoInfo.centerLong}})}return this._visibleAltizureProjects=n,this.importMore(e,t)}var s="AltizureLayer:"+r+"is not supported yet";return console.warn(s),Promise.reject(s)}},{key:"importMore",value:function(e,t){var r=t.eventHandlers.onImportFinished,n=t.eventHandlers.onError,i={onEntityCreated:t.eventHandlers.onEntityCreated,onEntityModelInitialized:t.eventHandlers.onEntityModelInitialized},o=e.type,a=this;if("featured"===o)return Promise.reject(new Error("feature import is not maintained."));if("custom"===o){for(var s=e.data,l=[],u=0;u<s.length;u++)if(a.validateTargetProject(s[u])){var c=a.createEntity(s[u],{eventHandlers:i});l.push(c)}else l.push(Promise.resolve(null));return Promise.all(l).then(function(e){for(var t=0,n=0;n<e.length;n++)e[n]&&(t+=1);return r("layer complete:"+t+"/"+e.length),Promise.resolve()}).catch(function(e){return console.warn("importMore error",e),Promise.rejct()})}if("animated"===o)return Promise.reject(new Error("animated import is not maintained."));if("ids"===o)return Promise.reject(new Error("ids import is not maintained."));var h="AltizureLayer unknown import type "+o;return n(h),Promise.reject(h)}},{key:"validateTargetProject",value:function(e){function t(e){return e>=-180.001&&e<=180.001}function r(e){return e>=-90.001&&e<=90.001}var n=!0;return!!e&&!!e.geoInfo&&!!e.geoInfo.autoAligned&&(n=n&&t(e.geoInfo.minLong)&&t(e.geoInfo.maxLong)&&r(e.geoInfo.minLat)&&r(e.geoInfo.maxLat),n=n&&Math.abs(e.geoInfo.maxLong-e.geoInfo.minLong)<2,n=n&&Math.abs(e.geoInfo.maxLat-e.geoInfo.minLat)<2)}},{key:"createEntity",value:function(e,t){var r={PID:e.id,apiInfo:e,eventHandlers:t.eventHandlers,forest:this.forest};for(var n in this.options)r[n]=this.options[n];var i=this.entityCache.getByEntry({layer:this,entityOptions:r});return Promise.resolve(i)}},{key:"removeEntity",value:function(e){e.deport(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"removeChild",this).call(this,e)}},{key:"sceneUpdated",value:function(e){this.forest.sceneUpdated(e),this.applyToChildren(function(e,t){e.sceneUpdated(t)},e)}},{key:"visibleAltizureProjects",value:function(){return Array.isArray(this._visibleAltizureProjects)?this._visibleAltizureProjects:(console.warn("_visibleAltizureProjects is not array",this._visibleAltizureProjects),[])}}]),t}(c.default);t.default=g},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){o.Object3D.call(this);var r=this;this.visible=!1,this.init={dir:e.dir.clone(),origin:e.origin.clone()};var n=e.dir,i=e.origin;this.earthRadius=e.earthRadius,this.projInfo=e.projInfo,this.maxAnisotropy=t.maxAnisotropy,this.age=100;try{this.age=function(){var e=new Date(Date.parse(r.projInfo.date));return(new Date-e)/864e5}()}catch(e){console.warn("invalid date",this.projInfo.date,e)}var a=void 0===t.color?16109078:t.color;a=this.age<3?16732945:a;var l=void 0===t.length?1:t.length;this.position.copy(i);var u=new o.BufferGeometry;u.addAttribute("position",new o.BufferAttribute(new Float32Array([0,0,0,0,1,0]),3)),this.line=new o.Line(u,new o.LineBasicMaterial({color:a})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.tagHolder=new o.Object3D,this.add(this.tagHolder),this.boxHolder=new o.Object3D,this.add(this.boxHolder);var c=new s.default(16,16,{margin:0});c.drawCircle(8,8,5,{outlineWidth:2,outlineStyle:"#"+a.toString(16),fillStyle:"rgb(240,144,7)"});var h=new o.SpriteMaterial({map:c.texture});this.dot=new o.Sprite(h),this.dot.scale.set(this.earthRadius/36e4,this.earthRadius/36e4,1),this.tagHolder.add(this.dot),this.setDirection(n),this.setLength(l),this.tag=null,this.box=null,this.fadingBox={isFading:!1,span:2,start:0},this.dropPin={isDropping:!0,span:.8,start:null}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(97),s=n(a),l=r(3),u=n(l);i.prototype=Object.create(o.Object3D.prototype),i.prototype.constructor=i,i.prototype.setDirection=function(){var e,t=new o.Vector3;return function(r){r.y>.99999?this.quaternion.set(0,0,0,1):r.y<-.99999?this.quaternion.set(1,0,0,0):(t.set(r.z,0,-r.x).normalize(),e=Math.acos(r.y),this.quaternion.setFromAxisAngle(t,e))}}(),i.prototype.setLength=function(e){var t=Math.max(.1,Math.min(this.projInfo.views/200,1.3)),r=1;r=this.age>0&&this.age<10?Math.max(.6,Math.min(1.3-.07*this.age,1.3)):0,t=Math.max(r,t),this.line.scale.set(1,t*Math.max(0,e),1),this.line.updateMatrix(),this.tagHolder&&this.tagHolder.position.set(0,t*Math.max(0,e),0)},i.prototype.setColor=function(e){this.line.material.color.copy(e)},i.prototype.addTag=function(e,t){if(null===this.tag){var r=this.projInfo.name.substr(0),n=this.projInfo.owner.name.substr(0),i=new s.default(256,128,{margin:4});this.maxAnisotropy&&(i.texture.anisotropy=this.maxAnisotropy),i.clear().drawTextCooked({text:r,lineHeight:28,fillStyle:"rgb(255, 255, 255)",font:"normal normal 500 24px Arial",outlineWidth:2,resetCursorY:!0,trimText:!0}).drawTextCooked({text:n,lineHeight:24,fillStyle:"rgb(225, 225, 225)",outlineStyle:"black",font:"normal normal 500 20px Arial",outlineWidth:1,resetCursorY:!1,trimText:!0});var a=new o.SpriteMaterial({map:i.texture});this.tag=new o.Sprite(a),this.tag.scale.set(this.earthRadius/15e3,this.earthRadius/3e4,1),this.tag.position.set(0,0,0),this.tagHolder.add(this.tag)}},i.prototype.removeTag=function(){if(null!==this.tag){this.tag.visible=!1,this.tagHolder.remove(this.tag);try{this.tag.material.map.dispose()}catch(e){console.warn("removeTage error:",e)}this.tag.material.dispose(),this.tag=null}},i.prototype.showTag=function(){null!==this.tag&&(this.tag.visible=!0)},i.prototype.hideTag=function(){null!==this.tag&&(this.tag.visible=!1)},i.prototype.addBox=function(){var e=this,t=(this.projInfo.name,this.earthRadius/u.default.EARTH_RADIUS),r=this.spinCircleTexutre();if(null!==this.box)this.fadingBox.isFading&&(this.fadingBox.isFading=!1,this.fadingBox.start=0);else{this.box=function(){var e=new o.CircleBufferGeometry(1,32),t=new o.MeshBasicMaterial({map:r,color:16109078,transparent:!0,opacity:.8,depthWrite:!1});return new o.Mesh(e,t)}();var n=function(){var r=e.projInfo.modelTransform,n=Math.max(r.maxBound[0]-r.minBound[0],r.maxBound[1]-r.minBound[1])*r.lengthUnitToMeter*t;return{latWorld:n,lngWorld:n}}(),i=Math.max(n.latWorld,n.lngWorld),a=new o.Quaternion;a.setFromAxisAngle(new o.Vector3(1,0,0),-Math.PI/2),this.box.quaternion.copy(a),this.boxHolder.scale.set(i,i,i);var s=10*t;this.boxHolder.position.set(0,s,0),this.boxHolder.add(this.box)}},i.prototype.fadeOutBox=function(e){null===this.box?(this.fadingBox.isFading=!1,this.fadingBox.start=0):this.fadingBox.isFading||(this.fadingBox.isFading=!0,this.fadingBox.start=e)},i.prototype.removeBox=function(){null!==this.box&&(this.hideBox(),this.boxHolder.remove(this.box),this.box.geometry.dispose(),this.box.material.dispose(),this.box=null)},i.prototype.showBox=function(){this.box.visible=!0},i.prototype.hideBox=function(){this.box.visible=!1},i.prototype.spinCircleTexutre=function(){var e=new o.TextureLoader;e.setCrossOrigin("");var t={"www.altizure.com":!0,"beta.altizure.com":!0,"127.0.0.1":!0,localhost:!0},r=t[window.location.hostname]?"":"https://beta.altizure.com",n=e.load(r+"/images/earth/loadingSpin.png");return function(){return n}}(),t.default=i},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(18),u=n(l),c=r(21),h=n(c),d=function(e){function t(e,r,n){i(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,h.default,r,n));return a.PID=n.PID,a._tree=null,a._bbox=null,a.options=n,a._infoImported=!1,a}return a(t,e),s(t,[{key:"startImport",value:function(){return Promise.resolve(this.bbox)}},{key:"updateMatrixWorld",value:function(e,t){if(!0!==this.matrixWorldNeedsUpdate&&!0!==e||(null===this.parent?this._matrixWorld.copy(this._matrix):this._matrixWorld.multiplyMatrices(this.parent.matrixWorld,this._matrix),this.matrixWorldNeedsUpdate=!1,e=!0),e){var r=this.matrixWorld.elements;this.sceneNode.matrix.set(r[0],r[4],r[8],r[12],r[1],r[5],r[9],r[13],r[2],r[6],r[10],r[14],r[3],r[7],r[11],1)}}},{key:"bbox",get:function(){return this._bbox}}]),t}(u.default);t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=r(18),c=n(u),h=r(85),d=n(h),f=r(13),p=n(f),m=r(3),v=n(m),g=r(25),y=function(e){function t(e,r){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default,p.default,r));return n._radius=r.earthRadius,n._tree=null,n.options=r,n._infoImported=!1,n.name="Earth Entity",n.loadPoliticalMap=!1,n.sceneNode.name="EarthEntity sceneNode",n.practicalSceneNode=new l.Object3D,n.practicalSceneNode.name="practicalSceneNode",n.practicalSceneNode.matrixAutoUpdate=!1,n.sceneNode.add(n.practicalSceneNode),n._useTexture=r.useTexture,n.northCap=null,n.southCap=null,n._treeNode=new l.Object3D,n._treeNode.name="_treeNode",n.sceneNode.add(n._treeNode),n._contactPoint=function(){var e=new l.SphereBufferGeometry(5,16,16),t=new l.MeshBasicMaterial({color:6674686}),r=new l.Mesh(e,t);return r.name="createContactPoint",r.visible=!1,r}(),n.practicalSceneNode.add(n._contactPoint),n.renderItems={orbitRing:r.renderItems.orbitRing},n._items=new l.Object3D,n.practicalSceneNode.add(n._items),n._focusPoint=function(){var e=new l.SphereBufferGeometry(5,16,16),t=new l.MeshBasicMaterial({color:6674686}),r=new l.Mesh(e,t);return r.name="createFocusPoint",r.visible=!1,r}(),n.practicalSceneNode.add(n._focusPoint),n}return a(t,e),s(t,[{key:"startImport",value:function(){this._tree=new this.TreeType(this.TileType,this._treeNode,this.options),this._infoImported=!0;var e=this;return this.initUI().then(function(){return e.initOptionalItems()}).then(function(){return Promise.resolve(e.bbox)})}},{key:"sceneUpdated",value:function(e){this._infoImported&&(this._tree.updateView(e.camera,e.pvmatrix,e.frustum),this._tree.loadUnloadedTiles())}},{key:"updateMatrixWorld",value:function(e,t){if(!0!==this.matrixWorldNeedsUpdate&&!0!==e||(null===this.parent?this._matrixWorld.copy(this._matrix):this._matrixWorld.multiplyMatrices(this.parent.matrixWorld,this._matrix),this.matrixWorldNeedsUpdate=!1,e=!0),e){var r=this.matrixWorld.elements;this.practicalSceneNode.matrix.set(r[0],r[4],r[8],r[12],r[1],r[5],r[9],r[13],r[2],r[6],r[10],r[14],r[3],r[7],r[11],1),this._infoImported&&this._tree.updateMatrix(this.matrixWorld)}}},{key:"initUI",value:function(){function e(e){function r(e,t){var r=v.default.webMercatorToDegreeGeographic(e,t);return v.default.geographicToCartesianCoord(r[0],r[1],n)}for(var n=e.radius,i="north"===e.polar,o=e.imageUrl,a=p.default.EarthResolution,s=Math.pow(2,a),u=v.default.EQUATOR/2,c=-u,h=u,d=-u,f=u,m=i?f:d,y=i?n:-n,b=void 0,_=(h-c)/s,w=new Float32Array(9*s),x=new Float32Array(6*s),M=0;M<s;M++){w[9*M]=0,w[9*M+1]=y,w[9*M+2]=0,x[6*M]=.5,x[6*M+1]=.5;var E=i?M:(M+1)%s,A=r(c+_*E,m);w[9*M+3]=A.x,w[9*M+4]=A.y,w[9*M+5]=A.z,x[6*M+2]=.5+.5*Math.cos(2*Math.PI*E/s),x[6*M+3]=.5+.5*Math.sin(2*Math.PI*E/s);var T=i?(M+1)%s:M,k=r(c+_*T,m);w[9*M+6]=k.x,w[9*M+7]=k.y,w[9*M+8]=k.z,x[6*M+4]=.5+.5*Math.cos(2*Math.PI*T/s),x[6*M+5]=.5+.5*Math.sin(2*Math.PI*T/s)}var S=new l.BufferGeometry;S.addAttribute("position",new l.BufferAttribute(w,3)),S.addAttribute("uv",new l.BufferAttribute(x,2));var C=void 0,P=void 0;return function(){return function(e){return new Promise(function(t,r){var n=null;n="north"===e?"data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAAeAAD/7gAOQWRvYmUAZMAAAAAB/9sAhAAQCwsLDAsQDAwQFw8NDxcbFBAQFBsfFxcXFxcfHhcaGhoaFx4eIyUnJSMeLy8zMy8vQEBAQEBAQEBAQEBAQEBAAREPDxETERUSEhUUERQRFBoUFhYUGiYaGhwaGiYwIx4eHh4jMCsuJycnLis1NTAwNTVAQD9AQEBAQEBAQEBAQED/wAARCAIAAgADASIAAhEBAxEB/8QAdAABAQEBAQEBAQAAAAAAAAAAAAECAwQFBgcBAQEBAQEAAAAAAAAAAAAAAAABAgMEEAEBAAICAgIBBAIBBQAAAAAAARECITESA0FRBGEiMhNxBYGhwUIjBhEBAQEBAQEAAwEAAAAAAAAAAAERAjEhQVESA//aAAwDAQACEQMRAD8A9/qnu/3X5l9nsn/o1vT6s/1l9ms00/8AVrOH0Px/xPR+J6/HSTWTuxz/ADvZ7tfT5fjzynzW71vyMY+R/s/wfV+N6pdtvLHNr8d+f7dfZ7rdOZnh9H/cfkfk+d139lsver4vEvHz8PT/AJc5Ncu6VFtR0rmAAKIoqCiEY22Xa4c9qlrUhawtrNrNq4uTLHkTNqauLtblvSJ4t6xYlSy1rWYa4Z8pGkaSs3dm7ouOiVjzx2XfJo1lLamTIJSzgysuUWOWcVo9mmOYkvAqmeEvSS/CC5WVkzc4po1bglQnBpjS8JnKWqjfayOetrXlVGjhMog0YjOTyUarO2uWvKJ5QHK6UuuI3vtnpzxte2asSZMNYwzcopFTKXZBfJMoCmUBAAFAAAyA/p3t/wBlr6tNtvZ7L44fI0/+k/I9Ot00/fptb39Mfma6fmba6+y3TWfykfL/ANl6/wAb0ezx/F2u2uPn7TjiWsddWOf5v5m35Xs223mLl5VvPfaV6Mk+Rz9QFQRUFALwxtsDeYl2crul3S1cdNtpXPas3ZPJnWpC1nbbhLvm4LEqr6+XSas6Y1jXlSFa4iX2MeSzmLrOL/ZmJdk4hf0NXDJlBNVbys6YWUMaMpbwmVRrFJNsktTyuUVrabWdMSWOnlcM3blRi7cou11+lm2tnSaGUal1+kuPgVAWIJLlUFRqKzF+AxchOhUAyAnJhVyDOBbWbUIM1crwNOdjOHbETxiYa48q6eES6pYSsCiKiZXB4gmV7MLgES1rB4mD+l/7P8D8T0aX2+raZk/fMvxf5e+v9tmvOuX6P/6Db8bG+3p3vlt/KZfl7z21/jPm1n/T3EKcDq5iKgB0W4Y22TVNtnLbZbsxWbVkMmUTKNLWdtsRXOy2/olWGvNzXXOXONZBVymQFMoKmNcMcyqIpkAA5goCcAIuT5ZymTVx1ljG/aZwZyamLMWYrOLKLnM5FItAAAAAFQFFlW3hnmKaixcsy4b/AG1UTWpvw1Jou2utgrnOYl5a8eMRma7SpQxhLlrpLQSWnkcmKil2ymaYwZBi0/w34ZT+vCKzyuFxhYmFqLwuEw0i8JgBX6f/AH23489909FtxeXyP8tezffbe7bXOay3zMjj1dqANAzdsLa5bVLSF2ZtZtTLNrcis0yIqBQVEw0iCKACoAohkFAAABFAAADDPy0lBFAEMKoIqUBRAFAABAaQAGs8MZXKosbvTnlZuGJnnCbSzkvay/FRUlysSzHSwGuGbRAMhUgGblfJCQFsyi8gLCgIyRan+BX0M55EV1chFPgHPauVrpu5VmtREq1mstAiggCKAAYRUoAAAAC5QBRAFEyuQAACwARKoCKAAAAACoAogChkBEaQEKAKimAJlUAUCA3NZWbrhZcLa0yx+hJ9tSfKIpQAQ5akhQYo34xLJgHsBMujkpkTKVWN3Ouu3TlYjUYqYasTCVqJgvCliCIshQZFEVAAAAAAAQFAAAAiouQAAQVAAAAABFAAAAAAAAAAAioZBcJzFlbmssUc/JYzZ47YamE/Iq5Qio3MJdYnRlUTDWElXIpZhC2oC5S0Khj11nJaxltjHXLJnhm3kGqxtFtwzaixmmFEVmhQVApOQZqRqxEVDCiCAAAAgKAAAAABAVFSgAAAAIoCKAAAAAAgCgAAAIUAy3rthghBv2TNzGTKiEqoqgAAHABmRLtFmmbyv9UBz8k8nT+s/r4Sxdd9mZ26WOe3FdGG/hk03nybdiGWaqIomVTCKzaTJvMJrRWuMJr2RM/uBdkXZEEBM8igCAAAAAAAAAAAAAAAAAAAACooCAoIAAAAACI0gI18IsBFgfALBFAVAGliLVSrlfJgyqNXZm7VKiar1fDF7dJOHPZusRnBm5BloBMgUyhdaDWJtHL+OzprrszvptnIoxe8tW2RnOUGs5MJOFzgVKzW5zGbASVWY0gAgKAAAAAAAAAAAAAABgAUAAAABBUAAAABBUBRFBKp2AAAsAAVAFAlVFMCXgHq1vDNia7cNZjUYY2mGMum3LlZilWGUq4T5wy0SltSd4KDWtq7ViXDVssBnySb4vSS4q7TPMRV8v0XMsYiwgvwzhekyoYFEEwjSABFoIAAAAAAACEpYQFEUBUWAAoIKAgqACmARGqgCKgAAAAAAAAKAAAAYVYqJMrgURvXaeOIzrvi8vH6/dvO29fZdrb8M89zxq8PX5ZmSYrlrtw3rcN6zhvMdMZw7cbOW+uNgLPmI18M91FMI0nYM4JmNCKmCLgUEwoDOFBALABIUAAABMmQUAAVAEKoJSFTMBpWZeWoCqkaVKhWsJtqqazgs4ahUVhZ2l7UF26c46YyxeKBFSdqioKAgAGBUAABRFAVAFWVBUaLElUR48Lpbrf0FjlJ9dbXTWuvw5azMdJ1h0jnV0ty6byXX9XKN+WWolMXDMmK6w29fGTDXK3nCY5Z1/lXSxFSzhlus4AnIsLAQVLwAioAAiiKgAAJUnbSAozaeciDaMzY8jRqoZZ5UW0EQJw1KzkyaOmvLWcMa7yQ1zeaspjtpc1u4ctbhZs2zY3dY57S5xHTOYSZEc7ricsx03c2WoSm3IUGVKiKZVAAAAIoIoAAACgIqKINZ4ZawqV5L2ShHN1am1jpNrXKNRZWa7SrHOVuNxl116y66/ujnpZjCzMvDUZrHs9eLmMS84ei2Vx8MVLFlS8pVsxM/LPcRVUiAFBRErVSxBlcAioAAACC1kF8PJm+nZc2Nz2/Zg43TeJmzt2tlTGtTBiXhPKytTxhvIikvCWpKZRQTICzt0m3w5NSrKldosrnNmtdsVuVmx3nSxjTaVvqtMue/NwxZi4dd5nlz74RYIuMCKliLemcZFVBUEUAMAAAAUgsABcKiBeCAqyAo8axIri6KsqEWI6RuVzlXW8txmvRHSVz0sreZG5WLFsNbzippbstxKqOe85s+GJOcOvs6y56xmtRUawzRQFBKi1EGakjVjORVEECgAM2NICVmt2J4wGZtg7axqlnPDK4zjC2pazyCoZPlFBQEyZQTVbla8nKVY1qWPR6rh18+cV5ZvXWbZn6tysWO21Tw+Wc5dJyqOVvODHDW2uOWJeQhLxymGrEiKmBqxkABFAAAAFQBqCCotmScGQFyIWXCo8oK5OiLKAK1GYqwb12sddbby4x10vw3GLHSbWThJk1rfDTLGUkxTeY6JftBSwKKyq4KGspVwzv/GpVLtMds5n2wlZ/prHTM+y2fbl8lllxZip/RjpmfZmfbmH9GOoa/wAYrSIljWYzaDNiZ4aZqVdSzK44I1rhBzuJUv263TW8udlSqhVSioIIqrGVgjTetwxHTXFnLXLNdZ0TaxNeBtl11s2mHPx8dmvXcL/K5VGNyRvbTMZxhDU2Id8GMQVNiRPlqAxcykq7THKf4RVAAAAXKAKIqouVt4ZX4B5p0JRzbUAFWIQG466Ocb1uG4zXSrqx5NRplq4Z2n0lpNgJVNpxmJKDQCjOzHs/jW9o57z9tZvixyKO3r9c1n9vs6nUYk2tW4vp9WP3bd/Ea93q85mfyn/Vn1b32ezba/E4/R133xMTt25nN5z8MW3XiG/brz5T/lzlcOplx0l121/jCpreIZmW5WUpLL0b3j/LP8dp+pauNW4OE2vCbZ4ZtMazJ/yzbipdrMJtmmi+dXyzHPnOF+cJqqlLcM28pVgGftOUVoIKLlZsxmrklSx1m9dNOs1582ct/wBl8eGpWbHby54b0v24S7SZxw3N9rMycNzpmx38oWOWu2Zl01uWvWbGPCzbPwzds3D04ljzba3XfPwlmLKti/BmUvSKl5jGGkKEEEVRMqAAAqAKuUWRUeadDOVly5NmVLBQWIqjereXOVqVYzY3K35Ofwnk1qY3nK4wzq1dl1Mb1qbTF4Z8k22toOkS3DOaUFyz7P40lN8eFS+VYx6NdNvZJv1/3dvyddbed8Y61eadt32TbXx9nM+NvmJLMvP7Wy7rXpxNd8XK/B69PH17Z5zeKm20177+nSfOZvxn2s7Z+Hn2znjp0vstvPX0s8bHLvr+vG5MYm1kWbR18dfGYYvriSGs25vHwlt+a1rpYbafKYFsuuTfqMycYW88Cpt8FuP8mCyXkCcf5T/yMfqWZQTbuJ8teKfJViX4OfsphFJ0Xo+Fx8AJ9GF46EX4Jcak1/VcfCjeeHTS/tjlJmYb14mG4xW9P4x20mY4azjDrpthuM10025xT2aSnfJm/LTLhizYt5dNpO3LbthuBYTtb0DAiooACiAKIAq5ZUHlWXlJFjk23cWMg0iqgCxplYo3nhJ2mSLqY3lPJm1ZBGo3GZhctI0m/SZbkzMKMa1Nv40s8dl7/wAIOOeVrW2uv0vjrfhn+a1rGu+2ut1l4qOnhr9F01+jL+zY41OY63XX6Zus+kvNNXXbiHl9J4fRZYahnbK23CWs+RVAEUAARQERURRFQVRBAAEbi5YlF1G5WvJzlajUpXbXrLpry5yyR0045bjFdJwvDN+1y0yzteHLZvfKeOIlWMxYnyRFTbio1eWalBMiCtJlMmQaTJlYCGVrIOKyFgw2KiiACCiLFFEWKLFygMtZWVlY1BpvXPwxK3rtfhUTfW5zhM4jpdrhjyn0oxnJOF8tZelzr9JqmScr+2pIDNjLV7MIM22JnLVjFiLqVlpm8VBQ7EUAABAEBFARFUQAAAVFEI1KyLCuk2zXfW8PNHfS8OnNYsdtdskc5XTXpphZym/DUY9ijmLtPoZaSot6QolZaqIrItZQXLUrIK1blkAc85Exiqw0ogqKIAqoAqoKNCKIqxlYo1GpWFVHTMsc84p5YQqY1tMzM7SVJcLxRVi9JBQyGImEBmrWUVErScIM4WWLcJ4WglqJyqKFEFAEEARQABUUAAAARY667cOLUrUSu025ddN83DzeTfruOW5WbHqTeZjHnjDVvDbGOf6GG/GXlmosZQoipQTKKliYayAzzBqoioCVBnsIiKAgqiKAqKIqoKKACiAjULUyAs5axwzK1NlRE5KmbgG5cwykoouUtEAqKiKJhTKC+ML+jOUtFSpktTLKhlLUNFyIqKAAAAogCoAKAoEAiK1NqwuVlSx3024xW5eMOGrtLw6SsWOkvGEsyTpVRnxiYawzUol1Twa8vtLsipZGatrPIqUXCIqCpUGMjNWcstAAACixQEFRQFQUURQFQBQBABUWKyGi5MplMmq0lpazlNFyiZMpq4VKAM2o1ZlPGplWEXeTxRLmxNCKkmFFEAFEUAABUAVAAVBRSAI3LhrXbNc41rxWpUsenWtTFjlreGtb8OkrnXT4S65anSxUcLozY6783DF4uEsWM4xEasZsZaES1MooM3a5XKK52GWjDNVmVTgAABVRVQVFAAAABckQBQMguTLIqLlMgABUVMplMplNXGsiZAxQyfKjWszWt7rJidpt7NdZw5zO1zS2eJiTtdtcUkxVvKKztwkWzIgI3NcxnaeNCVFRYKAAAAAAoAAAg1GVWDtrtw1rtiuOta8m5WbHp02lb6rz+q4dfPnFblYsXeZ5c++HTap4fIMWMWN284TCKx4H9eWs4Wbcorlv6/pJHbGcudzLylmErkAy2mBcogAKKsSKIAAoAAAAAAAAACKAnJzU2uF165BJCxflKCFakS9pisi4RAxlf0QBWp0wsqwFnaazlfkHTWRj24wZZ25W+JJ9YlaJCstaCKAAAqAKgAKigAKhKsRYo3N66zbM/Vwb1uGuaxY75y6TlynRNrG9Zsa21xyxK662bTDn442sKRmxnWO10vjlzneEs+q1rGPbrZy663C7SbzBZsNyvEgOToHRQBUFGhIogAAqKAAAAAAAAAACYUAQKALNcrrM1rfaaa4X56lrne8JhNL8tfKetMWcrh0xKm8xDDWMJDa/RGRV7IKFmEXe5kwa/qCLg274IqJYy3WbEqgRUVBQEABRBQAAWAI1HTXFnLllZssqWPRrwOU3rpp1mtys46eu4Xu5c/LnhvW4uL20zY1nDPjLctWJnFKOdt13xW5cHt08pmdxz02zxe08X2PMA5OgAAfKwqiNIogAAACiAKIAoAAAIoAAAgKBLhjaXa8tmC/oSTCgDWuJMue212uPhrnCa6lGcF1w6zWN7aTxP5TXngnMpWWm5jHKXnplvSLPoWYF2ZVAX5S9gx8q1iJhFEUFQBABQEVAUBQIAlajc3uMObcaiV0047Xa5uYxK3ry1GW5tcL6+e3K3Fw6aXFX8s118cPNvPHd6+LHD3ac5i9ROa8YDi7ARQAVUQUQAAAAAFAABUAVAAVFAAAwAAZAAAAakjPs2k4ihmxf7LjDM6VNokxWPG5bkXxnZhrm1rvhbI5/LPi+tZtrVjM4XyWIp2hFFswl6bxnVgVAEVAEBUUBFQBUUADKorUZjUWI1GtbisStRqVLF3/dizt211l0/VxddNmozV13uvFdP5RjbWbTM7X15xitRmvAGV7cXYVFEAEAAAAAAABQAAAAAAABRFAAAAAAAyzjnLQUIBFBQgM7T4ZuuHRLMpmmuYt1wjPiz63rym3Ca3DW1lWBrU2IZVEARUARQAAAAABUBGosrDUWI1GsskaG5WpWI3OViN6bcu0mJl59eK9Ov8W+WK+bhcKOToiggAAAAAKIKAAAAAAAAAAAKgCgAAAAAAAAAKiwAAEvTle3W8sWYSkZWAkaqiC6ioCAAKAAAAAAAALKgI1lcsi6Y3l09blHTXaSNys10xy7ziOHrvy667NxivEA5OgAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAgCWKgMXhYtjPTLSgAAAAAAAAAAAAAAoIoAZayysqxHbSukuK46V0y6SsWOADDQAAAAAAAAAAAAAAKgAAAAAAKIoAAAAAAAACAACAqAAze2jCKyG0EUBMgpLk7QFEUAAAAAAFAAEUABUa1uHSXLjK15NSpYouCwGRUQAAAAAAAABQEUAEVAAAAAAAFQBQAAAAAEVABUAQQVcmQAAELGHSs4SxWb0jdjOExdGvHjLMjXlxgRiVUnbRFDKAKIoAAKIAEFABFFEUR//9k=":"data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAAeAAD/7gAOQWRvYmUAZMAAAAAB/9sAhAAQCwsLDAsQDAwQFw8NDxcbFBAQFBsfFxcXFxcfHhcaGhoaFx4eIyUnJSMeLy8zMy8vQEBAQEBAQEBAQEBAQEBAAREPDxETERUSEhUUERQRFBoUFhYUGiYaGhwaGiYwIx4eHh4jMCsuJycnLis1NTAwNTVAQD9AQEBAQEBAQEBAQED/wAARCAIAAgADASIAAhEBAxEB/8QAggABAQEBAQEBAAAAAAAAAAAAAAECAwQFBgEBAQEBAAAAAAAAAAAAAAAAAAECAxABAQACAQQBAQMICAQHAQAAAAERAgMhMRIEQQVRExRhcbHRIlM0FTJygpKisiNzkaFCYvCBwVLCQzUzEQEBAQEBAQEAAAAAAAAAAAAAARECMSFB/9oADAMBAAIRAxEAPwD9ris+Vjeu0rXjKDOuzXeM+OF7A47cV8suHLpvrtmPbnqXXXbuDzcVtxl6PHMJpJ2bnQHn5fXm8w+d/LLx8t3j7FrO0liD4vNpya9mvS9nbXfx2r6O/DrtOzwbentOXy1B9S+PJx5c9OKy5c+LbbTXFdNeaZw1IlreLjDnvxXD0yyzLPJZNchr53JbpetdOCzbtXk9zmztZHb0OPfGaYa92ureEzhZmitdDGUsWIHjAAAFAAAAAAEIqIKACyrlgtBvyZu0+E7r4gnWp4t4UGJDbXMaysB4t7tx7ZdNOebdLXfk49dp1eXk9Wy51B3mL2quPDNpcV6ZjAMYalLE7A1kwzK0CVFpAErTAKAAEXAIqUgLhQBw1lldpsmISAtoiglhMqQAAAUBiyM2TLdjFBnbSOe3HPh2vVZIupjnr5w5NrdcO2JYl0hqY+Tv6223J5V9D19PHTGHaaa/Y1JPg1cZmrUjWIlFEAAAAAAACplcGAJS0wAigAAgItZBqLKgDSWpkBI0kaBOphTIM3SGK1agM9TLSXUEWVMANd0TKgJe5UsyB5C+JYAqSKCUyWIDcq4YlxXSA5LKvcxhQICAAACUFyuWQGmbqq5Biani2gJFBQIAGaAAAAAACZBpMGTIKJlMgomVyAAAAgGBKCpkwmAaRYuAYyspYSAuTJgknyBkMLgEMrgwBUw1WQLEarICpU6g3DDMq2gVILgFx0YsxWpU26gjWtZjQMS2NZylizsAYqVddooLBMoKBkDBQwCRTAAAoAIAAAAAAACgmFUGcGGkoJgVKAuEi5AwGUBciKgCKosS07IA1lmKgtRKZBcnczCbAvYtZtMguTKAFqS1qariAJhb0ICJhagGDCgIoUCJQAwZMoCrEsSA1YxjFbZ2BYGtWwElKlIDWqoAAKgAAAAAigAAAAAACglUsBDAWgCKAqKAISgplAAFBGkEErNbSwGZK1IswqiYSxUtQIqar3Bc4Z8lrOALcrEwuAVMFzFgLIWEUGMr3WwwDItSAhFsQGrGWspYAADMuK2xhqAuCTAAAKgAAAAAAAKAICooIAAAopQBDAZBMGFXAMrEqSg3hnC5QAFwCKJQUSNYAiUuydwAW9gTyE8asQMUjVTxUS1LSxZOgE7LOiCC25EigplDILKvdhrIFjLWWe4KYMKDMVrxTAM0XCWAYWRIuQLUydTAGSGFwoAAC4QAAQAFAEBUUBAAAUUQAQUEjUrFWUFrFbrIJMtQkKCiRQAUGWmMrkEpmi4AkWdBm3qDfRm3qW9EmAayvlGLmmAazKrMioCLIUEEqwFZrSWARUhQCCwBUJQaygAgoCYXAQDAlpFFBMgqVcs0Gp1LElaBkEBQAAEAAAAAQUFwLAQKgLYkitYBlmtJjIEpeq+J2AkwJkBS1CgzYsirQRnPVpj5BuGEXAJTC4S34BeixmRpAAoLEpkBmkKsBYVYzaCNRBRUVEFEUCKy1ACiUEyuWRRcmcJJSwGpSmpQQXBgEjXwi5BmmSpYDWSRmNyguGVyUEBcIISLgBLEaygArNUBYUEy1LlzpLYDoZZ8gF8kzkwuMAki24TKbARvHRiNygzhcLQGbCRqsgsMhgCUBAAAKZSgDMtqgtRUBciKAqKoAIAsAZajKwFKAJhZqGVFwlLsx5dQbhSVKCmUyk7gtRTAIsiYMguEwZWUDCXKylAXKEQVMqmAIZak6M2AsSxMrlQKZATB4rGgY8TDTNBclrFrWvUCdVusXszaCXoTZL1JrgFuzUZky0C5ZqXKgZWJglwC0BABMguCmTIJiRF7gM2rLlnbusvRUXIxaa7A38rEqZRWlZi5BoQBFgAokVREy1hnAJeqYbwYBnNjUPEAAAUnRroDF6s2OmOpYDEi4OxkFwRMmQKRUQXIiguUqZMqGEaliWASAAKhAWphUyCWEuCpJQatyli4KDM7t2dGcYq3boCXoSp3Aa6JlOtMA1lARFAFHO7yXq3a8XvTk8Ltp8A9ssrnyb4fO9H2+Ta+O718udp0VHTj5ZejtLHz+uvVvXnoPXZlcOenLLMr97KK1iJNeqTbJN+qDa4mEly1IDKW4aseXm5NptiA9OuzTy8e+3y76b5B0ShQFjKxRUW1AUMpkFqRMrKC1nOFtyzYC+RN8JhnaA3N289HKStAtSxqFBkXCYBYuEjU7AyKUGajSyAxi5bNklAsUSgGcJlO4LnKkKAvZJEoNZS1kBb2TFWNTGAYiVqzqSAzMtLiAghkiCgCsckuOjhdsy616bHPfSdweC+t47eWr1cGts/aTe4TTmkuFiOvJxSzo8u/Hdeseq8nRjbbXaKjw8ns7ccb9b25v0qe1weWl2nw8nBxbf0s4/IzfVj7et08cys77a46PHpvtrr42t6b23FXDXSc/jTb3ZqxtxXa9EvqZgPRxe3rv0dLprtcvn/c7ce3R69OT9jr3KO3hrhm/s049rsm8s61FehFQEMlIolpKtjINZS1FwApIoEhhYAM2NJQIUAMmUUDJUUEWUMAZMpSAqypUgN1lpmgGMo0CYVMqCLImFyBamEysBMLhamQS3Bk2iQFFgCAAKigAIDG86Ns2A4bcd26fa8947x7vfZ8uPJx+VyDN08tcuV12ldppvF21uFRjXWWYryb+pt97nXpq9WtsrpkR5567Xhiul3kc99/kHo4tZjq6WR5OPnzcO15cCxnn16Pm+xzbcfSPo7ck2jxe5wXbS7a9z8F9P3J08q9+/Lptpn4fG4eLWSftYv2PXpenhlIPrItQVKsCKFiYaATBhcmQRUyoCWlTGQWAAAAYXCAAABkMAVFwYBAWAsSrEoJlcs0lBrC4SVcglStVASRcL2TIFQMAlo1NSzAEEUAAAAABAAATCoBhnaNAOPhLW7rJCzDny8t10qo4clu22I1OG7fs1y4OXy5Osevl2xPKIseKf6fLh6dpLrmV5uXi22vlO9NeHmx3IL1mzvp47a2Xq4cmu0n5XPi5NpyYvZUZno73mu07PVr6lly9Gu2uGrczog6gCpRWQWVrLMiqJaZFx0BMrGflqAohaAIoAICwIAAAAILBFBCAoVKqAsMJnC5BMCymQSrKUAAAwsRQXyY2quHu/wfPf8As2/QBPa9X99x/wB6frX8X6v77j/v6/rflhB+q/F+r++4/wC/r+s/F+p++4/7+v635fTj35Nppx63fe9tZM1myy4vSzvAfqvxfq/vuP8Av6/rPxfqfvuP+/r+t+VAfr5ZtJdbmXtYPJ9K/gOL+1/mr1gAAJQoJlUjSozs53SbdK3tUkoOenBppbWrtrt+yzy7WRnj21zm9wdtOKfLO88ezX3kkeXl555Yphr0cfFrvOrny+vx69Z3deLeTWW/LPPt06A4cfJrNsbPXr47dnxfZ5Ntbbr3T1ff3lk2B94BFDAAqLlnKiqgCWKACKAkihaAmFAAcvb5/wAN6+/Njy8ZMT8tuAdB4L7nvcGn33s8Ot4vnwv7Wue2cpx+5794vxO/DreCzONbfOa/b1QfQV5PX96b+lfb5pNZrnMn5Lhz19n6ny6ffcXDpOO9dddrfKwHvHk0+o8W3qb+ztLrePpvp8zb7HKe19T+7/EfcafdY8vDN8/EH0Bz9f2NPZ4debj7bfF7y/YvNy6cPFty7/0dJmg2Pn6+z9T5NPvuPg0nHeuum1vnY6a+3y+x633vqaS8s2xvx7/GO/2KPXUjx+r7/Jz+1twb8f3d00ztL3m0smPzOvq+ztzc3sce2sk4dvGWfPfv/wAAenBI823t76+/p6vjPHbTyu3z8/qefb3/AHfxe3racWnlM3TyuPLX4sB9Jx4fZ4ue7zjz/p7eO2ZjrGPX5Pe23x7HFpppjvrc3Ljw+1z82nPeHj1+849/HWdpt170HsnLx7a3bXabTXvi5xhn1+fj9jjnLx58bmTPTs+Z9L25/Dnl1n3d22u22es2x2en6P8AwOn59v0oO/s+7wer4/fWzzzjEz2dpZZLOsvWV8vfin1D3+eXrx8Ol49b/wB1+f8Ajl6fpXNeT1Zpv/T4bePafm7A9jh7v8Hz/wBTb9Du4e9/B8/9Tb9Cj8ud+k7j2+jwXWz2NulnXj/WSW3IluTX1vpP0/8AC8f3vJP9fedf+2f+39bj9X+mfeZ9ngn+pOvJpP8Aqn2z8r3et7WvJpjk2k3nfPTLxfVPa5PT9zg5+Prrtrdd9fjaS5/9Syz0l18EfU+oenx83F/MPT68e3Xk0n/Tfm4/S+Wiv0n0r+A4v7X+avW8n0r+A4v7X+avWAABWLltLAZlXODGC4sVHPfb7Hl/HeHJ4bR6rq4cnq67bTbHUHTe+euY4zpXp11k0w57ceeyxKlvlriPPy8G1/aejSeN6u18dtewPnTl5ZjW9o9E389cXu1vx6157fCgzy+tbLcPJeCzbth9Lj5ptMU34tdp0B7wGWgAEpFAAFAAAAAAARQHk+q/wHL/AGf82r1ufscGvscO3DvbNdsZs79LkHL6h/Ac39U9T+A4v9ufodebh15uHbh2tmu0xbO68fFrx8OvDrbdddfGW98IPj667bfQ7j43zfzeT7HBtrtwce2v9G6zH/Bj1/V4uDg/DzO2lzny+cvN/K/GXTi9jl4+K/8A1y9OoOPrcvDpy+9zckz6/nPjymc34fTm+l45vLPCzMvxjDnxepwcXBfX11/07nyl+c/a838qmPu5z8s4L/8AXnpj7AT6Ln8Nvf8AovJbr+bEd/qPHpyepvryb/d6dLd8eXa/ZHS+txfh762s8eO6+PTvinF6/HxevPX/AKXHJZfL5l+0Hl4/W9y8et4/dzpZPHHHr2+HP6RNvP2rdvOXfHn28r1zXT+VyS6cfscunFe/HL0evg4OP1+OcXFMaz/nftoPHx//ALPL/tT/AOKfTtp+M93T5884/JnZ6562k9rb2pb57a+Nnxj/AMRx2+mcV335dN99OXfa7eetxZnvPzA58n/7XF/tX/5O3vep+I0m2l8efj68e/5fsPW9DTg5Nubbfbl5dpi77/Yxv9Nm292/Ec08rbibdJkG/R9z8RpdOSePPx9OTT/1cfpXf2v92t8H03j4Oec85N995mXysuczHXo3r6OmnHy6acm+v323ndpcWXPwDz/S/wD+Hs/7m36E9HmnB9JvLf8Ap8sfnz0ez1vU4/W4bxaW2bW3ba97a5X6bw31Z6vntOObeWemb/yB5PQ9X6hrwTk4uXXScv7dm2ub+hr1pzep9RvHz7Tb8TM+UmJ5R9TXWa6zXXpNZiT8kcvZ9Tj9i8e21uu3FfLXbXuDs4e9/B8/9Tb9Du4e9/B8/wDU2/Qo/NcM47y6/eXGmer60xiY7fGHxnXh9nk4b066/Ot7NcdZ6x1zr6jX1Li4uX1/V25N/CSWZ/8AKfqceHn4+afs3G3zre71e1623tehwyba6Tj2t3327a6zOa139ksTj5bGfpXH6/FyXXi9mcnnOvD064+XzPqXH6/H7e+vr3OneydtdvmRvl9vi4dL6/o510vTk57/AE+T832R4nJ0fpPpX8Bxf2v81et5PpX8Bxf2v81etQAQAASpexaijPVZMrhqCMb411cpct80tnRx0lNTHSa5rW08NKzxyy9Wua/sqPFvzbSs/wBOLvrrtXbh49fH8qaY8enJOHezf57Ov387ztT2vV+82l+xNeCeOPsJVfWARQAAAABQAABKCwpFoMrEqgAAAAAAAAIACoAoABgATAqWAZKkaBmVrLOOqiK4e9/B8/8AU2/Q7G2uu2t12mddpiy/MoPyI/Sfyr0P3X+Lb9Z/KvQ/df4tv1or83LZcy4s7WO3L7nscvFrw77/AOnr18Z0zfy/a+9/KvQ/df4tv1n8q9D91/i2/Wo/Nj9J/KvQ/df4tv1n8q9D91/i2/WgfSv4Di/tf5q9bPHx6cWk4+OeOmvSSNKACAlVATCYaMCMqlWKJesY8cOmGaDnvv4vPze1rNbPl158XV8n2v2Lm9k0XX28ctl7PZw+zM/nfDt+83/Yb15eTj2k2TVfpsTbTMeXbfx2w8/r/UdfGa7Pbprpz4wqPbUVBQAABQAAABUqpQSNMqACAoAAAAgAAAAAACiAKIoBQBFjNuF1ohRayCioCiKAAKAAAIAAAACVWaCNRMKAzY1WaqOe2kvd5vZ9Oc0w9G+Z1OPeXpTB8nX6d91tbJl5vb4N5c2Yfd3sm2Xk9vWctkwzivlacWt1znq9fq+7eHbxtNvQ8J5SvHzcdlz9hzKlr9YioqgAACgJlQAAWJSLQZUQFCAAACAAAAAAAAAAAAqKAAIljPy2zYCypSFBZVsYlw38AgAKAAAKAIAAAADLSAAAJhUBjbTLn93Zcx3qYUea6b2peC7PViLgHi24rJivDzetttez7W2krjvpMdjWXqRpKjSCKoIoCLEICggKAgAAAAAKCKAgAAAAAAAAKCKAgAAACYFQGbOrUqUgNIqAKgCiKAAigAAACKgCooICAUBRQAKl1yqxEJVSNCsgKAAIKABgQFQAAAAAAUBFBAAAAAAFAAAAAAAQAArMaSwEABQKAZEoKEAURQAEUAARTAEAoJUKAAKKAgohFRoZt6mUVpAAMiKKsRQAKggEAFQAABFQBYgoqKgAACgAAAAAAAAIAAAAjLSWARSRQQoAAoIACiKAAKACBREEUwKqAALEaggYE7AWLImWpcop2RaAM1osUQADICARFgKioAAAACAKKAAACKAAAAAAAAAAAgAAioAqKCUVAFiEBagAAAKgCgAAAgqUBAAjSKBgq/CUVKutRZqgbVItidgaMiAqAoKCDNWFSA0igIAAAAAoAAAAIqAoAAAAAAAAAAAgACCoCoAAAAAAAAACoooigESqlEQhjLQEMdSL8inwi1KCNeTK4QW1J1qYWAUynemMUFABVSKozU+Wqz8oNJlfhAAFAAAAAAAAAAAAAAAAAAAAAAQAAABBUAAAAABYCC1BRUaAAAQAJEWkAhQBUKAlixnLUQLWbWrEwCRfkkamARcGFBAFBj5bZoNQqarQQAAAAAAAAAAAAAAAAAAAAAAAQAAAAABBUAAAVAVQQFEUAAAyM3rUFq46HTBOoJFXCY6gXsQvSJKoNdEhUF6YROoDXRJOphYCWhsmQaElyoCWKlBI0xO7aiAAAgKmQBTKEBRAFAAAAAAAAAAAAAAAAAEAAEUBABQAFRUAAgKKlBMmEndoBe0XCVAT5DUDbqi1lRqKioJSFJQLFz0RAMphcAM5w6TZnxLAbylZigigAAAgAgqWqLCs5awCC4QFyuWVQXJlm0gNAAAKAAAAAACgCBUBQAAAEVAAAURoEwogGTCfK0EpFx0LEGs9Ge6y9GZeoCxWb3A+U+Wr2Zio0sTIil6pg7LM0EmVmtbkXMBnCYM9U22oATsmeoKWiYyBMtIuQQVAQMJlRcdGLG52TawEjcjMalQEw1lMgki4S3CTbILhcYIUAAABQAgArIKQgCgAiNVkFAAAAABBQAACpFSIKKz2oNFEoJ2axgW9QZTYvcvVYhOwvaIDXhiIu1Y65RWqS4JCg15M2sgLFJGoDFuOhGrhAWTAmTKi4Zq5EEjSRQSsVus2KM3aue21dLGfHIia7V08nPxwXIOsuWnLWunlEVLMsyYreYlmQalmBnGFgKAAAAQFFQAAAUABKqUEikABRBFEAAABFCkKRBpKZAChKBL1atZ+SgWZRZeiKGTafMK1J06iFMJMqipU7tVOwF1JCWqAlFBAsIBhcAomDC2s5BTKZEFAUSxMNAM4ZsdMJgHPFMbOmDOEHPGGpVsys0BJmq1jCYADBgAMGAAwuFGVhYSAUVMICgAYAASqCUAFQAAAAFEFgABUAwmVyC4Zrc7M/KiQwoCLAEf/2Q==";var i=new Image;i.src=n,i.onload=function(){var e=new l.Texture(i);e.needsUpdate=!0,t(e)}})}(o).then(function(e){return b=e,t.options.maxAnisotropy&&(b.anisotropy=t.options.maxAnisotropy),Promise.resolve()})}().then(function(){if(C=new g.GroundSelfShaderMaterial,t._useTexture)C.setTexture(b);else{var e=new l.DataTexture(Uint8Array.from([0,10,40,255]),1,1,l.RGBAFormat,l.UnsignedByteType,l.UVMapping);e.needsUpdate=!0,C.setTexture(e)}return P=new l.Mesh(S,C),Promise.resolve(P)}).catch(function(){return console.warn("Loading earth texture failed."),P=new l.Mesh(S),Promise.resolve(P)})}var t=this,r={radius:t._radius,polar:"north",imageUrl:"north"},n={radius:t._radius,polar:"south",imageUrl:"south"};return e(r).then(function(r){return r.name="northCap",t.northCap=r,t.practicalSceneNode.add(r),e(n)}).then(function(e){return e.name="southCap",t.southCap=e,t.practicalSceneNode.add(e),Promise.resolve()}).catch(function(e){return console.warn("EarthEntity initUI error:",e),Promise.resolve()})}},{key:"initOptionalItems",value:function(){var e=this,t=[];if(this.renderItems.orbitRing){var r=new Promise(function(t,r){for(var n=new l.Object3D,i=1.1*e._radius,o=Math.PI/180,a=new l.LineBasicMaterial({linewidth:.5,color:7329264,transparent:!0,opacity:.4}),s=new l.Geometry,u=0;u<360;u++){var c=i*Math.cos(o*u),h=i*Math.sin(o*u);s.vertices.push(new l.Vector3(.985*c,0,.985*h)),s.vertices.push(new l.Vector3(c,0,h)),u%30==0?(s.vertices.push(new l.Vector3(.935*c,0,.935*h)),s.vertices.push(new l.Vector3(c,0,h)),s.vertices.push(new l.Vector3(.935*c,0,.935*h)),s.vertices.push(new l.Vector3(c,0,h))):u%5==0&&(s.vertices.push(new l.Vector3(.965*c,0,.965*h)),s.vertices.push(new l.Vector3(c,0,h)),s.vertices.push(new l.Vector3(.965*c,0,.965*h)),s.vertices.push(new l.Vector3(c,0,h)))}var d=new l.LineSegments(s,a),f=new l.LineSegments(s,a);f.rotation.z=Math.PI/2,n.add(d),n.add(f),e._items.add(n),t()});t.push(r)}return Promise.all(t)}},{key:"bbox",get:function(){return new l.Box3(new l.Vector3(-this._radius,-this._radius,-this._radius),new l.Vector3(this._radius,this._radius,this._radius))}},{key:"contactPoint",get:function(){return null===this._contactPoint?void console.warn("contactPoint not ready."):this._contactPoint}},{key:"focusPoint",get:function(){return null===this._focusPoint?void console.warn("focusPoint not ready."):this._focusPoint}}]),t}(c.default);t.default=y},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(28),s=n(a),l=r(91),u=n(l),c=r(0),h=function(){function e(t,r){i(this,e),this._capacity=t.capacity,this._useWorker=t.useWorker;try{this._worker=this._useWorker?new u.default:null}catch(e){console.error("Cannot initiate web worker",e),this._worker=null,this._useWorker=!1}r=r||{},this.debug=void 0!==r.debug&&r.debug,this._size=0,this.waitQueue=new s.default,this._taskMap=new Map}return o(e,[{key:"destruct",value:function(){this.waitQueue.clear(),this.waitQueue=null,this._capacity=0,this._size=0,this._taskMap.clear(),this._taskMap=null,this._worker&&(this._worker.terminate(),this._worker=null)}},{key:"clear",value:function(){this.waitQueue.clear(),this._size=0,this._taskMap.clear(),this._worker&&this._worker.terminate()}},{key:"abortPending",value:function(){for(var e=[];!this.waitQueue.isEmpty();){var t=this.waitQueue.dequeue(),r=t.reject(new Error("[Dock] abortPending"));e.push(r)}return Promise.all(e)}},{key:"fill",value:function(){for(var e=this.waitQueue,t=this,r=this.capacity-this.size;r>0&&!e.isEmpty();){var n=e.dequeue();this.act(n).then(function(){t._size--,t.fill()}).catch(function(e){console.error("Dock.add",e)}),r=this.capacity-this.size}}},{key:"act",value:function(e){this._size++;var t=e.func,r=e.resolve,n=e.reject;return function(e){return Promise.race([e,new Promise(function(e,t){setTimeout(function(){t(new Error("timeout"))},12e4)})])}(t()).then(function(e){return r(e),Promise.resolve()}).catch(function(e){return n(e),Promise.resolve()})}},{key:"queue",value:function(e,t){function r(){function t(e){return e instanceof c.Mesh?void 0!==e.material||(console.warn("[Forest] material/map not ready",e.material),!1):(console.error("[Dock] Invalid mesh",e),!1)}var r=null,o=n._taskMap.get(i).tiles;return o.forEach(function(e){e.expired||(r=e)}),o.clear(),null===r?Promise.reject(new Error("[Dock] No active tile")):n.loadTileTask(e,r).then(function(e){return t(e)?Promise.resolve(e):Promise.reject(new Error("[Dock] Parsing error: invalid Mesh."))})}var n=this,i=this._getTileKey(e,t),o=null;if(this._taskMap.has(i)){var a=this._taskMap.get(i);a.tiles.add(t),o=a.task}else{var s=new Set;s.add(t);var l=new Promise(function(e,t){n.waitQueue.enqueue({func:r,resolve:function(t){return n._taskMap.delete(i),e(t)},reject:function(e){return n._taskMap.delete(i),t(e)}})});o=l;var u={task:l,tiles:s};this._taskMap.set(i,u),this.fill()}return o}},{key:"loadTileTask",value:function(e,t,r){return t.trial=0,this._useWorker?this._worker.scheduleLoad(t).then(function(e){return t.onWorkerLoad(e)}):t.tileLoader()}},{key:"_getTileKey",value:function(e,t){var r=e;return r+=t.level+"_"+t.x+"_"+t.y}},{key:"size",get:function(){return this._size}},{key:"capacity",get:function(){return this._capacity}},{key:"info",get:function(){return{capacity:this.capacity,size:this.size,queue:this.waitQueue.getLength()}}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){var t=this;n(this,e),r.p="/js/";var i=r(62);this.worker=new i,this.listeners=new Map,this.worker.onmessage=function(e){var r=e.data.key,n=e.data.filename;if(t.listeners.has(r)){var i=t.listeners.get(r);t.listeners.delete(r),200!==e.data.status&&404!==e.data.status&&0!==e.data.status&&console.warn("bundle load suffers error",e),i.map(function(t){t(null,e.data)})}else console.warn("Worker cannot find callback for tile",n)},this.worker.onError=function(e){for(var t=0;t<100;t++)console.warn("Worker runtime error",e.message)}}return i(e,[{key:"terminate",value:function(){if(this.worker)try{this.worker.terminate()}catch(e){return console.error("LoadWorker terminate failed",e),!1}return!0}},{key:"scheduleLoad",value:function(e){var t=this,r=e.fileName(),n=e.basepath+r;return new Promise(function(i,o){var a=function(e,t){e?o(e):i(t)};if(t.listeners.has(n))t.listeners.get(n).push(a);else{t.listeners.set(n,[a]);var s=e.basepath;"/"===s.substr(0,1)&&(s=window.location.protocol+"//"+window.location.host+s);var l={key:n,filename:r,path:s+r+".ab"};t.worker.postMessage(l)}})}}]),e}();t.default=o},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(26),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=r(0),l=function(){function e(t,r){n(this,e),this.capacity=t.capacity,r=r||{},this.debug=void 0!==r.debug&&r.debug;var i=this;this.cache=new a.default(this.capacity),this.cache.shift=function(){var e=a.default.prototype.shift.call(this),t=e.value;if(t.geometry.dispose(),t.material.materials)for(var r=0;r<t.material.materials.length;r++){var n=t.material.materials[r];n.map&&(n.map.dispose(),n.map=void 0),n.dispose()}else if(Array.isArray(t.material))for(var i=0;i<t.material.length;i++){var o=t.material[i];o.map&&(o.map.dispose(),o.map=void 0),o.dispose()}else t.material.map&&(t.material.map.dispose(),t.material.map=void 0),t.material.dispose();return e},this.cache.removeAll=function(){for(var e=i.capacity+1;i.cache.head&&e>=0;)i.cache.shift(),e--;return e>=0||(console.warn("cache removeAll error"),!1)},this._stat={hit:0,miss:0}}return i(e,[{key:"destruct",value:function(){var e=!0;return e=this.cache.removeAll()&&e,this.cache=null,e||console.warn("SharedTileCache destruct failed"),this._stat.hit=0,this._stat.miss=0,e}},{key:"clear",value:function(){var e=!0;return e=this.cache.removeAll()&&e,e||console.warn("SharedTileCache clear failed"),this._stat.hit=0,this._stat.miss=0,e}},{key:"getTile",value:function(e,t){var r=this._getTileKey(e,t),n=this.cache.get(r);if(void 0===n)this._stat.miss++;else{if(!this._validateMesh(n)){console.warn("SharedTileCache provides invalid mesh",n);var i=this.cache.remove(r);if(i.geometry.dispose(),i.material.materials)for(var o=0;o<i.material.materials.length;o++){var a=i.material.materials[o];a.map&&(a.map.dispose(),a.map=void 0),a.dispose()}else if(Array.isArray(i.material))for(var s=0;s<i.material.length;s++){var l=i.material[s];l.map&&(l.map.dispose(),l.map=void 0),l.dispose()}else i.material.map&&(i.material.map.dispose(),i.material.map=void 0),i.material.dispose();return}this._stat.hit++}return n}},{key:"putTile",value:function(e,t,r){if(this._validateMesh(r)){var n=this._getTileKey(e,t);return!this.cache.get(n)&&(this.cache.put(n,r),!0)}return console.warn("[SharedTileCache] receives invalid tile."),!1}},{key:"_getTileKey",value:function(e,t){var r=e;return r+=t.level+"_"+t.x+"_"+t.y}},{key:"_validateMesh",value:function(e){return e instanceof s.Mesh?void 0!==e.material||(console.warn("[Forest] material/map not ready",e.material),!1):(console.error("[Cache] Invalid mesh",e),!1)}},{key:"stat",get:function(){return this._stat}},{key:"info",get:function(){return{stat:this.stat,size:this.cache.size}}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(22),s=n(a),l=r(92),u=n(l),c=r(90),h=n(c),d=r(0),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(d),p=function(){function e(t,r){i(this,e);var n=t.cacheCapacity,o=t.dockCapacity,a=function(e){var t=s.default.detectIE(),r=!!t&&t<=11;return r&&console.warn("You are using an old IE browser. Upgrade to IE 12 or later to get best viewing experience."),!r&&window.Worker&&e}(t.allowWorker);r=r||{},this.debug=void 0!==r.debug&&r.debug,this.cache=new u.default({capacity:n}),this.dock=new h.default({capacity:o,useWorker:a}),this.status="working"}return o(e,[{key:"destruct",value:function(){var e=!0;return e=this.dock.destruct()&&e,this.worker&&(e=e&&this.worker.terminate(),this.worker=void 0),e=this.cache.destruct()&&e,e||console.warn("SharedTileRetriever destruct failed."),this.status="destructed",e}},{key:"abortPending",value:function(){return this.dock.abortPending()}},{key:"clear",value:function(){var e=!0;return e=this.dock.clear()&&e,e=this.cache.clear()&&e,e||console.warn("SharedTileRetriever clear failed."),e}},{key:"request",value:function(e,t){function r(e){var t=new f.BoxGeometry(1,1,1);t.vertices[0]=e.boundingBox[6].clone(),t.vertices[1]=e.boundingBox[2].clone(),t.vertices[2]=e.boundingBox[5].clone(),t.vertices[3]=e.boundingBox[1].clone(),t.vertices[4]=e.boundingBox[3].clone(),t.vertices[5]=e.boundingBox[7].clone(),t.vertices[6]=e.boundingBox[0].clone(),t.vertices[7]=e.boundingBox[4].clone();var r=new f.MeshPhongMaterial({opacity:0,transparent:!0}),n=new f.Mesh(t,r);return n.place_holder=!0,n.visible=!1,n}function n(e){if(e){var t=e.clone();return t.place_holder=e.place_holder,t.visible=e.visible,t}return e}if("working"!==this.status)return console.warn("SharedTileRetriever destructing",t.info(),"request failed"),!1;var i=this,o=this.cache.getTile(e,t);return o?Promise.resolve(n(o)):this.dock.queue(e,t).then(function(e){return Promise.resolve(e)}).catch(function(e){return t.expired?Promise.resolve(void 0):"[Dock] abortPending"===e.message?Promise.reject(e):"not found"===e?Promise.resolve(r(t)):"local data"===e?Promise.reject(new Error("local data")):"expired"===e?Promise.reject(e):(console.warn("unknown load error",e),Promise.reject(e))}).then(function(r){return void 0!==r&&i.cache.putTile(e,t,r),Promise.resolve(n(r))})}},{key:"info",get:function(){return{cache:this.cache.info,dock:this.dock.info}}}]),e}();t.default=p},function(e,t,r){"use strict";function n(e,t){if(!(e&&e.isBufferAttribute&&t&&t.isBufferAttribute))return console.error("TWo buffer attribute must be valid.",e,t),null;var r=e.array.length+t.array.length,n=null;if(e.array.constructor===Uint16Array&&r>Math.pow(2,e.array.BYTES_PER_ELEMENT)){n=new Uint32Array(r);for(var i=0;i<e.array.length;++i)n[i]=e.array[i];for(var o=0,a=e.array.length;o<t.array.length;++o,++a)n[a]=t.array[o]}else n=new e.array.constructor(r),n.set(e.array),n.set(t.array,e.array.length);return new h.BufferAttribute(n,e.itemSize)}function i(e,t){if(!t||!t.isBufferGeometry)return console.error("THREE.BufferGeometry.merge(): geometry1 not an instance of THREE.BufferGeometry.",t),null;if(null!==e.index&&null===t.index)return console.error("The new geometries must have index because the original geometry has index"),null;var r=e.attributes,i=t.attributes,o=0;for(var a in i)if(void 0===r[a])r[a]=i[a].clone();else{var s=r[a],l=i[a];o=s.count,r[a]=n(s,l)}var u=e.index;if(null!==t.index)if(null===u)e.setIndex(t.index);else{var c=e.index.array.length;e.setIndex(n(e.index,t.index));for(var h=c;h<e.index.array.length;h++)e.index.array[h]+=o}return e}function o(e){return e&&e.isBufferGeometry?e.index?e.index.count:0:(console.error("geometry not an instance of THREE.BufferGeometry.",e),0)}function a(e){var t=e.urls,r=0;if(t)for(var n in t)t.hasOwnProperty(n)&&(r+=t[n].length);return r}function s(e){function t(e,t){return e.substr(0,t.length)===t}return new Promise(function(r,n){var i=e.src;if("string"==typeof i)if(t(i,"data:")){var o=new h.Texture(e);o.image.onload=function(){(window.URL||window.webkitURL).revokeObjectURL(e.src),r(o)}}else{var a=new h.TextureLoader;a.load(i,function(t){(window.URL||window.webkitURL).revokeObjectURL(e.src),r(t)},void 0,function(e){n(e)})}else n("The img is not an image.")})}function l(e,t,r){function n(e){t(o,e),o.removeEventListener("load",i.load)}var i={load:n};r&&(i.progress=function(e){r(o,e)});var o=new XMLHttpRequest;c(o,i),o.open("GET",e,!0),o.send(null)}function u(e,t){l(e,function(e){t(JSON.parse(e.responseText))})}function c(e,t){for(var r in t)e.addEventListener(r,t[r])}Object.defineProperty(t,"__esModule",{value:!0});var h=r(0),d=function(){};d.prototype.load=function(e,t,r){this.downloadModelJson(e,r,t)},d.BufferGeometryCreator=function(){},d.BufferGeometryCreator.prototype.create=function(e,t,r){var n,i,o=new h.BufferGeometry,a=new Float32Array(3*e.length/8);r.needNormal&&(i=new Float32Array(3*e.length/8)),0===r.displayMode&&(n=new Float32Array(2*e.length/8));var s,l,u,c,d,f,p,m,v=e.length;for(l=0,u=0,s=u;s<v;s+=8)c=e[s],d=e[s+1],f=e[s+2],a[l++]=c,a[l++]=d,a[l++]=f;if(l=0,u=3,0===r.displayMode)for(s=u;s<v;s+=8)p=e[s],m=e[s+1],n[l++]=p,n[l++]=m;l=0,u=5;var g=!0;if(r.needNormal)for(s=u;s<v;s+=8)c=e[s],d=e[s+1],f=e[s+2],i[l++]=c,i[l++]=d,i[l++]=f,c*c+d*d+f*f>1e-4&&(g=!1);g&&(r.needNormal=!1);var y;if(!0===r.extendModel){var b,_,w=new Float32Array(3*t.length);for(r.needNormal&&(b=new Float32Array(3*t.length)),0===r.displayMode&&(_=new Float32Array(2*t.length)),y=0;y<t.length;++y)w[3*y]=a[3*t[y]],w[3*y+1]=a[3*t[y]+1],w[3*y+2]=a[3*t[y]+2],r.needNormal&&(b[3*y]=i[3*t[y]],b[3*y+1]=i[3*t[y]+1],b[3*y+2]=i[3*t[y]+2]),0===r.displayMode&&(_[2*y]=n[2*t[y]],_[2*y+1]=n[2*t[y]+1]);o.addAttribute("position",new h.BufferAttribute(w,3)),r.needNormal&&o.addAttribute("normal",new h.BufferAttribute(b,3)),0===r.displayMode&&o.addAttribute("uv",new h.BufferAttribute(b,2))}else o.setIndex(new h.BufferAttribute(t,1)),o.addAttribute("position",new h.BufferAttribute(a,3)),r.needNormal&&o.addAttribute("normal",new h.BufferAttribute(i,3)),0===r.displayMode&&o.addAttribute("uv",new h.BufferAttribute(n,2));return o.computeBoundingSphere(),o},d.GeometryCreator=function(){},d.GeometryCreator.prototype={create:function(e,t){var r=new h.Geometry;this.init_vertices(r,e,8,0);var n=this.init_uvs(e,8,3),i=this.init_normals(e,8,5);return this.init_faces(r,i,n,t),r.computeCentroids(),r},init_vertices:function(e,t,r,n){var i,o,a,s,l=t.length;for(i=n;i<l;i+=r)o=t[i],a=t[i+1],s=t[i+2],this.addVertex(e,o,a,s)},init_normals:function(e,t,r){var n,i,o,a,s=[],l=e.length;for(n=r;n<l;n+=t)i=e[n],o=e[n+1],a=e[n+2],s.push(i,o,a);return s},init_uvs:function(e,t,r){var n,i,o,a=[],s=e.length;for(n=r;n<s;n+=t)i=e[n],o=e[n+1],a.push(i,o);return a},init_faces:function(e,t,r,n){var i,o,a,s,l,u,c,h,d,f,p=n.length;for(i=0;i<p;i+=3)o=n[i],a=n[i+1],s=n[i+2],this.f3n(e,t,o,a,s,0,o,a,s),l=r[2*o],u=r[2*o+1],c=r[2*a],h=r[2*a+1],d=r[2*s],f=r[2*s+1],this.uv3(e.faceVertexUvs[0],l,u,c,h,d,f)},addVertex:function(e,t,r,n){e.vertices.push(new h.Vector3(t,r,n))},f3n:function(e,t,r,n,i,o,a,s,l){var u=t[3*a],c=t[3*a+1],d=t[3*a+2],f=t[3*s],p=t[3*s+1],m=t[3*s+2],v=t[3*l],g=t[3*l+1],y=t[3*l+2],b=new h.Vector3(u,c,d),_=new h.Vector3(f,p,m),w=new h.Vector3(v,g,y);e.faces.push(new h.Face3(r,n,i,[b,_,w],null,o))},uv3:function(e,t,r,n,i,o,a){var s=[];s.push(new h.Vector2(t,r)),s.push(new h.Vector2(n,i)),s.push(new h.Vector2(o,a)),e.push(s)}};var f={decodeOffsets:[-4095,-4095,-4095,0,0,-511,-511,-511],decodeScales:[1/8191,1/8191,1/8191,1/1023,1/1023,1/1023,1/1023,1/1023]};window.DEFAULT_DECODE_PARAMS=f,d.prototype.decompressAttribsInner_=function(e,t,r,n,i,o,a,s){for(var l=0,u=t;u<r;u++){var c=e.charCodeAt(u);l+=c>>1^-(1&c),n[i]=s*(l+a),i+=o}},d.prototype.decompressIndices_=function(e,t,r,n,i){for(var o=0,a=0;a<r;a++){var s=e.charCodeAt(t++);n[i++]=o-s,0===s&&o++}},d.prototype.decompressAABBs_=function(e,t,r,n,i){for(var o=6*r,a=t+o,s=0,l=new Float32Array(o),u=t;u<a;u+=6){var c=e.charCodeAt(u+0)+n[0],h=e.charCodeAt(u+1)+n[1],d=e.charCodeAt(u+2)+n[2],f=e.charCodeAt(u+3)+1>>1,p=e.charCodeAt(u+4)+1>>1,m=e.charCodeAt(u+5)+1>>1;l[s++]=i[0]*(c+f),l[s++]=i[1]*(h+p),l[s++]=i[2]*(d+m),l[s++]=i[0]*f,l[s++]=i[1]*p,l[s++]=i[2]*m}return l},d.prototype.decompressMesh=function(e,t,r,n,i,o){for(var a=r.decodeScales.length,s=r.decodeOffsets,l=r.decodeScales,u=t.attribRange[0],c=t.attribRange[1],h=u,d=new Float32Array(a*c),f=0;f<a;f++){var p=h+c,m=l[f],v=s[f];m&&(f<3&&(m=1,v=0),this.decompressAttribsInner_(e,h,p,d,f,a,v,m)),h=p}var g=3*t.indexRange[1],y=new Uint16Array(g);this.decompressIndices_(e,h,g,y,0);var b=null,_=t.bboxes;return _&&(b=this.decompressAABBs_(e,_,t.names.length,s,l)),[n,i,d,y,b,r]},d.prototype.copyAttrib=function(e,t,r,n){for(var i=0;i<e;i++)r[i]=t[e*n+i]},d.prototype.decodeAttrib2=function(e,t,r,n,i,o,a,s,l,u){for(var c=0;c<5;c++){var h=e.charCodeAt(i+o*c+u),d=h>>1^-(1&h);l[c]+=d,s[t*u+c]=l[c],a[t*u+c]=n[c]*(l[c]+r[c])}},d.prototype.accumulateNormal=function(e,t,r,n,i){var o=n[8*e],a=n[8*e+1],s=n[8*e+2],l=n[8*t],u=n[8*t+1],c=n[8*t+2],h=n[8*r],d=n[8*r+1],f=n[8*r+2];l-=o,u-=a,c-=s,h-=o,d-=a,f-=s,o=u*f-c*d,a=c*h-l*f,s=l*d-u*h,i[3*e]+=o,i[3*e+1]+=a,i[3*e+2]+=s,i[3*t]+=o,i[3*t+1]+=a,i[3*t+2]+=s,i[3*r]+=o,i[3*r+1]+=a,i[3*r+2]+=s},d.prototype.decompressMesh2=function(e,t,r,n,i,o){var a,s,l=r.decodeScales.length,u=r.decodeOffsets,c=r.decodeScales,h=t.attribRange[0],d=t.attribRange[1],f=t.codeRange[0],p=3*t.codeRange[2],m=new Uint16Array(p),v=new Int32Array(3*d),g=new Uint16Array(l),y=new Uint16Array(l*d),b=new Float32Array(l*d),_=0,w=0;for(a=0;a<p;a+=3){var x=e.charCodeAt(f++),M=Math.min(a,96);if(x<M){var E,A,T,k=x%3,S=a-(x-k);switch(k){case 0:E=m[S+2],A=m[S+1],T=m[S+0];break;case 1:E=m[S+0],A=m[S+2],T=m[S+1];break;case 2:E=m[S+1],A=m[S+0],T=m[S+2]}m[w++]=E,m[w++]=A,x=e.charCodeAt(f++);var C=_-x;if(m[w++]=C,0===x){for(s=0;s<5;s++){var P=e.charCodeAt(h+d*s+_),O=(P>>1^-(1&P))+y[l*E+s]+y[l*A+s]-y[l*T+s];g[s]=O,y[l*_+s]=O,b[l*_+s]=c[s]*(O+u[s])}_++}else this.copyAttrib(l,y,g,C)}else{var R=_-(x-M);m[w++]=R,x===M?this.decodeAttrib2(e,l,u,c,h,d,b,y,g,_++):this.copyAttrib(l,y,g,R),x=e.charCodeAt(f++);var L=_-x;m[w++]=L,0===x?this.decodeAttrib2(e,l,u,c,h,d,b,y,g,_++):this.copyAttrib(l,y,g,L),x=e.charCodeAt(f++);var I=_-x;if(m[w++]=I,0===x){for(s=0;s<5;s++)g[s]=(y[l*R+s]+y[l*L+s])/2;this.decodeAttrib2(e,l,u,c,h,d,b,y,g,_++)}else this.copyAttrib(l,y,g,I)}}for(a=0;a<d;a++){var B=v[3*a],D=v[3*a+1],j=v[3*a+2],z=511/Math.sqrt(B*B+D*D+j*j),N=e.charCodeAt(h+5*d+a),U=e.charCodeAt(h+6*d+a),F=e.charCodeAt(h+7*d+a);b[l*a+5]=z*B+(N>>1^-(1&N)),b[l*a+6]=z*D+(U>>1^-(1&U)),b[l*a+7]=z*j+(F>>1^-(1&F))}o(n,i,b,m,void 0,t)},d.prototype.downloadMesh=function(e,t,r,n,i){function o(e,o){for(;u<r.length;){var l=r[u],c=l.indexRange;if(c){if(a=c[0]+3*c[1],e.responseText.length<a)break;s.decompressMesh(e.responseText,l,n,t,u,i)}else{var h=l.codeRange;if(a=h[0]+h[1],e.responseText.length<a)break;s.decompressMesh2(e.responseText,l,n,t,u,i)}++u}}var a,s=this,u=0;l(e,function(e,t){200!==e.status&&0!==e.status||o(e,t)})},d.prototype.downloadMeshes=function(e,t,r,n){for(var i in t){var o=t[i];this.downloadMesh(e+i,i,o,r,n)}},d.prototype.createMeshCallbackSync=function(e,t){return p},d.prototype.createMeshCallback=function(e,t,r){function n(e){if(!h.Math.isPowerOfTwo(e.width)||!h.Math.isPowerOfTwo(e.height)){var t=document.createElement("canvas");return t.width=i(e.width),t.height=i(e.height),t.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),t}return e}function i(e){--e;for(var t=1;t<32;t<<=1)e|=e>>t;return e+1}var o=0,a=0,s={},l={},u={},c=t.urls;for(var f in c)s[f]=c[f].length,l[f]=0,a++,u[f]=new h.Object3D;var p=new h.Object3D,m=new d.GeometryCreator,v=new d.BufferGeometryCreator;return function(i,c,d,f,g,y){var b,_,w;w=void 0===t.options.useBuffers||t.options.useBuffers?v.create(d,f,t.options):m.create(d,f);var x={};if(0===t.options.displayMode)for(var M in t.materials){var E=t.materials[M],A=new Image,T=new h.Texture(A);x.name=M,x.map=T,_=new h.MeshPhongMaterial(x),b=new h.Mesh(w,_),u[i].add(b);for(var k in E){var S=E[k];t.options.isMobile&&(S=S.split(".")[0]+"_m."+S.split(".")[1]);var C=e+S,P=new h.ImageLoader;P.load(C,function(e){T.image=n(e),T.needsUpdate=!0,++l[i]===s[i]&&(o++,p.add(u[i]),o===a&&r(p))})}}0!==t.options.displayMode&&(_=new h.MeshPhongMaterial(x),b=new h.Mesh(w,_),u[i].add(b),++l[i]===s[i]&&(o++,p.add(u[i]),o===a&&r(p)))}};var p=function(e,t,r,n,a,s,l,u,c,f,p,m,v,g,y){for(var b=f.decodeScales,_=f.decodeOffsets,w=v,x=[],M=0;M<3;M++)x[M]=b[M]*_[M];var E=new h.Matrix4;E.multiply((new h.Matrix4).makeTranslation(x[0],x[1],x[2])).multiply((new h.Matrix4).makeScale(b[0],b[1],b[2]));var A=(new d.BufferGeometryCreator).create(l,u,e.options),T={},k=e.urls[a][s].material;if(0===e.options.displayMode){var S=e.materials[k];T.name=k;var C=A.attributes.normal;if("map_Kd"in S){var P=S.map_Kd;P in t&&(T.map=t[P])}else if("Kd"in S){var O=S.Kd;T.color="rgb("+O[0]+", "+O[1]+", "+O[2]+")"}if("Ka"in S&&C){var R=S.Ka;T.emissive="rgb("+R[0]+", "+R[1]+", "+R[2]+")"}if("map_Ks"in S&&C){var L=S.map_Ks;L in t&&(T.specularMap=t[L])}else if("Ks"in S&&C){var I=S.Ks;T.specular="rgb("+I[0]+", "+I[1]+", "+I[2]+")"}if("d"in S){var B=S.d;T.opacity=B}if("Ns"in S&&C){var D=S.Ns;T.shininess=D}var j=null;if(C)j=new h.MeshPhongMaterial(T);else{var z={};for(var N in T)"shininess"!==N&&"specular"!==N&&"emissive"!==N&&(z[N]=T[N]);j=new h.MeshBasicMaterial(z)}m.push(j);var U=o(p);p=i(p,A);var F=o(A);if(p.addGroup(U,F,m.length-1),m.length===w){e={};var H=null;H=w>1?m:j;var V=new h.Mesh(p,H);V.applyMatrix(E);var G=new h.Object3D;G.add(V),n.add(G),g(n)}}else if(0!==e.options.displayMode){var W={};for(var X in T)"shininess"!==X&&"specular"!==X&&"emissive"!==X&&(W[X]=T[X]);var Y=new h.MeshBasicMaterial(W);m.push(Y);var q=o(p);p=i(p,A);var K=o(A);if(p.addGroup(q,K,m.length-1),m.length===w){e={};var Z=null;Z=w>1?m:Y;var Q=new h.Mesh(p,Z);Q.applyMatrix(E);var J=new h.Object3D;J.add(Q),n.add(J),g(n)}}};d.prototype.decodeModel=function(e,t,r){var n={},i=e.urls,o=new h.Object3D;for(var l in i)n[l]=new h.Object3D;var u=[],c={};for(var d in e.materials){var f=e.materials[d];f.hasOwnProperty("map_Kd")&&function(){var t=f.map_Kd;u.push(s(e[t]).then(function(e){e.wrapS=h.RepeatWrapping,e.wrapT=h.RepeatWrapping,e.needsUpdate=!0,c[t]=e}))}()}var m=this;Promise.all(u).then(function(){var s=e.decodeParams,l=new h.BufferGeometry,u=[],d=a(e);for(var f in i)for(var v=i[f],g=0;g<v.length;){var y=v[g],b=y.indexRange,_=e[f];if(b){var w=b[0]+3*b[1];if(_.length<w)break;y.decodeParam&&(s=y.decodeParam);var x=m.decompressMesh(_,y,s,f,g);setTimeout(p(e,c,n,o,x[0],x[1],x[2],x[3],x[4],x[5],l,u,d,t,r),10)}++g}}).catch(function(e){console.log("Error in loading textures",e)})},d.prototype.downloadModel=function(e,t,r,n){var i=this.createMeshCallback(t,r,n);this.downloadMeshes(e,r.urls,r.decodeParams,i)},d.prototype.downloadModelJson=function(e,t,r){u(e,function(n){n.decodeParams||(t&&t.decodeParams?n.decodeParams=t.decodeParams:n.decodeParams=f),n.options=t;var i=e.substr(0,e.lastIndexOf("/")+1),o=i;t&&t.geometryBase&&(i=t.geometryBase,"/"!==i.charAt(i.length-1)&&(i+="/")),t&&t.materialBase&&(o=t.materialBase,"/"!==o.charAt(o.length-1)&&(o+="/")),this.downloadModel(i,o,n,r)}.bind(this))},t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(26),s=n(a),l=r(45),u=n(l),c=function(){function e(t){i(this,e),this.limit=t||66,this.cache=new s.default(t),this.debug=!1,this.stat={hit:0,miss:0};var r=this;this.cache.shift=function(){var e=s.default.prototype.shift.call(this);return r.debug&&console.log("cache shift",e.value),e.value.detach(),e},this.cache.removeAll=function(){for(var e=t+1;r.cache.head&&e>=0;)r.cache.shift(),e--;return e>=0||(console.error("cache removeAll error"),!1)}}return o(e,[{key:"destruct",value:function(){var e=!0;return e=e&&this.cache.removeAll(),this.cache=void 0,this.stat=void 0,e||console.warn("TileCache destruct failed"),e}},{key:"info",value:function(){return{hit_rate:this.stat.hit+this.stat.miss===0?0:this.stat.hit/(this.stat.hit+this.stat.miss),size:this.cache.size}}},{key:"getByEntry",value:function(e){var t=this.debug,r=this;if(void 0===e||void 0===e.layer||void 0===e.entityOptions)return Promise.reject(new Error("AltizureMeshEntityCache invalid getByEntry params"));var n=e.layer,i=e.entityOptions,o=function(e){return e.PID}(i),a=this.cache.get(o);return void 0===a?(t&&console.log("miss"),function(){return a=new u.default(n,i),r.cache.put(o,a),r.stat.miss++,Promise.resolve(a)}()):(t&&console.log("hit"),function(){return r.stat.hit++,Promise.resolve(a)}())}}]),e}();t.default=c},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){n(this,e),this.id=null,this.name=null,this.views=null,this.owner={},this.owner.name=null,this.owner.joined=null,this.date=null,this.geoInfo={},this.geoInfo.autoAligned=null,this.geoInfo.minLat=null,this.geoInfo.minLong=null,this.geoInfo.maxLat=null,this.geoInfo.maxLong=null,this.geoInfo.centerLat=null,this.geoInfo.centerLong=null,this.versionControl=null,this.cloudPath=null,this.modelTransform=null}return i(e,[{key:"destruct",value:function(){this.id=null,this.name=null,this.views=null,this.owner.name=null,this.owner.joined=null,this.owner={},this.date=null,this.geoInfo.autoAligned=null,this.geoInfo.minLat=null,this.geoInfo.minLong=null,this.geoInfo.maxLat=null,this.geoInfo.maxLong=null,this.geoInfo.centerLat=null,this.geoInfo.centerLong=null,this.geoInfo={},this.versionControl=null,this.cloudPath=null,this.modelTransform.origin=null,this.modelTransform.xDir=null,this.modelTransform.yDir=null,this.modelTransform.zDir=null,this.modelTransform.minBound=null,this.modelTransform.maxBound=null,this.modelTransform.xTiles=null,this.modelTransform.yTiles=null,this.modelTransform.zTiles=null,this.modelTransform.floorHeight=null,this.modelTransform.onLoadTrans=null,this.modelTransform.lengthUnitToMeter=null,this.modelTransform={}}},{key:"loadInfo",value:function(){}},{key:"valid",get:function(){for(var e=["id","name","views","owner","date","geoInfo","versionControl","cloudPath","modelTransform"],t=0;t<e.length;t++)if(null===this[e[t]])return!1;e=Object.keys(this.owner);for(var r=0;r<e.length;r++)if(null===this.owner[e[r]])return!1;e=Object.keys(this.geoInfo);for(var n=0;n<e.length;n++)if(null===this.geoInfo[e[n]])return!1;e=Object.keys(this.modelTransform);for(var i=0;i<e.length;i++)if(null===this.modelTransform[e[i]])return console.error("invalid AltizureProjectInfo attribute this.modelTransform[",e[i],"]=",this[e[i]]),!1;var o=Math.max(Math.abs(this.geoInfo.maxLat-this.geoInfo.minLat),Math.abs(this.geoInfo.maxLong-this.geoInfo.minLong));return!(o>2&&(console.warn("Unusual large(",o,") project ",this.name,this.id),1))}}]),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e,t,r){var i=document.createElement("canvas");i.width=e,i.height=t,this.canvas=i,this.style=r||{},this.style={margin:void 0===this.style.margin?.05*i.width:this.style.margin};var o=i.getContext("2d");this.context=o;var a=new n.Texture(i);this.texture=a,this.cursorY=0};i.prototype.clear=function(e){return void 0!==e?(this.context.fillStyle=e,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)):this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.texture.needsUpdate=!0,this},i.prototype.drawText=function(e,t,r,n,i){if(void 0!==i&&(this.context.font=i),void 0===t||null===t){var o=this.context.measureText(e);t=(this.canvas.width-o.width)/2}return this.context.fillStyle=n,this.context.strokeStyle="black",this.context.lineJoin="round",this.context.fillText(e,t,r),this.context.lineWidth=1,this.context.strokeText(e,t,r),this.context.fill(),this.context.stroke(),this.texture.needsUpdate=!0,this},i.prototype.drawTextCooked=function(e){var t=this,r=this.context,n=this.canvas;e=e||{};var i=e.text,o={margin:void 0!==e.margin?e.margin:0,lineHeight:void 0!==e.lineHeight?e.lineHeight:.1,align:void 0!==e.align?e.align:"center",fillStyle:void 0!==e.fillStyle?e.fillStyle:"black",font:void 0!==e.font?e.font:"bold 102.4px Arial",outlineWidth:void 0!==e.outlineWidth?2*e.outlineWidth:2,outlineStyle:void 0!==e.outlineStyle?e.outlineStyle:"black",resetCursorY:void 0===e.resetCursorY||e.resetCursorY,trimText:void 0===e.trimText||e.trimText},a=o.lineHeight,s=o.margin;o.lineHeight<1&&(a=o.lineHeight*n.height),o.margin<1&&(s=o.margin*n.height),console.assert("string"==typeof i),r.save(),r.fillStyle=o.fillStyle,r.lineJoin="round",r.font=o.font,r.textBaseline="top";var l=s+this.style.margin;o.resetCursorY||(l=this.cursorY+s);do{var u="";u=o.trimText?function(e){var i="",o=n.width-2*t.style.margin-2*s;if(r.measureText(e).width<o)return e.substr(0,e.length);var a=e.length-1;i=e.substr(0,a)+" ...";for(var l=r.measureText(i).width;a>0&&l>3*o;)a/=2,i=e.substr(0,a)+" ...",l=r.measureText(i).width;for(;a>0&&l>o;)a-=1,i=e.substr(0,a)+" ...",l=r.measureText(i).width;return i}(i):function(e){for(var i="",o=n.width-2*t.style.margin-2*s;i.length!==e.length&&!(r.measureText(i).width>o);)i+=e.substr(i.length,1);return i}(i),i=i.substr(u.length);var c=r.measureText(u),h=0;"left"===o.align?h=s+this.style.margin:"right"===o.align?h=n.width-s-c.width-this.style.margin:"center"===o.align?h=(n.width-c.width)/2:console.assert(!1),this.context.lineWidth=Math.max(1,o.outlineWidth),this.context.strokeStyle="black",this.context.strokeText(u,h,l),this.context.fillText(u,h,l),l+=a}while(i.length>0&&!o.trimText);return r.restore(),this.cursorY=l,this.texture.needsUpdate=!0,this},i.prototype.drawImage=function(){return this.context.drawImage.apply(this.context,arguments),this.texture.needsUpdate=!0,this},i.prototype.drawRectangle=function(e,t,r,n,i){return i=i||{},i={outlineWidth:i.outlineWidth||2,outlineStyle:i.outlineStyle||"rgb(0, 0, 0)",fillStyle:i.fillStyle||null},this.context.save(),null!==i.fillStyle&&(this.context.fillStyle=i.fillStyle,this.context.fillRect(e,t,r,n)),i.outlineWidth>0&&(this.context.strokeStyle=i.outlineStyle,this.context.lineWidth=i.outlineWidth,this.context.strokeRect(e,t,r,n)),this.context.restore(),this.texture.needsUpdate=!0,this},i.prototype.drawCircle=function(e,t,r,n){return n=n||{},n={outlineWidth:void 0===n.outlineWidth?2:2*n.outlineWidth,outlineStyle:void 0===n.outlineStyle?"rgb(0, 0, 0)":n.outlineStyle,fillStyle:void 0===n.fillStyle?null:n.fillStyle},this.context.save(),this.context.arc(e,t,r,0,2*Math.PI),n.outlineWidth>0&&(this.context.strokeStyle=n.outlineStyle,this.context.lineWidth=n.outlineWidth,this.context.stroke()),null!==n.fillStyle&&(this.context.fillStyle=n.fillStyle,this.context.fill()),this.context.restore(),this.texture.needsUpdate=!0,this},t.default=i},function(e,t,r){"use strict";function n(e,t,r,n){return t.degree--,e.next===e?t.child=void 0:t.child=e.next,a(e),r=l(r,e,n),e.isMarked=!1,r}function i(e,t,r){var o=e.parent;return o&&(e.isMarked?(t=n(e,o,t,r),t=i(o,t,r)):e.isMarked=!0),t}function o(e,t){for(var r=[],n=new d(e);n.hasNext();){for(var i=n.next();r[i.degree];){if(t(i,r[i.degree])>0){var o=i;i=r[i.degree],r[i.degree]=o}s(r[i.degree],i,t),r[i.degree]=void 0,i.degree++}r[i.degree]=i}e=void 0;for(var a=0;a<r.length;a++)r[a]&&(r[a].next=r[a],r[a].prev=r[a],e=l(e,r[a],t));return e}function a(e){var t=e.prev,r=e.next;t.next=r,r.prev=t,e.next=e,e.prev=e}function s(e,t,r){a(e),t.child=l(e,t.child,r),e.parent=t,e.isMarked=!1}function l(e,t,r){if(e||t){if(!e)return t;if(!t)return e;var n=e.next;return e.next=t.next,e.next.prev=e,t.next=n,t.next.prev=t,r(e,t)<0?e:t}}function u(e){var t=0,r=e;do{t++,r.child&&(t+=u(r.child)),r=r.next}while(r!==e);return t}function c(e,t){this.key=e,this.value=t,this.prev=this,this.next=this,this.degree=0,this.parent=void 0,this.child=void 0,this.isMarked=void 0}Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){this.minNode=void 0,this.nodeCount=0,e&&(this.compare=e)};h.prototype.clear=function(){this.minNode=void 0,this.nodeCount=0},h.prototype.decreaseKey=function(e,t){if(void 0===e)throw new Error("Cannot decrease key of non-existent node");if(this.compare({key:t},{key:e.key})>0)throw new Error("New key is larger than old key");e.key=t;var r=e.parent;r&&this.compare(e,r)<0&&(n(e,r,this.minNode,this.compare),i(r,this.minNode,this.compare)),this.compare(e,this.minNode)<0&&(this.minNode=e)},h.prototype.delete=function(e){var t=e.parent;t&&(n(e,t,this.minNode,this.compare),i(t,this.minNode,this.compare)),this.minNode=e,this.extractMinimum()},h.prototype.extractMinimum=function(){var e=this.minNode;if(e){if(e.child){var t=e.child;do{t.parent=void 0,t=t.next}while(t!==e.child)}var r;e.next!==e&&(r=e.next),a(e),this.nodeCount--,this.minNode=l(r,e.child,this.compare),r&&(this.minNode=r,this.minNode=o(this.minNode,this.compare))}return e},h.prototype.findMinimum=function(){return this.minNode},h.prototype.insert=function(e,t){var r=new c(e,t);return this.minNode=l(this.minNode,r,this.compare),this.nodeCount++,r},h.prototype.isEmpty=function(){return void 0===this.minNode},h.prototype.size=function(){return this.isEmpty()?0:u(this.minNode)},h.prototype.union=function(e){this.minNode=l(this.minNode,e.minNode,this.compare),this.nodeCount+=e.nodeCount},h.prototype.compare=function(e,t){return e.key>t.key?1:e.key<t.key?-1:0};var d=function(e){this.items=[];var t=e;do{this.items.push(t),t=t.next}while(e!==t)};d.prototype.hasNext=function(){return this.items.length>0},d.prototype.next=function(){return this.items.shift()},t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){var r=document.createElement("div");r.id="widget_load";var n=document.createElement("div");return n.id="loadText",n.innerHTML="Loading : 0%",n.style.cssText="color:#"+t.toString(16)+";",r.appendChild(n),{domElement:r,update:function(){var t=e.smart_options.loading.total,r=e.smart_options.loading.left;n.innerHTML=0===r?"Loading complete.":t<=0?"Loading complete.":"Loading : "+Math.max(10,((t-r)/t*100).toFixed(2))+"%"}}};t.default=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(29),o=n(i),a=r(27),s=n(a),l=function(e,t,r){var n=document.createElement("div");n.id="monitor",n.style.cssText="width:180px;opacity:0.9;cursor:pointer;background-color:#002";var i="padding:0 0 3px 3px;text-align:left;position:relative;color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;line-height:15px",a=o.default.createDiv,l=a(n,"sceneText",i,"Scene: 0"),u=a(n,"cacheText",i,"Cache: 0"),c=a(n,"visText",i,"Vis: 0"),h=a(n,"loadText",i,"Load: 0"),d=a(n,"sceneTriText",i,"Scene Tri.: 0"),f=a(n,"sceneVerText",i,"Scene Ver.: 0"),p=a(n,"visTriText",i,"Vis Tri.: 0"),m=a(n,"visVerText",i,"Vis Ver.: 0"),v=a(n,"tile",i,"Tile: "),g=a(n,"",i,"Programs: "),y=a(n,"",i,"Geometries: "),b=a(n,"",i,"Textures: "),_=a(n,"",i,"Draw calls: "),w=a(n,"",i,"Points: "),x=a(n,"",i,"Vertices: "),M=a(n,"",i,"Faces: "),E=function(){for(var t=0,r=0,n=0,i=0,o=0,a=0,l=0;l<e.children.length;++l)o=s.default.getNumOfFaces(e.children[l]),a=s.default.getNumOfVertices(e.children[l]),t+=o,r+=a,e.children[l].visible&&(n+=o,i+=a);d.innerHTML="Scene Tri.: "+t,f.innerHTML="Scene Ver.: "+r,p.innerHTML="Vis Tri.: "+n,m.innerHTML="Vis Ver.: "+i},A=function(){g.innerHTML="Programs: "+r.info.programs.length,y.innerHTML="Geometries: "+r.info.memory.geometries,b.innerHTML="Textures: "+r.info.memory.textures,_.innerHTML="Draw calls: "+r.info.render.calls,w.innerHTML="Points: "+r.info.render.points,x.innerHTML="Vertices: "+r.info.render.vertices,M.innerHTML="Faces: "+r.info.render.faces};return{domElement:n,update:function(){l.innerHTML="Scene: "+e.children.length,u.innerHTML="Cache: "+t.tile_retriever.cacheSize();for(var r=0,n=0;n<e.children.length;++n)e.children[n].visible&&r++;c.innerHTML="Vis: "+r,h.innerHTML="Load: "+t.smart_options.loading.total,E(),A()},updateTileName:function(e){v.innerHTML="Tile: "+e}}};t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(26),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(e){var t=e.limit||500;this.debug=!1,this.cache=new o.default(t),this.loadFunc=e.loadFunc,this.display_lod=!1,"boolean"==typeof e.display_lod&&(this.display_lod=e.display_lod);var r=this;this.cache.shift=function(){var e=o.default.prototype.shift.call(this);return this.debug&&console.log("cache shift",e.value),r.releaseMemory(e.value),e},this.cache.removeAll=function(){for(var e=t+1;r.cache.head&&e>=0;)r.cache.shift(),e--;return e>=0||(console.warn("cache removeAll error"),!1)},this.stat={hit:0,miss:0}};a.prototype.destruct=function(){var e=!0;return this.loadFunc=void 0,e=e&&this.cache.removeAll(),this.cache=void 0,this.stat=void 0,e||console.warn("TileCache destruct failed"),e},a.prototype.releaseMemory=function(e){this.debug&&console.log("releasing",e),this.debug&&e.debug_info&&console.log("releasing",JSON.stringify(e.debug_info));try{e.geometry.dispose(),e.geometry=null}catch(e){console.warn("dispose geometry failed")}try{e.material.map&&(e.material.map.dispose(),e.material.map=void 0)}catch(e){console.warn("can not re-allocate texture")}try{e.material.dispose(),e.material=null}catch(e){console.war("dispose material failed")}return e=null},a.prototype.loadByURL=function(e){},a.prototype.info=function(){return{hit_rate:this.stat.hit+this.stat.miss===0?0:this.stat.hit/(this.stat.hit+this.stat.miss),size:this.cache.size}},a.prototype.getSize=function(){return this.cache.size},a.prototype.get=function(e){function t(e){return new Promise(function(t){return setTimeout(t,e)})}function r(e){var t=new n.BoxGeometry(1,1,1);t.vertices[0]=e.boundingBox[6].clone(),t.vertices[1]=e.boundingBox[2].clone(),t.vertices[2]=e.boundingBox[5].clone(),t.vertices[3]=e.boundingBox[1].clone(),t.vertices[4]=e.boundingBox[3].clone(),t.vertices[5]=e.boundingBox[7].clone(),t.vertices[6]=e.boundingBox[0].clone(),t.vertices[7]=e.boundingBox[4].clone();var r=s.debug||s.display_lod?new n.MeshPhongMaterial({color:function(e){var t=1e4*Math.sin(e++);return 16777215*(t-Math.floor(t))}(e.level+e.x+e.y)}):new n.MeshPhongMaterial({opacity:0,transparent:!0});return new n.Mesh(t,r)}function i(e){var t=new n.BoxGeometry(1,1,1);t.vertices[0]=e.boundingBox[2].clone(),t.vertices[1]=e.boundingBox[2].clone(),t.vertices[2]=e.boundingBox[1].clone(),t.vertices[3]=e.boundingBox[1].clone(),t.vertices[4]=e.boundingBox[3].clone(),t.vertices[5]=e.boundingBox[3].clone(),t.vertices[6]=e.boundingBox[0].clone(),t.vertices[7]=e.boundingBox[0].clone();var r=s.debug||s.display_lod?new n.MeshPhongMaterial({color:function(e){var t=1e4*Math.sin(e++);return 16777215*(t-Math.floor(t))}(e.level+e.x+e.y)}):new n.MeshPhongMaterial({opacity:0,transparent:!0});return new n.Mesh(t,r)}var o=function(t){return e.level+"_"+e.x+"_"+e.y}(),a=this.cache.get(o),s=this,l=s.debug;return l&&console.log("get",o),void 0===a?(l&&console.log("miss"),function(){return s.display_lod?(a=r(e),s.cache.put(o,a),s.stat.miss++,t(Math.random()%10).then(function(){return Promise.resolve(a)})):(s.stat.miss++,s.loadFunc(e).then(function(e){var t=s.cache.get(o);return t?(l&&console.warn("duplicated copy arrived"),s.releaseMemory(e),e=t):s.cache.put(o,e),Promise.resolve(e)}).catch(function(t){var r=s.cache.get(o);return l&&console.warn("loadFunc failed:",t),r?(l&&console.warn("IMPORTANT: 1st copy is success but 2nd copy fail"),Promise.resolve(r)):e.expired?Promise.resolve():"not found"===t?(a=i(e),a.place_holder=!0,a.visible=!1,s.cache.put(o,a),Promise.resolve(a)):Promise.reject(t)}))}()):(l&&console.log("hit"),function(){return s.stat.hit++,Promise.resolve(a)}())},t.default=a},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,r){function n(e){return Promise.race([e,new Promise(function(e,t){setTimeout(function(){t("Time out")},f)})])}function i(e){function r(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}return t?r(e.level)&&r(e.x)&&r(e.y)?t.get(e):(console.warn("getTile error",e),Promise.reject("unrecognize tile_info, "+JSON.stringify(e.info()))):Promise.reject("tile_cache is already destructed.")}var o=r.capacity,a=0,s=this,l=r.debug;s.info=function(){return{capacity:o,size:a}},s.fill=function(){var t=e;if(t)for(var r=o-a;r>0&&!t.isEmpty();){var n=t.dequeue();s.send(n),r=o-a}},s.send=function(e){a++,l&&e.tile.expired&&console.warn("sending an expired node",e.tile),n(i(e.tile)).then(function(t){e.callback(t,e.session),a--,s.fill()}).catch(function(e){l&&console.warn("get tile",e,"will try to load next time"),a--,s.fill()})}}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(28),l=n(s),u=r(101),c=n(u),h=r(22),d=n(h),f=6e6,p=function(){function e(){var t=this;i(this,e),r.p="/js/";var n=r(62);this.worker=new n,this.listeners=new Map,this.worker.onmessage=function(e){var r=e.data.filename;if(t.listeners.has(r)){var n=t.listeners.get(r);t.listeners.delete(r),200!==e.data.status&&404!==e.data.status&&0!==e.data.status&&console.warn("bundle load suffers error",e),n.map(function(t){t(null,e.data)})}else console.warn("Worker cannot find callback for tile",r)},this.worker.onError=function(e){for(var t=0;t<1e4;t++)console.warn("Worker runtime error",e.message)}}return a(e,[{key:"terminate",value:function(){if(this.worker)try{this.worker.terminate()}catch(e){return console.error("LoaderThread terminate failed",e),!1}return!0}},{key:"scheduleLoad",value:function(e){function t(e,t){return e.substr(0,t.length)===t}var r=this,n=e.fileName();return new Promise(function(i,o){var a=function(e,t){e?o(e):i(t)};if(r.listeners.has(n)){var s=r.listeners.get(n);s.push(a),r.listeners.set(n,s)}else{r.listeners.set(n,[a]);var l=e.basepath;t(l,"/")&&(l=window.location.protocol+"//"+window.location.host+l);var u={filename:n,path:l+n+".ab"};r.worker.postMessage(u)}})}}]),e}(),m=function(){function e(t){i(this,e),this.debug=t.debug;var r=d.default.detectIE();if(r&&(r=r<=11),r&&console.warn("You are using an old IE browser. Upgrade to IE 12 or later to get best viewing experience."),this.allowWorker=!r&&(t.allow_worker||!1),this.allowWorker)try{this.worker=new p}catch(e){console.error("Cannot initiate web worker",e),this.allowWorker=!1,this.worker=null}this.wait_queue=new l.default,this.tile_cache=new c.default({limit:t.cache_size,debug:this.debug,display_lod:t.display_lod,loadFunc:this.loadTile.bind(this)}),this.dock=new o(this.wait_queue,this.tile_cache,{capacity:t.dock_capacity,debug:this.debug}),this.status="working"}return a(e,[{key:"destruct",value:function(){var e=!0;return this.status="destructing",this.wait_queue.clear(),this.wait_queue=void 0,this.allowWorker&&this.worker&&(e=e&&this.worker.terminate(),this.worker=void 0),e=e&&this.tile_cache.destruct(),this.tile_cache=void 0,this.dock=void 0,e||console.warn("TileRetriever destruct failed."),this.status="destructed",e}},{key:"loadTile",value:function(e){return"working"!==this.status?Promise.reject("TileRetriever destructing"):(e.trial=0,this.worker?this.worker.scheduleLoad(e).then(function(t){return e.onWorkerLoad(t)}):e.tileLoader())}},{key:"info",value:function(){return{cache:this.tile_cache.info(),queue:this.wait_queue.getLength(),dock:this.dock.info()}}},{key:"cacheSize",value:function(){return this.tile_cache.getSize()}},{key:"request",value:function(e,t,r){if("working"!==this.status)return void console.warn("TileRetriever destructing",e.info(),"request failed");this.wait_queue.enqueue({tile:e,session:t,callback:r}),this.dock.fill()}},{key:"clear",value:function(){this.debug&&this.wait_queue.getLength()>0&&console.log("clear wait queue length",this.wait_queue.getLength()),this.wait_queue.clear()}}]),e}();t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){this.toys=[]};i.prototype={constructor:i,Toys:function(){return this.toys},AddToy:function(e){this.toys.push(e),console.log("add toy, # ",this.toys.length)},ClearToys:function(){for(var e=this.toys.length;e--;)this.toys[e].Data()instanceof n.Mesh&&this.toys[e].render();this.toys=[]},Water:function(){for(var e=this.Toys().length;e--;)if("water"===this.Toys()[e].Category())return this.Toys()[e];return null},UpdateWater:function(e){for(var t=this.Toys().length;t--;)if("water"===this.Toys()[t].Category())return this.Toys()[t]=e,!0;return!1},update:function(){for(var e=this.toys.length;e--;)this.toys[e].update()}},t.default=i},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=r(24),a=n(o),s=r(10),l=n(s),u=function(e,t,r){this.REQUIRED_FIELDS=["origin","x_dir","y_dir","z_dir","max_bound","min_bound","x_tiles","y_tiles","z_tiles","camera_pos","onload_trans","maxDistance","minDistance","maxPanDistance","maxPolarAngle"],this.OPTIONAL_FIELDS=["center_pos","centerPan","grid_step","level_start","total_level","min_area","lru_size","length_unit_to_meter","floor_height","useLowTexture","extra","display_mode","mode","enableLighting"],Object.freeze(this.REQUIRED_FIELDS),Object.freeze(this.OPTIONAL_FIELDS),this.isMobile=t,this.tile_salt=r,this.transformation=new a.default};u.prototype.load=function(e,t,r){var n=this,o=n.isMobile?e+"info_m.txt":e+"info.txt";(0,l.default)({method:"get",url:o}).then(function(e){for(var r=e.data,a=0;a<n.REQUIRED_FIELDS.length;a++){var s=n.REQUIRED_FIELDS[a];r.hasOwnProperty(s)||console.error("Missing field in "+o+": "+s)}n.origin=new i.Vector3(r.origin.x,r.origin.y,r.origin.z),n.x_dir=new i.Vector3(r.x_dir.x,r.x_dir.y,r.x_dir.z),n.y_dir=new i.Vector3(r.y_dir.x,r.y_dir.y,r.y_dir.z),n.z_dir=new i.Vector3(r.z_dir.x,r.z_dir.y,r.z_dir.z),n.max_bound=new i.Vector3(r.max_bound.x,r.max_bound.y,r.max_bound.z),n.min_bound=new i.Vector3(r.min_bound.x,r.min_bound.y,r.min_bound.z),n.x_tiles=r.x_tiles,n.y_tiles=r.y_tiles,n.z_tiles=r.z_tiles,n.camera_pos=r.camera_pos,n.center_pos=r.hasOwnProperty("center_pos")?r.center_pos:new i.Vector3(0,0,0),n.grid_step=r.grid_step,n.centerPan=r.centerPan,n.maxDistance=Number(r.maxDistance),n.maxPanDistance=r.maxPanDistance,n.maxPolarAngle=r.maxPolarAngle,n.minDistance=Number(r.minDistance),n.mode=r.mode,n.extra=r.extra,n.enableLighting=/true/i.test(r.enableLighting),n.clampZoomDistance=r.clampZoomDistance+""!="false",n.minLevel=r.hasOwnProperty("level_start")?r.level_start:0,n.maxLevel=r.hasOwnProperty("total_level")?r.total_level:Math.ceil(Math.log(Math.max(r.x_tiles,r.y_tiles))/Math.LN2),n.min_area=r.hasOwnProperty("min_area")?r.min_area:.01,n.lru_size=r.hasOwnProperty("lru_size")?r.lru_size:500,n.length_unit_to_meter=r.hasOwnProperty("length_unit_to_meter")?r.length_unit_to_meter:.037,n.floor_height=r.hasOwnProperty("floor_height")?r.floor_height:0,n.useLowTexture=r.hasOwnProperty("useLowTexture")?r.useLowTexture:0,n.tile_salt=r.hasOwnProperty("version_control")?r.version_control:n.tile_salt;var l=new i.Matrix4;r.onload_trans instanceof Array?l.set.apply(l,r.onload_trans):l.makeRotationX(Math.PI*r.onload_trans.x).multiply((new i.Matrix4).makeRotationY(Math.PI*r.onload_trans.y)).multiply((new i.Matrix4).makeRotationZ(Math.PI*r.onload_trans.z));var u=l.multiply((new i.Matrix4).makeTranslation(-n.origin.x,-n.origin.y,-n.origin.z));n.transformation.set({onload:u,scale:n.length_unit_to_meter}),n.maxPolarAngle=Math.max(2/3,n.maxPolarAngle),t&&t(n)}).catch(function(e){console.log("ViewerDataInfo",e);var t=e.response.data,n=e.response.status,i=e.response.headers;r&&r(t,n,i)})},u.prototype.constructor=u,t.default=u},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){if(h){var e;(e=console).log.apply(e,arguments)}}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(110),l=n(s),u=r(52),c=n(u),h=!1,d=new c.default,f=window.URL||window.webkitURL;null==f&&(f={createObjectURL:function(){return""}});var p=function(){function e(t){i(this,e),this.data={},this.entries=[],this.buffer=null,this.storeBuffer=null!=t&&t,this.context=null}return a(e,[{key:"_parsePixels",value:function(e,t){new l.default(e).parse(function(e,r){if(e)console.error("Bundle: fail to parse bundle png",e);else{var n=r.getWidth(),i=r.getHeight(),a=r.pixels;o("Image width and height",n,i),o("Image pixels",a.length,a),t(a,n,i)}})}},{key:"_parsePixelsFast",value:function(e,t,r){this.context=null==this.context?document.createElement("canvas").getContext("2d"):this.context,this.context.imageSmoothingEnabled=!1;var n=this.context;return this._parseImg(e,function(e){var r=e.width,i=e.height;n.canvas.width=r,n.canvas.height=i,n.drawImage(e,0,0);var a=n.getImageData(0,0,r,i),s=a.data;o("Image width and height",r,e.height),o("Canvas data array",s.length,s);var l=s.length/(r*i);t(s,r,i,l)},r)}},{key:"_parseImg",value:function(e,t,r){r=r||"image/jpeg";var n=new Image;switch(n.onload=function(){f.revokeObjectURL(n.src),null!=t&&t(n)},n.onerror=function(){console.error("Bundle: failed to create <img> with buffer")},window.location.protocol){case"http:":case"https:":n.src=this._parseURI(e,r);break;case"file:":n.src=this._parseImgURI(e,r);break;default:console.error("Unknown browsing protocal, please report to support@altizure.com ")}return n}},{key:"_parseURI",value:function(e,t){var r=null==t?new Blob([e]):new Blob([e],{type:t});return f.createObjectURL(r)}},{key:"_Uint8ToString",value:function(e){var t=[];if(Uint8Array.prototype.subarray)for(var r=0;r<e.byteLength;r+=32768)t.push(String.fromCharCode.apply(null,e.subarray(r,Math.min(r+32768,e.byteLength))));else if(Uint8Array.prototype.slice)for(var n=0;n<e.byteLength;n+=32768)t.push(String.fromCharCode.apply(null,e.slice(n,Math.min(n+32768,e.byteLength))));else for(var i=0;i<e.byteLength;i+=32768){for(var o=new Uint8Array(Math.min(32768,e.byteLength-i)),a=0;a<o.byteLength;++a)o[a]=e[i+a];t.push(String.fromCharCode.apply(null,o))}return t.join("")}},{key:"_parseImgURI",value:function(e,t){if(e instanceof Uint8Array)return null==t?"data:;base64,"+btoa(this._Uint8ToString(e)):"data:"+t+";base64,"+btoa(this._Uint8ToString(e));if(e instanceof ArrayBuffer){var r=new Uint8Array(e);return null==t?"data:;base64,"+btoa(this._Uint8ToString(r)):"data:"+t+";base64,"+btoa(this._Uint8ToString(r))}console.error("Unknow type ",e)}},{key:"parseBundle",value:function(e,t,r,n){n=n||{};var i=0,a="",s=new Uint8Array(t*r*3),l=n.password||"";this.storeBuffer&&(this.buffer=s);for(var u=0;u<e.length;u++)(u+1)%4!=0&&(s[i++]=e[u]);if(o("Extracted Uint8Array",s.length,s),h){for(var c="",d=500;d<800;d++)c+=s[d]+",";console.log("500 to 800 bytes"),console.log(c)}for(i=0;i<s.length&&!(s[i]<5);)a+=String.fromCharCode(s[i++]);o("Found the string 0 char at index "+i+" with value "+s[i]),o(a),i++;var f=0;if(""!==l)for(var p=i;p<s.length;p++){var m=s[p],v=l.charCodeAt(f);m^=v,s[p]=m,f=(f+1)%l.length}this.entries=[];var g=a.split("\n");a=g.join(""),g=a.split(";");for(var y=0;y<g.length;y++)if(""!==g[y]){var b=g[y].split(",");this.entries.push({path:b[0],type:b[1],length:parseInt(b[2],10)})}o("this.entries",this.entries);for(var _=0;_<this.entries.length;_++){var w=this.entries[_],x=s.subarray(i,i+w.length);o("Extracting "+w.path+": length "+x.length),o("Starts at "+i+" with value "+x[0]),o("Ends at "+(i+w.length)+" with value "+x[x.length-1]),i+=w.length,this.data[w.path]=x}}},{key:"parse",value:function(e,t,r){var n=this;o("ArrayBuffer",e.byteLength),(t.robust?this._parsePixels.bind(this):this._parsePixelsFast.bind(this))(e,function(e,i,o){n.parseBundle(e,i,o,t),d.add(function(){r(n)},10)})}},{key:"load",value:function(e,t,r){var n=this,i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onprogress=function(e){var r=.999*(e.total<=0?0:e.loaded/(e.total+5));null!=t&&t(null,r)},i.onload=function(){n.parse(i.response,function(e){null!=t&&t(e,1)},r)},i.send()}},{key:"exists",value:function(e){return null!=this.data[e]}},{key:"read",value:function(e){return null===this.data[e]&&console.error("Bundle: ["+e+"] not found."),this.data[e]}},{key:"readText",value:function(e){var t="",r=this.read(e);if(null==r)return t;for(var n=0;n<r.length;n++)t+=String.fromCharCode(r[n]);return t}},{key:"readJSON",value:function(e){var t=this.readText(e);return""===t?{}:JSON.parse(t)}},{key:"readElement",value:function(e,t){var r=document.createElement(t);return r.textContent=this.readText(e),r}},{key:"readScript",value:function(e){return this.readElement(e,"script")}},{key:"readCSS",value:function(e){return this.readElement(e,"style")}},{key:"readImg",value:function(e,t){var r=this.read(e);return null===r?(console.error("Cannot read ",e),""):this._parseImg(r,t)}},{key:"readDataURL",value:function(e,t){var r=this.read(e);return null===r?"":this._parseURI(r,t)}},{key:"readRGBA",value:function(e,t,r){this.parsePixels(this.read(e),t,r)}},{key:"clearData",value:function(){this.data={}}}]),e}();t.default=p},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Water=t.WaterManager=t.WaterSetting=t.MaskManager=t.MaskSetting=t.RefreshQueue=t.EarthMath=t.BrowserCapatibility=t.ServiceLocal=t.ServiceRemote=t.AltizureApi=t.Transformation=t.GeoCoord=t.Forest=t.AltizureProjectTree=t.AltizureProjectTile=t.MeshSmartTile=t.PointSmartTile=t.CameraSmartTile=t.EarthBasic=t.HyperEntity=t.HyperLayer=t.HyperNode=t.HyperViewer=t.Viewer=void 0;var i=r(64),o=n(i),a=r(36),s=n(a),l=r(11),u=n(l),c=r(19),h=n(c),d=r(18),f=n(d),p=r(65),m=n(p),v=r(63),g=n(v),y=r(39),b=n(y),_=r(38),w=n(_),x=r(21),M=n(x),E=r(40),A=n(E),T=r(24),k=n(T),S=r(23),C=n(S),P=r(41),O=n(P),R=r(20),L=n(R),I=r(34),B=n(I),D=r(33),j=n(D),z=r(37),N=n(z),U=r(3),F=n(U),H=r(22),V=n(H),G=r(16),W=n(G),X=r(15),Y=n(X),q=r(17),K=n(q),Z=r(35),Q=n(Z),J=r(42),$=n(J);r(66),t.Viewer=o.default,t.HyperViewer=s.default,t.HyperNode=u.default,t.HyperLayer=h.default,t.HyperEntity=f.default,t.EarthBasic=m.default,t.CameraSmartTile=g.default,t.PointSmartTile=b.default,t.MeshSmartTile=w.default,t.AltizureProjectTile=L.default,t.AltizureProjectTree=M.default,t.Forest=N.default,t.GeoCoord=A.default,t.Transformation=k.default,t.AltizureApi=C.default,t.ServiceRemote=B.default,t.ServiceLocal=j.default,t.BrowserCapatibility=V.default,t.EarthMath=F.default,t.RefreshQueue=O.default,t.MaskSetting=W.default,t.MaskManager=Y.default,t.WaterSetting=K.default,t.WaterManager=Q.default,t.Water=$.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=this,t=null,r=[];this.add=function(n,i,o,a,s,l){if(n)return r.push([n,i,o,a,s,l]),void(1===r.length&&function n(i){t=setTimeout(function(){i=e.add(),r.length&&n(i)},i||0)}(l));var u=r.shift();return u?(u[0].call(u[1],u[2],u[3],u[4]),u[5]):0},this.clear=function(){clearTimeout(t),r=[]}};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i={drawBbox:function(e){return i._drawWireframeBox(e.boundingBox)},drawBox:function(e){var t=[];return t[0]=new n.Vector3(e.min.x,e.min.y,e.min.z),t[1]=new n.Vector3(e.min.x,e.min.y,e.max.z),t[2]=new n.Vector3(e.max.x,e.min.y,e.max.z),t[3]=new n.Vector3(e.max.x,e.min.y,e.min.z),t[4]=new n.Vector3(e.min.x,e.max.y,e.min.z),t[5]=new n.Vector3(e.min.x,e.max.y,e.max.z),t[6]=new n.Vector3(e.max.x,e.max.y,e.max.z),t[7]=new n.Vector3(e.max.x,e.max.y,e.min.z),i._drawWireframeBox(t)},drawBoxByPoint:function(e,t){var r=[];return r[0]=e.clone(),r[1]=new n.Vector3(e.x,e.y,t.z),r[2]=new n.Vector3(t.x,e.y,t.z),r[3]=new n.Vector3(t.x,e.y,e.z),r[4]=new n.Vector3(e.x,t.y,e.z),r[5]=new n.Vector3(e.x,t.y,t.z),r[6]=t.clone(),r[7]=new n.Vector3(t.x,t.y,e.z),i._drawWireframeBox(r)},_drawWireframeBox:function(e){for(var t=new n.Geometry,r=[0,1,2,3,0,4,7,3,2,6,7,6,5,1,2,6,5,4,0,1],i=0;i<r.length;++i)t.vertices.push(e[r[i]]);var o=new n.LineBasicMaterial({color:65280});return new n.Line(t,o)},buildAxes:function(e){var t=new n.Object3D;t.name="xyzaxes",t.add(this.drawLine(new n.Vector3(0,0,0),new n.Vector3(e,0,0),16711680,!1)),t.add(this.drawLine(new n.Vector3(0,0,0),new n.Vector3(0,e,0),65280,!1)),t.add(this.drawLine(new n.Vector3(0,0,0),new n.Vector3(0,0,e),255,!1));var r=new n.PlaneGeometry(e,e),i=new n.MeshBasicMaterial({side:n.DoubleSide,color:8947848});i.opacity=.5,i.transparent=!0;var o=new n.Mesh(r,i);return o.applyMatrix((new n.Matrix4).makeRotationX(Math.PI/2)),o.applyMatrix((new n.Matrix4).makeTranslation(e/2,0,e/2)),t.add(o),t},buildTransAxes:function(e,t,r,i,o){var a=new n.Object3D;return a.add(this.drawLine(e,e.clone().add(t.clone().multiplyScalar(o)),16711680,!0)),a.add(this.drawLine(e,e.clone().add(r.clone().multiplyScalar(o)),65280,!0)),a.add(this.drawLine(e,e.clone().add(i.clone().multiplyScalar(o)),255,!0)),a},drawLine:function(e,t,r,i){var o,a=new n.Geometry;return o=i?new n.LineDashedMaterial({linewidth:3,color:r,dashSize:3,gapSize:3}):new n.LineBasicMaterial({linewidth:3,color:r}),a.vertices.push(e.clone()),a.vertices.push(t.clone()),a.computeLineDistances(),new n.LineSegments(a,o)},drawSphere:function(e,t,r){var i=new n.SphereGeometry(t,32,32),o=new n.MeshBasicMaterial({color:r}),a=new n.Mesh(i,o);return a.position.copy(e),a},buildLocalAxes:function(e,t){var r=new n.Object3D;e.matrixWorldNeedsUpdate=!0;var i=new n.Vector3(0,0,0);e.localToWorld(i);var o=new n.Vector3(t,0,0);e.localToWorld(o);var a=new n.Vector3(0,t,0);e.localToWorld(a);var s=new n.Vector3(0,0,t);return e.localToWorld(s),r.add(this.drawLine(i,o,16711680,!1)),r.add(this.drawLine(i,a,65280,!1)),r.add(this.drawLine(i,s,255,!1)),r},renderAsImage:function(e,t,r,o,a){var s=e.getContext(),l=new n.WebGLRenderTarget(o,a,{minFilter:n.NearestFilter,magFilter:n.NearestFilter,format:n.RGBAFormat});e.setSize(o,a),r.aspect=o/a,r instanceof n.OrthographicCamera&&(r.right=r.top*r.aspect,r.left=-r.right),e.render(t,r,l,!0);var u=new Uint8Array(o*a*4);return s.readPixels(0,0,o,a,s.RGBA,s.UNSIGNED_BYTE,u),this.flipImageInY(u,o,a),i.convertFboToImage(u,o,a)},flipImageInY:function(e,t,r){var n,i,o;for(n=0;n<4*t;n+=4)for(i=0;i<Math.floor(r/2);i++){var a=t*i*4+n,s=[];for(o=0;o<4;o++)s[o]=e[a+o];var l=t*(r-i-1)*4+n;for(o=0;o<4;o++)e[a+o]=e[l+o],e[l+o]=s[o]}},convertFboToImage:function(e,t,r){var n=document.createElement("canvas");n.width=t,n.height=r;var i=n.getContext("2d"),o=i.createImageData(t,r);return o.data.set(e),i.putImageData(o,0,0),n.toDataURL("image/jpeg",.9)},showImage:function(e){console.warn("I am just too lazy to convert this.")}};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){this.width=0,this.height=0,this.bitDepth=0,this.colorType=0,this.compressionMethod=0,this.filterMethod=0,this.interlaceMethod=0,this.colors=0,this.alpha=!1,this.pixelBits=0,this.palette=null,this.pixels=null};n.prototype.getWidth=function(){return this.width},n.prototype.setWidth=function(e){this.width=e},n.prototype.getHeight=function(){return this.height},n.prototype.setHeight=function(e){this.height=e},n.prototype.getBitDepth=function(){return this.bitDepth},n.prototype.setBitDepth=function(e){if(-1===[2,4,8,16].indexOf(e))throw new Error("invalid bith depth "+e);this.bitDepth=e},n.prototype.getColorType=function(){return this.colorType},n.prototype.setColorType=function(e){var t=0,r=!1;switch(e){case 0:t=1;break;case 2:t=3;break;case 3:t=1;break;case 4:t=2,r=!0;break;case 6:t=4,r=!0;break;default:throw new Error("invalid color type")}this.colors=t,this.alpha=r,this.colorType=e},n.prototype.getCompressionMethod=function(){return this.compressionMethod},n.prototype.setCompressionMethod=function(e){if(0!==e)throw new Error("invalid compression method "+e);this.compressionMethod=e},n.prototype.getFilterMethod=function(){return this.filterMethod},n.prototype.setFilterMethod=function(e){if(0!==e)throw new Error("invalid filter method "+e);this.filterMethod=e},n.prototype.getInterlaceMethod=function(){return this.interlaceMethod},n.prototype.setInterlaceMethod=function(e){if(0!==e&&1!==e)throw new Error("invalid interlace method "+e);this.interlaceMethod=e},n.prototype.setPalette=function(e){if(e.length%3!=0)throw new Error("incorrect PLTE chunk length");if(e.length>3*Math.pow(2,this.bitDepth))throw new Error("palette has more colors than 2^bitdepth");this.palette=e},n.prototype.getPalette=function(){return this.palette},n.prototype.getPixel=function(e,t){if(!this.pixels)throw new Error("pixel data is empty");if(e>=this.width||t>=this.height)throw new Error("x,y position out of bound");var r=this.colors*this.bitDepth/8*(t*this.width+e),n=this.pixels;switch(this.colorType){case 0:return[n[r],n[r],n[r],255];case 2:return[n[r],n[r+1],n[r+2],255];case 3:return[this.palette[3*n[r]+0],this.palette[3*n[r]+1],this.palette[3*n[r]+2],255];case 4:return[n[r],n[r],n[r],n[r+1]];case 6:return[n[r],n[r+1],n[r+2],n[r+3]]}},t.default=n},function(e,t,r){"use strict";(function(e){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(e.length!==t.length)return!1;for(var r=e.length;r--;)if(e[r]!==t[r])return!1;return!0}function o(e,t){return(e[t]<<24)+(e[t+1]<<16)+(e[t+2]<<8)+(e[t+3]<<0)}function a(e,t){return e[t]<<0}function s(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}function l(e){if("string"==typeof e){var t=e;e=new Array(t.length);for(var r=0,n=t.length;r<n;r++)e[r]=t[r].charCodeAt(0)}else"ArrayBuffer"===v.call(e).slice(8,-1)&&(e=new Uint8Array(e));this.i=0,this.bytes=e,this.png=new f.default,this.dataChunks=[]}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=r(140),h=n(c),d=r(109),f=n(d),p=function(e,t){try{var r=h.default.inflate(e);t(null,r)}catch(e){t(e)}},m=Array.prototype.slice,v=Object.prototype.toString;l.prototype.readBytes=function(e){var t=this.i+e;if(t>this.bytes.length)throw new Error("Unexpectedly reached end of file");var r=m.call(this.bytes,this.i,t);return this.i=t,r},l.prototype.decodeHeader=function(){if(0!==this.i)throw new Error("file pointer should be at 0 to read the header");var e=this.readBytes(8);if(!i(e,[137,80,78,71,13,10,26,10]))throw new Error("invalid PNGReader file (bad signature)");this.header=e},l.prototype.decodeChunk=function(){var e=o(this.readBytes(4),0);if(e<0)throw new Error("Bad chunk length "+(4294967295&e));var t=s(this.readBytes(4)),r=this.readBytes(e),n=this.readBytes(4);switch(t){case"IHDR":this.decodeIHDR(r);break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this.decodeIEND(r)}return{}.crc=n,t},l.prototype.decodeIHDR=function(e){var t=this.png;t.setWidth(o(e,0)),t.setHeight(o(e,4)),t.setBitDepth(a(e,8)),t.setColorType(a(e,9)),t.setCompressionMethod(a(e,10)),t.setFilterMethod(a(e,11)),t.setInterlaceMethod(a(e,12))},l.prototype.decodePLTE=function(e){this.png.setPalette(e)},l.prototype.decodeIDAT=function(e){this.dataChunks.push(e)},l.prototype.decodeIEND=function(){},l.prototype.decodePixels=function(t){var r,n,i,o,a=this.png,s=this,l=0;for(o=this.dataChunks.length;o--;)l+=this.dataChunks[o].length;var u=new e(l);for(r=0,i=0,o=this.dataChunks.length;r<o;r++){var c=this.dataChunks[r];for(n=0;n<c.length;n++)u[i++]=c[n]}p(u,function(e,r){if(e)return t(e);try{0===a.getInterlaceMethod()?s.interlaceNone(r):s.interlaceAdam7(r)}catch(e){return t(e)}t()})},l.prototype.interlaceNone=function(t){for(var r,n=this.png,i=Math.max(1,n.colors*n.bitDepth/8),o=i*n.width,s=new e(i*n.width*n.height),l=0,u=0;u<t.length;u+=o+1){switch(r=m.call(t,u+1,u+o+1),a(t,u)){case 0:this.unFilterNone(r,s,i,l,o);break;case 1:this.unFilterSub(r,s,i,l,o);break;case 2:this.unFilterUp(r,s,i,l,o);break;case 3:this.unFilterAverage(r,s,i,l,o);break;case 4:this.unFilterPaeth(r,s,i,l,o);break;default:throw new Error("unkown filtered scanline")}l+=o}n.pixels=s},l.prototype.interlaceAdam7=function(e){throw new Error("Adam7 interlacing is not implemented yet")},l.prototype.unFilterNone=function(e,t,r,n,i){for(var o=0,a=i;o<a;o++)t[n+o]=e[o]},l.prototype.unFilterSub=function(e,t,r,n,i){for(var o=0;o<r;o++)t[n+o]=e[o];for(;o<i;o++)t[n+o]=e[o]+t[n+o-r]&255},l.prototype.unFilterUp=function(e,t,r,n,i){var o=0;if(n-i<0)for(;o<i;o++)t[n+o]=e[o];else for(;o<i;o++){var a=e[o],s=t[n+o-i];t[n+o]=a+s&255}},l.prototype.unFilterAverage=function(e,t,r,n,i){var o=0;if(n-i<0){for(;o<r;o++)t[n+o]=e[o];for(;o<i;o++)t[n+o]=e[o]+(t[n+o-r]>>1)&255}else{for(;o<r;o++)t[n+o]=e[o]+(t[n-i+o]>>1)&255;for(;o<i;o++){var a=e[o],s=t[n+o-r],l=t[n+o-i];t[n+o]=a+(s+l>>1)&255}}},l.prototype.unFilterPaeth=function(e,t,r,n,i){var o=0;if(n-i<0){for(;o<r;o++)t[n+o]=e[o];for(;o<i;o++)t[n+o]=e[o]+t[n+o-r]&255}else{for(;o<r;o++)t[n+o]=e[o]+t[n+o-i]&255;for(;o<i;o++){var a=e[o],s=t[n+o-r],l=t[n+o-i],u=t[n+o-i-r],c=s+l-u,h=Math.abs(c-s),d=Math.abs(c-l),f=Math.abs(c-u),p=void 0;p=h<=d&&h<=f?s:d<=f?l:u,t[n+o]=a+p&255}}},l.prototype.parse=function(e,t){"function"==typeof e&&(t=e),"object"!==(void 0===e?"undefined":u(e))&&(e={});try{for(this.decodeHeader();this.i<this.bytes.length;){var r=this.decodeChunk();if("IHDR"===r&&!1===e.data||"IEND"===r)break}var n=this.png;this.decodePixels(function(e){t(e,n)})}catch(e){t(e)}},t.default=l}).call(t,r(113).Buffer)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(27),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(e,t,r){function i(e,t){var r=window.devicePixelRatio||1,i=s.canvas.height,o=s.drawingBufferHeight,a=new n.Vector3(e/s.canvas.clientWidth*(s.drawingBufferWidth/s.canvas.width)*2-1,1-2*(t*o/i+(i-o)/r)/s.canvas.clientHeight,0);l.setFromCamera(a.clone(),u.camera)}function a(e,t){i(e,t);var r;if(u.sceneGraphRoot instanceof n.Plane){var o=l.ray.intersectPlane(u.sceneGraphRoot);r=null==o?[]:[{point:o}]}else r=l.intersectObjects(u.sceneGraphRoot.children,!0);return r}this.camera=e,this.sceneGraphRoot=r;var s=t.getContext(),l=new n.Raycaster,u=this;this.pickPoint=function(e,t){var r=a(e,t);return r.length>0?r[0].point:null},this.pickObject=function(e,t){var r=a(e,t);return r.length>0?r[0].object:null},this.pickTile=function(e,t){var r=this.pickObject(e,t);return null===r?null:o.default.getTileFromMesh(r).name},this.pickLeafTile=function(e,t,r){var i=a(e,t);if(0===i.length)return null;var s=o.default.getTileFromMesh(i[0].object).name;if(o.default.parseTileName(s).level===r.maxLevel)return s;var l=i[0].point,u=r.info,c=(new n.Matrix4).getInverse(u.onload_transformation),h=l.clone().applyMatrix4(c),d=u.x_dir.clone().multiplyScalar(u.min_bound.x),f=u.y_dir.clone().multiplyScalar(u.min_bound.y),p=u.origin.clone().add(d).add(f);h=h.sub(p);var m=h.clone().dot(u.x_dir),v=h.clone().dot(u.y_dir);return m=Math.floor(m/u.x_unit),v=Math.floor(v/u.y_unit),m=Math.min(u.x_tiles-1,Math.max(0,m)),v=Math.min(u.y_tiles-1,Math.max(0,v)),o.default.makeTileName(r.maxLevel,m,v)},this.worldToScreen=function(e){var t=window.devicePixelRatio||1,r=(new n.Matrix4).multiplyMatrices(u.camera.projectionMatrix,u.camera.matrixWorldInverse),i=e.clone().applyMatrix4(r),o=.5*(i.x+1)*s.canvas.clientWidth*(s.canvas.width/s.drawingBufferWidth),a=(.5*(1-i.y)*s.canvas.clientHeight-(s.canvas.height-s.drawingBufferHeight)/t)*(s.canvas.height/s.drawingBufferHeight);return new n.Vector2(o,a)},this.isPointVisible=function(e){var t=e.clone(),r=u.camera.position.clone().sub(t).normalize();return new n.Raycaster(t,r).intersectObjects(u.sceneGraphRoot.children,!0).length<1},this.pickTileDirect=function(e,r,i){var a,l,c,h,d=new n.WebGLRenderTarget(s.drawingBufferWidth,s.drawingBufferHeight,{minFilter:n.NearestFilter});for(c=0;c<u.sceneGraphRoot.children.length;c++)if(l=u.sceneGraphRoot.children[c],""!==l.name){var f=c>255?255:c,p=c>512?c-512:0,m=Math.min(255,Math.max(c-256,0)),v=new n.Color;v.setRGB(f/255,m/255,p/255);var g=new n.MeshBasicMaterial({color:v});for(a=o.default.getMeshes(l),h=0;h<a.length;h++)a[h].temp_material=a[h].material,a[h].material=g}t.render(i,u.camera,d,!0);var y=new Uint8Array(4),b=new n.DataTexture(y,1,1);for(s.readPixels(e,s.drawingBufferHeight-r,1,1,s.RGBA,s.UNSIGNED_BYTE,b.image.data),c=0;c<u.sceneGraphRoot.children.length;c++)if(l=u.sceneGraphRoot.children[c],""!==l.name)for(a=o.default.getMeshes(l),h=0;h<a.length;h++)a[h].material=a[h].temp_material,delete a[h].temp_material;var _=y[0]+y[1]+y[2];return _<u.sceneGraphRoot.children.length?u.sceneGraphRoot.children[_].name:null},this.getRay=function(e,t){return i(e,t),l.ray},this.updateSgr=function(e){this.sceneGraphRoot=e}};t.default=a},function(e,t,r){"use strict";function n(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function i(e){return 3*e.length/4-n(e)}function o(e){var t,r,i,o,a,s=e.length;o=n(e),a=new h(3*s/4-o),r=o>0?s-4:s;var l=0;for(t=0;t<r;t+=4)i=c[e.charCodeAt(t)]<<18|c[e.charCodeAt(t+1)]<<12|c[e.charCodeAt(t+2)]<<6|c[e.charCodeAt(t+3)],a[l++]=i>>16&255,a[l++]=i>>8&255,a[l++]=255&i;return 2===o?(i=c[e.charCodeAt(t)]<<2|c[e.charCodeAt(t+1)]>>4,a[l++]=255&i):1===o&&(i=c[e.charCodeAt(t)]<<10|c[e.charCodeAt(t+1)]<<4|c[e.charCodeAt(t+2)]>>2,a[l++]=i>>8&255,a[l++]=255&i),a}function a(e){return u[e>>18&63]+u[e>>12&63]+u[e>>6&63]+u[63&e]}function s(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16)+(e[o+1]<<8)+e[o+2],i.push(a(n));return i.join("")}function l(e){for(var t,r=e.length,n=r%3,i="",o=[],a=0,l=r-n;a<l;a+=16383)o.push(s(e,a,a+16383>l?l:a+16383));return 1===n?(t=e[r-1],i+=u[t>>2],i+=u[t<<4&63],i+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],i+=u[t>>10],i+=u[t>>4&63],i+=u[t<<2&63],i+="="),o.push(i),o.join("")}t.byteLength=i,t.toByteArray=o,t.fromByteArray=l;for(var u=[],c=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,p=d.length;f<p;++f)u[f]=d[f],c[d.charCodeAt(f)]=f;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},function(e,t,r){"use strict";(function(e){function n(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=o.prototype):(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,r){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return a(this,e,t,r)}function a(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?d(e,t,r,n):"string"==typeof t?c(e,t,r):f(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t,r,n){return s(t),t<=0?i(e,t):void 0!==r?"string"==typeof n?i(e,t).fill(r,n):i(e,t).fill(r):i(e,t)}function u(e,t){if(s(t),e=i(e,t<0?0:0|p(t)),!o.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function c(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!o.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(t,r);e=i(e,n);var a=e.write(t,r);return a!==n&&(e=e.slice(0,a)),e}function h(e,t){var r=t.length<0?0:0|p(t.length);e=i(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function d(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),o.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=o.prototype):e=h(e,t),e}function f(e,t){if(o.isBuffer(t)){var r=0|p(t.length);return e=i(e,r),0===e.length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||K(t.length)?i(e,0):h(e,t);if("Buffer"===t.type&&J(t.data))return h(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function p(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function m(e){return+e!=e&&(e=0),o.alloc(+e)}function v(e,t){if(o.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Y(e).length;default:if(n)return G(e).length;t=(""+t).toLowerCase(),n=!0}}function g(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return S(this,t,r);case"ascii":return P(this,t,r);case"latin1":case"binary":return O(this,t,r);case"base64":return k(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function b(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:_(e,t,r,n,i);if("number"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):_(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function _(e,t,r,n,i){function o(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}var u;if(i){var c=-1;for(u=r;u<s;u++)if(o(e,u)===o(t,-1===c?0:u-c)){if(-1===c&&(c=u),u-c+1===l)return c*a}else-1!==c&&(u-=u-c),c=-1}else for(r+l>s&&(r=s-l),u=r;u>=0;u--){for(var h=!0,d=0;d<l;d++)if(o(e,u+d)!==o(t,d)){h=!1;break}if(h)return u}return-1}function w(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function x(e,t,r,n){return q(G(t,e.length-r),e,r,n)}function M(e,t,r,n){return q(W(t),e,r,n)}function E(e,t,r,n){return M(e,t,r,n)}function A(e,t,r,n){return q(Y(t),e,r,n)}function T(e,t,r,n){return q(X(t,e.length-r),e,r,n)}function k(e,t,r){return 0===t&&r===e.length?Z.fromByteArray(e):Z.fromByteArray(e.slice(t,r))}function S(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o=e[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s<=r){var l,u,c,h;switch(s){case 1:o<128&&(a=o);break;case 2:128==(192&(l=e[i+1]))&&(h=(31&o)<<6|63&l)>127&&(a=h);break;case 3:l=e[i+1],u=e[i+2],128==(192&l)&&128==(192&u)&&(h=(15&o)<<12|(63&l)<<6|63&u)>2047&&(h<55296||h>57343)&&(a=h);break;case 4:l=e[i+1],u=e[i+2],c=e[i+3],128==(192&l)&&128==(192&u)&&128==(192&c)&&(h=(15&o)<<18|(63&l)<<12|(63&u)<<6|63&c)>65535&&h<1114112&&(a=h)}}null===a?(a=65533,s=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=s}return C(n)}function C(e){var t=e.length;if(t<=$)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=$));return r}function P(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function O(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function R(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=V(e[o]);return i}function L(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function I(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,r,n,i,a){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function D(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function j(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function z(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function N(e,t,r,n,i){return i||z(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),Q.write(e,t,r,n,23,4),r+4}function U(e,t,r,n,i){return i||z(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),Q.write(e,t,r,n,52,8),r+8}function F(e){if(e=H(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function H(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function V(e){return e<16?"0"+e.toString(16):e.toString(16)}function G(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function W(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function X(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function Y(e){return Z.toByteArray(F(e))}function q(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function K(e){return e!==e}var Z=r(112),Q=r(138),J=r(139);t.Buffer=o,t.SlowBuffer=m,t.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=n(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,r){return a(null,e,t,r)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,r){return l(null,e,t,r)},o.allocUnsafe=function(e){return u(null,e)},o.allocUnsafeSlow=function(e){return u(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!J(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=o.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var a=e[r];if(!o.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i),i+=a.length}return n},o.byteLength=v,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):g.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,r,n,i){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var a=i-n,s=r-t,l=Math.min(a,s),u=this.slice(n,i),c=e.slice(t,r),h=0;h<l;++h)if(u[h]!==c[h]){a=u[h],s=c[h];break}return a<s?-1:s<a?1:0},o.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},o.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return w(this,e,t,r);case"utf8":case"utf-8":return x(this,e,t,r);case"ascii":return M(this,e,t,r);case"latin1":case"binary":return E(this,e,t,r);case"base64":return A(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n;if(o.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=o.prototype;else{var i=t-e;n=new o(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},o.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},o.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},o.prototype.readUInt8=function(e,t){return t||I(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||I(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||I(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||I(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){t||I(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||I(e,4,this.length),Q.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||I(e,4,this.length),Q.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||I(e,8,this.length),Q.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||I(e,8,this.length),Q.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,n){e=+e,t|=0,r|=0,n||B(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,n){e=+e,t|=0,r|=0,n||B(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):j(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);B(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);B(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):j(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,r){return N(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return N(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return U(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return U(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,a=n-r;if(this===e&&r<t&&t<n)for(i=a-1;i>=0;--i)e[i+t]=this[i+r];else if(a<1e3||!o.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+a),t);return a},o.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var a;if("number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{var s=o.isBuffer(e)?e:G(new o(e,n).toString()),l=s.length;for(a=0;a<r-t;++a)this[a+t]=s[a%l]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,r(60))},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return function(){var t=e,r=t.lib,n=r.BlockCipher,i=t.algo,o=[],a=[],s=[],l=[],u=[],c=[],h=[],d=[],f=[],p=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var r=0,n=0,t=0;t<256;t++){var i=n^n<<1^n<<2^n<<3^n<<4;i=i>>>8^255&i^99,o[r]=i,a[i]=r;var m=e[r],v=e[m],g=e[v],y=257*e[i]^16843008*i;s[r]=y<<24|y>>>8,l[r]=y<<16|y>>>16,u[r]=y<<8|y>>>24,c[r]=y;var y=16843009*g^65537*v^257*m^16843008*r;h[i]=y<<24|y>>>8,d[i]=y<<16|y>>>16,f[i]=y<<8|y>>>24,p[i]=y,r?(r=m^e[e[e[g^m]]],n^=e[e[n]]):r=n=1}}();var m=[0,1,2,4,8,16,32,64,128,27,54],v=i.AES=n.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,r=e.sigBytes/4,n=this._nRounds=r+6,i=4*(n+1),a=this._keySchedule=[],s=0;s<i;s++)if(s<r)a[s]=t[s];else{var l=a[s-1];s%r?r>6&&s%r==4&&(l=o[l>>>24]<<24|o[l>>>16&255]<<16|o[l>>>8&255]<<8|o[255&l]):(l=l<<8|l>>>24,l=o[l>>>24]<<24|o[l>>>16&255]<<16|o[l>>>8&255]<<8|o[255&l],l^=m[s/r|0]<<24),a[s]=a[s-r]^l}for(var u=this._invKeySchedule=[],c=0;c<i;c++){var s=i-c;if(c%4)var l=a[s];else var l=a[s-4];u[c]=c<4||s<=4?l:h[o[l>>>24]]^d[o[l>>>16&255]]^f[o[l>>>8&255]]^p[o[255&l]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,l,u,c,o)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,h,d,f,p,a);var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,n,i,o,a,s){for(var l=this._nRounds,u=e[t]^r[0],c=e[t+1]^r[1],h=e[t+2]^r[2],d=e[t+3]^r[3],f=4,p=1;p<l;p++){var m=n[u>>>24]^i[c>>>16&255]^o[h>>>8&255]^a[255&d]^r[f++],v=n[c>>>24]^i[h>>>16&255]^o[d>>>8&255]^a[255&u]^r[f++],g=n[h>>>24]^i[d>>>16&255]^o[u>>>8&255]^a[255&c]^r[f++],y=n[d>>>24]^i[u>>>16&255]^o[c>>>8&255]^a[255&h]^r[f++];u=m,c=v,h=g,d=y}var m=(s[u>>>24]<<24|s[c>>>16&255]<<16|s[h>>>8&255]<<8|s[255&d])^r[f++],v=(s[c>>>24]<<24|s[h>>>16&255]<<16|s[d>>>8&255]<<8|s[255&u])^r[f++],g=(s[h>>>24]<<24|s[d>>>16&255]<<16|s[u>>>8&255]<<8|s[255&c])^r[f++],y=(s[d>>>24]<<24|s[u>>>16&255]<<16|s[c>>>8&255]<<8|s[255&h])^r[f++];e[t]=m,e[t+1]=v,e[t+2]=g,e[t+3]=y},keySize:8});t.AES=n._createHelper(v)}(),e.AES}(r(1),r(8),r(9),r(5),r(2))}()},function(e,t,r){!function(n,i){e.exports=t=function(e){return function(){function t(e){return e<<8&4278255360|e>>>8&16711935}var r=e,n=r.lib,i=n.WordArray,o=r.enc;o.Utf16=o.Utf16BE={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i+=2){var o=t[i>>>2]>>>16-i%4*8&65535;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>1]|=e.charCodeAt(n)<<16-n%2*16;return i.create(r,2*t)}},o.Utf16LE={stringify:function(e){for(var r=e.words,n=e.sigBytes,i=[],o=0;o<n;o+=2){var a=t(r[o>>>2]>>>16-o%4*8&65535);i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var r=e.length,n=[],o=0;o<r;o++)n[o>>>1]|=t(e.charCodeAt(o)<<16-o%2*16);return i.create(n,2*r)}}}(),e.enc.Utf16}(r(1))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return function(t){var r=e,n=r.lib,i=n.CipherParams,o=r.enc,a=o.Hex;r.format.Hex={stringify:function(e){return e.ciphertext.toString(a)},parse:function(e){var t=a.parse(e);return i.create({ciphertext:t})}}}(),e.format.Hex}(r(1),r(2))}()},function(e,t,r){!function(n,i){e.exports=t=function(e){return function(){if("function"==typeof ArrayBuffer){var t=e,r=t.lib,n=r.WordArray,i=n.init;(n.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,r=[],n=0;n<t;n++)r[n>>>2]|=e[n]<<24-n%4*8;i.call(this,r,t)}else i.apply(this,arguments)}).prototype=n}}(),e.lib.WordArray}(r(1))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return e.mode.CFB=function(){function t(e,t,r,n){var i=this._iv;if(i){var o=i.slice(0);this._iv=void 0}else var o=this._prevBlock;n.encryptBlock(o,0);for(var a=0;a<r;a++)e[t+a]^=o[a]}var r=e.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(e,r){var n=this._cipher,i=n.blockSize;t.call(this,e,r,i,n),this._prevBlock=e.slice(r,r+i)}}),r.Decryptor=r.extend({processBlock:function(e,r){var n=this._cipher,i=n.blockSize,o=e.slice(r,r+i);t.call(this,e,r,i,n),this._prevBlock=o}}),r}(),e.mode.CFB}(r(1),r(2))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return e.mode.CTRGladman=function(){function t(e){if(255==(e>>24&255)){var t=e>>16&255,r=e>>8&255,n=255&e;255===t?(t=0,255===r?(r=0,255===n?n=0:++n):++r):++t,e=0,e+=t<<16,e+=r<<8,e+=n}else e+=1<<24;return e}function r(e){return 0===(e[0]=t(e[0]))&&(e[1]=t(e[1])),e}var n=e.lib.BlockCipherMode.extend(),i=n.Encryptor=n.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,o=this._iv,a=this._counter;o&&(a=this._counter=o.slice(0),this._iv=void 0),r(a);var s=a.slice(0);n.encryptBlock(s,0);for(var l=0;l<i;l++)e[t+l]^=s[l]}});return n.Decryptor=i,n}(),e.mode.CTRGladman}(r(1),r(2))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return e.mode.CTR=function(){var t=e.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,i=this._iv,o=this._counter;i&&(o=this._counter=i.slice(0),this._iv=void 0);var a=o.slice(0);r.encryptBlock(a,0),o[n-1]=o[n-1]+1|0;for(var s=0;s<n;s++)e[t+s]^=a[s]}});return t.Decryptor=r,t}(),e.mode.CTR}(r(1),r(2))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return e.mode.ECB=function(){var t=e.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),t.Decryptor=t.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),t}(),e.mode.ECB}(r(1),r(2))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return e.mode.OFB=function(){var t=e.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,i=this._iv,o=this._keystream;i&&(o=this._keystream=i.slice(0),this._iv=void 0),r.encryptBlock(o,0);for(var a=0;a<n;a++)e[t+a]^=o[a]}});return t.Decryptor=r,t}(),e.mode.OFB}(r(1),r(2))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return e.pad.AnsiX923={pad:function(e,t){var r=e.sigBytes,n=4*t,i=n-r%n,o=r+i-1;e.clamp(),e.words[o>>>2]|=i<<24-o%4*8,e.sigBytes+=i},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Ansix923}(r(1),r(2))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return e.pad.Iso10126={pad:function(t,r){var n=4*r,i=n-t.sigBytes%n;t.concat(e.lib.WordArray.random(i-1)).concat(e.lib.WordArray.create([i<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Iso10126}(r(1),r(2))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return e.pad.Iso97971={pad:function(t,r){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,r)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971}(r(1),r(2))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding}(r(1),r(2))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return e.pad.ZeroPadding={pad:function(e,t){var r=4*t;e.clamp(),e.sigBytes+=r-(e.sigBytes%r||r)},unpad:function(e){for(var t=e.words,r=e.sigBytes-1;!(t[r>>>2]>>>24-r%4*8&255);)r--;e.sigBytes=r+1}},e.pad.ZeroPadding}(r(1),r(2))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return function(){var t=e,r=t.lib,n=r.Base,i=r.WordArray,o=t.algo,a=o.SHA1,s=o.HMAC,l=o.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,n=s.create(r.hasher,e),o=i.create(),a=i.create([1]),l=o.words,u=a.words,c=r.keySize,h=r.iterations;l.length<c;){var d=n.update(t).finalize(a);n.reset();for(var f=d.words,p=f.length,m=d,v=1;v<h;v++){m=n.finalize(m),n.reset();for(var g=m.words,y=0;y<p;y++)f[y]^=g[y]}o.concat(d),u[0]++}return o.sigBytes=4*c,o}});t.PBKDF2=function(e,t,r){return l.create(r).compute(e,t)}}(),e.PBKDF2}(r(1),r(31),r(30))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return function(){function t(){for(var e=this._X,t=this._C,r=0;r<8;r++)s[r]=t[r];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<s[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<s[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<s[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<s[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<s[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<s[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<s[6]>>>0?1:0)|0,this._b=t[7]>>>0<s[7]>>>0?1:0;for(var r=0;r<8;r++){var n=e[r]+t[r],i=65535&n,o=n>>>16,a=((i*i>>>17)+i*o>>>15)+o*o,u=((4294901760&n)*n|0)+((65535&n)*n|0);l[r]=a^u}e[0]=l[0]+(l[7]<<16|l[7]>>>16)+(l[6]<<16|l[6]>>>16)|0,e[1]=l[1]+(l[0]<<8|l[0]>>>24)+l[7]|0,e[2]=l[2]+(l[1]<<16|l[1]>>>16)+(l[0]<<16|l[0]>>>16)|0,e[3]=l[3]+(l[2]<<8|l[2]>>>24)+l[1]|0,e[4]=l[4]+(l[3]<<16|l[3]>>>16)+(l[2]<<16|l[2]>>>16)|0,e[5]=l[5]+(l[4]<<8|l[4]>>>24)+l[3]|0,e[6]=l[6]+(l[5]<<16|l[5]>>>16)+(l[4]<<16|l[4]>>>16)|0,e[7]=l[7]+(l[6]<<8|l[6]>>>24)+l[5]|0}var r=e,n=r.lib,i=n.StreamCipher,o=r.algo,a=[],s=[],l=[],u=o.RabbitLegacy=i.extend({_doReset:function(){var e=this._key.words,r=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var o=0;o<4;o++)t.call(this);for(var o=0;o<8;o++)i[o]^=n[o+4&7];if(r){var a=r.words,s=a[0],l=a[1],u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),c=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8),h=u>>>16|4294901760&c,d=c<<16|65535&u;i[0]^=u,i[1]^=h,i[2]^=c,i[3]^=d,i[4]^=u,i[5]^=h,i[6]^=c,i[7]^=d;for(var o=0;o<4;o++)t.call(this)}},_doProcessBlock:function(e,r){var n=this._X;t.call(this),a[0]=n[0]^n[5]>>>16^n[3]<<16,a[1]=n[2]^n[7]>>>16^n[5]<<16,a[2]=n[4]^n[1]>>>16^n[7]<<16,a[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)a[i]=16711935&(a[i]<<8|a[i]>>>24)|4278255360&(a[i]<<24|a[i]>>>8),e[r+i]^=a[i]},blockSize:4,ivSize:2});r.RabbitLegacy=i._createHelper(u)}(),e.RabbitLegacy}(r(1),r(8),r(9),r(5),r(2))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return function(){function t(){for(var e=this._X,t=this._C,r=0;r<8;r++)s[r]=t[r];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<s[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<s[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<s[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<s[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<s[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<s[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<s[6]>>>0?1:0)|0,this._b=t[7]>>>0<s[7]>>>0?1:0;for(var r=0;r<8;r++){var n=e[r]+t[r],i=65535&n,o=n>>>16,a=((i*i>>>17)+i*o>>>15)+o*o,u=((4294901760&n)*n|0)+((65535&n)*n|0);l[r]=a^u}e[0]=l[0]+(l[7]<<16|l[7]>>>16)+(l[6]<<16|l[6]>>>16)|0,e[1]=l[1]+(l[0]<<8|l[0]>>>24)+l[7]|0,e[2]=l[2]+(l[1]<<16|l[1]>>>16)+(l[0]<<16|l[0]>>>16)|0,e[3]=l[3]+(l[2]<<8|l[2]>>>24)+l[1]|0,e[4]=l[4]+(l[3]<<16|l[3]>>>16)+(l[2]<<16|l[2]>>>16)|0,e[5]=l[5]+(l[4]<<8|l[4]>>>24)+l[3]|0,e[6]=l[6]+(l[5]<<16|l[5]>>>16)+(l[4]<<16|l[4]>>>16)|0,e[7]=l[7]+(l[6]<<8|l[6]>>>24)+l[5]|0}var r=e,n=r.lib,i=n.StreamCipher,o=r.algo,a=[],s=[],l=[],u=o.Rabbit=i.extend({_doReset:function(){for(var e=this._key.words,r=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var i=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var n=0;n<4;n++)t.call(this);for(var n=0;n<8;n++)o[n]^=i[n+4&7];if(r){var a=r.words,s=a[0],l=a[1],u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),c=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8),h=u>>>16|4294901760&c,d=c<<16|65535&u;o[0]^=u,o[1]^=h,o[2]^=c,o[3]^=d,o[4]^=u,o[5]^=h,o[6]^=c,o[7]^=d;for(var n=0;n<4;n++)t.call(this)}},_doProcessBlock:function(e,r){var n=this._X;t.call(this),a[0]=n[0]^n[5]>>>16^n[3]<<16,a[1]=n[2]^n[7]>>>16^n[5]<<16,a[2]=n[4]^n[1]>>>16^n[7]<<16,a[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)a[i]=16711935&(a[i]<<8|a[i]>>>24)|4278255360&(a[i]<<24|a[i]>>>8),e[r+i]^=a[i]},blockSize:4,ivSize:2});r.Rabbit=i._createHelper(u)}(),e.Rabbit}(r(1),r(8),r(9),r(5),r(2))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return function(){function t(){for(var e=this._S,t=this._i,r=this._j,n=0,i=0;i<4;i++){t=(t+1)%256,r=(r+e[t])%256;var o=e[t];e[t]=e[r],e[r]=o,n|=e[(e[t]+e[r])%256]<<24-8*i}return this._i=t,this._j=r,n}var r=e,n=r.lib,i=n.StreamCipher,o=r.algo,a=o.RC4=i.extend({_doReset:function(){for(var e=this._key,t=e.words,r=e.sigBytes,n=this._S=[],i=0;i<256;i++)n[i]=i;for(var i=0,o=0;i<256;i++){var a=i%r,s=t[a>>>2]>>>24-a%4*8&255;o=(o+n[i]+s)%256;var l=n[i];n[i]=n[o],n[o]=l}this._i=this._j=0},_doProcessBlock:function(e,r){e[r]^=t.call(this)},keySize:8,ivSize:0});r.RC4=i._createHelper(a);var s=o.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)t.call(this)}});r.RC4Drop=i._createHelper(s)}(),e.RC4}(r(1),r(8),r(9),r(5),r(2))}()},function(e,t,r){!function(n,i){e.exports=t=function(e){return function(t){function r(e,t,r){return e^t^r}function n(e,t,r){return e&t|~e&r}function i(e,t,r){return(e|~t)^r}function o(e,t,r){return e&r|t&~r}function a(e,t,r){return e^(t|~r)}function s(e,t){return e<<t|e>>>32-t}var l=e,u=l.lib,c=u.WordArray,h=u.Hasher,d=l.algo,f=c.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),p=c.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),m=c.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),v=c.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),g=c.create([0,1518500249,1859775393,2400959708,2840853838]),y=c.create([1352829926,1548603684,1836072691,2053994217,0]),b=d.RIPEMD160=h.extend({_doReset:function(){this._hash=c.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var l=0;l<16;l++){var u=t+l,c=e[u];e[u]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}var h,d,b,_,w,x,M,E,A,T,k=this._hash.words,S=g.words,C=y.words,P=f.words,O=p.words,R=m.words,L=v.words;x=h=k[0],M=d=k[1],E=b=k[2],A=_=k[3],T=w=k[4];for(var I,l=0;l<80;l+=1)I=h+e[t+P[l]]|0,I+=l<16?r(d,b,_)+S[0]:l<32?n(d,b,_)+S[1]:l<48?i(d,b,_)+S[2]:l<64?o(d,b,_)+S[3]:a(d,b,_)+S[4],I|=0,I=s(I,R[l]),I=I+w|0,h=w,w=_,_=s(b,10),b=d,d=I,I=x+e[t+O[l]]|0,I+=l<16?a(M,E,A)+C[0]:l<32?o(M,E,A)+C[1]:l<48?i(M,E,A)+C[2]:l<64?n(M,E,A)+C[3]:r(M,E,A)+C[4],I|=0,I=s(I,L[l]),I=I+T|0,x=T,T=A,A=s(E,10),E=M,M=I;I=k[1]+b+A|0,k[1]=k[2]+_+T|0,k[2]=k[3]+w+x|0,k[3]=k[4]+h+M|0,k[4]=k[0]+d+E|0,k[0]=I},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(t.length+1),this._process();for(var i=this._hash,o=i.words,a=0;a<5;a++){var s=o[a];o[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return i},clone:function(){var e=h.clone.call(this);return e._hash=this._hash.clone(),e}});l.RIPEMD160=h._createHelper(b),l.HmacRIPEMD160=h._createHmacHelper(b)}(Math),e.RIPEMD160}(r(1))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return function(){var t=e,r=t.lib,n=r.WordArray,i=t.algo,o=i.SHA256,a=i.SHA224=o.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=o._doFinalize.call(this);return e.sigBytes-=4,e}});t.SHA224=o._createHelper(a),t.HmacSHA224=o._createHmacHelper(a)}(),e.SHA224}(r(1),r(53))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return function(t){var r=e,n=r.lib,i=n.WordArray,o=n.Hasher,a=r.x64,s=a.Word,l=r.algo,u=[],c=[],h=[];!function(){for(var e=1,t=0,r=0;r<24;r++){u[e+5*t]=(r+1)*(r+2)/2%64;var n=t%5,i=(2*e+3*t)%5;e=n,t=i}for(var e=0;e<5;e++)for(var t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var o=1,a=0;a<24;a++){for(var l=0,d=0,f=0;f<7;f++){if(1&o){var p=(1<<f)-1;p<32?d^=1<<p:l^=1<<p-32}128&o?o=o<<1^113:o<<=1}h[a]=s.create(l,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=s.create()}();var f=l.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new s.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var r=this._state,n=this.blockSize/2,i=0;i<n;i++){var o=e[t+2*i],a=e[t+2*i+1];o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8);var s=r[i];s.high^=a,s.low^=o}for(var l=0;l<24;l++){for(var f=0;f<5;f++){for(var p=0,m=0,v=0;v<5;v++){var s=r[f+5*v];p^=s.high,m^=s.low}var g=d[f];g.high=p,g.low=m}for(var f=0;f<5;f++)for(var y=d[(f+4)%5],b=d[(f+1)%5],_=b.high,w=b.low,p=y.high^(_<<1|w>>>31),m=y.low^(w<<1|_>>>31),v=0;v<5;v++){var s=r[f+5*v];s.high^=p,s.low^=m}for(var x=1;x<25;x++){var s=r[x],M=s.high,E=s.low,A=u[x];if(A<32)var p=M<<A|E>>>32-A,m=E<<A|M>>>32-A;else var p=E<<A-32|M>>>64-A,m=M<<A-32|E>>>64-A;var T=d[c[x]];T.high=p,T.low=m}var k=d[0],S=r[0];k.high=S.high,k.low=S.low;for(var f=0;f<5;f++)for(var v=0;v<5;v++){var x=f+5*v,s=r[x],C=d[x],P=d[(f+1)%5+5*v],O=d[(f+2)%5+5*v];s.high=C.high^~P.high&O.high,s.low=C.low^~P.low&O.low}var s=r[0],R=h[l];s.high^=R.high,s.low^=R.low}},_doFinalize:function(){var e=this._data,r=e.words,n=(this._nDataBytes,8*e.sigBytes),o=32*this.blockSize;r[n>>>5]|=1<<24-n%32,r[(t.ceil((n+1)/o)*o>>>5)-1]|=128,e.sigBytes=4*r.length,this._process();for(var a=this._state,s=this.cfg.outputLength/8,l=s/8,u=[],c=0;c<l;c++){var h=a[c],d=h.high,f=h.low;d=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),u.push(f),u.push(d)}return new i.init(u,s)},clone:function(){for(var e=o.clone.call(this),t=e._state=this._state.slice(0),r=0;r<25;r++)t[r]=t[r].clone();return e}});r.SHA3=o._createHelper(f),r.HmacSHA3=o._createHmacHelper(f)}(Math),e.SHA3}(r(1),r(14))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return function(){var t=e,r=t.x64,n=r.Word,i=r.WordArray,o=t.algo,a=o.SHA512,s=o.SHA384=a.extend({_doReset:function(){this._hash=new i.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=16,e}});t.SHA384=a._createHelper(s),t.HmacSHA384=a._createHmacHelper(s)}(),e.SHA384}(r(1),r(14),r(54))}()},function(e,t,r){!function(n,i,o){e.exports=t=function(e){return function(){function t(e,t){var r=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=r,this._lBlock^=r<<e}function r(e,t){var r=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=r,this._rBlock^=r<<e}var n=e,i=n.lib,o=i.WordArray,a=i.BlockCipher,s=n.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],u=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],h=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],f=s.DES=a.extend({_doReset:function(){for(var e=this._key,t=e.words,r=[],n=0;n<56;n++){var i=l[n]-1;r[n]=t[i>>>5]>>>31-i%32&1}for(var o=this._subKeys=[],a=0;a<16;a++){for(var s=o[a]=[],h=c[a],n=0;n<24;n++)s[n/6|0]|=r[(u[n]-1+h)%28]<<31-n%6,s[4+(n/6|0)]|=r[28+(u[n+24]-1+h)%28]<<31-n%6;s[0]=s[0]<<1|s[0]>>>31;for(var n=1;n<7;n++)s[n]=s[n]>>>4*(n-1)+3;s[7]=s[7]<<5|s[7]>>>27}for(var d=this._invSubKeys=[],n=0;n<16;n++)d[n]=o[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,n,i){this._lBlock=e[n],this._rBlock=e[n+1],t.call(this,4,252645135),t.call(this,16,65535),r.call(this,2,858993459),r.call(this,8,16711935),t.call(this,1,1431655765);for(var o=0;o<16;o++){for(var a=i[o],s=this._lBlock,l=this._rBlock,u=0,c=0;c<8;c++)u|=h[c][((l^a[c])&d[c])>>>0];this._lBlock=l,this._rBlock=s^u}var f=this._lBlock;this._lBlock=this._rBlock,this._rBlock=f,t.call(this,1,1431655765),r.call(this,8,16711935),r.call(this,2,858993459),t.call(this,16,65535),t.call(this,4,252645135),e[n]=this._lBlock,e[n+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});n.DES=a._createHelper(f);var p=s.TripleDES=a.extend({_doReset:function(){var e=this._key,t=e.words;this._des1=f.createEncryptor(o.create(t.slice(0,2))),this._des2=f.createEncryptor(o.create(t.slice(2,4))),this._des3=f.createEncryptor(o.create(t.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});n.TripleDES=a._createHelper(p)}(),e.TripleDES}(r(1),r(8),r(9),r(5),r(2))}()},function(e,t,r){(function(t,r){!function(t,n){e.exports=function(){"use strict";function e(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function i(e){return"function"==typeof e}function o(e){W=e}function a(e){X=e}function s(){return void 0!==G?function(){G(u)}:l()}function l(){var e=setTimeout;return function(){return e(u,1)}}function u(){for(var e=0;e<V;e+=2)(0,J[e])(J[e+1]),J[e]=void 0,J[e+1]=void 0;V=0}function c(e,t){var r=arguments,n=this,i=new this.constructor(d);void 0===i[ee]&&O(i);var o=n._state;return o?function(){var e=r[o-1];X(function(){return S(o,i,e,n._result)})}():E(n,i,e,t),i}function h(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var r=new t(d);return _(r,e),r}function d(){}function f(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function m(e){try{return e.then}catch(e){return ie.error=e,ie}}function v(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}function g(e,t,r){X(function(e){var n=!1,i=v(r,t,function(r){n||(n=!0,t!==r?_(e,r):x(e,r))},function(t){n||(n=!0,M(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&i&&(n=!0,M(e,i))},e)}function y(e,t){t._state===re?x(e,t._result):t._state===ne?M(e,t._result):E(t,void 0,function(t){return _(e,t)},function(t){return M(e,t)})}function b(e,t,r){t.constructor===e.constructor&&r===c&&t.constructor.resolve===h?y(e,t):r===ie?(M(e,ie.error),ie.error=null):void 0===r?x(e,t):i(r)?g(e,t,r):x(e,t)}function _(t,r){t===r?M(t,f()):e(r)?b(t,r,m(r)):x(t,r)}function w(e){e._onerror&&e._onerror(e._result),A(e)}function x(e,t){e._state===te&&(e._result=t,e._state=re,0!==e._subscribers.length&&X(A,e))}function M(e,t){e._state===te&&(e._state=ne,e._result=t,X(w,e))}function E(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+re]=r,i[o+ne]=n,0===o&&e._state&&X(A,e)}function A(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)n=t[a],i=t[a+r],n?S(r,n,i,o):i(o);e._subscribers.length=0}}function T(){this.error=null}function k(e,t){try{return e(t)}catch(e){return oe.error=e,oe}}function S(e,t,r,n){var o=i(r),a=void 0,s=void 0,l=void 0,u=void 0;if(o){if(a=k(r,n),a===oe?(u=!0,s=a.error,a.error=null):l=!0,t===a)return void M(t,p())}else a=n,l=!0;t._state!==te||(o&&l?_(t,a):u?M(t,s):e===re?x(t,a):e===ne&&M(t,a))}function C(e,t){try{t(function(t){_(e,t)},function(t){M(e,t)})}catch(t){M(e,t)}}function P(){return ae++}function O(e){e[ee]=ae++,e._state=void 0,e._result=void 0,e._subscribers=[]}function R(e,t){this._instanceConstructor=e,this.promise=new e(d),this.promise[ee]||O(this.promise),H(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?x(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&x(this.promise,this._result))):M(this.promise,L())}function L(){return new Error("Array Methods must be provided an Array")}function I(e){return new R(this,e).promise}function B(e){var t=this;return new t(H(e)?function(r,n){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(r,n)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function D(e){var t=this,r=new t(d);return M(r,e),r}function j(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function z(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function N(e){this[ee]=P(),this._result=this._state=void 0,this._subscribers=[],d!==e&&("function"!=typeof e&&j(),this instanceof N?C(this,e):z())}function U(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=N}var F=void 0;F=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var H=F,V=0,G=void 0,W=void 0,X=function(e,t){J[V]=e,J[V+1]=t,2===(V+=2)&&(W?W(u):$())},Y="undefined"!=typeof window?window:void 0,q=Y||{},K=q.MutationObserver||q.WebKitMutationObserver,Z="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),Q="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,J=new Array(1e3),$=void 0;$=Z?function(){return function(){return t.nextTick(u)}}():K?function(){var e=0,t=new K(u),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}():Q?function(){var e=new MessageChannel;return e.port1.onmessage=u,function(){return e.port2.postMessage(0)}}():void 0===Y?function(){try{var e=n(151);return G=e.runOnLoop||e.runOnContext,s()}catch(e){return l()}}():l();var ee=Math.random().toString(36).substring(16),te=void 0,re=1,ne=2,ie=new T,oe=new T,ae=0;return R.prototype._enumerate=function(e){for(var t=0;this._state===te&&t<e.length;t++)this._eachEntry(e[t],t)},R.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===h){var i=m(e);if(i===c&&e._state!==te)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===N){var o=new r(d);b(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new r(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},R.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===te&&(this._remaining--,e===ne?M(n,r):this._result[t]=r),0===this._remaining&&x(n,this._result)},R.prototype._willSettleAt=function(e,t){var r=this;E(e,void 0,function(e){return r._settledAt(re,t,e)},function(e){return r._settledAt(ne,t,e)})},N.all=I,N.race=B,N.resolve=h,N.reject=D,N._setScheduler=o,N._setAsap=a,N._asap=X,N.prototype={constructor:N,then:c,catch:function(e){return this.then(null,e)}},N.polyfill=U,N.Promise=N,N}()}()}).call(t,r(149),r(60))},function(e,t){t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,u=l>>1,c=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-c)-1,f>>=-c,c+=s;c>0;o=256*o+e[t+h],h+=d,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=256*a+e[t+h],h+=d,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),o-=u}return(f?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var a,s,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),t+=a+h>=1?d/l:d*Math.pow(2,1-h),t*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(t*l-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+f]=255&s,f+=p,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[r+f]=255&a,f+=p,a/=256,u-=8);e[r+f-p]|=128*m}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";var n=r(4).assign,i=r(141),o=r(142),a=r(57),s={};n(s,i,o,a),e.exports=s},function(e,t,r){"use strict";function n(e){if(!(this instanceof n))return new n(e);this.options=l.assign({level:p,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var r=s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==f)throw new Error(c[r]);if(t.header&&s.deflateSetHeader(this.strm,t.header),t.dictionary){var i;if(i="string"==typeof t.dictionary?u.string2buf(t.dictionary):"[object ArrayBuffer]"===d.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=s.deflateSetDictionary(this.strm,i))!==f)throw new Error(c[r]);this._dict_set=!0}}function i(e,t){var r=new n(t);if(r.push(e,!0),r.err)throw r.msg;return r.result}function o(e,t){return t=t||{},t.raw=!0,i(e,t)}function a(e,t){return t=t||{},t.gzip=!0,i(e,t)}var s=r(143),l=r(4),u=r(55),c=r(32),h=r(59),d=Object.prototype.toString,f=0,p=-1,m=0,v=8;n.prototype.push=function(e,t){var r,n,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:!0===t?4:0,"string"==typeof e?i.input=u.string2buf(e):"[object ArrayBuffer]"===d.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new l.Buf8(o),i.next_out=0,i.avail_out=o),1!==(r=s.deflate(i,n))&&r!==f)return this.onEnd(r),this.ended=!0,!1;0!==i.avail_out&&(0!==i.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(u.buf2binstring(l.shrinkBuf(i.output,i.next_out))):this.onData(l.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&1!==r);return 4===n?(r=s.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===f):2!==n||(this.onEnd(f),i.avail_out=0,!0)},n.prototype.onData=function(e){this.chunks.push(e)},n.prototype.onEnd=function(e){e===f&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=n,t.deflate=i,t.deflateRaw=o,t.gzip=a},function(e,t,r){"use strict";function n(e){if(!(this instanceof n))return new n(e);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var r=a.inflateInit2(this.strm,t.windowBits);if(r!==u.Z_OK)throw new Error(c[r]);this.header=new d,a.inflateGetHeader(this.strm,this.header)}function i(e,t){var r=new n(t);if(r.push(e,!0),r.err)throw r.msg;return r.result}function o(e,t){return t=t||{},t.raw=!0,i(e,t)}var a=r(146),s=r(4),l=r(55),u=r(57),c=r(32),h=r(59),d=r(144),f=Object.prototype.toString;n.prototype.push=function(e,t){var r,n,i,o,c,h,d=this.strm,p=this.options.chunkSize,m=this.options.dictionary,v=!1;if(this.ended)return!1;n=t===~~t?t:!0===t?u.Z_FINISH:u.Z_NO_FLUSH,"string"==typeof e?d.input=l.binstring2buf(e):"[object ArrayBuffer]"===f.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new s.Buf8(p),d.next_out=0,d.avail_out=p),r=a.inflate(d,u.Z_NO_FLUSH),r===u.Z_NEED_DICT&&m&&(h="string"==typeof m?l.string2buf(m):"[object ArrayBuffer]"===f.call(m)?new Uint8Array(m):m,r=a.inflateSetDictionary(this.strm,h)),r===u.Z_BUF_ERROR&&!0===v&&(r=u.Z_OK,v=!1),r!==u.Z_STREAM_END&&r!==u.Z_OK)return this.onEnd(r),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&r!==u.Z_STREAM_END&&(0!==d.avail_in||n!==u.Z_FINISH&&n!==u.Z_SYNC_FLUSH)||("string"===this.options.to?(i=l.utf8border(d.output,d.next_out),o=d.next_out-i,c=l.buf2string(d.output,i),d.next_out=o,d.avail_out=p-o,o&&s.arraySet(d.output,d.output,i,o,0),this.onData(c)):this.onData(s.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(v=!0)}while((d.avail_in>0||0===d.avail_out)&&r!==u.Z_STREAM_END);return r===u.Z_STREAM_END&&(n=u.Z_FINISH),n===u.Z_FINISH?(r=a.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===u.Z_OK):n!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),d.avail_out=0,!0)},n.prototype.onData=function(e){this.chunks.push(e)},n.prototype.onEnd=function(e){e===u.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=n,t.inflate=i,t.inflateRaw=o,t.ungzip=i},function(e,t,r){"use strict";function n(e,t){return e.msg=I[t],t}function i(e){return(e<<1)-(e>4?9:0)}function o(e){for(var t=e.length;--t>=0;)e[t]=0}function a(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(P.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function s(e,t){O._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,a(e.strm)}function l(e,t){e.pending_buf[e.pending++]=t}function u(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function c(e,t,r,n){var i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,P.arraySet(t,e.input,e.next_in,i,r),1===e.state.wrap?e.adler=R(e.adler,t,i,r):2===e.state.wrap&&(e.adler=L(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)}function h(e,t){var r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-ue?e.strstart-(e.w_size-ue):0,u=e.window,c=e.w_mask,h=e.prev,d=e.strstart+le,f=u[o+a-1],p=u[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(r=t,u[r+a]===p&&u[r+a-1]===f&&u[r]===u[o]&&u[++r]===u[o+1]){o+=2,r++;do{}while(u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&o<d);if(n=le-(d-o),o=d-le,n>a){if(e.match_start=t,a=n,n>=s)break;f=u[o+a-1],p=u[o+a]}}}while((t=h[t&c])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function d(e){var t,r,n,i,o,a=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-ue)){P.arraySet(e.window,e.window,a,a,0),e.match_start-=a,e.strstart-=a,e.block_start-=a,r=e.hash_size,t=r;do{n=e.head[--t],e.head[t]=n>=a?n-a:0}while(--r);r=a,t=r;do{n=e.prev[--t],e.prev[t]=n>=a?n-a:0}while(--r);i+=a}if(0===e.strm.avail_in)break;if(r=c(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=se)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+se-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<se)););}while(e.lookahead<ue&&0!==e.strm.avail_in)}function f(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(d(e),0===e.lookahead&&t===B)return ye;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,s(e,!1),0===e.strm.avail_out))return ye;if(e.strstart-e.block_start>=e.w_size-ue&&(s(e,!1),0===e.strm.avail_out))return ye}return e.insert=0,t===z?(s(e,!0),0===e.strm.avail_out?_e:we):(e.strstart>e.block_start&&(s(e,!1),e.strm.avail_out),ye)}function p(e,t){for(var r,n;;){if(e.lookahead<ue){if(d(e),e.lookahead<ue&&t===B)return ye;if(0===e.lookahead)break}if(r=0,e.lookahead>=se&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+se-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-ue&&(e.match_length=h(e,r)),e.match_length>=se)if(n=O._tr_tally(e,e.strstart-e.match_start,e.match_length-se),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=se){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+se-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=O._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(s(e,!1),0===e.strm.avail_out))return ye}return e.insert=e.strstart<se-1?e.strstart:se-1,t===z?(s(e,!0),0===e.strm.avail_out?_e:we):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?ye:be}function m(e,t){for(var r,n,i;;){if(e.lookahead<ue){if(d(e),e.lookahead<ue&&t===B)return ye;if(0===e.lookahead)break}if(r=0,e.lookahead>=se&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+se-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=se-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-ue&&(e.match_length=h(e,r),e.match_length<=5&&(e.strategy===X||e.match_length===se&&e.strstart-e.match_start>4096)&&(e.match_length=se-1)),e.prev_length>=se&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-se,n=O._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-se),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+se-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=se-1,e.strstart++,n&&(s(e,!1),0===e.strm.avail_out))return ye}else if(e.match_available){if(n=O._tr_tally(e,0,e.window[e.strstart-1]),n&&s(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return ye}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=O._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<se-1?e.strstart:se-1,t===z?(s(e,!0),0===e.strm.avail_out?_e:we):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?ye:be}function v(e,t){for(var r,n,i,o,a=e.window;;){if(e.lookahead<=le){if(d(e),e.lookahead<=le&&t===B)return ye;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=se&&e.strstart>0&&(i=e.strstart-1,(n=a[i])===a[++i]&&n===a[++i]&&n===a[++i])){o=e.strstart+le;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);e.match_length=le-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=se?(r=O._tr_tally(e,1,e.match_length-se),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=O._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(s(e,!1),0===e.strm.avail_out))return ye}return e.insert=0,t===z?(s(e,!0),0===e.strm.avail_out?_e:we):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?ye:be}function g(e,t){for(var r;;){if(0===e.lookahead&&(d(e),0===e.lookahead)){if(t===B)return ye;break}if(e.match_length=0,r=O._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(s(e,!1),0===e.strm.avail_out))return ye}return e.insert=0,t===z?(s(e,!0),0===e.strm.avail_out?_e:we):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?ye:be}function y(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function b(e){e.window_size=2*e.w_size,o(e.head),e.max_lazy_match=C[e.level].max_lazy,e.good_match=C[e.level].good_length,e.nice_match=C[e.level].nice_length,e.max_chain_length=C[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=se-1,e.match_available=0,e.ins_h=0}function _(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=J,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new P.Buf16(2*oe),this.dyn_dtree=new P.Buf16(2*(2*ne+1)),this.bl_tree=new P.Buf16(2*(2*ie+1)),o(this.dyn_ltree),o(this.dyn_dtree),o(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new P.Buf16(ae+1),this.heap=new P.Buf16(2*re+1),o(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new P.Buf16(2*re+1),o(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function w(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=Q,t=e.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?he:ve,e.adler=2===t.wrap?0:1,t.last_flush=B,O._tr_init(t),U):n(e,H)}function x(e){var t=w(e);return t===U&&b(e.state),t}function M(e,t){return e&&e.state?2!==e.state.wrap?H:(e.state.gzhead=t,U):H}function E(e,t,r,i,o,a){if(!e)return H;var s=1;if(t===W&&(t=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),o<1||o>$||r!==J||i<8||i>15||t<0||t>9||a<0||a>K)return n(e,H);8===i&&(i=9);var l=new _;return e.state=l,l.strm=e,l.wrap=s,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+se-1)/se),l.window=new P.Buf8(2*l.w_size),l.head=new P.Buf16(l.hash_size),l.prev=new P.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new P.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=r,x(e)}function A(e,t){return E(e,t,J,ee,te,Z)}function T(e,t){var r,s,c,h;if(!e||!e.state||t>N||t<0)return e?n(e,H):H;if(s=e.state,!e.output||!e.input&&0!==e.avail_in||s.status===ge&&t!==z)return n(e,0===e.avail_out?G:H);if(s.strm=e,r=s.last_flush,s.last_flush=t,s.status===he)if(2===s.wrap)e.adler=0,l(s,31),l(s,139),l(s,8),s.gzhead?(l(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),l(s,255&s.gzhead.time),l(s,s.gzhead.time>>8&255),l(s,s.gzhead.time>>16&255),l(s,s.gzhead.time>>24&255),l(s,9===s.level?2:s.strategy>=Y||s.level<2?4:0),l(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(l(s,255&s.gzhead.extra.length),l(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=L(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=de):(l(s,0),l(s,0),l(s,0),l(s,0),l(s,0),l(s,9===s.level?2:s.strategy>=Y||s.level<2?4:0),l(s,xe),s.status=ve);else{var d=J+(s.w_bits-8<<4)<<8,f=-1;f=s.strategy>=Y||s.level<2?0:s.level<6?1:6===s.level?2:3,d|=f<<6,0!==s.strstart&&(d|=ce),d+=31-d%31,s.status=ve,u(s,d),0!==s.strstart&&(u(s,e.adler>>>16),u(s,65535&e.adler)),e.adler=1}if(s.status===de)if(s.gzhead.extra){for(c=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>c&&(e.adler=L(e.adler,s.pending_buf,s.pending-c,c)),a(e),c=s.pending,s.pending!==s.pending_buf_size));)l(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>c&&(e.adler=L(e.adler,s.pending_buf,s.pending-c,c)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=fe)}else s.status=fe;if(s.status===fe)if(s.gzhead.name){c=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>c&&(e.adler=L(e.adler,s.pending_buf,s.pending-c,c)),a(e),c=s.pending,s.pending===s.pending_buf_size)){h=1;break}h=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,l(s,h)}while(0!==h);s.gzhead.hcrc&&s.pending>c&&(e.adler=L(e.adler,s.pending_buf,s.pending-c,c)),0===h&&(s.gzindex=0,s.status=pe)}else s.status=pe;if(s.status===pe)if(s.gzhead.comment){c=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>c&&(e.adler=L(e.adler,s.pending_buf,s.pending-c,c)),a(e),c=s.pending,s.pending===s.pending_buf_size)){h=1;break}h=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,l(s,h)}while(0!==h);s.gzhead.hcrc&&s.pending>c&&(e.adler=L(e.adler,s.pending_buf,s.pending-c,c)),0===h&&(s.status=me)}else s.status=me;if(s.status===me&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&a(e),s.pending+2<=s.pending_buf_size&&(l(s,255&e.adler),l(s,e.adler>>8&255),e.adler=0,s.status=ve)):s.status=ve),0!==s.pending){if(a(e),0===e.avail_out)return s.last_flush=-1,U}else if(0===e.avail_in&&i(t)<=i(r)&&t!==z)return n(e,G);if(s.status===ge&&0!==e.avail_in)return n(e,G);if(0!==e.avail_in||0!==s.lookahead||t!==B&&s.status!==ge){var p=s.strategy===Y?g(s,t):s.strategy===q?v(s,t):C[s.level].func(s,t);if(p!==_e&&p!==we||(s.status=ge),p===ye||p===_e)return 0===e.avail_out&&(s.last_flush=-1),U;if(p===be&&(t===D?O._tr_align(s):t!==N&&(O._tr_stored_block(s,0,0,!1),t===j&&(o(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),a(e),0===e.avail_out))return s.last_flush=-1,U}return t!==z?U:s.wrap<=0?F:(2===s.wrap?(l(s,255&e.adler),l(s,e.adler>>8&255),l(s,e.adler>>16&255),l(s,e.adler>>24&255),l(s,255&e.total_in),l(s,e.total_in>>8&255),l(s,e.total_in>>16&255),l(s,e.total_in>>24&255)):(u(s,e.adler>>>16),u(s,65535&e.adler)),a(e),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?U:F)}function k(e){var t;return e&&e.state?(t=e.state.status)!==he&&t!==de&&t!==fe&&t!==pe&&t!==me&&t!==ve&&t!==ge?n(e,H):(e.state=null,t===ve?n(e,V):U):H}function S(e,t){var r,n,i,a,s,l,u,c,h=t.length;if(!e||!e.state)return H;if(r=e.state,2===(a=r.wrap)||1===a&&r.status!==he||r.lookahead)return H;for(1===a&&(e.adler=R(e.adler,t,h,0)),r.wrap=0,h>=r.w_size&&(0===a&&(o(r.head),r.strstart=0,r.block_start=0,r.insert=0),c=new P.Buf8(r.w_size),P.arraySet(c,t,h-r.w_size,r.w_size,0),t=c,h=r.w_size),s=e.avail_in,l=e.next_in,u=e.input,e.avail_in=h,e.next_in=0,e.input=t,d(r);r.lookahead>=se;){n=r.strstart,i=r.lookahead-(se-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+se-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--i);r.strstart=n,r.lookahead=se-1,d(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=se-1,r.match_available=0,e.next_in=l,e.input=u,e.avail_in=s,r.wrap=a,U}var C,P=r(4),O=r(148),R=r(56),L=r(58),I=r(32),B=0,D=1,j=3,z=4,N=5,U=0,F=1,H=-2,V=-3,G=-5,W=-1,X=1,Y=2,q=3,K=4,Z=0,Q=2,J=8,$=9,ee=15,te=8,re=286,ne=30,ie=19,oe=2*re+1,ae=15,se=3,le=258,ue=le+se+1,ce=32,he=42,de=69,fe=73,pe=91,me=103,ve=113,ge=666,ye=1,be=2,_e=3,we=4,xe=3;C=[new y(0,0,0,0,f),new y(4,4,8,4,p),new y(4,5,16,8,p),new y(4,6,32,32,p),new y(4,4,16,16,m),new y(8,16,32,32,m),new y(8,16,128,128,m),new y(8,32,128,256,m),new y(32,128,258,1024,m),new y(32,258,258,4096,m)],t.deflateInit=A,t.deflateInit2=E,t.deflateReset=x,t.deflateResetKeep=w,t.deflateSetHeader=M,t.deflate=T,t.deflateEnd=k,t.deflateSetDictionary=S,t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,r){"use strict";function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=n},function(e,t,r){"use strict";e.exports=function(e,t){var r,n,i,o,a,s,l,u,c,h,d,f,p,m,v,g,y,b,_,w,x,M,E,A,T;r=e.state,n=e.next_in,A=e.input,i=n+(e.avail_in-5),o=e.next_out,T=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=r.dmax,u=r.wsize,c=r.whave,h=r.wnext,d=r.window,f=r.hold,p=r.bits,m=r.lencode,v=r.distcode,g=(1<<r.lenbits)-1,y=(1<<r.distbits)-1;e:do{p<15&&(f+=A[n++]<<p,p+=8,f+=A[n++]<<p,p+=8),b=m[f&g];t:for(;;){if(_=b>>>24,f>>>=_,p-=_,0==(_=b>>>16&255))T[o++]=65535&b;else{if(!(16&_)){if(0==(64&_)){b=m[(65535&b)+(f&(1<<_)-1)];continue t}if(32&_){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}w=65535&b,_&=15,_&&(p<_&&(f+=A[n++]<<p,p+=8),w+=f&(1<<_)-1,f>>>=_,p-=_),p<15&&(f+=A[n++]<<p,p+=8,f+=A[n++]<<p,p+=8),b=v[f&y];r:for(;;){if(_=b>>>24,f>>>=_,p-=_,!(16&(_=b>>>16&255))){if(0==(64&_)){b=v[(65535&b)+(f&(1<<_)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(x=65535&b,_&=15,p<_&&(f+=A[n++]<<p,(p+=8)<_&&(f+=A[n++]<<p,p+=8)),(x+=f&(1<<_)-1)>l){e.msg="invalid distance too far back",r.mode=30;break e}if(f>>>=_,p-=_,_=o-a,x>_){if((_=x-_)>c&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(M=0,E=d,0===h){if(M+=u-_,_<w){w-=_;do{T[o++]=d[M++]}while(--_);M=o-x,E=T}}else if(h<_){if(M+=u+h-_,(_-=h)<w){w-=_;do{T[o++]=d[M++]}while(--_);if(M=0,h<w){_=h,w-=_;do{T[o++]=d[M++]}while(--_);M=o-x,E=T}}}else if(M+=h-_,_<w){w-=_;do{T[o++]=d[M++]}while(--_);M=o-x,E=T}for(;w>2;)T[o++]=E[M++],T[o++]=E[M++],T[o++]=E[M++],w-=3;w&&(T[o++]=E[M++],w>1&&(T[o++]=E[M++]))}else{M=o-x;do{T[o++]=T[M++],T[o++]=T[M++],T[o++]=T[M++],w-=3}while(w>2);w&&(T[o++]=T[M++],w>1&&(T[o++]=T[M++]))}break}}break}}while(n<i&&o<s);w=p>>3,n-=w,p-=w<<3,f&=(1<<p)-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=f,r.bits=p}},function(e,t,r){"use strict";function n(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function i(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new y.Buf16(320),this.work=new y.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function o(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=j,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new y.Buf32(me),t.distcode=t.distdyn=new y.Buf32(ve),t.sane=1,t.back=-1,C):R}function a(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,o(e)):R}function s(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?R:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,a(e))):R}function l(e,t){var r,n;return e?(n=new i,e.state=n,n.window=null,r=s(e,t),r!==C&&(e.state=null),r):R}function u(e){return l(e,ge)}function c(e){if(ye){var t;for(v=new y.Buf32(512),g=new y.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(x(E,e.lens,0,288,v,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;x(A,e.lens,0,32,g,0,e.work,{bits:5}),ye=!1}e.lencode=v,e.lenbits=9,e.distcode=g,e.distbits=5}function h(e,t,r,n){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new y.Buf8(o.wsize)),n>=o.wsize?(y.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),y.arraySet(o.window,t,r-n,i,o.wnext),n-=i,n?(y.arraySet(o.window,t,r-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}function d(e,t){var r,i,o,a,s,l,u,d,f,p,m,v,g,me,ve,ge,ye,be,_e,we,xe,Me,Ee,Ae,Te=0,ke=new y.Buf8(4),Se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return R;r=e.state,r.mode===q&&(r.mode=K),s=e.next_out,o=e.output,u=e.avail_out,a=e.next_in,i=e.input,l=e.avail_in,d=r.hold,f=r.bits,p=l,m=u,Me=C;e:for(;;)switch(r.mode){case j:if(0===r.wrap){r.mode=K;break}for(;f<16;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}if(2&r.wrap&&35615===d){r.check=0,ke[0]=255&d,ke[1]=d>>>8&255,r.check=_(r.check,ke,2,0),d=0,f=0,r.mode=z;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",r.mode=de;break}if((15&d)!==D){e.msg="unknown compression method",r.mode=de;break}if(d>>>=4,f-=4,xe=8+(15&d),0===r.wbits)r.wbits=xe;else if(xe>r.wbits){e.msg="invalid window size",r.mode=de;break}r.dmax=1<<xe,e.adler=r.check=1,r.mode=512&d?X:q,d=0,f=0;break;case z:for(;f<16;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}if(r.flags=d,(255&r.flags)!==D){e.msg="unknown compression method",r.mode=de;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=de;break}r.head&&(r.head.text=d>>8&1),512&r.flags&&(ke[0]=255&d,ke[1]=d>>>8&255,r.check=_(r.check,ke,2,0)),d=0,f=0,r.mode=N;case N:for(;f<32;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}r.head&&(r.head.time=d),512&r.flags&&(ke[0]=255&d,ke[1]=d>>>8&255,ke[2]=d>>>16&255,ke[3]=d>>>24&255,r.check=_(r.check,ke,4,0)),d=0,f=0,r.mode=U;case U:for(;f<16;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}r.head&&(r.head.xflags=255&d,r.head.os=d>>8),512&r.flags&&(ke[0]=255&d,ke[1]=d>>>8&255,r.check=_(r.check,ke,2,0)),d=0,f=0,r.mode=F;case F:if(1024&r.flags){for(;f<16;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}r.length=d,r.head&&(r.head.extra_len=d),512&r.flags&&(ke[0]=255&d,ke[1]=d>>>8&255,r.check=_(r.check,ke,2,0)),d=0,f=0}else r.head&&(r.head.extra=null);r.mode=H;case H:if(1024&r.flags&&(v=r.length,v>l&&(v=l),v&&(r.head&&(xe=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),y.arraySet(r.head.extra,i,a,v,xe)),512&r.flags&&(r.check=_(r.check,i,v,a)),l-=v,a+=v,r.length-=v),r.length))break e;r.length=0,r.mode=V;case V:if(2048&r.flags){if(0===l)break e;v=0;do{xe=i[a+v++],r.head&&xe&&r.length<65536&&(r.head.name+=String.fromCharCode(xe))}while(xe&&v<l);if(512&r.flags&&(r.check=_(r.check,i,v,a)),l-=v,a+=v,xe)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=G;case G:if(4096&r.flags){if(0===l)break e;v=0;do{xe=i[a+v++],r.head&&xe&&r.length<65536&&(r.head.comment+=String.fromCharCode(xe))}while(xe&&v<l);if(512&r.flags&&(r.check=_(r.check,i,v,a)),l-=v,a+=v,xe)break e}else r.head&&(r.head.comment=null);r.mode=W;case W:if(512&r.flags){for(;f<16;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}if(d!==(65535&r.check)){e.msg="header crc mismatch",r.mode=de;break}d=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=q;break;case X:for(;f<32;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}e.adler=r.check=n(d),d=0,f=0,r.mode=Y;case Y:if(0===r.havedict)return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=l,r.hold=d,r.bits=f,O;e.adler=r.check=1,r.mode=q;case q:if(t===k||t===S)break e;case K:if(r.last){d>>>=7&f,f-=7&f,r.mode=ue;break}for(;f<3;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}switch(r.last=1&d,d>>>=1,f-=1,3&d){case 0:r.mode=Z;break;case 1:if(c(r),r.mode=re,t===S){d>>>=2,f-=2;break e}break;case 2:r.mode=$;break;case 3:e.msg="invalid block type",r.mode=de}d>>>=2,f-=2;break;case Z:for(d>>>=7&f,f-=7&f;f<32;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}if((65535&d)!=(d>>>16^65535)){e.msg="invalid stored block lengths",r.mode=de;break}if(r.length=65535&d,d=0,f=0,r.mode=Q,t===S)break e;case Q:r.mode=J;case J:if(v=r.length){if(v>l&&(v=l),v>u&&(v=u),0===v)break e;y.arraySet(o,i,a,v,s),l-=v,a+=v,u-=v,s+=v,r.length-=v;break}r.mode=q;break;case $:for(;f<14;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}if(r.nlen=257+(31&d),d>>>=5,f-=5,r.ndist=1+(31&d),d>>>=5,f-=5,r.ncode=4+(15&d),d>>>=4,f-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=de;break}r.have=0,r.mode=ee;case ee:for(;r.have<r.ncode;){for(;f<3;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}r.lens[Se[r.have++]]=7&d,d>>>=3,f-=3}for(;r.have<19;)r.lens[Se[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Ee={bits:r.lenbits},Me=x(M,r.lens,0,19,r.lencode,0,r.work,Ee),r.lenbits=Ee.bits,Me){e.msg="invalid code lengths set",r.mode=de;break}r.have=0,r.mode=te;case te:for(;r.have<r.nlen+r.ndist;){for(;Te=r.lencode[d&(1<<r.lenbits)-1],ve=Te>>>24,ge=Te>>>16&255,ye=65535&Te,!(ve<=f);){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}if(ye<16)d>>>=ve,f-=ve,r.lens[r.have++]=ye;else{if(16===ye){for(Ae=ve+2;f<Ae;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}if(d>>>=ve,f-=ve,0===r.have){e.msg="invalid bit length repeat",r.mode=de;break}xe=r.lens[r.have-1],v=3+(3&d),d>>>=2,f-=2}else if(17===ye){for(Ae=ve+3;f<Ae;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}d>>>=ve,f-=ve,xe=0,v=3+(7&d),d>>>=3,f-=3}else{for(Ae=ve+7;f<Ae;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}d>>>=ve,f-=ve,xe=0,v=11+(127&d),d>>>=7,f-=7}if(r.have+v>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=de;break}for(;v--;)r.lens[r.have++]=xe}}if(r.mode===de)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=de;break}if(r.lenbits=9,Ee={bits:r.lenbits},Me=x(E,r.lens,0,r.nlen,r.lencode,0,r.work,Ee),r.lenbits=Ee.bits,Me){e.msg="invalid literal/lengths set",r.mode=de;break}if(r.distbits=6,r.distcode=r.distdyn,Ee={bits:r.distbits},Me=x(A,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Ee),r.distbits=Ee.bits,Me){e.msg="invalid distances set",r.mode=de;break}if(r.mode=re,t===S)break e;case re:r.mode=ne;case ne:if(l>=6&&u>=258){e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=l,r.hold=d,r.bits=f,w(e,m),s=e.next_out,o=e.output,u=e.avail_out,a=e.next_in,i=e.input,l=e.avail_in,d=r.hold,f=r.bits,r.mode===q&&(r.back=-1);break}for(r.back=0;Te=r.lencode[d&(1<<r.lenbits)-1],ve=Te>>>24,ge=Te>>>16&255,ye=65535&Te,!(ve<=f);){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}if(ge&&0==(240&ge)){for(be=ve,_e=ge,we=ye;Te=r.lencode[we+((d&(1<<be+_e)-1)>>be)],ve=Te>>>24,ge=Te>>>16&255,ye=65535&Te,!(be+ve<=f);){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}d>>>=be,f-=be,r.back+=be}if(d>>>=ve,f-=ve,r.back+=ve,r.length=ye,0===ge){r.mode=le;break}if(32&ge){r.back=-1,r.mode=q;break}if(64&ge){e.msg="invalid literal/length code",r.mode=de;break}r.extra=15&ge,r.mode=ie;case ie:if(r.extra){for(Ae=r.extra;f<Ae;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=oe;case oe:for(;Te=r.distcode[d&(1<<r.distbits)-1],ve=Te>>>24,ge=Te>>>16&255,ye=65535&Te,!(ve<=f);){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}if(0==(240&ge)){for(be=ve,_e=ge,we=ye;Te=r.distcode[we+((d&(1<<be+_e)-1)>>be)],ve=Te>>>24,ge=Te>>>16&255,ye=65535&Te,!(be+ve<=f);){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}d>>>=be,f-=be,r.back+=be}if(d>>>=ve,f-=ve,r.back+=ve,64&ge){e.msg="invalid distance code",r.mode=de;break}r.offset=ye,r.extra=15&ge,r.mode=ae;case ae:if(r.extra){for(Ae=r.extra;f<Ae;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=de;break}r.mode=se;case se:if(0===u)break e;if(v=m-u,r.offset>v){if((v=r.offset-v)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=de;break}v>r.wnext?(v-=r.wnext,g=r.wsize-v):g=r.wnext-v,v>r.length&&(v=r.length),me=r.window}else me=o,g=s-r.offset,v=r.length;v>u&&(v=u),u-=v,r.length-=v;do{o[s++]=me[g++]}while(--v);0===r.length&&(r.mode=ne);break;case le:if(0===u)break e;o[s++]=r.length,u--,r.mode=ne;break;case ue:if(r.wrap){for(;f<32;){if(0===l)break e;l--,d|=i[a++]<<f,f+=8}if(m-=u,e.total_out+=m,r.total+=m,m&&(e.adler=r.check=r.flags?_(r.check,o,m,s-m):b(r.check,o,m,s-m)),m=u,(r.flags?d:n(d))!==r.check){e.msg="incorrect data check",r.mode=de;break}d=0,f=0}r.mode=ce;case ce:if(r.wrap&&r.flags){for(;f<32;){if(0===l)break e;l--,d+=i[a++]<<f,f+=8}if(d!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=de;break}d=0,f=0}r.mode=he;case he:Me=P;break e;case de:Me=L;break e;case fe:return I;case pe:default:return R}return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=l,r.hold=d,r.bits=f,(r.wsize||m!==e.avail_out&&r.mode<de&&(r.mode<ue||t!==T))&&h(e,e.output,e.next_out,m-e.avail_out)?(r.mode=fe,I):(p-=e.avail_in,m-=e.avail_out,e.total_in+=p,e.total_out+=m,r.total+=m,r.wrap&&m&&(e.adler=r.check=r.flags?_(r.check,o,m,e.next_out-m):b(r.check,o,m,e.next_out-m)),e.data_type=r.bits+(r.last?64:0)+(r.mode===q?128:0)+(r.mode===re||r.mode===Q?256:0),(0===p&&0===m||t===T)&&Me===C&&(Me=B),Me)}function f(e){if(!e||!e.state)return R;var t=e.state;return t.window&&(t.window=null),e.state=null,C}function p(e,t){var r;return e&&e.state?(r=e.state,0==(2&r.wrap)?R:(r.head=t,t.done=!1,C)):R}function m(e,t){var r,n,i=t.length;return e&&e.state?(r=e.state,0!==r.wrap&&r.mode!==Y?R:r.mode===Y&&(n=1,(n=b(n,t,i,0))!==r.check)?L:h(e,t,i,i)?(r.mode=fe,I):(r.havedict=1,C)):R}var v,g,y=r(4),b=r(56),_=r(58),w=r(145),x=r(147),M=0,E=1,A=2,T=4,k=5,S=6,C=0,P=1,O=2,R=-2,L=-3,I=-4,B=-5,D=8,j=1,z=2,N=3,U=4,F=5,H=6,V=7,G=8,W=9,X=10,Y=11,q=12,K=13,Z=14,Q=15,J=16,$=17,ee=18,te=19,re=20,ne=21,ie=22,oe=23,ae=24,se=25,le=26,ue=27,ce=28,he=29,de=30,fe=31,pe=32,me=852,ve=592,ge=15,ye=!0;t.inflateReset=a,t.inflateReset2=s,t.inflateResetKeep=o,t.inflateInit=u,t.inflateInit2=l,t.inflate=d,t.inflateEnd=f,t.inflateGetHeader=p,t.inflateSetDictionary=m,t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,r){"use strict";var n=r(4),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,r,l,u,c,h,d){var f,p,m,v,g,y,b,_,w,x=d.bits,M=0,E=0,A=0,T=0,k=0,S=0,C=0,P=0,O=0,R=0,L=null,I=0,B=new n.Buf16(16),D=new n.Buf16(16),j=null,z=0;for(M=0;M<=15;M++)B[M]=0;for(E=0;E<l;E++)B[t[r+E]]++;for(k=x,T=15;T>=1&&0===B[T];T--);if(k>T&&(k=T),0===T)return u[c++]=20971520,u[c++]=20971520,d.bits=1,0;for(A=1;A<T&&0===B[A];A++);for(k<A&&(k=A),P=1,M=1;M<=15;M++)if(P<<=1,(P-=B[M])<0)return-1;if(P>0&&(0===e||1!==T))return-1;for(D[1]=0,M=1;M<15;M++)D[M+1]=D[M]+B[M];for(E=0;E<l;E++)0!==t[r+E]&&(h[D[t[r+E]]++]=E);if(0===e?(L=j=h,y=19):1===e?(L=i,I-=257,j=o,z-=257,y=256):(L=a,j=s,y=-1),R=0,E=0,M=A,g=c,S=k,C=0,m=-1,O=1<<k,v=O-1,1===e&&O>852||2===e&&O>592)return 1;for(var N=0;;){N++,b=M-C,h[E]<y?(_=0,w=h[E]):h[E]>y?(_=j[z+h[E]],w=L[I+h[E]]):(_=96,w=0),f=1<<M-C,p=1<<S,A=p;do{p-=f,u[g+(R>>C)+p]=b<<24|_<<16|w|0}while(0!==p);for(f=1<<M-1;R&f;)f>>=1;if(0!==f?(R&=f-1,R+=f):R=0,E++,0==--B[M]){if(M===T)break;M=t[r+h[E]]}if(M>k&&(R&v)!==m){for(0===C&&(C=k),g+=A,S=M-C,P=1<<S;S+C<T&&!((P-=B[S+C])<=0);)S++,P<<=1;if(O+=1<<S,1===e&&O>852||2===e&&O>592)return 1;m=R&v,u[m]=k<<24|S<<16|g-c|0}}return 0!==R&&(u[g+R]=M-C<<24|64<<16|0),d.bits=k,0}},function(e,t,r){"use strict";function n(e){for(var t=e.length;--t>=0;)e[t]=0}function i(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function o(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function a(e){return e<256?oe[e]:oe[256+(e>>>7)]}function s(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function l(e,t,r){e.bi_valid>Y-r?(e.bi_buf|=t<<e.bi_valid&65535,s(e,e.bi_buf),e.bi_buf=t>>Y-e.bi_valid,e.bi_valid+=r-Y):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function u(e,t,r){l(e,r[2*t],r[2*t+1])}function c(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function h(e){16===e.bi_valid?(s(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function d(e,t){var r,n,i,o,a,s,l=t.dyn_tree,u=t.max_code,c=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(o=0;o<=X;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<W;r++)n=e.heap[r],o=l[2*l[2*n+1]+1]+1,o>p&&(o=p,m++),l[2*n+1]=o,n>u||(e.bl_count[o]++,a=0,n>=f&&(a=d[n-f]),s=l[2*n],e.opt_len+=s*(o+a),h&&(e.static_len+=s*(c[2*n+1]+a)));if(0!==m){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(o=p;0!==o;o--)for(n=e.bl_count[o];0!==n;)(i=e.heap[--r])>u||(l[2*i+1]!==o&&(e.opt_len+=(o-l[2*i+1])*l[2*i],l[2*i+1]=o),n--)}}function f(e,t,r){var n,i,o=new Array(X+1),a=0;for(n=1;n<=X;n++)o[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=c(o[s]++,s))}}function p(){var e,t,r,n,o,a=new Array(X+1);for(r=0,n=0;n<U-1;n++)for(se[n]=r,e=0;e<1<<$[n];e++)ae[r++]=n;for(ae[r-1]=n,o=0,n=0;n<16;n++)for(le[n]=o,e=0;e<1<<ee[n];e++)oe[o++]=n;for(o>>=7;n<V;n++)for(le[n]=o<<7,e=0;e<1<<ee[n]-7;e++)oe[256+o++]=n;for(t=0;t<=X;t++)a[t]=0;for(e=0;e<=143;)ne[2*e+1]=8,e++,a[8]++;for(;e<=255;)ne[2*e+1]=9,e++,a[9]++;for(;e<=279;)ne[2*e+1]=7,e++,a[7]++;for(;e<=287;)ne[2*e+1]=8,e++,a[8]++;for(f(ne,H+1,a),e=0;e<V;e++)ie[2*e+1]=5,ie[2*e]=c(e,5);ue=new i(ne,$,F+1,H,X),ce=new i(ie,ee,0,V,X),he=new i(new Array(0),te,0,G,q)}function m(e){var t;for(t=0;t<H;t++)e.dyn_ltree[2*t]=0;for(t=0;t<V;t++)e.dyn_dtree[2*t]=0;for(t=0;t<G;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*K]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function v(e){e.bi_valid>8?s(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function g(e,t,r,n){v(e),n&&(s(e,r),s(e,~r)),R.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}function y(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function b(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&y(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!y(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function _(e,t,r){var n,i,o,s,c=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],i=e.pending_buf[e.l_buf+c],c++,0===n?u(e,i,t):(o=ae[i],u(e,o+F+1,t),s=$[o],0!==s&&(i-=se[o],l(e,i,s)),n--,o=a(n),u(e,o,r),0!==(s=ee[o])&&(n-=le[o],l(e,n,s)))}while(c<e.last_lit);u(e,K,t)}function w(e,t){var r,n,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=W,r=0;r<l;r++)0!==o[2*r]?(e.heap[++e.heap_len]=u=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)i=e.heap[++e.heap_len]=u<2?++u:0,o[2*i]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=u,r=e.heap_len>>1;r>=1;r--)b(e,o,r);i=l;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],b(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,b(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],d(e,t),f(o,u,e.bl_count)}function x(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++s<l&&i===a||(s<u?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*Z]++):s<=10?e.bl_tree[2*Q]++:e.bl_tree[2*J]++,s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4))}function M(e,t,r){var n,i,o=-1,a=t[1],s=0,c=7,h=4;for(0===a&&(c=138,h=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<c&&i===a)){if(s<h)do{u(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(u(e,i,e.bl_tree),s--),u(e,Z,e.bl_tree),l(e,s-3,2)):s<=10?(u(e,Q,e.bl_tree),l(e,s-3,3)):(u(e,J,e.bl_tree),l(e,s-11,7));s=0,o=i,0===a?(c=138,h=3):i===a?(c=6,h=3):(c=7,h=4)}}function E(e){var t;for(x(e,e.dyn_ltree,e.l_desc.max_code),x(e,e.dyn_dtree,e.d_desc.max_code),w(e,e.bl_desc),t=G-1;t>=3&&0===e.bl_tree[2*re[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function A(e,t,r,n){var i;for(l(e,t-257,5),l(e,r-1,5),l(e,n-4,4),i=0;i<n;i++)l(e,e.bl_tree[2*re[i]+1],3);M(e,e.dyn_ltree,t-1),M(e,e.dyn_dtree,r-1)}function T(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return I;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return B;for(t=32;t<F;t++)if(0!==e.dyn_ltree[2*t])return B;return I}function k(e){de||(p(),de=!0),e.l_desc=new o(e.dyn_ltree,ue),e.d_desc=new o(e.dyn_dtree,ce),e.bl_desc=new o(e.bl_tree,he),e.bi_buf=0,e.bi_valid=0,m(e)}function S(e,t,r,n){l(e,(j<<1)+(n?1:0),3),g(e,t,r,!0)}function C(e){l(e,z<<1,3),u(e,K,ne),h(e)}function P(e,t,r,n){var i,o,a=0;e.level>0?(e.strm.data_type===D&&(e.strm.data_type=T(e)),w(e,e.l_desc),w(e,e.d_desc),a=E(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?S(e,t,r,n):e.strategy===L||o===i?(l(e,(z<<1)+(n?1:0),3),_(e,ne,ie)):(l(e,(N<<1)+(n?1:0),3),A(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),_(e,e.dyn_ltree,e.dyn_dtree)),m(e),n&&v(e)}function O(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(ae[r]+F+1)]++,e.dyn_dtree[2*a(t)]++),e.last_lit===e.lit_bufsize-1}var R=r(4),L=4,I=0,B=1,D=2,j=0,z=1,N=2,U=29,F=256,H=F+1+U,V=30,G=19,W=2*H+1,X=15,Y=16,q=7,K=256,Z=16,Q=17,J=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ee=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=new Array(2*(H+2));n(ne);var ie=new Array(2*V);n(ie);var oe=new Array(512);n(oe);var ae=new Array(256);n(ae);var se=new Array(U);n(se);var le=new Array(V);n(le);var ue,ce,he,de=!1;t._tr_init=k,t._tr_stored_block=S,t._tr_flush_block=P,t._tr_tally=O,t._tr_align=C},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function o(e){if(h===clearTimeout)return clearTimeout(e);if((h===n||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function a(){m&&f&&(m=!1,f.length?p=f.concat(p):v=-1,p.length&&s())}function s(){if(!m){var e=i(a);m=!0;for(var t=p.length;t;){for(f=p,p=[];++v<t;)f&&f[v].run();v=-1,t=p.length}f=null,m=!1,o(e)}}function l(e,t){this.fun=e,this.array=t}function u(){}var c,h,d=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(e){c=r}try{h="function"==typeof clearTimeout?clearTimeout:n}catch(e){h=n}}();var f,p=[],m=!1,v=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];p.push(new l(e,t)),1!==p.length||m||i(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=u,d.addListener=u,d.once=u,d.off=u,d.removeListener=u,d.removeAllListeners=u,d.emit=u,d.prependListener=u,d.prependOnceListener=u,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t,r){e.exports=function(){return r(61)('!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=27)}([function(t,e,n){"use strict";function r(t){return"[object Array]"===E.call(t)}function o(t){return"[object ArrayBuffer]"===E.call(t)}function i(t){return"undefined"!=typeof FormData&&t instanceof FormData}function s(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer}function u(t){return"string"==typeof t}function a(t){return"number"==typeof t}function c(t){return void 0===t}function f(t){return null!==t&&"object"==typeof t}function l(t){return"[object Date]"===E.call(t)}function p(t){return"[object File]"===E.call(t)}function h(t){return"[object Blob]"===E.call(t)}function d(t){return"[object Function]"===E.call(t)}function v(t){return f(t)&&d(t.pipe)}function m(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams}function y(t){return t.replace(/^\\s*/,"").replace(/\\s*$/,"")}function g(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function w(t,e){if(null!==t&&void 0!==t)if("object"==typeof t||r(t)||(t=[t]),r(t))for(var n=0,o=t.length;n<o;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}function b(){function t(t,n){"object"==typeof e[n]&&"object"==typeof t?e[n]=b(e[n],t):e[n]=t}for(var e={},n=0,r=arguments.length;n<r;n++)w(arguments[n],t);return e}function _(t,e,n){return w(e,function(e,r){t[r]=n&&"function"==typeof e?x(e,n):e}),t}var x=n(7),A=n(29),E=Object.prototype.toString;t.exports={isArray:r,isArrayBuffer:o,isBuffer:A,isFormData:i,isArrayBufferView:s,isString:u,isNumber:a,isObject:f,isUndefined:c,isDate:l,isFile:p,isBlob:h,isFunction:d,isStream:v,isURLSearchParams:m,isStandardBrowserEnv:g,forEach:w,merge:b,extend:_,trim:y}},function(t,e,n){"use strict";(function(e){function r(t,e){!o.isUndefined(t)&&o.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var o=n(0),i=n(24),s={"Content-Type":"application/x-www-form-urlencoded"},u={adapter:function(){var t;return"undefined"!=typeof XMLHttpRequest?t=n(3):void 0!==e&&(t=n(3)),t}(),transformRequest:[function(t,e){return i(e,"Content-Type"),o.isFormData(t)||o.isArrayBuffer(t)||o.isBuffer(t)||o.isStream(t)||o.isFile(t)||o.isBlob(t)?t:o.isArrayBufferView(t)?t.buffer:o.isURLSearchParams(t)?(r(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):o.isObject(t)?(r(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},o.forEach(["delete","get","head"],function(t){u.headers[t]={}}),o.forEach(["post","put","patch"],function(t){u.headers[t]=o.merge(s)}),t.exports=u}).call(e,n(2))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(f===setTimeout)return setTimeout(t,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(e){try{return f.call(null,t,0)}catch(e){return f.call(this,t,0)}}}function i(t){if(l===clearTimeout)return clearTimeout(t);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function s(){v&&h&&(v=!1,h.length?d=h.concat(d):m=-1,d.length&&u())}function u(){if(!v){var t=o(s);v=!0;for(var e=d.length;e;){for(h=d,d=[];++m<e;)h&&h[m].run();m=-1,e=d.length}h=null,v=!1,i(t)}}function a(t,e){this.fun=t,this.array=e}function c(){}var f,l,p=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(t){f=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(t){l=r}}();var h,d=[],v=!1,m=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new a(t,e)),1!==d.length||v||o(u)},a.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e,n){"use strict";(function(e){var r=n(0),o=n(16),i=n(19),s=n(25),u=n(23),a=n(6),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(18);t.exports=function(t){return new Promise(function(f,l){var p=t.data,h=t.headers;r.isFormData(p)&&delete h["Content-Type"];var d=new XMLHttpRequest,v="onreadystatechange",m=!1;if("test"===e.env.NODE_ENV||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in d||u(t.url)||(d=new window.XDomainRequest,v="onload",m=!0,d.onprogress=function(){},d.ontimeout=function(){}),t.auth){var y=t.auth.username||"",g=t.auth.password||"";h.Authorization="Basic "+c(y+":"+g)}if(d.open(t.method.toUpperCase(),i(t.url,t.params,t.paramsSerializer),!0),d.timeout=t.timeout,d[v]=function(){if(d&&(4===d.readyState||m)&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var e="getAllResponseHeaders"in d?s(d.getAllResponseHeaders()):null,n=t.responseType&&"text"!==t.responseType?d.response:d.responseText,r={data:n,status:1223===d.status?204:d.status,statusText:1223===d.status?"No Content":d.statusText,headers:e,config:t,request:d};o(f,l,r),d=null}},d.onerror=function(){l(a("Network Error",t,null,d)),d=null},d.ontimeout=function(){l(a("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",d)),d=null},r.isStandardBrowserEnv()){var w=n(21),b=(t.withCredentials||u(t.url))&&t.xsrfCookieName?w.read(t.xsrfCookieName):void 0;b&&(h[t.xsrfHeaderName]=b)}if("setRequestHeader"in d&&r.forEach(h,function(t,e){void 0===p&&"content-type"===e.toLowerCase()?delete h[e]:d.setRequestHeader(e,t)}),t.withCredentials&&(d.withCredentials=!0),t.responseType)try{d.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&d.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){d&&(d.abort(),l(t),d=null)}),void 0===p&&(p=null),d.send(p)})}}).call(e,n(2))},function(t,e,n){"use strict";function r(t){this.message=t}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,t.exports=r},function(t,e,n){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,n){"use strict";var r=n(15);t.exports=function(t,e,n,o,i){var s=new Error(t);return r(s,e,n,o,i)}},function(t,e,n){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}},function(t,e,n){t.exports=n(10)},function(t,e,n){"use strict";t.exports=n(28).polyfill()},function(t,e,n){"use strict";function r(t){var e=new s(t),n=i(s.prototype.request,e);return o.extend(n,s.prototype,e),o.extend(n,e),n}var o=n(0),i=n(7),s=n(12),u=n(1),a=r(u);a.Axios=s,a.create=function(t){return r(o.merge(u,t))},a.Cancel=n(4),a.CancelToken=n(11),a.isCancel=n(5),a.all=function(t){return Promise.all(t)},a.spread=n(26),t.exports=a,t.exports.default=a},function(t,e,n){"use strict";function r(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var n=this;t(function(t){n.reason||(n.reason=new o(t),e(n.reason))})}var o=n(4);r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var t;return{token:new r(function(e){t=e}),cancel:t}},t.exports=r},function(t,e,n){"use strict";function r(t){this.defaults=t,this.interceptors={request:new s,response:new s}}var o=n(1),i=n(0),s=n(13),u=n(14),a=n(22),c=n(20);r.prototype.request=function(t){"string"==typeof t&&(t=i.merge({url:arguments[0]},arguments[1])),t=i.merge(o,this.defaults,{method:"get"},t),t.method=t.method.toLowerCase(),t.baseURL&&!a(t.url)&&(t.url=c(t.baseURL,t.url));var e=[u,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)n=n.then(e.shift(),e.shift());return n},i.forEach(["delete","get","head","options"],function(t){r.prototype[t]=function(e,n){return this.request(i.merge(n||{},{method:t,url:e}))}}),i.forEach(["post","put","patch"],function(t){r.prototype[t]=function(e,n,r){return this.request(i.merge(r||{},{method:t,url:e,data:n}))}}),t.exports=r},function(t,e,n){"use strict";function r(){this.handlers=[]}var o=n(0);r.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},r.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},r.prototype.forEach=function(t){o.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=r},function(t,e,n){"use strict";function r(t){t.cancelToken&&t.cancelToken.throwIfRequested()}var o=n(0),i=n(17),s=n(5),u=n(1);t.exports=function(t){return r(t),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=o.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||u.adapter)(t).then(function(e){return r(t),e.data=i(e.data,e.headers,t.transformResponse),e},function(e){return s(e)||(r(t),e&&e.response&&(e.response.data=i(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,n){"use strict";t.exports=function(t,e,n,r,o){return t.config=e,n&&(t.code=n),t.request=r,t.response=o,t}},function(t,e,n){"use strict";var r=n(6);t.exports=function(t,e,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?e(r("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}},function(t,e,n){"use strict";var r=n(0);t.exports=function(t,e,n){return r.forEach(n,function(n){t=n(t,e)}),t}},function(t,e,n){"use strict";function r(){this.message="String contains an invalid character"}function o(t){for(var e,n,o=String(t),s="",u=0,a=i;o.charAt(0|u)||(a="=",u%1);s+=a.charAt(63&e>>8-u%1*8)){if((n=o.charCodeAt(u+=.75))>255)throw new r;e=e<<8|n}return s}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.prototype=new Error,r.prototype.code=5,r.prototype.name="InvalidCharacterError",t.exports=o},function(t,e,n){"use strict";function r(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var o=n(0);t.exports=function(t,e,n){if(!e)return t;var i;if(n)i=n(e);else if(o.isURLSearchParams(e))i=e.toString();else{var s=[];o.forEach(e,function(t,e){null!==t&&void 0!==t&&(o.isArray(t)&&(e+="[]"),o.isArray(t)||(t=[t]),o.forEach(t,function(t){o.isDate(t)?t=t.toISOString():o.isObject(t)&&(t=JSON.stringify(t)),s.push(r(e)+"="+r(t))}))}),i=s.join("&")}return i&&(t+=(-1===t.indexOf("?")?"?":"&")+i),t}},function(t,e,n){"use strict";t.exports=function(t,e){return e?t.replace(/\\/+$/,"")+"/"+e.replace(/^\\/+/,""):t}},function(t,e,n){"use strict";var r=n(0);t.exports=r.isStandardBrowserEnv()?function(){return{write:function(t,e,n,o,i,s){var u=[];u.push(t+"="+encodeURIComponent(e)),r.isNumber(n)&&u.push("expires="+new Date(n).toGMTString()),r.isString(o)&&u.push("path="+o),r.isString(i)&&u.push("domain="+i),!0===s&&u.push("secure"),document.cookie=u.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(t,e,n){"use strict";t.exports=function(t){return/^([a-z][a-z\\d\\+\\-\\.]*:)?\\/\\//i.test(t)}},function(t,e,n){"use strict";var r=n(0);t.exports=r.isStandardBrowserEnv()?function(){function t(t){var e=t;return n&&(o.setAttribute("href",e),e=o.href),o.setAttribute("href",e),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}var e,n=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");return e=t(window.location.href),function(n){var o=r.isString(n)?t(n):n;return o.protocol===e.protocol&&o.host===e.host}}():function(){return function(){return!0}}()},function(t,e,n){"use strict";var r=n(0);t.exports=function(t,e){r.forEach(t,function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])})}},function(t,e,n){"use strict";var r=n(0);t.exports=function(t){var e,n,o,i={};return t?(r.forEach(t.split("\\n"),function(t){o=t.indexOf(":"),e=r.trim(t.substr(0,o)).toLowerCase(),n=r.trim(t.substr(o+1)),e&&(i[e]=i[e]?i[e]+", "+n:n)}),i):i}},function(t,e,n){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,n){"use strict";var r=n(8),o=function(t){return t&&t.__esModule?t:{default:t}}(r);n(9),onmessage=function(t){function e(){var t=c?{texData:n(f,f),cntWhite:f*f,pack_mask:{poly_num:0,height:f,width:f,data:[0,f*f]}}:{texData:null},e=[];return e.push(t),{dataset:u.dataset,usage:u.usage,status:"failed",data:e}}function n(t,e){return new Uint8Array(t*e*4).fill(255)}function r(t){for(var e=t.width,n=t.height,r=t.data,o=new Uint8ClampedArray(e*n*4),i=0,s=!1,u=0,a=0,c=0;c<r.length;++c){var f=r[c],l=function(t,n,r,i){for(var s=r,u=t,a=n,c=4*(u*e+a);s--;)o[c]=o[c+1]=o[c+2]=o[c+3]=i,c+=4,++a===e&&(u++,a=0);return{row:u,col:a}}(u,a,f,s?255:0);u=l.row,a=l.col,i+=!0===s?1:0,s=!s}return{rgba:o,cntWhite:i}}function i(t,e,n,r){for(var o=Math.floor(e*r),i=Math.floor(n*r),s=o*i*4,u=new Uint8ClampedArray(s),a=0,c=0,f=0,l=0;l<i;++l)for(var p=0;p<o;++p)c=4*(l*o+p),f=4*(l/r*e+p/r),u[c]=t[f],u[c+1]=t[f+1],u[c+2]=t[f+2],u[c+3]=t[f+3],a+=0!==u[c]?1:0;return{rgba:u,cntWhite:a}}var s=t.data.isDebug,u={dataset:t.data.dataset,usage:t.data.usage},a=t.data.baseURL,c=t.data.edit,f=t.data.maskSize,l={headers:{"Content-Type":"application/json; charset=UTF-8"},credentials:"include"};s&&console.log("post api",a,u),o.default.post(a+"/api/mask/get_all",u,l).then(function(t){var n=t.data;if(s&&console.log("Worker::get res data",n),"success"===n.status){var o=n.summary.maskInfos;if(o.length>0){for(var a=0;a<o.length;++a){var l=o[a].pack_mask,p=l.width,h=l.height,d=r(l);if(p!==f){var v=f/p,m=i(d.rgba,p,h,v);d.rgba=[],d.rgba=m.rgba,d.cntWhite=m.cntWhite}var y=new Uint8Array(d.rgba,1);o[a].texData=y,o[a].cntWhite=d.cntWhite,c?o[a].rgba=d.rgba:(l.data=[],l=void 0)}postMessage({dataset:u.dataset,usage:u.usage,status:"success",data:o})}else console.warn("download all mask error"),postMessage(e())}else postMessage(e())}).catch(function(t){console.warn("MaskLoader download mask summary error",t),postMessage(e())})},onerror=function(t){throw console.error("MaskLoader error",t),t}},function(t,e,n){(function(e,r){!function(e,n){t.exports=n()}(0,function(){"use strict";function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function o(t){return"function"==typeof t}function i(t){z=t}function s(t){V=t}function u(){return void 0!==X?function(){X(c)}:a()}function a(){var t=setTimeout;return function(){return t(c,1)}}function c(){for(var t=0;t<I;t+=2){(0,Q[t])(Q[t+1]),Q[t]=void 0,Q[t+1]=void 0}I=0}function f(t,e){var n=arguments,r=this,o=new this.constructor(p);void 0===o[tt]&&L(o);var i=r._state;return i?function(){var t=n[i-1];V(function(){return j(i,o,t,r._result)})}():E(r,o,t,e),o}function l(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(p);return b(n,t),n}function p(){}function h(){return new TypeError("You cannot resolve a promise with itself")}function d(){return new TypeError("A promises callback cannot return that same promise.")}function v(t){try{return t.then}catch(t){return ot.error=t,ot}}function m(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function y(t,e,n){V(function(t){var r=!1,o=m(n,e,function(n){r||(r=!0,e!==n?b(t,n):x(t,n))},function(e){r||(r=!0,A(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,A(t,o))},t)}function g(t,e){e._state===nt?x(t,e._result):e._state===rt?A(t,e._result):E(e,void 0,function(e){return b(t,e)},function(e){return A(t,e)})}function w(t,e,n){e.constructor===t.constructor&&n===f&&e.constructor.resolve===l?g(t,e):n===ot?(A(t,ot.error),ot.error=null):void 0===n?x(t,e):o(n)?y(t,e,n):x(t,e)}function b(e,n){e===n?A(e,h()):t(n)?w(e,n,v(n)):x(e,n)}function _(t){t._onerror&&t._onerror(t._result),T(t)}function x(t,e){t._state===et&&(t._result=e,t._state=nt,0!==t._subscribers.length&&V(T,t))}function A(t,e){t._state===et&&(t._state=rt,t._result=e,V(_,t))}function E(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+nt]=n,o[i+rt]=r,0===i&&t._state&&V(T,t)}function T(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?j(n,r,o,i):o(i);t._subscribers.length=0}}function S(){this.error=null}function C(t,e){try{return t(e)}catch(t){return it.error=t,it}}function j(t,e,n,r){var i=o(n),s=void 0,u=void 0,a=void 0,c=void 0;if(i){if(s=C(n,r),s===it?(c=!0,u=s.error,s.error=null):a=!0,e===s)return void A(e,d())}else s=r,a=!0;e._state!==et||(i&&a?b(e,s):c?A(e,u):t===nt?x(e,s):t===rt&&A(e,s))}function R(t,e){try{e(function(e){b(t,e)},function(e){A(t,e)})}catch(e){A(t,e)}}function k(){return st++}function L(t){t[tt]=st++,t._state=void 0,t._result=void 0,t._subscribers=[]}function O(t,e){this._instanceConstructor=t,this.promise=new t(p),this.promise[tt]||L(this.promise),H(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?x(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&x(this.promise,this._result))):A(this.promise,U())}function U(){return new Error("Array Methods must be provided an Array")}function B(t){return new O(this,t).promise}function P(t){var e=this;return new e(H(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function D(t){var e=this,n=new e(p);return A(n,t),n}function N(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function q(){throw new TypeError("Failed to construct \'Promise\': Please use the \'new\' operator, this object constructor cannot be called as a function.")}function M(t){this[tt]=k(),this._result=this._state=void 0,this._subscribers=[],p!==t&&("function"!=typeof t&&N(),this instanceof M?R(this,t):q())}function F(){var t=void 0;if(void 0!==r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=M}var W=void 0;W=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var H=W,I=0,X=void 0,z=void 0,V=function(t,e){Q[I]=t,Q[I+1]=e,2===(I+=2)&&(z?z(c):Z())},J="undefined"!=typeof window?window:void 0,K=J||{},Y=K.MutationObserver||K.WebKitMutationObserver,$="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),G="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Q=new Array(1e3),Z=void 0;Z=$?function(){return function(){return e.nextTick(c)}}():Y?function(){var t=0,e=new Y(c),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():G?function(){var t=new MessageChannel;return t.port1.onmessage=c,function(){return t.port2.postMessage(0)}}():void 0===J?function(){try{var t=n(31);return X=t.runOnLoop||t.runOnContext,u()}catch(t){return a()}}():a();var tt=Math.random().toString(36).substring(16),et=void 0,nt=1,rt=2,ot=new S,it=new S,st=0;return O.prototype._enumerate=function(t){for(var e=0;this._state===et&&e<t.length;e++)this._eachEntry(t[e],e)},O.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===l){var o=v(t);if(o===f&&t._state!==et)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===M){var i=new n(p);w(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},O.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===et&&(this._remaining--,t===rt?A(r,n):this._result[e]=n),0===this._remaining&&x(r,this._result)},O.prototype._willSettleAt=function(t,e){var n=this;E(t,void 0,function(t){return n._settledAt(nt,e,t)},function(t){return n._settledAt(rt,e,t)})},M.all=B,M.race=P,M.resolve=l,M.reject=D,M._setScheduler=i,M._setAsap=s,M._asap=V,M.prototype={constructor:M,then:f,catch:function(t){return this.then(null,t)}},M.polyfill=F,M.Promise=M,M})}).call(e,n(2),n(30))},function(t,e){function n(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function r(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&n(t.slice(0,0))}t.exports=function(t){return null!=t&&(n(t)||r(t)||!!t._isBuffer)}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){}]);\n//# sourceMappingURL=MaskLoader.js.map',r.p+"MaskLoader.js")}},function(e,t){}])}(r(0),r(8))}()},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_get=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0},_three=__webpack_require__(0),_LngLatAlt=__webpack_require__(5),_LngLatAlt2=_interopRequireDefault(_LngLatAlt),_HyperNode2=__webpack_require__(64),_HyperNode3=_interopRequireDefault(_HyperNode2),_PMatrix=__webpack_require__(46),_PMatrix2=_interopRequireDefault(_PMatrix),_EarthConstants=__webpack_require__(4),_EarthConstants2=_interopRequireDefault(_EarthConstants),_EarthMath=__webpack_require__(10),_EarthMath2=_interopRequireDefault(_EarthMath),_TransformControls=__webpack_require__(55),_TransformControls2=_interopRequireDefault(_TransformControls),Marker=function(_HyperNode){function Marker(markerOptions){function defaultVal(e){return void 0===e&&(e={}),void 0===e.position&&(e.position=new _LngLatAlt2.default),void 0===e.visible&&(e.visible=!0),void 0===e.earth&&(e.earth=null),void 0===e.name&&(e.name="unknown"),void 0===e.interactable&&(e.interactable=!1),e}_classCallCheck(this,Marker);var debug=!1;if(debug&&console.log("Marker constructor"),markerOptions=defaultVal(markerOptions),markerOptions.sandbox&&!markerOptions.earth&&(markerOptions.earth=markerOptions.sandbox),null===markerOptions.earth){var _ret;return console.error("Marker constructor is not assigned with an earth"),_ret=void 0,_possibleConstructorReturn(_this,_ret)}var _this=_possibleConstructorReturn(this,(Marker.__proto__||Object.getPrototypeOf(Marker)).call(this,markerOptions.earth.markerLayer));if(_this._position=markerOptions.position,_this._orientation=new _three.Quaternion,markerOptions.orientation){var orientationQuaternion=new _three.Quaternion(markerOptions.orientation._x,markerOptions.orientation._y,markerOptions.orientation._z,markerOptions.orientation._w);_this._orientation=orientationQuaternion}_this._scale=markerOptions.scale,_this.earth=markerOptions.earth,_this._name=markerOptions.name,_this.shapeHolder=new _three.Object3D,_this.shapeHolder.name=_this._name+" shapeHolder",_this.sceneNode.add(_this.shapeHolder),_this.shapeHolder.visible=markerOptions.visible,_this.contentHolder=new _three.Object3D,_this.shapeHolder.add(_this.contentHolder),_this.decoHolder=new _three.Object3D,_this.shapeHolder.add(_this.decoHolder),_this._interactShape=null,_this._interactable=!1,void 0!==markerOptions.clickable&&(_this.clickable=markerOptions.clickable),_this.interactable=markerOptions.interactable,_this.ready4Interaction=!1,_this.animationTime=0;var _onClick=void 0,_onMouseOver=void 0,_onMouseEnter=void 0,_onMouseLeave=void 0;if(markerOptions.eventHandlers&&(_onClick=markerOptions.eventHandlers._onClick?eval("("+markerOptions.eventHandlers._onClick+")"):null,_onMouseOver=markerOptions.eventHandlers._onMouseOver?eval("("+markerOptions.eventHandlers._onMouseOver+")"):null,_onMouseEnter=markerOptions.eventHandlers._onMouseEnter?eval("("+markerOptions.eventHandlers._onMouseEnter+")"):null,_onMouseLeave=markerOptions.eventHandlers._onMouseLeave?eval("("+markerOptions.eventHandlers._onMouseLeave+")"):null),_this.eventHandlers={_onClick:_onClick,_onMouseOver:_onMouseOver,_onMouseEnter:_onMouseEnter,_onMouseLeave:_onMouseLeave},null===Marker.control&&(Marker.control=new _TransformControls2.default(_this.earth.earthView.camera,_this.earth.domElement)),_this._property.type="Marker",_this._property.pose={position:_this._position,orientation:_this.shapeHolder.quaternion,scale:_this._scale},_this._property.name=_this._name,_this._property.materialDescriptions=markerOptions.materialDescriptions?markerOptions.materialDescriptions:[],_this._property.patrolRoutes=markerOptions.patrolRoutes||[],_this._property.interactable=_this.interactable,_this._property.eventHandlers={_onClick:_this.eventHandlers._onClick?_this.eventHandlers._onClick.toString():null,_onMouseOver:_this.eventHandlers._onMouseOver?_this.eventHandlers._onMouseOver.toString():null,_onMouseEnter:_this.eventHandlers._onMouseEnter?_this.eventHandlers._onMouseEnter.toString():null,_onMouseLeave:_this.eventHandlers._onMouseLeave?_this.eventHandlers._onMouseLeave.toString():null},_this._property.patrolRoutes[0]){var patrol=_this._property.patrolRoutes[0];patrol.startTime&&setTimeout(function(){return _this.playAnimation(0,patrol.loop)},patrol.startTime)}return _this.setPose(_this._position,_this._orientation,_this._scale),_this}return _inherits(Marker,_HyperNode),_createClass(Marker,[{key:"destruct",value:function(){this.interactable&&(this.interactable=!1),this.needRemoveSelfRef&&this.removeSelfRef&&this.removeSelfRef(),_get(Marker.prototype.__proto__||Object.getPrototypeOf(Marker.prototype),"destruct",this).call(this)}},{key:"getUpdatePosition",value:function(){return this._updatePosition(),JSON.parse(JSON.stringify(this._position))}},{key:"_updatePosition",value:function(){if(0!==this.shapeHolder.position.x||0!==this.shapeHolder.position.y||0!==this.shapeHolder.position.z){var e=this.shapeHolder.position.clone().applyMatrix4(this.matrixWorld),t=new _three.Matrix4;t.getInverse(this.earth.markerLayer.matrixWorld);var r=e.applyMatrix4(t),n=_EarthMath2.default.getLngLatAltFromNoneGroundCartesian(_EarthConstants2.default.EarthResolution,r,_EarthConstants2.default.scale),i=n.lng,o=n.lat,a=n.alt;Object.assign(this._position,{lng:i,lat:o,alt:a});var s=_EarthMath2.default.getLocalSystemOnEarthSurface(_EarthConstants2.default.EarthResolution,this._position.lng,this._position.lat,_EarthConstants2.default.scale+this._position.alt/_EarthConstants2.default.EARTH_RADIUS*_EarthConstants2.default.scale),l=new _PMatrix2.default;l.makeBasis(s.lng,s.lat,s.alt),l.setPosition(s.origin),this.setMatrix(l),this.shapeHolder.position.x=0,this.shapeHolder.position.y=0,this.shapeHolder.position.z=0}}},{key:"on",value:function(e,t){switch(e){case"click":this.eventHandlers._onClick=t,this._property.eventHandlers._onClick=t.toString();break;case"mouseover":this.eventHandlers._onMouseOver=t,this._property.eventHandlers._onMouseOver=t.toString();break;case"mouseenter":this.eventHandlers._onMouseEnter=t,this._property.eventHandlers._onMouseEnter=t.toString();break;case"mouseleave":this.eventHandlers._onMouseLeave=t,this._property.eventHandlers._onMouseLeave=t.toString();break;default:console.log("unknown eventType "+e)}}},{key:"setContent",value:function(e){return!!function(e){var t=e instanceof _three.Object3D;return t||console.warn("Marker: unknown content type",e),t}(e)&&(this.contentHolder.add(e),!0)}},{key:"unsetContent",value:function(){function e(e){e.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&(e.material.map&&e.material.map.dispose(),e.material.dispose())});for(var t=e.children.length-1;t>=0;t--){var r=e.children[t];e.remove(r)}}e(this.contentHolder),e(this.decoHolder),this._interactShape=null}},{key:"setDecoration",value:function(e){this.decoHolder.add(e)}},{key:"setShape",value:function(){console.warn("setShape is obselated. Refer to Marker::setContent")}},{key:"unsetShape",value:function(){console.warn("unsetShape is obselated. Refer to Marker::unsetContent")}},{key:"setPose",value:function(e,t,r){if(e){Object.assign(this._position,e);var n=_EarthMath2.default.getLocalSystemOnEarthSurface(_EarthConstants2.default.EarthResolution,e.lng,e.lat,_EarthConstants2.default.scale+e.alt/_EarthConstants2.default.EARTH_RADIUS*_EarthConstants2.default.scale),i=new _PMatrix2.default;i.makeBasis(n.lng,n.lat,n.alt),i.setPosition(n.origin),this.setMatrix(i)}if(t)if(t.isEuler)this.shapeHolder.setRotationFromEuler(t);else if(t instanceof _three.Quaternion)this.shapeHolder.setRotationFromQuaternion(t),this._orientation.copy(t);else{var o=new _three.Vector3(t.x,t.y,t.z);o.normalize(),this.shapeHolder.rotateOnAxis(o,t.w)}r&&("number"==typeof r?this.shapeHolder.scale.copy(new _three.Vector3(r,r,r)):console.warn("[Marker] scale must be a number",r,this.shapeHolder.scale.clone()))}},{key:"getMtlParams",value:function(){var e=[];return this.contentHolder.traverse(function(t){"Mesh"===t.type&&e.push(Object.assign({},t.mtlParams))}),e}},{key:"__markerSetInteractable",value:function(e){if(e){var t=this;this.listen("mouseover",function(e){t.eventHandlers._onMouseOver&&t.eventHandlers._onMouseOver(e)}),this.listen("mouseenter",function(e){t.eventHandlers._onMouseEnter&&t.eventHandlers._onMouseEnter(e)}),this.listen("mouseleave",function(e){t.eventHandlers._onMouseLeave&&t.eventHandlers._onMouseLeave(e)});var r=!1,n={x:0,y:0};this.listen("mousedown",function(e){r=!0,n.x=e.clientX,n.y=e.clientY}),this.listen("mouseup",function(e){r&&function(e,t,r,n){return(e-r)*(e-r)+(t-n)*(t-n)<3}(e.clientX,e.clientY,n.x,n.y)&&t.eventHandlers._onClick&&t.eventHandlers._onClick(e),r=!1})}else this._interactable&&(this.stopListen("mouseover"),this.stopListen("mouseenter"),this.stopListen("mouseleave"),this.stopListen("mousedown"),this.stopListen("mouseup"))}},{key:"appendContent",value:function(e){this.contentHolder.add(e)}},{key:"reduceContent",value:function(e){this.contentHolder.remove(e)}},{key:"showControl",value:function(e){if("translate"!==e&&"rotate"!==e)return void console.error("control mode not supported",e);Marker.control.attach(this.shapeHolder),Marker.control.space="local",Marker.control.setMode(e),this.earth.scene.add(Marker.control)}},{key:"detachControl",value:function(){Marker.control.detach(this.shapeHolder),this.earth.scene.remove(Marker.control),this._updatePosition()}},{key:"setControlMode",value:function(e){if("translate"!==e&&"rotate"!==e)return void console.error("control mode not supported",e);Marker.control.setMode(e)}},{key:"changeMaterial",value:function(e){var t=this._property.materialDescriptions;this.contentHolder.traverse(function(r){if("Mesh"===r.type&&r.material.name===e.name){r.material=e;for(var n=!1,i=0;i<t.length;++i)t[i].name===e.name&&(t[i]=r.material.description,n=!0);n||t.push(r.material.description)}}),this._property.materialDescriptions=t}},{key:"getMaterials",value:function(){var e=[];return this.contentHolder.traverse(function(t){"Mesh"===t.type&&e.push(t.material)}),e}},{key:"playAnimation",value:function(){function e(e,t,r){var n={lng:e.position.lng+r*t.lng,lat:e.position.lat+r*t.lat,alt:e.position.alt+r*t.alt},i=t.prevOrientation.clone();return i.slerp(t.currOrientation,r/t.timeInterval),{position:n,orientation:i}}function t(e,t){var r=t.timestamp-e.timestamp;return{lng:(t.position.lng-e.position.lng)/r,lat:(t.position.lat-e.position.lat)/r,alt:(t.position.alt-e.position.alt)/r,prevOrientation:new _three.Quaternion(e.orientation._x,e.orientation._y,e.orientation._z,e.orientation._w),currOrientation:new _three.Quaternion(t.orientation._x,t.orientation._y,t.orientation._z,t.orientation._w),timeInterval:r}}var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this._property.patrolRoutes[r].route;if(void 0===i)return void console.error("[Marker playAnimation] route is undefined");if(i.length<2)return void console.error("animation records not enough",i);this.startTime=null,this.routeCursor=0,this.playing=!0;var o=this,a=i[o.routeCursor],s=i[o.routeCursor+1],l=t(a,s);o.animate=function(u){if(!o.startTime)return void(o.startTime=u.currentTime);var c=u.currentTime-o.startTime,h=i[o.routeCursor],d=i[o.routeCursor+1];if(d&&d.timestamp<c)if(o.routeCursor+=1,h=d,void 0===(d=i[o.routeCursor+1])){if(n)return o.startTime=u.currentTime,o.routeCursor=0,void(l=t(a,s));o.resetAnimation(r)}else{var f=d.timestamp-h.timestamp;f<=0&&console.error("[PatrolService] animation timestamp error"),l=t(h,d)}if(o.playing){var p=e(h,l,c-h.timestamp);o.setPose(p.position,p.orientation)}}}},{key:"resetAnimation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.playing=!1,this.startTime=null,this.routeCursor=0,this.animate=function(e){};var t=this._property.patrolRoutes[e].route[0];this.setPose(t.position,new _three.Quaternion(t.orientation._x,t.orientation._y,t.orientation._z,t.orientation._w)),document.dispatchEvent(new CustomEvent("reset_animation"))}},{key:"updateMatrixWorld",value:function(e,t){if(!0!==this.matrixWorldNeedsUpdate&&!0!==e||(null===this.parent?this._matrixWorld.copy(this._matrix):this._matrixWorld.multiplyMatrices(this.parent.matrixWorld,this._matrix),this.matrixWorldNeedsUpdate=!1,e=!0),e){var r=this.matrixWorld.elements;this.sceneNode.matrix.set(r[0],r[4],r[8],r[12],r[1],r[5],r[9],r[13],r[2],r[6],r[10],r[14],r[3],r[7],r[11],1)}}},{key:"sceneUpdated",value:function(e){}},{key:"animate",value:function(e){}},{key:"updateVisibility",value:function(e){}},{key:"listen",value:function(e,t){this.earth.interaction.register(this,e,t)||console.warn("Marker.listen failed.")}},{key:"stopListen",value:function(e){this.earth.interaction.unregister(this,e)||console.warn("Marker.listen failed.")}},{key:"position",get:function(){return JSON.parse(JSON.stringify(this._position))}},{key:"patrolRoutes",get:function(){return JSON.parse(JSON.stringify(this._property.patrolRoutes))},set:function(e){this._property.patrolRoutes=e}},{key:"ID",get:function(){return this.sceneNode.uuid}},{key:"clickable",set:function(e){console.warn("Marker clickable is deprecating. Set to the interactable instead"),this.interactable=e},get:function(){return console.warn("Marker clickable is deprecating. Set to the interactable instead"),this._interactable}},{key:"interactable",set:function(e){this.ready4Interaction&&this.__markerSetInteractable(e),this._interactable=e},get:function(){return this._interactable}},{key:"scale",get:function(){return this.shapeHolder.scale.x},set:function(e){this.setPose(void 0,void 0,e)}},{key:"orientation",get:function(){return this.shapeHolder.quaternion.clone()}},{key:"interactShape",set:function(e){e.visible=!1,this._interactShape=e,this.shapeHolder.add(this._interactShape),this.__markerSetInteractable(this.interactable),this.ready4Interaction=!0},get:function(){return this._interactShape}},{key:"visible",get:function(){return this.shapeHolder.visible},set:function(e){this.shapeHolder.visible=e}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}}]),Marker}(_HyperNode3.default);Marker.control=null;var _default=Marker;exports.default=_default;var _temp=function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Marker,"Marker","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/Marker.js"),__REACT_HOT_LOADER__.register(_default,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/Marker.js"))}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=n.EarthBasic.HyperClasses.CONSTANTS,o={EarthResolution:i.EarthResolution,scale:i.scale,EARTH_RADIUS:i.EARTH_RADIUS,EQUATOR:i.EQUATOR},a=o;t.default=a,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"con","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/earth/EarthConstants.js"),__REACT_HOT_LOADER__.register(o,"EarthConstants","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/earth/EarthConstants.js"),__REACT_HOT_LOADER__.register(a,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/earth/EarthConstants.js"))}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t,r,i){n(this,e),this.lng=t,this.lat=r,this.alt=void 0===i?0:i,this.lng=Math.max(Math.min(180,this.lng),-180),this.lat=Math.max(Math.min(90,this.lat),-90)}return i(e,[{key:"equals",value:function(e){return e.lat===this.lat&&e.lng===this.lng&&e.alt===this.alt}}]),e}(),a=o;t.default=a,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(o,"LngLatAlt","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/geo/LngLatAlt.js"),__REACT_HOT_LOADER__.register(a,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/geo/LngLatAlt.js"))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0},c=r(3),h=n(c),d=r(4),f=n(d),p=r(2),m=r(52),v=n(m),g=r(57),y=n(g),b=r(0),_=function(e){function t(e){i(this,t);var r=e,n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r)),a=n;if(!function(){return!!(e&&e.projInfo&&e.projInfo.id)&&(a._property.type="AltizureProjectMarker",a._property.id=e.projInfo.id,!0)}()){var s;return console.error("AltizureProjectMarker invalid input",e),s=void 0,o(n,s)}n._isMobile=p.BrowserCapatibility.isMobile(),n.HOST=e.HOST,n._apiInfo=e.projInfo,n._projInfo=function(e){function t(e){return e instanceof Array&&3===e.length?new b.Vector3(e[0],e[1],e[2]):e&&e.x&&e.y&&e.z?new b.Vector3(e.x,e.y,e.z):void console.error("objToVec3 invalid obj",e)}var r=e.modelTransform;return{PID:e.id,origin:t(r.origin),x_dir:t(r.xDir),y_dir:t(r.yDir),z_dir:t(r.zDir),max_bound:t(r.maxBound),min_bound:t(r.minBound),x_tiles:r.xTiles,y_tiles:r.yTiles,z_tiles:r.zTiles,floor_height:r.floorHeight,length_unit_to_meter:r.lengthUnitToMeter,isMobile:a._isMobile,minLevel:0,maxLevel:function(e,t){for(var r=Math.max(e,t),n=0;r>1;)r/=2,n++;return n}(r.xTiles,r.yTiles),onLoadTrans:r.onLoadTrans,tile_salt:null===e.versionControl?"":e.versionControl}}(n._apiInfo),n.showXYZ=!0,n.treeNode=new b.Object3D,n.treeNode.name="treeNode";var l=function(e){var t=e.min_bound,r=e.max_bound,n=e.origin,i=r.x-t.x,o=r.y-t.y,a=r.z-t.z,s=new v.default(i,o,a,6923221),l=new b.Matrix4;l.makeTranslation(n.x,n.y,(r.z+t.z)/2+n.z),s.applyMatrix(l);for(var u=new b.BoxBufferGeometry(i,o,a),c=new Uint16Array(30),h=0;h<8;h++)c[3*h]=u.index.array[3*h+2],c[3*h+1]=u.index.array[3*h+1],c[3*h+2]=u.index.array[3*h];c[24]=u.index.array[32],c[25]=u.index.array[31],c[26]=u.index.array[30],c[27]=u.index.array[35],c[28]=u.index.array[34],c[29]=u.index.array[33],u.index.array=c,u.index.count=30,u.applyMatrix(l);var d=new b.Mesh(u),p=new b.Object3D;l.makeTranslation(-n.x,-n.y,-n.z-t.z),p.applyMatrix(l);var m=f.default.scale/f.default.EARTH_RADIUS;return l.makeScale(m,m,m),p.applyMatrix(l),s.applyMatrix(p.matrix),s.name="fence",{fence:s,centeredTransfrom:p,box:d}}({min_bound:n.projInfo.min_bound,max_bound:n.projInfo.max_bound,origin:n.projInfo.origin}),u=l.fence,c=l.centeredTransfrom,h=l.box;return n.projHolder=c,n.projHolder.add(n.treeNode),n.projHolder.name="projHolder",n._tree=null,n.decoHolder.add(u),h.applyMatrix(n.projHolder.matrix),n.interactShape=h,n.hasDepthMap=!1,n._depthMap=void 0,n._depthMapNeedsUpdate=!0,n._overlayMarkers=[],n._waterManager=null,n.waterHolder=new b.Object3D,n.waterHolder.applyMatrix(n.projHolder.matrix),n.shapeHolder.add(n.waterHolder),n.import(),n}return a(t,e),l(t,[{key:"destruct",value:function(){this.interactable&&(this.interactable=!1),this.deport(),this.unsetContent(),this.deportWater(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destruct",this).call(this)}},{key:"import",value:function(){var e=this;!function(){var r={PID:e.projInfo.PID,debug:!1,useRemoteAltizureServer:"https://www.altizure.com",isMobile:e._isMobile,onError:function(e,t){console.warn("AltizureProjectMarker.createTree",e,t)},viewModeType:{TEXTURE:0,FLAT:1,WIREFRAME:2,SELECT:3,CROP:4},viewMode:4,fullScene:!1,quality:40,display_lod:!1,allow_worker:!0,bbox:!1,MAX_THREADS:8,MAX_CACHE_SIZE:150,ENTITY_CACHE_SIZE:150,MIN_AREA:.1,maxAnisotropy:1,dataPath:e.preferredPath,HOST:e.HOST},n=e.projInfo;if(void 0===n.transformation){var i=new b.Matrix4;n.onLoadTrans instanceof Array?3===n.onLoadTrans.length?i.makeRotationX(Math.PI*n.onLoadTrans[0]).multiply((new b.Matrix4).makeRotationY(Math.PI*n.onLoadTrans[1])).multiply((new b.Matrix4).makeRotationZ(Math.PI*n.onLoadTrans[2])):16===n.onLoadTrans.length?i.set.apply(i,n.onLoadTrans):console.error("AltizureMeshEntity createTree: incorrect onLoadTrans",n.onLoadTrans):"object"===s(n.onLoadTrans)&&void 0!==n.onLoadTrans.x&&void 0!==n.onLoadTrans.y&&void 0!==n.onLoadTrans.z&&i.makeRotationX(Math.PI*n.onLoadTrans.x).multiply((new b.Matrix4).makeRotationY(Math.PI*n.onLoadTrans.y)).multiply((new b.Matrix4).makeRotationZ(Math.PI*n.onLoadTrans.z));var o=i.multiply((new b.Matrix4).makeTranslation(-n.origin.x,-n.origin.y,-n.origin.z));void 0===n.length_unit_to_meter&&(n.length_unit_to_meter=1),n.transformation=new p.Transformation,n.transformation.set({onload:o,scale:n.length_unit_to_meter})}if(e._tree=new p.AltizureProjectTree(p.MeshSmartTile,e.treeNode,e.dataUrl,e.projInfo,r),!t._forest){var a=e._isMobile,l={FOREST_CAPACITY:a?110:280,MAX_DOWNLOAD_CONCURRENCY:a?4:10,MIN_AREA:a?.1:.01,MAX_LEVEL:a?10:12,allowWorker:!0},u={trees:[],CACHE_CAPACITY:a?140:350};t._forest=new p.Forest(l,u)}t._forest.add(e._tree)}(),this.setContent(this.projHolder)}},{key:"deport",value:function(){var e=!0;return t._forest&&t._forest.remove(this._tree),this._tree&&(e=e&&this._tree.destruct(),this._tree=null),e||console.warn("AltizureProjectMarker deport failed."),e}},{key:"pickDepthMap",value:function(e){var t=this;if(e instanceof Array){!function(){if(!t.hasDepthMap||t._depthMapNeedsUpdate){var e=t.earth.renderer;if(!e.extensions.get("WEBGL_depth_texture"))return void console.warn("cannot generate depthMap for altizure project marker");var r=e.getSize(),n=new b.WebGLRenderTarget(r.width,r.height);n.texture.format=b.RGBFormat,n.texture.minFilter=b.NearestFilter,n.texture.magFilter=b.NearestFilter,n.texture.generateMipmaps=!1,n.stencilBuffer=!1,n.depthBuffer=!0,n.depthTexture=new b.DepthTexture,n.depthTexture.type=b.UnsignedShortType;var i=new b.OrthographicCamera(-1,1,1,-1,0,1),o=new b.ShaderMaterial({vertexShader:"\n          varying vec2 vUv;\n          void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          }\n          ",fragmentShader:"\n          varying vec2 vUv;\n          uniform sampler2D tDiffuse;\n          uniform sampler2D tDepth;\n\n          float readDepth (sampler2D depthSampler, vec2 coord) {\n            float fragCoordZ = texture2D(depthSampler, coord).x;\n            return fragCoordZ;\n          }\n          void main() {\n            float depth = readDepth(tDepth, vUv);\n            gl_FragColor.rgb = vec3(depth);\n            gl_FragColor.a = 1.0;\n          }\n          ",uniforms:{tDiffuse:{value:n.texture},tDepth:{value:n.depthTexture}}}),a=new b.PlaneBufferGeometry(2,2),s=new b.Mesh(a,o),l=new b.Scene;l.add(s);var u=e.getPixelRatio();n.setSize(r.width*u,r.height*u);var c=t.decoHolder.children[0],h=c.position.clone().applyMatrix4(c.matrixWorld),d=Math.abs(2*c.children[4].position.z),f=new b.Vector3(0,0,0),p=new b.Vector3(0,0,d),m=new b.Vector3(0,1,0),v=f.clone().applyMatrix4(c.matrixWorld),g=p.clone().applyMatrix4(c.matrixWorld),y=m.clone().applyMatrix4(c.matrixWorld),_=g.clone().add(v.clone().negate()),w=_.clone().length(),x=y.clone().add(v.clone().negate()).normalize(),M=Math.abs(c.children[0].position.x)/d*w,E=Math.abs(c.children[2].position.y)/d*w,A=new b.OrthographicCamera(-M,M,E,-E,0,1),T=h.clone().add(_),k=new b.Matrix4;k.lookAt(T,h,x),A.position.copy(T),A.quaternion.setFromRotationMatrix(k),A.near=.5*w,A.far=1.5*w,A.updateProjectionMatrix();var S=new b.WebGLRenderTarget(r.width,r.height);e.render(t.contentHolder,A,n),e.render(l,i,S),t._depthMap={},t._depthMap.dimension={w:r.width,h:r.height},t._depthMap.boxHeight=d,t._depthMap.resolution=Math.abs(4*c.children[0].position.x*c.children[2].position.y/(r.width*r.height));var C=new Uint8Array(4*r.width*r.height);e.readRenderTargetPixels(S,0,0,r.width,r.height,C);for(var P=new Uint8Array(r.width*r.height),O=0;O<P.length;++O)P[O]=C[4*O];t._depthMap.buffer=P,t.hasDepthMap=!0,t._depthMapNeedsUpdate=!1,console.log("Depth map updated")}}();var r=[];return e.map(function(e){var n=t._apiInfo.geoInfo,i=(e.lat-n.minLat)/(n.maxLat-n.minLat),o=(e.lng-n.minLong)/(n.maxLong-n.minLong),a=1===o?parseInt(t._depthMap.dimension.w*o)-1:parseInt(t._depthMap.dimension.w*o),s=1===i?parseInt(t._depthMap.dimension.h*i)-1:parseInt(t._depthMap.dimension.h*i);if(o>=0&&o<=1&&i>=0&&i<=1){var l=s*t._depthMap.dimension.w+a,u=(1-t._depthMap.buffer[l]/255)*t._depthMap.boxHeight;r.push(u)}else console.error("{lng, lat} is out of the boundary of the project marker",e,n)}),r}console.warn("[pickDepthMap] Argument is not an instance of Array",e)}},{key:"updateDepthMap",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._depthMapNeedsUpdate=!0,t&&this.pickDepthMap([]),this._overlayMarkers.map(function(t){var r=[{lng:t.position.lng,lat:t.position.lat}],n=e.pickDepthMap(r)[0];t.setPose(Object.assign({},r[0],{alt:n}))})}},{key:"addOverlayMarker",value:function(e){var t=this,r=!1;this._overlayMarkers.map(function(t){t.ID===e.ID&&(r=!0)}),r||(this._overlayMarkers.push(e),e.needRemoveSelfRef=!0,e.removeSelfRef=function(){t.removeOverlayMarker(e),e.needRemoveSelfRef=void 0})}},{key:"removeOverlayMarker",value:function(e){var t=this;this._overlayMarkers.map(function(r,n){r.ID===e.ID&&t._overlayMarkers.splice(n,1)})}},{key:"getRegionVolume",value:function(e){var t=this;if(void 0===e)return void console.error("polygon marker is required");!function(){var r=t.earth.renderer,n=r.getSize(),i=t.decoHolder.children[0],o=i.position.clone().applyMatrix4(i.matrixWorld),a=Math.abs(2*i.children[4].position.z),s=new b.Vector3(0,0,0),l=new b.Vector3(0,0,a),u=new b.Vector3(0,1,0),c=s.clone().applyMatrix4(i.matrixWorld),h=l.clone().applyMatrix4(i.matrixWorld),d=u.clone().applyMatrix4(i.matrixWorld),f=h.clone().add(c.clone().negate()),p=f.clone().length(),m=d.clone().add(c.clone().negate()).normalize(),v=Math.abs(i.children[0].position.x)/a*p,g=Math.abs(i.children[2].position.y)/a*p,y=new b.OrthographicCamera(-v,v,g,-g,0,1),_=o.clone().add(f),w=new b.Matrix4;w.lookAt(_,o,m),y.position.copy(_),y.quaternion.setFromRotationMatrix(w),y.near=.5*p,y.far=1.5*p,y.updateProjectionMatrix();var x=new b.WebGLRenderTarget(n.width,n.height);x.texture.format=b.RGBAFormat,x.texture.minFilter=b.NearestFilter,x.texture.magFilter=b.NearestFilter;var M=r.getClearColor();r.setClearColor(16777215,0),r.render(e.contentHolder,y,x),r.setClearColor(M,0);var E=new Uint8Array(4*n.width*n.height);r.readRenderTargetPixels(x,0,0,n.width,n.height,E);for(var A=new Uint8Array(n.width*n.height),T=0;T<A.length;++T)A[T]=E[4*T+3];t.maskBuffer=A}(),this.updateDepthMap(!0);for(var r=this.pickDepthMap(e.boundaryPts),n=r.reduce(function(e,t){return e+t})/r.length,i=0,o=0;o<this.maskBuffer.length;++o)if(0!==this.maskBuffer[o]){var a=this._depthMap.buffer[o];a=(1-a/255)*this._depthMap.boxHeight-n,i+=a*this._depthMap.resolution}return i}},{key:"show",value:function(){}},{key:"hide",value:function(){}},{key:"light",value:function(){}},{key:"dim",value:function(){}},{key:"sceneUpdated",value:function(e){if(console.warn("AltizureProjectMarker sceneUpdated should be managed by forest"),null!==this._tree){if(isNaN(e.camera.far))return;this._tree.updateView(e.camera,e.pvmatrix,e.frustum),this._tree.loadUnloadedTiles()}}},{key:"updateVisibility",value:function(e){if(null!==this._tree){var t=e.frustum;this._tree.updateVisibility(t)}}},{key:"animate",value:function(e){this._waterManager&&this._waterManager.renderWaters()}},{key:"_XYZ",value:function(){function e(e,r,n,i){var o,a=new b.Geometry;return o=i?new b.LineDashedMaterial({linewidth:1,color:n,dashSize:t/1e3,gapSize:t/300}):new b.LineBasicMaterial({linewidth:1,color:n}),a.vertices.push(e.clone()),a.vertices.push(r.clone()),a.computeLineDistances(),new b.LineSegments(a,o)}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001;return function(t){var r=new b.Object3D;return r.add(e(new b.Vector3(0,0,0),new b.Vector3(t,0,0),16711680,!1)),r.add(e(new b.Vector3(0,0,0),new b.Vector3(-t,0,0),16711680,!0)),r.add(e(new b.Vector3(0,0,0),new b.Vector3(0,t,0),65280,!1)),r.add(e(new b.Vector3(0,0,0),new b.Vector3(0,-t,0),65280,!0)),r.add(e(new b.Vector3(0,0,0),new b.Vector3(0,0,t),255,!1)),r.add(e(new b.Vector3(0,0,0),new b.Vector3(0,0,-t),255,!0)),r}(t)}},{key:"importWater",value:function(){var e={sceneNode:this.waterHolder,scene:this.earth.scene,renderer:this.earth.renderer,camera:this.earth.viewerCamera,PID:this.projInfo.PID,dataPath:this.preferredPath,maskSize:512,info:this.projInfo,maxMaskNum:3,updateMaskFormat:!1,isDebug:!1,edit:!1,HOST:this.HOST,altizureApi:this.earth.apiService};this._waterManager=new y.default(e);var t=this;return this._waterManager.downloadAll().then(function(){return Promise.resolve(t)})}},{key:"deportWater",value:function(){this._waterManager&&this._waterManager.destruct()}},{key:"projInfo",get:function(){return this._projInfo}},{key:"preferredPath",get:function(){for(var e=["oss_sz","oss_usw","local"],t=this._apiInfo.cloudPath,r=0;r<e.length;r++)for(var n=0;n<t.length;n++)if(t[n].key===e[r])return t[n].dataUrl;console.error("preferredPath error",this._apiInfo,t,e)}},{key:"dataUrl",get:function(){var e=this.preferredPath;return e&&e.length>0&&"/"===e[0]&&(e="https://www.altizure.com"+e),e+"/web/"}},{key:"water",get:function(){var e=this;return{import:function(){return e.importWater()},set speed(t){var r=e._waterManager;for(var n in r.maskSettings)r.maskSettings[n].speed=t},set wave(t){var r=e._waterManager;for(var n in r.maskSettings)r.maskSettings[n].wave=t},set color(t){var r=e._waterManager;for(var n in r.maskSettings)r.maskSettings[n].color=t},get speed(){console.warn("Not allowed to get speed.")}}}}]),t}(h.default);_._forest=null;var w=_;t.default=w,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(_,"AltizureProjectMarker","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/AltizureProjectMarker.js"),__REACT_HOT_LOADER__.register(w,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/AltizureProjectMarker.js"))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0},u=r(0),c=r(3),h=n(c),d=r(4),f=n(d),p=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(!function(e){return!!(e&&e.position&&e.earth)&&(e.scale||(e.scale=1),!0)}(e)){var n;return console.warn("TagMarker invalid init input",e),n=void 0,o(r,n)}return r._property.type="TagMarker",r._property.imgUrl=e.imgUrl,r._property.scale=e.scale,r.tag=null,r.tagHolder=new u.Object3D,r.setContent(r.tagHolder),r._scale=f.default.scale/5e5,r._addTag(e.imgUrl),null!==t.textureCache&&void 0!==t.textureCache||(t.textureCache={}),r}return a(t,e),s(t,[{key:"destruct",value:function(){this.interactable&&(this.interactable=!1),t.clearAllImgTextureCache(),t.textureCache=null,null!==this.tag&&this.tag.material&&this.tag.material.dispose(),this.unsetContent(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destruct",this).call(this)}},{key:"_addTag",value:function(e,r,n){if(null===this.tag){var i=this;if(t.ImgTextureCacheExist(e)){var o=t.getImgTextureFromCache(e),a=new u.SpriteMaterial({map:o,color:16777215,depthTest:!1});i.tag=new u.Sprite(a);var s=o.image.width/o.image.height;i.tag.scale.set(i._scale*s,i._scale,1),i.tag.position.set(0,0,0),i.interactShape=i.tag.clone(),i.tagHolder.add(i.tag),i.imgUrl=e,r&&r()}else{var l=new u.TextureLoader;l.withCredentials=!0,l.load(e,function(n){n.minFilter=u.LinearFilter;var o=new u.SpriteMaterial({map:n,color:16777215,depthTest:!1});i.tag=new u.Sprite(o);var a=n.image.width/n.image.height;i.tag.scale.set(i._scale*a,i._scale,1),i.tag.position.set(0,0,0),i.tagHolder.add(i.tag),i.interactShape=i.tag.clone(),i.imgUrl=e,t.cacheImgTexture(i.imgUrl,n),r&&r()},function(e){},function(r){console.warn("an error happened while loading "+e);var o=[0,0,0,0],a=[255,0,0,255],s=[];s=s.concat(a).concat(o).concat(a),s=s.concat(o).concat(a).concat(o),s=s.concat(a).concat(o).concat(a);var l=new u.DataTexture(Uint8Array.from(s),3,3,u.RGBAFormat,u.UnsignedByteType,u.UVMapping);l.minFilter=l.magFilter=u.LinearFilter,l.needsUpdate=!0;var c=new u.SpriteMaterial({map:l,color:16777215,depthTest:!1});i.tag=new u.Sprite(c);var h=l.image.width/l.image.height;i.tag.scale.set(i._scale*h,i._scale,1),i.tag.position.set(0,0,0),i.tagHolder.add(i.tag),i.interactShape=i.tag.clone(),i.imgUrl="TagMarkerTexture404",t.cacheImgTexture("TagMarkerTexture404",l),i._property.imgUrl="TagMarkerTexture404",n&&n()})}}}},{key:"texture",set:function(e){this.textureAsync={data:e,onSuccess:void 0,onFail:void 0}},get:function(){return this.imgUrl}},{key:"textureAsync",set:function(e){var r=e.data,n=e.onSuccess,i=e.onFail;if(null===this.tag)this._addTag(r,n,i);else{var o=this;if(t.ImgTextureCacheExist(r)){var a=t.getImgTextureFromCache(r);o.tag.material.map=a;var s=a.image.width/a.image.height;o.tag.scale.set(o._scale*s,o._scale,1),o.imgUrl=r,o._property.imgUrl=r,n&&n()}else{var l=new u.TextureLoader;l.setCrossOrigin("anonymous"),l.withCredentials=!0,l.load(r,function(e){e.minFilter=u.LinearFilter,o.tag.material.map=e;var i=e.image.width/e.image.height;o.tag.scale.set(o._scale*i,o._scale,1),o.imgUrl=r,t.cacheImgTexture(r,e),o._property.imgUrl=r,n&&n()},function(e){},function(e){console.warn("an error happened while loading "+r),i&&i()})}}},get:function(){return this.imgUrl}}],[{key:"ImgTextureCacheExist",value:function(e){return!!t.textureCache&&null!==t.textureCache[e]&&void 0!==t.textureCache[e]}},{key:"getImgTextureFromCache",value:function(e){return t.ImgTextureCacheExist(e)?t.textureCache[e]:null}},{key:"cacheImgTexture",value:function(e,r){null!==t.textureCache&&void 0!==t.textureCache||(t.textureCache={}),t.textureCache[e]=r}},{key:"clearAllImgTextureCache",value:function(){for(var e in t.textureCache)t.textureCache[e]&&t.textureCache[e].dispose();t.textureCache={}}}]),t}(h.default);p.textureCache=null;var m=p;t.default=m,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(p,"TagMarker","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/TagMarker.js"),__REACT_HOT_LOADER__.register(m,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/TagMarker.js"))}()},function(e,t,r){e.exports=r(28)},function(e,t,r){"use strict";(function(t){function n(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var i=r(1),o=r(42),a={"Content-Type":"application/x-www-form-urlencoded"},s={adapter:function(){var e;return"undefined"!=typeof XMLHttpRequest?e=r(17):void 0!==t&&(e=r(17)),e}(),transformRequest:[function(e,t){return o(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(n(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)?(n(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};s.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],function(e){s.headers[e]={}}),i.forEach(["post","put","patch"],function(e){s.headers[e]=i.merge(a)}),e.exports=s}).call(t,r(23))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=n.EarthBasic.HyperClasses.EarthMath,o=i;t.default=o,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"EarthMath","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/earth/EarthMath.js"),__REACT_HOT_LOADER__.register(o,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/earth/EarthMath.js"))}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),l=r(12),u={uniforms:{bumpMapUsed:{type:"f",value:0},bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1},bumpMapPath:{value:null},normalMapUsed:{type:"f",value:0},normalMap:{type:"t",value:null},normalScale:{type:"v2",value:[1,1]},normalMapPath:{value:null},displacementMapUsed:{type:"f",value:0},displacementMap:{type:"t",value:null},displacementScale:{type:"f",value:0},displacementBias:{type:"f",value:0},displacementMapPath:{value:null},ka:{type:"v3",value:[.2,.2,.2]},mapKaUsed:{type:"f",value:0},mapKa:{type:"t",value:null},mapKaPath:{value:null},mapKaWidth:{type:"f",value:1},mapKaHeight:{type:"f",value:1},kd:{type:"v3",value:[.1,.1,1]},mapKdUsed:{type:"f",value:0},mapKd:{type:"t",value:null},mapKdPath:{value:null},mapKdWidth:{type:"f",value:1},mapKdHeight:{type:"f",value:1},ks:{type:"v3",value:[1,.1,.1]},mapKsUsed:{type:"f",value:0},mapKs:{type:"t",value:null},mapKsPath:{value:null},mapKsWidth:{type:"f",value:1},mapKsHeight:{type:"f",value:1},ns:{type:"f",value:20},d:{type:"f",value:1},diffuseOn:{type:"f",value:1},specularOn:{type:"f",value:1},ambientPercentage:{type:"f",value:100},diffusePercentage:{type:"f",value:100},specularPercentage:{type:"f",value:100}},vertexShader:"\nvarying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vViewPosition;\n"+l.SelfShaderChunks.DisplacementMapPositionCalculation_vertex+s.ShaderChunk.common+s.ShaderChunk.bsdfs+s.ShaderChunk.lights_pars+"\nvoid main(){\n  vUv = uv;\n  vNormal = normalize(normalMatrix * normal);\n  vViewPosition = -(modelViewMatrix * vec4(position, 1.0)).xyz;\n  vec3 transformedPosition = position + displacementMapOffset(normal, uv);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(transformedPosition, 1.0);\n}\n",fragmentShader:"\n#define USE_BUMPMAP\n#define USE_NORMALMAP\n\nuniform vec3 ka;\nuniform float mapKaUsed;\nuniform sampler2D mapKa;\nuniform float mapKaWidth;\nuniform float mapKaHeight;\nuniform vec3 kd;\nuniform float mapKdUsed;\nuniform sampler2D mapKd;\nuniform float mapKdWidth;\nuniform float mapKdHeight;\nuniform vec3 ks;\nuniform float mapKsUsed;\nuniform sampler2D mapKs;\nuniform float mapKsWidth;\nuniform float mapKsHeight;\nuniform float ns;\n\nuniform float d;\n\nuniform float bumpMapUsed;\nuniform float normalMapUsed;\n\nvarying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vViewPosition;\n\nuniform float diffuseOn;\nuniform float specularOn;\nuniform float ambientPercentage;\nuniform float diffusePercentage;\nuniform float specularPercentage;\n"+s.ShaderChunk.common+s.ShaderChunk.bsdfs+s.ShaderChunk.lights_pars+s.ShaderChunk.bumpmap_pars_fragment+s.ShaderChunk.normalmap_pars_fragment+"\nvec3 getDiffuse(vec3 lightColor, vec3 direction, vec3 normal, vec3 diffuse){\n  return saturate(dot(direction, normal)) * lightColor * diffuse;\n}\n\nvec3 getSpecular(vec3 lightColor, vec3 direction, vec3 normal, vec3 position, vec3 camera, vec3 specular, float shininess){\n  vec3 viewDir = normalize(camera - position);\n  vec3 reflectedDir = 2.0 * dot(direction, normal) * normal - direction;\n  float specularTerm = max(0.0000001, dot(viewDir, reflectedDir));\n  specularTerm = pow(specularTerm, shininess);\n  return specularTerm * lightColor * specular;\n}\n\nvoid main(){\n  vec3 color = vec3(0.0);\n  vec3 modelPosition = -vViewPosition;\n  vec3 treatedNormal = normalize(vNormal);\n  if(bumpMapUsed>0.5)treatedNormal = perturbNormalArb(modelPosition, treatedNormal, dHdxy_fwd());\n  if(normalMapUsed>0.5)treatedNormal = perturbNormal2Arb( modelPosition, treatedNormal );\n  vec3 ambientColor = ka;\n  vec3 diffuseColor = kd;\n  vec3 specularColor = ks;\n  float shininess = ns;\n  vec3 ambientResultColor = vec3(0.0);\n  vec3 diffuseResultColor = vec3(0.0);\n  vec3 specularResultColor = vec3(0.0);\n  if(mapKaUsed>0.5){\n    ambientColor *= texture2D(mapKa, vUv).rgb;\n  }\n  if(mapKdUsed>0.5){\n    diffuseColor *= texture2D(mapKd, vUv).rgb;\n  }\n  if(mapKsUsed>0.5){\n    specularColor *= texture2D(mapKs, vUv).rgb;\n  }\n\n  ambientResultColor += ambientColor;\n  #if NUM_DIR_LIGHTS > 0\n    for(int i=0;i<NUM_DIR_LIGHTS;++i){\n      if(diffuseOn>0.5){\n        diffuseResultColor += getDiffuse(directionalLights[i].color, directionalLights[i].direction, treatedNormal, diffuseColor);\n      }\n\n      if(specularOn>0.5){\n        specularResultColor += getSpecular(\n          directionalLights[i].color, directionalLights[i].direction, treatedNormal, modelPosition, cameraPosition, specularColor, shininess\n        );\n      }\n    }\n  #endif\n  #if NUM_POINT_LIGHTS > 0\n    for(int i=0;i<NUM_POINT_LIGHTS;++i){\n      vec3 direction = normalize(pointLights[i].position - modelPosition);\n      if(diffuseOn>0.5){\n        diffuseResultColor += getDiffuse(pointLights[i].color, direction, treatedNormal, diffuseColor);\n      }\n\n      if(specularOn>0.5){\n        specularResultColor += getSpecular(\n          pointLights[i].color, direction, treatedNormal, modelPosition, cameraPosition, specularColor, shininess\n        );\n      }\n    }\n  #endif\n  diffuseResultColor += diffuseColor * RECIPROCAL_PI; // indirect diffuse color\n\n  color += ambientResultColor * ambientPercentage / 100.0;\n  color += diffuseResultColor * diffusePercentage / 100.0;\n  color += specularResultColor * specularPercentage / 100.0;\n  gl_FragColor = vec4(color, d);\n}\n"},c=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),o=JSON.parse(JSON.stringify(u.uniforms));return r.uniforms=s.UniformsUtils.merge([s.UniformsLib.lights,o]),r.vertexShader=u.vertexShader,r.fragmentShader=u.fragmentShader,r.transparent=!0,r.extensions.derivatives=!0,r.lights=!0,r.description={},r.description.type="MTLPhongShaderMaterial",r.loadMTLOptions(e),r}return o(t,e),a(t,[{key:"loadMTLOptions",value:function(e){if(void 0!==e&&null!==e&&Object.keys(e).length>0){if(this.name=e.name,this.description.name=e.name,e.ka&&(this.uniforms.ka.value=e.ka,this.description.ka=e.ka),e.kd&&(this.uniforms.kd.value=e.kd,this.description.kd=e.kd),e.ks&&(this.uniforms.ks.value=e.ks,this.description.ks=e.ks),e.ns){var t=l.SelfHelperFunctions.getFloatStringPair(e.ns);t&&(this.uniforms.ns.value=t.f,this.description.ns=t.s)}if(e.d){var r=l.SelfHelperFunctions.getFloatStringPair(e.ns);r&&(this.uniforms.d.value=r.f,this.description.d=r.s)}var n=e.bump,i=e.map_kd;void 0!==i&&null!==i&&(this._loadTexture(i,this.uniforms.mapKd,this.uniforms.mapKdUsed,this.uniforms.mapKdPath,this.uniforms.mapKdWidth,this.uniforms.mapKdHeight),this.description.map_kd=i),void 0!==n&&null!==n&&(this._loadTexture(n,this.uniforms.bumpMap,this.uniforms.bumpMapUsed,this.uniforms.bumpMapPath),this.description.bump=n);var o=e.mapKaPath;if(void 0!==o&&null!==o&&(this._loadTexture(o,this.uniforms.mapKa,this.uniforms.mapKaUsed,this.uniforms.mapKaPath,this.uniforms.mapKaWidth,this.uniforms.mapKaHeight),this.description.mapKaPath=o),e.ambientPercentage){var a=l.SelfHelperFunctions.getFloatStringPair(e.ambientPercentage);a&&(this.uniforms.ambientPercentage.value=a.f,this.description.ambientPercentage=a.s)}if(e.diffuseOn){var s=l.SelfHelperFunctions.getFloatStringPair(e.diffuseOn);s&&(this.uniforms.diffuseOn.value=s.f,this.description.diffuseOn=s.s)}if(e.diffusePercentage){var u=l.SelfHelperFunctions.getFloatStringPair(e.diffusePercentage);u&&(this.uniforms.diffusePercentage.value=u.f,this.description.diffusePercentage=u.s)}var c=e.mapKsPath;if(void 0!==c&&null!==c&&(this._loadTexture(c,this.uniforms.mapKs,this.uniforms.mapKsUsed,this.uniforms.mapKsPath,this.uniforms.mapKsWidth,this.uniforms.mapKsHeight),this.description.mapKsPath=c),e.specularOn){var h=l.SelfHelperFunctions.getFloatStringPair(e.specularOn);h&&(this.uniforms.specularOn.value=h.f,this.description.specularOn=h.s)}if(e.specularPercentage){var d=l.SelfHelperFunctions.getFloatStringPair(e.specularPercentage);d&&(this.uniforms.specularPercentage.value=d.f,this.description.specularPercentage=d.s)}}}},{key:"setAmbientTexture",value:function(e){this._loadTexture(e,this.uniforms.mapKa,this.uniforms.mapKaUsed,this.uniforms.mapKaPath,this.uniforms.mapKaWidth,this.uniforms.mapKaHeight),this.description.mapKaPath=e}},{key:"setAmbientColor",value:function(e){this.uniforms.ka.value=e.slice(0,3),this.description.ka=e.slice(0,3)}},{key:"setAmbientPercentage",value:function(e){var t=l.SelfHelperFunctions.getFloatStringPair(e);t&&(this.uniforms.ambientPercentage.value=t.f,this.description.ambientPercentage=t.s)}},{key:"setDiffuseTexture",value:function(e){this._loadTexture(e,this.uniforms.mapKd,this.uniforms.mapKdUsed,this.uniforms.mapKdPath,this.uniforms.mapKdWidth,this.uniforms.mapKdHeight),this.description.map_kd=e}},{key:"setDiffuseColor",value:function(e){this.uniforms.kd.value=e.slice(0,3),this.description.kd=e.slice(0,3)}},{key:"setDiffuseState",value:function(e){var t=l.SelfHelperFunctions.getFloatStringPair(e);t&&(this.uniforms.diffuseOn.value=t.f,this.description.diffuseOn=t.s)}},{key:"setDiffusePercentage",value:function(e){var t=l.SelfHelperFunctions.getFloatStringPair(e);t&&(this.uniforms.diffusePercentage.value=t.f,this.description.diffusePercentage=t.s)}},{key:"setSpecularTexture",value:function(e){this._loadTexture(e,this.uniforms.mapKs,this.uniforms.mapKsUsed,this.uniforms.mapKsPath,this.uniforms.mapKsWidth,this.uniforms.mapKsHeight),this.description.mapKsPath=e}},{key:"setSpecularColor",value:function(e){this.uniforms.ks.value=e.slice(0,3),this.description.ks=e.slice(0,3)}},{key:"setSpecularState",value:function(e){var t=l.SelfHelperFunctions.getFloatStringPair(e);t&&(this.uniforms.specularOn.value=t.f,this.description.specularOn=t.s)}},{key:"setSpecularShininess",value:function(e){var t=l.SelfHelperFunctions.getFloatStringPair(e);t&&(this.uniforms.ns.value=t.f,this.description.ns=t.s)}},{key:"setSpecularPercentage",value:function(e){var t=l.SelfHelperFunctions.getFloatStringPair(e);t&&(this.uniforms.specularPercentage.value=t.f,this.description.specularPercentage=t.s)}},{key:"getAmbient",value:function(){return{color:this.array2Hex(this.uniforms.ka.value),textureUsed:this.uniforms.mapKaUsed.value,texturePath:this.uniforms.mapKaPath.value,percentage:this.uniforms.ambientPercentage.value}}},{key:"getDiffuse",value:function(){return{state:this.uniforms.diffuseOn.value,color:this.array2Hex(this.uniforms.kd.value),textureUsed:this.uniforms.mapKdUsed.value,texturePath:this.uniforms.mapKdPath.value,percentage:this.uniforms.diffusePercentage.value}}},{key:"getSpecular",value:function(){return{state:this.uniforms.specularOn.value,color:this.array2Hex(this.uniforms.ks.value),textureUsed:this.uniforms.mapKsUsed.value,texturePath:this.uniforms.mapKsPath.value,percentage:this.uniforms.specularPercentage.value,shininess:this.uniforms.ns.value}}},{key:"array2Hex",value:function(e){return"#"+Math.round(255*e[0]).toString(16)+Math.round(255*e[1]).toString(16)+Math.round(255*e[2]).toString(16)}},{key:"_loadTexture",value:function(e,t,r,n,i,o){if(""===e)return void(r.value=0);var a=new s.TextureLoader;a.setCrossOrigin("anonymous"),a.withCredentials=!0,a.load(e,function(a){t.value=a,i&&(i.value=parseFloat(a.image.width)),o&&(o.value=parseFloat(a.image.height)),n.value=e,r.value=1},function(e){},function(t){console.warn("an error happened while loading "+e)})}},{key:"clone",value:function(){return new this.constructor(this.description)}}]),t}(s.ShaderMaterial),h=c;t.default=h,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(u,"MTLPhongShaderMaterialParameters","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/MTLPhongShaderMaterial.js"),__REACT_HOT_LOADER__.register(c,"MTLPhongShaderMaterial","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/MTLPhongShaderMaterial.js"),__REACT_HOT_LOADER__.register(h,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/MTLPhongShaderMaterial.js"))}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelfHelperFunctions=t.SelfShaderChunks=void 0;var n=r(0),i={DisplacementMapPositionCalculation_vertex:"\nuniform float displacementMapUsed;\nuniform sampler2D displacementMap;\nuniform float displacementScale;\nuniform float displacementBias;\nvec3 displacementMapOffset(vec3 normal, vec2 uv){\n  if(displacementMapUsed>0.5){\n    return normalize(normal) * (texture2D(displacementMap, uv).x * displacementScale + displacementBias);\n  }else{\n    return vec3(0.0);\n  }\n}\n",SimplePostProcessingColorCalculation_fragment:"\nuniform float red, green, blue, alpha;\nuniform float lighting;\nuniform vec2 contract;\nvec4 calculateSimplePostProcessingColor(vec4 color){\n  vec3 tempColor = color.rgb;\n  tempColor += vec3(red, blue, green);\n  for(int i=0;i<3;++i){\n      if(tempColor[i]<0.0)tempColor[i]=0.0;\n      else if(tempColor[i]>1.0)tempColor[i]=1.0;\n    }\n    if(lighting>0.0){\n      tempColor = log(tempColor*(lighting+1.0)+vec3(1.0))/log(vec3(lighting+2.0));\n    }\n    else{\n      tempColor = pow(tempColor,vec3(1.0-lighting));\n    }\n    for(int i=0;i<3;++i){\n      if(tempColor[i]<contract[0])tempColor[i]=0.0;\n      else if(tempColor[i]>contract[1])tempColor[i]=1.0;\n      else{\n        tempColor[i] = (tempColor[i]-contract[0])/(contract[1]-contract[0]);\n      }\n    }\n    return vec4(tempColor, color.a * alpha);\n}\n",MatrixTranspose:"\nfloat transpose(float m) {\n  return m;\n}\n\nmat2 transpose(mat2 m) {\n  return mat2(m[0][0], m[1][0],\n              m[0][1], m[1][1]);\n}\n\nmat3 transpose(mat3 m) {\n  return mat3(m[0][0], m[1][0], m[2][0],\n              m[0][1], m[1][1], m[2][1],\n              m[0][2], m[1][2], m[2][2]);\n}\n\nmat4 transpose(mat4 m) {\n  return mat4(m[0][0], m[1][0], m[2][0], m[3][0],\n              m[0][1], m[1][1], m[2][1], m[3][1],\n              m[0][2], m[1][2], m[2][2], m[3][2],\n              m[0][3], m[1][3], m[2][3], m[3][3]);\n}\n",MatrixInverse:"\nfloat inverse(float m) {\n  return 1.0 / m;\n}\n\nmat2 inverse(mat2 m) {\n  return mat2(m[1][1],-m[0][1],\n             -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n",getSharpnessMapColor:"\nvec3 getSharpnessMapColor(sampler2D map, vec2 vUv, float mapWidth, float mapHeight){\n  vec3 result = vec3(0.0);\n  result += 5.0 * texture2D(map, vUv).rgb;\n  result += -1.0 * texture2D(map, vec2(vUv.x - 1.0/mapWidth, vUv.y)).rgb;\n  result += -1.0 * texture2D(map, vec2(vUv.x + 1.0/mapWidth, vUv.y)).rgb;\n  result += -1.0 * texture2D(map, vec2(vUv.x, vUv.y - 1.0/mapHeight)).rgb;\n  result += -1.0 * texture2D(map, vec2(vUv.x, vUv.y + 1.0/mapHeight)).rgb;\n  result /= 1.0;\n  return result;\n}\n"},o={deepCopyUniforms:function(e){var t=void 0,r=void 0,i=void 0,o={};for(t in e){o[t]={};for(r in e[t])i=e[t][r],i instanceof n.Color||i instanceof n.Vector2||i instanceof n.Vector3||i instanceof n.Vector4||i instanceof n.Matrix4?o[t][r]=i.clone():i instanceof n.Texture?(o[t][r]=i.clone(),o[t][r].needsUpdate=!0):i instanceof Array?o[t][r]=i.slice():(String,o[t][r]=i)}return o},getFloatStringPair:function(e){return"number"==typeof e?{f:e,s:e.toString()}:"string"==typeof e?{f:parseFloat(e),s:e}:null}};t.SelfShaderChunks=i,t.SelfHelperFunctions=o,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"SelfShaderChunks","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/SelfShaderChunks.js"),__REACT_HOT_LOADER__.register(o,"SelfHelperFunctions","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/SelfShaderChunks.js"))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(2),s=r(65),l=n(s),u=r(61),c=n(u),h=function(){function e(t,r){i(this,e),r.api||(r.api={API_HOST:"U2FsdGVkX19l4+V8uQYRigbhRUbtp+TqhjxwRO/FKTliJ0AFJkFXCzSs+ehN700y",API_KEY:"U2FsdGVkX19phGn0b5VCcKo7Vu7x1XAz2BKyuIasob2KrQD1CLAC9Ls72FjPeP+/NBhDGn19Gsh13EumIGZ95w=="}),this.earthView=new a.EarthBasic(t,null,r);var n=this;this.layers={marker:null},function(){!function(){n.earthView.layers.marker=new l.default(n.sceneRoot,{dataSeeds:[]}),n.earthView.layers.marker.sceneNode.name="marker layer sceneNode",n.earthView.layers.marker.updateMatrixWorld(!0)}()}(),this.materialManager=new c.default}return o(e,[{key:"destruct",value:function(){}},{key:"freeze",value:function(){return this.earthView.control.enabled=!1,!0}},{key:"unfreeze",value:function(){return this.earthView.control.enabled=!0,!0}},{key:"addAltizureProjects",value:function(e){return this.earthView.addAltizureProjects(e)}},{key:"pick",value:function(e){return e.changedTouches&&(e.x=e.changedTouches[0].pageX,e.y=e.changedTouches[0].pageY),this.earthView.control.pickEarthContactPoint(e)}},{key:"pickOnProjects",value:function(e){e.changedTouches&&(e.x=e.changedTouches[0].pageX,e.y=e.changedTouches[0].pageY);var t=this.earthView.control.pickProjectContactPoint(e,"marker");return t||(t=this.earthView.control.pickProjectContactPoint(e)),t}},{key:"scene",get:function(){return this.earthView.scene}},{key:"sceneRoot",get:function(){return this.earthView.earthSceneRoot}},{key:"markerLayer",get:function(){return this.earthView.layers.marker}},{key:"viewerCamera",get:function(){return this.earthView.camera}},{key:"domElement",get:function(){return this.earthView.renderer.domElement}},{key:"renderer",get:function(){return this.earthView.renderer}}]),e}(),d=h;t.default=d,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(h,"Earth","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/earth/Earth.js"),__REACT_HOT_LOADER__.register(d,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/earth/Earth.js"))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0},u=r(3),c=n(u),h=r(51),d=r(0),f=r(67),p=n(f),m=r(4),v=n(m),g=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=r;if(!function(){return e&&e.shape&&e.objUrl?(n._property.type="OBJMarker",n._property.shape=e.shape,n._property.objUrl=e.objUrl,n._property.mtlUrl=e.mtlUrl,n._property.upDir=e.upDir,n._property.scale=e.scale,e.upDir||(e.upDir={x:0,y:0,z:1}),e.scale||(e.scale=1),!0):(console.error("OBJMarker missing arguments",e),!1)}()){var a;return a=void 0,o(r,a)}for(var s=[],l=0;l<r._property.materialDescriptions.length;++l){var u=r._property.materialDescriptions[l],c=r.earth.materialManager.materials[u.type.toLowerCase()],f=new c(u);s.push(f)}if(null===t.objCache&&(t.objCache=new p.default),null===t.loading&&(t.loading={}),void 0!==e.shape){var m=e.shape;if("CUSTOMIZE"===m&&void 0!==e.objUrl){var g=e.objUrl,y=e.mtlUrl||"",b={objUrl:g,mtlUrl:y,upDir:function(e){return new d.Vector3(e.x,e.y,e.z)}(e.upDir),scale:e.scale,clickable:e.clickable},_=t.objCache.get(g,null);if(!_||e.isRollOver){var w=function(){var e=new d.MeshLambertMaterial({color:16711680,transparent:!0,opacity:.5}),t=new d.Mesh(new d.ConeGeometry(.2,1.6,20),e);t.rotateX(-Math.PI/2);var r=new d.MeshLambertMaterial({color:16711680,wireframe:!0}),n=new d.Mesh(new d.RingGeometry(.35,.4,32),r);n.translateZ(-.75);var i=new d.Group;i.add(t),i.add(n);var o=new d.Group;o.add(i);var a=new d.Matrix4;a.makeTranslation(0,0,.8),o.applyMatrix(a);var s=v.default.scale/v.default.EARTH_RADIUS*4;return a.makeScale(s,s,s),o.applyMatrix(a),o}(),x=t.loading[g];x?x.push({marker:r,mtls:s}):(t.loading[g]=[],(0,h.addMTLOBJ)(b).then(function(r){t.objCache.set(g,r),t.loading[g].map(function(e){var r=e.marker,n=e.mtls;r.unsetContent();var i=t.objCache.get(g,null);r.setContent(i),n.map(function(e){r.changeMaterial(e)}),r._updateMaterialDescriptions()}),t.loading[g]=null,e.isRollOver&&r.children[0].children.map(function(e){e.material.color=new d.Color(1,0,0),e.material.wireframe=!0}),n.unsetContent(),n.setContent(r),s.map(function(e){n.changeMaterial(e)}),n._updateMaterialDescriptions()}).catch(function(t){e.errHandler&&e.errHandler(t),console.error("addMTLOBJ err",t)})),n.setContent(w),s.map(function(e){n.changeMaterial(e)}),n._updateMaterialDescriptions()}else n.setContent(_),s.map(function(e){n.changeMaterial(e)}),n._updateMaterialDescriptions()}else"CUSTOMIZE"===m&&console.error("OBJ url is requred")}else console.error("OBJ load failed");return r}return a(t,e),s(t,[{key:"destruct",value:function(){this.interactable&&(this.interactable=!1),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unsetContent",this).call(this),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destruct",this).call(this)}},{key:"_updateMaterialDescriptions",value:function(){var e=this;this.contentHolder.traverse(function(t){if("Mesh"===t.type){var r=t.material.description;if(null!==r&&void 0!==r){for(var n=!1,i=0;i<e._property.materialDescriptions.length;++i)e._property.materialDescriptions[i].name===r.name&&(e._property.materialDescriptions[i]=r,n=!0);n||e._property.materialDescriptions.push(r)}}})}},{key:"setBboxColor",value:function(e){var t=this.decoHolder.children[0].material.color.clone();return this.decoHolder.children[0].material.color.copy(e),t}},{key:"setContent",value:function(e){return!!function(e){var t=e instanceof d.Object3D;return t||console.warn("Marker: unknown content type",e),t}(e)&&(this.contentHolder.add(e),e.objSpaceBBox&&(this.decoHolder.add(e.objSpaceBBox),this.interactShape=e.objSpaceBBox.clone(),this.interactShape.geometry=e.objSpaceBBox.geometry.clone()),!0)}},{key:"bboxColor",set:function(e){this.decoHolder.children[0].material.color.copy(new d.Color(e))},get:function(){return this.decoHolder.children[0].material.color}}]),t}(c.default);g.objCache=null,g.loading=null;var y=g;t.default=y,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(g,"OBJMarker","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/OBJMarker.js"),__REACT_HOT_LOADER__.register(y,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/OBJMarker.js"))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0},u=r(0),c=r(3),h=n(c),d=r(5),f=n(d),p=r(10),m=n(p),v=r(4),g=n(v),y=r(54),b=n(y),_=!1,w=function(e){function t(e){if(i(this,t),_&&console.log("PolyLineMarker",e),!function(e){return!(!e||!e.earth&&!e.sandbox||(null!==e.points&&void 0!==e.points&&e.points instanceof Array?e.points.length<2&&(console.warn("PolyLineMarker cannot be cnstructed due to no enough points",e.points),1):(console.warn("PolyLineMarker no usable points!",e),1)))}(e)){var r;return console.warn("PolyLineMarker invalid init input",e),r=void 0,o(u,r)}var n=e.points.slice(),a=function(e){for(var t=0,r=0,n=0,i=e.length,o=0;o<i;++o)t+=e[o].lng,r+=e[o].lat,n+=e[o].alt;var a=new f.default(t/i,r/i,n/i);_&&console.log("[PolyLineMarker] center",a);var s=m.default.getLocalSystemOnEarthSurface(g.default.EarthResolution,a.lng,a.lat,g.default.scale+a.alt/g.default.EARTH_RADIUS*g.default.scale);return _&&console.log("[PolyLineMarker] system",s),{center:a,system:s}}(n),s=a.center,l=a.system;e.position=s;var u=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));u._lineWidth=void 0!==e.lineWidth?e.lineWidth:1;var c=!!e.pointVisible&&e.pointVisible;u._pointVisible=c,u._color=e.color||16777215,u._fenceHeight=e.fenceHeight?e.fenceHeight:5,u.imgUrl=e.imgUrl,u.center=s,u.system=l,u.points=[n[0],n[1]];var h={position:n[0],earth:e.earth,visible:c,imgUrl:u.imgUrl,scale:u.scale},d={position:n[1],earth:e.earth,visible:c,imgUrl:u.imgUrl,scale:u.scale},p=u._BasicShape(h,d);u.lines=p.lines,u.pointsMarks=p.pointsMarks;for(var v=2;v<n.length;++v)u.addPointMarker(n[v]);return u.setContent(u.lines),u._interactShape=null,u._property.type="PolyLineMarker",u._property.points=u.points,u._property.lineWidth=u._lineWidth,u._property.color=u._color,u._property.pointVisible=u._pointVisible,u._property.scale=u.scale,u._property.imgUrl=u.imgUrl,u._property.fenceHeight=u._fenceHeight,u}return a(t,e),s(t,[{key:"_calculateSystemAndCenter",value:function(){for(var e=0,t=0,r=0,n=this.points.length,i=0;i<n;++i)e+=this.points[i].lng,t+=this.points[i].lat,r+=this.points[i].alt;this.center=new f.default(e/n,t/n,r/n),_&&console.log("[PolyLineMarker] center",this.center),this.system=m.default.getLocalSystemOnEarthSurface(g.default.EarthResolution,this.center.lng,this.center.lat,g.default.scale+this.center.alt/g.default.EARTH_RADIUS*g.default.scale),_&&console.log("[PolyLineMarker] system",this.system)}},{key:"_convertPointToXYZPoint",value:function(e){null!==this.system&&void 0!==this.system||this._calculateSystemAndCenter();var t=m.default.geographicToEarthSurface(g.default.EarthResolution,e.lng,e.lat,g.default.scale+e.alt/g.default.EARTH_RADIUS*g.default.scale);_&&console.log("[PolyLineMarker] earthPt",t);var r=t.clone().sub(this.system.origin),n=1*r.dot(this.system.lng),i=1*r.dot(this.system.lat),o=1*r.dot(this.system.alt);return new u.Vector3(n,i,o)}},{key:"_constructLineBufferGeometryAttributesArrayUsingTwoPoints",value:function(e,t){var r=this._convertPointToXYZPoint(e),n=this._convertPointToXYZPoint(t),i=new f.default(e.lng,e.lat,e.alt+this._fenceHeight),o=new f.default(t.lng,t.lat,t.alt+this._fenceHeight),a=this._convertPointToXYZPoint(i),s=this._convertPointToXYZPoint(o);return{position:[r.x,r.y,r.z,n.x,n.y,n.z,a.x,a.y,a.z,a.x,a.y,a.z,s.x,s.y,s.z,n.x,n.y,n.z],uv:[1,1,0,1,1,0,1,0,0,0,0,1]}}},{key:"_BasicShape",value:function(e,t){var r=e.position,n=t.position,i=this._constructLineBufferGeometryAttributesArrayUsingTwoPoints(r,n),o=i.position,a=i.uv,s=new u.BufferGeometry;s.addAttribute("position",new u.BufferAttribute(new Float32Array(o),3)),s.addAttribute("uv",new u.BufferAttribute(new Float32Array(a),2));var l=new u.DataTexture(Uint8Array.from([0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255]),2,2,u.RGBAFormat,u.UnsignedByteType,u.UVMapping);l.minFilter=l.magFilter=u.LinearFilter,l.needsUpdate=!0;var c=new u.ShaderMaterial({transparent:!0,side:u.DoubleSide,linewidth:this._lineWidth,uniforms:{color:{value:new u.Color(this._color)},map:{value:l}},vertexShader:"\n      uniform float linewidth;\n      varying vec2 vUv;\n      void main(){\n        vUv = uv;\n        gl_PointSize = linewidth;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n      }\n      ",fragmentShader:"\n      uniform vec3 color;\n      uniform sampler2D map;\n      varying vec2 vUv;\n      void main(){\n        gl_FragColor = vec4(color, 1.0) * texture2D(map, vUv);\n      }\n      "}),h=new u.Mesh(s,c),d=[];if(e.visible){var f=new b.default(e),p=new b.default(t);d.concat([f,p])}return{lines:h,pointsMarks:d}}},{key:"addPointMarker",value:function(e){var t=e;this.points.push(t);var r=this.points.length;if(!(r<2)){var n=this.points[r-2],i=this.points[r-1],o=this._constructLineBufferGeometryAttributesArrayUsingTwoPoints(n,i),a=Array.prototype.slice.call(this.lines.geometry.attributes.position.array);a=a.concat(o.position),this.lines.geometry.attributes.position.setArray(new Float32Array(a)),this.lines.geometry.attributes.position.needsUpdate=!0;var s=Array.prototype.slice.call(this.lines.geometry.attributes.uv.array);if(s=s.concat(o.uv),this.lines.geometry.attributes.uv.setArray(new Float32Array(s)),this.lines.geometry.attributes.uv.needsUpdate=!0,this._pointVisible){var l=new b.default({position:e,earth:this.earth,imgUrl:this.imgUrl,scale:this.scale.x,visible:this._pointVisible});return this.pointsMarks.push(l),l}return null}}},{key:"update",value:function(){for(var e=this,t=[],r=[],n=0;n<this.points.length-1;++n){var i=this.points[n],o=this.points[n+1],a=this._constructLineBufferGeometryAttributesArrayUsingTwoPoints(i,o);t=t.concat(a.position),r=r.concat(a.uv)}this.lines.geometry.attributes.position.setArray(new Float32Array(t)),this.lines.geometry.attributes.position.needsUpdate=!0,this.lines.geometry.attributes.uv.setArray(new Float32Array(r)),this.lines.geometry.attributes.uv.needsUpdate=!0,this.pointsMarks.map(function(e){e&&(e.destruct(),e=null)}),this.pointsMarks=[],this._pointVisible&&this.points.map(function(t){var r=new b.default({position:t,earth:e.earth,imgUrl:e.imgUrl,scale:e.scale.x,visible:e._pointVisible});e.pointsMarks.push(r)})}},{key:"destruct",value:function(){if(this.lines&&(this.lines.geometry&&this.lines.geometry.dispose(),this.lines.material&&this.lines.material.dispose()),this.pointsMarks){for(var e=0;e<this.pointsMarks.length;++e)this.pointsMarks[e].destruct(),this.pointsMarks[e]=null;this.pointsMarks=[]}l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destruct",this).call(this)}},{key:"interactShape",set:function(e){console.warn("[PolyLineMarker] cannot set interactShape")}},{key:"interactable",set:function(e){e&&console.warn("[PolyLineMarker] cannot set interactable")}},{key:"color",set:function(e){if(this.lines&&this.lines.material){var t=new u.Color(e);this.lines.material.uniforms.color.value=t,this._color=e,this._property.color=e}}},{key:"lineWidth",set:function(e){this.lines&&this.lines.material&&(this.lines.material.linewidth=e,this._lineWidth=e,this._property.lineWidth=e)},get:function(){return this._lineWidth}},{key:"fenceHeight",set:function(e){this._fenceHeight=e,this.update()},get:function(){return this._fenceHeight}}]),t}(h.default),x=w;t.default=x,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(_,"debug","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/PolyLineMarker.js"),__REACT_HOT_LOADER__.register(w,"PolyLineMarker","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/PolyLineMarker.js"),__REACT_HOT_LOADER__.register(x,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/PolyLineMarker.js"))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){function r(e,t){return e-t}c.BufferGeometry.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var n,i,o=[],a=Math.cos(1/180*Math.PI),s=[0,0],l={},u=["a","b","c"];e.isBufferGeometry?(i=new c.Geometry,i.fromBufferGeometry(e)):i=e.clone(),i.computeFaceNormals();for(var h=i.vertices,d=i.faces,f=0,p=d.length;f<p;f++)for(var m=d[f],v=0;v<3;v++)s[0]=m[u[v]],s[1]=m[u[(v+1)%3]],s.sort(r),n=s.toString(),void 0===l[n]?l[n]={index1:s[0],index2:s[1],face1:f,face2:void 0}:l[n].face2=f;for(n in l){var g=l[n];if(void 0===g.face2||d[g.face1].normal.dot(d[g.face2].normal)<=a){var y=h[g.index1];o.push(y.x,y.y,y.z),y=h[g.index2],o.push(y.x,y.y,y.z)}}var b=new Float32Array(o);this.addAttribute("position",new c.BufferAttribute(b,3))}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0},c=r(0),h=r(3),d=n(h),f=r(5),p=n(f),m=r(10),v=n(m),g=r(4),y=n(g);s.prototype=Object.create(c.BufferGeometry.prototype),s.prototype.constructor=s;var b=function(e){function t(e){i(this,t);var r=e.volume,n=r.points;if(!function(){var t=!0;if(!(t=t&&n.length>=4))return console.error("PolygonMarker needs at least 4 points"),t;if(!(t=t&&n[0].equals(n[n.length-1])))return console.error("PolygonMarker points are not closed. (first and last points should be equal)"),t;if(!(t=t&&void 0===e.scale))return console.error("PolygonMarker should not be scaled, used lng lat directly."),t;var i={height:100,color:16711680,opacity:.1};try{r=Object.assign({},i,r)}catch(e){console.error("PolygonMarker init defaults failed.",r),t=!1}return t}()){var a;return console.error("PolygonMarker construction failed."),a=void 0,o(u,a)}r.height=(r.top-r.bottom)*y.default.scale/y.default.EARTH_RADIUS,r.ground=r.bottom*y.default.scale/y.default.EARTH_RADIUS;var l=function(){for(var e=0,t=0,i=0;i<n.length;i++)e+=n[i].lng,t+=n[i].lat;for(var o=new p.default(e/n.length,t/n.length,0),a=v.default.getLocalSystemOnEarthSurface(y.default.EarthResolution,o.lng,o.lat,y.default.scale),l=[],u=0;u<n.length;u++){var h=v.default.geographicToEarthSurface(y.default.EarthResolution,n[u].lng,n[u].lat,y.default.scale),d=h.clone().sub(a.origin),f=1*d.dot(a.lng),m=1*d.dot(a.lat),g=d.dot(a.alt);l.push(new c.Vector3(f,m,g))}var b=new c.Matrix4;b.makeScale(1e7,1e7,1e7),l=l.map(function(e){return e.applyMatrix4(b)});var _=new c.Shape;_.moveTo(l[0].x,l[0].y);for(var w=1;w<n.length;w++)_.lineTo(l[w].x,l[w].y);var x={steps:1,amount:1e7*r.height,bevelEnabled:!1},M=new c.ExtrudeGeometry(_,x);M.applyMatrix((new c.Matrix4).makeTranslation(0,0,1e7*r.ground)),M.applyMatrix((new c.Matrix4).makeScale(1e-7,1e-7,1e-7));var E=new c.MeshLambertMaterial({color:r.color,transparent:!0,opacity:r.opacity,depthWrite:!1}),A=new c.Mesh(M,E),T=new s(M);return{mesh:A,line:new c.LineSegments(T,new c.LineBasicMaterial({color:r.color,linewidth:2})),center:o}}();e.position=l.center;var u=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return u.boundaryPts=n,u._top=r.top,u._bottom=r.bottom,u.extrudeMesh=l.mesh,u.extrudeLine=l.line,u.setContent(u.extrudeMesh),u.interactShape=u.extrudeMesh.clone(),u.setDecoration(u.extrudeLine),u._color=r.color,u._property.type="PolygonMarker",u._property.volume=r,u._property.name=e.name,u}return a(t,e),l(t,[{key:"destruct",value:function(){this.interactable&&(this.interactable=!1),this.unsetContent(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destruct",this).call(this)}},{key:"color",set:function(e){var t=new c.Color(e);this.extrudeMesh.material.color=t,this.extrudeMesh.material.needsUpdate=!0,this.extrudeLine.material.color=t,this.extrudeLine.material.needsUpdate=!0,this._property.volume.color=e},get:function(){return this.extrudeMesh.material.color}},{key:"opacity",set:function(e){return"number"!=typeof e?(console.warn("wrong opacity type"),!1):(e=Math.min(1,Math.max(0,e)),this.extrudeMesh.material.opacity=e,this.extrudeMesh.material.needsUpdate=!0,this._property.volume.opacity=e,!0)},get:function(){return this.extrudeMesh.material.opacity}},{key:"top",set:function(e){if(e<=this._bottom)throw new Error("invalid value");var t=this.extrudeMesh.geometry.vertices;if(t.length<=0)throw new Error("no vertices");for(var r=t[0].z,n=t[0].z,i=1;i<t.length;++i)r=t[i].z>r?t[i].z:r,n=t[i].z<n?t[i].z:n;var o=(r-n)/(this._top-this._bottom);o=Math.abs(o),this._top=e;for(var a=0;a<t.length;++a)t[a].z===r&&(t[a].z=o*(this._top-this._bottom)+n);this.extrudeMesh.geometry.verticesNeedUpdate=!0,this.extrudeLine.geometry=new s(this.extrudeMesh.geometry),this._property.volume.top=this._top},get:function(){return this._top}},{key:"bottom",set:function(e){if(e>=this._top)throw new Error("invalid value");var t=this.extrudeMesh.geometry.vertices;if(t.length<=0)throw new Error("no vertices");for(var r=t[0].z,n=t[0].z,i=1;i<t.length;++i)r=t[i].z>r?t[i].z:r,n=t[i].z<n?t[i].z:n;var o=(r-n)/(this._top-this._bottom);o=Math.abs(o),this._bottom=e;for(var a=0;a<t.length;++a)t[a].z===n&&(t[a].z=r-o*(this._top-this._bottom));this.extrudeMesh.geometry.verticesNeedUpdate=!0,this.extrudeLine.geometry=new s(this.extrudeMesh.geometry),this._property.volume.bottom=this._bottom},get:function(){return this._bottom}}]),t}(d.default),_=b;t.default=_,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(s,"EdgesGeometry","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/PolygonMarker.js"),__REACT_HOT_LOADER__.register(b,"PolygonMarker","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/PolygonMarker.js"),__REACT_HOT_LOADER__.register(_,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/PolygonMarker.js"))}()},function(e,t,r){"use strict";(function(t){var n=r(1),i=r(34),o=r(37),a=r(43),s=r(41),l=r(20),u="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||r(36);e.exports=function(e){return new Promise(function(c,h){var d=e.data,f=e.headers;n.isFormData(d)&&delete f["Content-Type"];var p=new XMLHttpRequest,m="onreadystatechange",v=!1;if("test"===t.env.NODE_ENV||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in p||s(e.url)||(p=new window.XDomainRequest,m="onload",v=!0,p.onprogress=function(){},p.ontimeout=function(){}),e.auth){var g=e.auth.username||"",y=e.auth.password||"";f.Authorization="Basic "+u(g+":"+y)}if(p.open(e.method.toUpperCase(),o(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p[m]=function(){if(p&&(4===p.readyState||v)&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var t="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,r=e.responseType&&"text"!==e.responseType?p.response:p.responseText,n={data:r,status:1223===p.status?204:p.status,statusText:1223===p.status?"No Content":p.statusText,headers:t,config:e,request:p};i(c,h,n),p=null}},p.onerror=function(){h(l("Network Error",e,null,p)),p=null},p.ontimeout=function(){h(l("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},n.isStandardBrowserEnv()){var b=r(39),_=(e.withCredentials||s(e.url))&&e.xsrfCookieName?b.read(e.xsrfCookieName):void 0;_&&(f[e.xsrfHeaderName]=_)}if("setRequestHeader"in p&&n.forEach(f,function(e,t){void 0===d&&"content-type"===t.toLowerCase()?delete f[t]:p.setRequestHeader(t,e)}),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){p&&(p.abort(),h(e),p=null)}),void 0===d&&(d=null),p.send(d)})}}).call(t,r(23))},function(e,t,r){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,r){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,r){"use strict";var n=r(33);e.exports=function(e,t,r,i,o){var a=new Error(e);return n(a,t,r,i,o)}},function(e,t,r){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Type=t.Particle=t.Tween=t.ParticleEngine=void 0;var n=r(0),i="\nattribute vec3  customColor;\nattribute float customOpacity;\nattribute float customSize;\nattribute float customAngle;\nattribute float customVisible; // float used as boolean (0 = false, 1 = true)\nvarying vec4  vColor;\nvarying float vAngle;\n\nvoid main()\n{\n  if ( customVisible > 0.5 ) { // true\n    vColor = vec4( customColor, customOpacity ); // set color associated to vertex use later in fragment shader.\n  } else { // false\n    vColor = vec4(0.0, 0.0, 0.0, 0.0); // make particle invisible.\n  }\n  vAngle = customAngle;\n\n  vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n  gl_PointSize = customSize * ( ( 1.0 / 200000.0 ) / length(cameraPosition.xyz - mvPosition.xyz) ); // scale particles as objects in 3D space\n  gl_Position = projectionMatrix * mvPosition;\n}\n",o="\nuniform sampler2D texture;\nvarying vec4 vColor;\nvarying float vAngle;\nvoid main()\n{\n  gl_FragColor = vColor;\n\n  float c = cos(vAngle);\n  float s = sin(vAngle);\n  vec2 rotatedUV = vec2(\n    c * (gl_PointCoord.x - 0.5) + s * (gl_PointCoord.y - 0.5) + 0.5,\n    c * (gl_PointCoord.y - 0.5) - s * (gl_PointCoord.x - 0.5) + 0.5\n  );  // rotate UV coordinates to rotate texture\n  vec4 rotatedTexture = texture2D( texture,  rotatedUV );\n  gl_FragColor = gl_FragColor * rotatedTexture;    // sets an otherwise white particle texture to desired color\n}\n",a=function(e,t){this.times=e||[],this.values=t||[]};a.prototype.constructor=a,a.prototype.lerp=function(e){for(var t=0,r=this.times.length;t<r&&e>this.times[t];)t++;if(0===t)return this.values[0];if(t===r)return this.values[r-1];var i=(e-this.times[t-1])/(this.times[t]-this.times[t-1]);return this.values[0]instanceof n.Vector3?this.values[t-1].clone().lerp(this.values[t],i):this.values[t-1]+i*(this.values[t]-this.values[t-1])},a.prototype.clone=function(){var e=this.times.slice(),t=this.values.slice();return new this.constructor(e,t)};var s=function(){this.position=new n.Vector3,this.velocity=new n.Vector3,this.acceleration=new n.Vector3,this.angle=0,this.angleVelocity=0,this.angleAcceleration=0,this.size=16,this.color=new n.Color,this.opacity=1,this.age=0,this.alive=0};s.prototype.constructor=s,s.prototype.update=function(e){if(this.position.add(this.velocity.clone().multiplyScalar(e)),this.velocity.add(this.acceleration.clone().multiplyScalar(e)),this.angle+=.01745329251*this.angleVelocity*e,this.angleVelocity+=.01745329251*this.angleAcceleration*e,this.age+=e,this.sizeTween.times.length>0&&(this.size=this.sizeTween.lerp(this.age)),this.colorTween.times.length>0){var t=this.colorTween.lerp(this.age);this.color=(new n.Color).setHSL(t.x,t.y,t.z)}this.opacityTween.times.length>0&&(this.opacity=this.opacityTween.lerp(this.age))};var l=Object.freeze({CUBE:1,SPHERE:2}),u=function(){this.positionStyle=l.CUBE,this.positionBase=new n.Vector3,this.positionSpread=new n.Vector3,this.positionRadius=0,this.velocityStyle=l.CUBE,this.velocityBase=new n.Vector3,this.velocitySpread=new n.Vector3,this.speedBase=0,this.speedSpread=0,this.accelerationBase=new n.Vector3,this.accelerationSpread=new n.Vector3,this.angleBase=0,this.angleSpread=0,this.angleVelocityBase=0,this.angleVelocitySpread=0,this.angleAccelerationBase=0,this.angleAccelerationSpread=0,this.sizeBase=0,this.sizeSpread=0,this.sizeTween=new a,this.colorBase=new n.Vector3(0,1,.5),this.colorSpread=new n.Vector3(0,0,0),this.colorTween=new a,this.opacityBase=1,this.opacitySpread=0,this.opacityTween=new a,this.blendStyle=n.NormalBlending,this.particleArray=[],this.particlesPerSecond=100,this.particleDeathAge=1,this.emitterAge=0,this.emitterAlive=!0,this.emitterDeathAge=60,this.particleCount=this.particlesPerSecond*Math.min(this.particleDeathAge,this.emitterDeathAge),this.particleGeometry=new n.BufferGeometry,this.particleTexture=null,this.particleMaterial=new n.ShaderMaterial({uniforms:{texture:{type:"t",value:this.particleTexture}},vertexShader:i,fragmentShader:o,transparent:!0,alphaTest:.5,blending:n.NormalBlending,depthTest:!0}),this.particleMesh=new n.Mesh,this.lastIndex=-1};u.prototype.constructor=u,u.prototype.setValues=function(e){if(void 0!==e){this.sizeTween=new a,this.colorTween=new a,this.opacityTween=new a;for(var t in e)this[t]=e[t];this.particleArray=[],this.emitterAge=0,this.emitterAlive=!0,this.particleCount=this.particlesPerSecond*Math.min(this.particleDeathAge,this.emitterDeathAge),this.particleGeometry=new n.BufferGeometry,this.particleMaterial=new n.ShaderMaterial({uniforms:{texture:{type:"t",value:e.particleTexture}},vertexShader:i,fragmentShader:o,transparent:!0,alphaTest:.5,blending:n.NormalBlending,depthTest:!0}),this.particleMesh=new n.Points}},u.prototype.randomValue=function(e,t){return e+t*(Math.random()-.5)},u.prototype.randomVector3=function(e,t){var r=new n.Vector3(Math.random()-.5,Math.random()-.5,Math.random()-.5);return(new n.Vector3).addVectors(e,(new n.Vector3).multiplyVectors(t,r))},u.prototype.createParticle=function(){var e=new s;if(e.sizeTween=this.sizeTween,e.colorTween=this.colorTween,e.opacityTween=this.opacityTween,this.positionStyle===l.CUBE&&(e.position=this.randomVector3(this.positionBase,this.positionSpread)),this.positionStyle===l.SPHERE){var t=2*Math.random()-1,r=6.2832*Math.random(),i=Math.sqrt(1-t*t),o=new n.Vector3(i*Math.cos(r),i*Math.sin(r),t);e.position=(new n.Vector3).addVectors(this.positionBase,o.multiplyScalar(this.positionRadius))}if(this.velocityStyle===l.CUBE&&(e.velocity=this.randomVector3(this.velocityBase,this.velocitySpread)),this.velocityStyle===l.SPHERE){var a=(new n.Vector3).subVectors(e.position,this.positionBase),u=this.randomValue(this.speedBase,this.speedSpread);e.velocity=a.normalize().multiplyScalar(u)}e.acceleration=this.randomVector3(this.accelerationBase,this.accelerationSpread),e.angle=this.randomValue(this.angleBase,this.angleSpread),e.angleVelocity=this.randomValue(this.angleVelocityBase,this.angleVelocitySpread),e.angleAcceleration=this.randomValue(this.angleAccelerationBase,this.angleAccelerationSpread),e.size=this.randomValue(this.sizeBase,this.sizeSpread);var c=this.randomVector3(this.colorBase,this.colorSpread);return e.color=(new n.Color).setHSL(c.x,c.y,c.z),e.opacity=this.randomValue(this.opacityBase,this.opacitySpread),e.age=0,e.alive=0,e},u.prototype.initialize=function(){for(var e=[],t=[],r=[],i=[],o=[],a=[],s=0;s<this.particleCount;s++)this.particleArray[s]=this.createParticle(),e=e.concat([this.particleArray[s].position.x,this.particleArray[s].position.y,this.particleArray[s].position.z]),t.push(this.particleArray[s].alive),r=r.concat([this.particleArray[s].color.r,this.particleArray[s].color.g,this.particleArray[s].color.b]),i.push(this.particleArray[s].opacity),o.push(this.particleArray[s].size),a.push(this.particleArray[s].angle);this.particleGeometry.addAttribute("position",new n.BufferAttribute(new Float32Array(e),3)),this.particleGeometry.addAttribute("customVisible",new n.BufferAttribute(new Float32Array(t),1)),this.particleGeometry.addAttribute("customColor",new n.BufferAttribute(new Float32Array(r),3)),this.particleGeometry.addAttribute("customOpacity",new n.BufferAttribute(new Float32Array(i),1)),this.particleGeometry.addAttribute("customSize",new n.BufferAttribute(new Float32Array(o),1)),this.particleGeometry.addAttribute("customAngle",new n.BufferAttribute(new Float32Array(a),1)),this.particleMaterial.blending=this.blendStyle,this.particleMaterial.depthWrite=!1,this.particleMesh=new n.Points(this.particleGeometry,this.particleMaterial),this.particleMesh.dynamic=!0,this.particleMesh.sortParticles=!0},u.prototype.update=function(e){if(-1===this.lastIndex&&(this.lastIndex=Math.floor(this.particlesPerSecond*(this.emitterAge+0))),this.lastIndex<this.particleCount){var t=Math.floor(this.particlesPerSecond*(this.emitterAge+e));t>this.particleCount&&(t=this.particleCount);for(var r=this.lastIndex;r<t;++r)this.particleArray[r].alive=1;this.lastIndex=t}for(var n=[],i=0;i<this.particleCount;i++)1===this.particleArray[i].alive&&(this.particleArray[i].update(e),this.particleArray[i].age>this.particleDeathAge&&(this.particleArray[i].alive=0,n.push(i)),this.particleGeometry.attributes.position.array[3*i]=this.particleArray[i].position.x,this.particleGeometry.attributes.position.array[3*i+1]=this.particleArray[i].position.y,this.particleGeometry.attributes.position.array[3*i+2]=this.particleArray[i].position.z,this.particleGeometry.attributes.customVisible.array[i]=this.particleArray[i].alive,this.particleGeometry.attributes.customColor.array[3*i]=this.particleArray[i].color.r,this.particleGeometry.attributes.customColor.array[3*i+1]=this.particleArray[i].color.g,this.particleGeometry.attributes.customColor.array[3*i+2]=this.particleArray[i].color.b,this.particleGeometry.attributes.customOpacity.array[i]=this.particleArray[i].opacity,this.particleGeometry.attributes.customSize.array[i]=this.particleArray[i].size,this.particleGeometry.attributes.customAngle.array[i]=this.particleArray[i].angle);if(this.particleGeometry.attributes.position.needsUpdate=!0,this.particleGeometry.attributes.customVisible.needsUpdate=!0,this.particleGeometry.attributes.customColor.needsUpdate=!0,this.particleGeometry.attributes.customOpacity.needsUpdate=!0,this.particleGeometry.attributes.customSize.needsUpdate=!0,this.particleGeometry.attributes.customAngle.needsUpdate=!0,this.emitterAlive){for(var o=0;o<n.length;o++){var a=n[o];this.particleArray[a]=this.createParticle(),this.particleArray[a].alive=1,this.particleArray[a].update(e),this.particleGeometry.attributes.position.array[3*a]=this.particleArray[a].position.x,this.particleGeometry.attributes.position.array[3*a+1]=this.particleArray[a].position.y,this.particleGeometry.attributes.position.array[3*a+2]=this.particleArray[a].position.z,this.particleGeometry.attributes.customVisible.array[a]=this.particleArray[a].alive,this.particleGeometry.attributes.customColor.array[3*a]=this.particleArray[a].color.r,this.particleGeometry.attributes.customColor.array[3*a+1]=this.particleArray[a].color.g,this.particleGeometry.attributes.customColor.array[3*a+2]=this.particleArray[a].color.b,this.particleGeometry.attributes.customOpacity.array[a]=this.particleArray[a].opacity,this.particleGeometry.attributes.customSize.array[a]=this.particleArray[a].size,this.particleGeometry.attributes.customAngle.array[a]=this.particleArray[a].angle}this.particleGeometry.attributes.position.needsUpdate=!0,this.particleGeometry.attributes.customVisible.needsUpdate=!0,this.particleGeometry.attributes.customColor.needsUpdate=!0,this.particleGeometry.attributes.customOpacity.needsUpdate=!0,this.particleGeometry.attributes.customSize.needsUpdate=!0,this.particleGeometry.attributes.customAngle.needsUpdate=!0,this.emitterAge+=e,this.emitterAge>this.emitterDeathAge&&(this.emitterAlive=!1)}},u.prototype.destroy=function(){},t.ParticleEngine=u,t.Tween=a,t.Particle=s,t.Type=l,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"particleVertexShader","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/ParticleEngine/ParticleEngine.js"),__REACT_HOT_LOADER__.register(o,"particleFragmentShader","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/ParticleEngine/ParticleEngine.js"),__REACT_HOT_LOADER__.register(a,"Tween","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/ParticleEngine/ParticleEngine.js"),__REACT_HOT_LOADER__.register(s,"Particle","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/ParticleEngine/ParticleEngine.js"),__REACT_HOT_LOADER__.register(l,"Type","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/ParticleEngine/ParticleEngine.js"),__REACT_HOT_LOADER__.register(u,"ParticleEngine","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/ParticleEngine/ParticleEngine.js"))}()},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function o(e){if(h===clearTimeout)return clearTimeout(e);if((h===n||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function a(){m&&f&&(m=!1,f.length?p=f.concat(p):v=-1,p.length&&s())}function s(){if(!m){var e=i(a);m=!0;for(var t=p.length;t;){for(f=p,p=[];++v<t;)f&&f[v].run();v=-1,t=p.length}f=null,m=!1,o(e)}}function l(e,t){this.fun=e,this.array=t}function u(){}var c,h,d=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(e){c=r}try{h="function"==typeof clearTimeout?clearTimeout:n}catch(e){h=n}}();var f,p=[],m=!1,v=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];p.push(new l(e,t)),1!==p.length||m||i(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=u,d.addListener=u,d.once=u,d.off=u,d.removeListener=u,d.removeAllListeners=u,d.emit=u,d.prependListener=u,d.prependOnceListener=u,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0},u=r(13),c=n(u),h=r(2),d=r(6),f=n(d),p=r(14),m=n(p),v=r(7),g=n(v),y=r(15),b=n(y),_=r(5),w=n(_),x=r(16),M=n(x),E=r(48),A=n(E),T=r(68),k=n(T),S=function(e){function t(e,r){function n(){r.composer?c._import(r.composer):r.metaInfo&&(c._metaInfo=new k.default(r.metaInfo),c._import(JSON.parse(c.metaInfo.scene)))}function a(){n()}if(i(this,t),!function(e,t){return document.getElementById(e)?t&&t.altizureApi&&t.altizureApi.key?(t.altizureApi.region||(t.altizureApi.region="CN"),t.altizureApi.apiUrl||("CN"===t.altizureApi.region?t.altizureApi.apiUrl="https://api.altizure.cn/graphql":t.altizureApi.apiUrl="https://api.altizure.com/graphql"),t.api||(t.api={API_HOST:"CN"===t.altizureApi.region?"U2FsdGVkX19l4+V8uQYRigbhRUbtp+TqhjxwRO/FKTliJ0AFJkFXCzSs+ehN700y":"U2FsdGVkX19sCTAwLFaMCv4S0aVKqN66ldP42OsYYTo1DonEjo6dPTRzKJMx4F1brwBMdZ0YJZO7fZna05NtPw==",API_KEY:"U2FsdGVkX19phGn0b5VCcKo7Vu7x1XAz2BKyuIasob2KrQD1CLAC9Ls72FjPeP+/NBhDGn19Gsh13EumIGZ95w=="}),!0):(console.error("Altizure sdk key is not found."),!1):(console.error("div "+e+" is missing."),!1)}(e,r)){var s;return s=void 0,o(u,s)}var l=function(e){return e.eventHandlers&&e.eventHandlers.onContentInitialized?e.eventHandlers.onContentInitialized=function(){e.eventHandlers.onContentInitialized(),a()}:(e.eventHandlers||(e.eventHandlers={}),e.eventHandlers.onContentInitialized||(e.eventHandlers.onContentInitialized=function(){a()})),e}(r),u=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l)),c=u;return u.HOST=r.HOST,u._apiService=new h.AltizureApi({apiUrl:r.altizureApi.apiUrl,key:r.altizureApi.key,altitoken:r.altizureApi.altitoken}),u._mouseInteraction=null,u._updateGPUPicker=null,u._metaInfo=null,u._bonCameraChange=u._onCameraChange.bind(u),function(){!function(){c._mouseInteraction=new A.default({camera:c.viewerCamera,domElement:c.domElement,scene:c.markerLayer.sceneNode,renderer:c.renderer});var e={promiseFn:function(e){var t=e.force;return c.interaction.gpuPicker.update(t),Promise.resolve()},timer:500,timeout:2e3,debug:!1};c._updateGPUPicker=new h.RefreshQueue(e),c.on("cameraChange",c._bonCameraChange)}(),c.earthView.animate=c.animate.bind(c)}(),u}return a(t,e),s(t,[{key:"destruct",value:function(){this.apiService.destruct(),this.off("cameraChange",this._bonCameraChange),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destruct",this).call(this)}},{key:"add",value:function(e,t){function r(e){return i.apiService.project({pid:e.pid}).then(function(t){return n(t,e)}).catch(function(e){return console.warn("[Solution.add] AltizureProjectMarker failed",e),Promise.reject(e)})}function n(e,t){if(!e)return Promise.reject(new Error("Invalid info."));e.views=1e3;var r=t.pose&&t.pose.position?t.pose.position:{lng:e.geoInfo.centerLong,lat:e.geoInfo.centerLat,alt:.01},n=t.pose&&t.pose.orientation?t.pose.orientation:void 0,o={position:r,earth:i,projInfo:e,materialDescriptions:t.materialDescriptions,patrolRoutes:t.patrolRoutes,orientation:n,HOST:i.HOST,eventHandlers:t.eventHandlers},a=new f.default(o);return Promise.resolve(a)}var i=this;if("AltizureProjectMarker"===e)return function(e){return r(e)}(t);if("OBJMarker"===e)return function(e){var t={position:e.pose.position,earth:i,name:e.name,shape:e.shape,objUrl:e.objUrl,mtlUrl:e.mtlUrl,upDir:e.upDir,scale:e.scale,materialDescriptions:e.materialDescriptions,patrolRoutes:e.patrolRoutes,orientation:e.pose.orientation,eventHandlers:e.eventHandlers},r=new m.default(t);return Promise.resolve(r)}(t);if("PublicAltizureProjectMarker"===e)return r(t);if("TagMarker"===e)return function(e){var t={position:e.pose.position,earth:i,name:e.name,imgUrl:e.imgUrl,scale:e.scale,materialDescriptions:e.materialDescriptions,patrolRoutes:e.patrolRoutes,orientation:e.pose.orientation,eventHandlers:e.eventHandlers},r=new g.default(t);return Promise.resolve(r)}(t);if("PolyLineMarker"===e)return function(e){var t={earth:i,name:e.name,points:e.points,lineWidth:e.lineWidth,color:e.color,visible:e.visible,pointVisible:e.pointVisible,materialDescriptions:e.materialDescriptions,patrolRoutes:e.patrolRoutes,orientation:e.pose.orientation,eventHandlers:e.eventHandlers},r=new b.default(t);return Promise.resolve(r)}(t);if("PolygonMarker"===e)return function(e){for(var t=e.volume,r=0;r<t.points.length;++r)t.points[r]=new w.default(t.points[r].lng,t.points[r].lat,t.points[r].alt);var n={volume:t,earth:i,name:e.name,materialDescriptions:e.materialDescriptions,patrolRoutes:e.patrolRoutes,orientation:e.pose.orientation,eventHandlers:e.eventHandlers},o=new M.default(n);return Promise.resolve(o)}(t);if("AltizureProjectInfo"===e)return function(e){return n(e.info,e.data)}(t);var o="[Solution.add] unknown type "+e;return console.warn(o),Promise.reject(new Error(o))}},{key:"exportToServer",value:function(e){return console.log("exportToServer",e),this.save(e)}},{key:"importFromServer",value:function(e){return console.log("importFromServer",e),this.load(e)}},{key:"_import",value:function(e){function t(e){var r=e.property.type;if("AltizureProjectMarker"===r?n.push({pid:e.property.id,pose:e.property.pose,patrolRoutes:e.property.patrolRoutes,materialDescriptions:e.property.materialDescriptions,eventHandlers:e.property.eventHandlers}):"OBJMarker"===r?i.push({objUrl:e.property.objUrl,mtlUrl:e.property.mtlUrl,pose:e.property.pose,shape:e.property.shape,name:e.property.name,upDir:e.property.upDir,scale:e.property.scale,patrolRoutes:e.property.patrolRoutes,materialDescriptions:e.property.materialDescriptions,eventHandlers:e.property.eventHandlers}):"TagMarker"===r?o.push({pose:e.property.pose,name:e.property.name,scale:e.property.scale,imgUrl:e.property.imgUrl,patrolRoutes:e.property.patrolRoutes,materialDescriptions:e.property.materialDescriptions,eventHandlers:e.property.eventHandlers}):"PolyLineMarker"===r?a.push({points:e.property.points,pose:e.property.pose,name:e.property.name,imgUrl:e.property.imgUrl,lineWidth:e.property.lineWidth,color:e.property.color,visible:e.property.visible,pointVisible:e.property.pointVisible,patrolRoutes:e.property.patrolRoutes,materialDescriptions:e.property.materialDescriptions,eventHandlers:e.property.eventHandlers}):"PolygonMarker"===r?s.push({volume:e.property.volume,name:e.property.name,patrolRoutes:e.property.patrolRoutes,materialDescriptions:e.property.materialDescriptions,pose:e.property.pose,eventHandlers:e.property.eventHandlers}):l.push(e.property),e.children&&e.children instanceof Array)for(var u=0;u<e.children.length;u++)t(e.children[u])}var r=this,n=[],i=[],o=[],a=[],s=[],l=[],u=this,c=!1,h=function(e){c?console.log("Initialized",e):(c=!0,console.log("first",e),u.camera.lookAt(e,0,45))};t(e);for(var d=[],f=0;f<n.length;f++)!function(e){var t=r.add("AltizureProjectMarker",n[e]).then(function(e){h(e)}).catch(function(t){return console.warn(n[e],t),Promise.resolve()});d.push(t)}(f);for(var f=0;f<i.length;f++)!function(e){var t=r.add("OBJMarker",i[e]).then(function(e){h(e)}).catch(function(t){return console.warn(i[e],t),Promise.resolve()});d.push(t)}(f);for(var f=0;f<o.length;++f)!function(e){var t=r.add("TagMarker",o[e]).then(function(e){h(e)}).catch(function(t){return console.warn(o[e],t),Promise.resolve()});d.push(t)}(f);for(var f=0;f<a.length;++f)!function(e){var t=r.add("PolyLineMarker",a[e]).then(function(e){h(e)}).catch(function(t){return console.warn(a[e],t),Promise.resolve()});d.push(t)}(f);for(var f=0;f<s.length;++f)!function(e){var t=r.add("PolygonMarker",s[e]).then(function(e){h(e)}).catch(function(t){return console.warn(s[e],t),Promise.resolve()});d.push(t)}(f);return Promise.all(d)}},{key:"animate",value:function(){}},{key:"on",value:function(e,t){switch(e){case"cameraChange":this.earthView.control.addEventListener("change",t);break;default:console.log("unknown eventType "+e)}}},{key:"off",value:function(e,t){switch(e){case"cameraChange":this.earthView.control.removeEventListener("change",t);break;default:console.log("unknown eventType "+e)}}},{key:"login",value:function(e){if(!function(){return!!e&&!!e.altitoken&&void 0}())return console.error("Invalid login info",e),!1;this._apiService.key=e.kep,this._apiService.altitoken=e.altitoken}},{key:"dbCreate",value:function(e){void 0===e&&(e=(new Date).toString());var t=this;return this.apiService.createProjectSolution({name:e}).then(function(e){return t._metaInfo=new k.default(e),Promise.resolve(t.metaInfo)})}},{key:"dbUpdate",value:function(){var e=this;return this.apiService.updateProjectSolution({id:this.metaInfo.id,options:{data:{name:this.metaInfo.name,scene:JSON.stringify(this.JSON)},preserveScene:!0}}).then(function(t){return e.metaInfo.update(t),Promise.resolve(e.metaInfo)})}},{key:"dbRemove",value:function(){var e=this;return this.apiService.removeProjectSolution({id:this.metaInfo.id}).then(function(t){e._metaInfo=null})}},{key:"dbRead",value:function(e){return this.apiService.solution({sid:e})}},{key:"save",value:function(e){console.log("save",this.metaInfo);var t=this;return this.metaInfo?(console.log("dbUpdate"),this.dbUpdate().then(function(e){return console.log(e),e})):(console.log("dbCreate"),this.dbCreate(e).then(function(e){return console.log(e),t.save()}))}},{key:"load",value:function(e){var t=this;return this.dbRead(e).then(function(e){return console.log("res",e),t._metaInfo=new k.default(e),console.log("scene",t.metaInfo),t._import(JSON.parse(t.metaInfo.scene))})}},{key:"_onCameraChange",value:function(){this._updateGPUPicker.add({force:!0})}},{key:"metaInfo",get:function(){return this._metaInfo}},{key:"apiService",get:function(){return this._apiService}},{key:"camera",get:function(){var e=this,t=e.earthView.control;return{get pose(){return t.cameraPose()},set pose(e){return t.setCameraPose(e)},set range(e){var r=e.tilt,n=e.alt;return void 0!==r&&t.tiltRange(r),void 0!==n&&t.altRange(n),!0},flyTo:function(e,r){return t.flyToPose(e,r)},stop:function(){return t.stopFlying()},lookAt:function(e,r,n){var i=e.position;return t.flyToPose({lng:i.lng,lat:i.lat,alt:i.alt+1e3,north:r,tilt:n})}}}},{key:"JSON",get:function(){return this.markerLayer.JSON}},{key:"interaction",get:function(){return this._mouseInteraction}},{key:"Math",get:function(){return h.EarthMath}}]),t}(c.default),C=S;t.default=C,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(S,"Solution","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/earth/Solution.js"),__REACT_HOT_LOADER__.register(C,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/earth/Solution.js"))}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=n.EarthBasic.GeoCoord,o=i;t.default=o,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"GeoCoord","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/geo/GeoCoord.js"),__REACT_HOT_LOADER__.register(o,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/geo/GeoCoord.js"))}()},function(e,t,r){"use strict";function n(e,t){for(var r=[],n=function(e){var t=[];if("Feature"===e.type){var r=void 0;r=Object.keys(e.properties.tags).indexOf("height")>-1?parseFloat(e.properties.tags.height):20,t.push({geometry:e.geometry,height:r})}else if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++){var i=void 0;i=Object.keys(e.features[n].properties.tags).indexOf("height")>-1?parseFloat(e.features[n].properties.tags.height):20,t.push({geometry:e.features[n].geometry,height:i})}else{if("GeometryCollection"!==e.type)throw new Error("The geoJSON is not valid.");for(var o=0;o<e.geometries.length;o++)t.push({geometry:e.geometries[o],height:20})}return t}(e),i=0;i<n.length;i++)if("Polygon"===n[i].geometry.type)for(var o=0;o<n[i].geometry.coordinates.length;o++){for(var a=n[i].geometry.coordinates[o],s=n[i].height,l=[],u=0;u<a.length;u++)l.push(new altizure.LngLatAlt(a[u][0],a[u][1],10));var c={points:l,height:s,color:15827200,opacity:.2};r.push(c)}else if("MultiPolygon"===n[i].geometry.type)for(var h=0;h<n[i].geometry.coordinates.length;h++)for(var d=0;d<n[i].geometry.coordinates[h].length;d++){for(var f=n[i].geometry.coordinates[h][d],p=n[i].height,m=[],v=0;v<f.length;v++)m.push(new altizure.LngLatAlt(f[v][0],f[v][1],10));var g={points:m,height:p,color:15827200,opacity:.2};r.push(g)}return r}Object.defineProperty(t,"__esModule",{value:!0}),t.drawGeoJson=n,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(n,"drawGeoJson","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/loader/addGeoOBJ.js")}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0},u=r(3),c=n(u),h=r(22),d=r(53),f=r(0),p=r(4),m=n(p),v=function(e){function t(e){i(this,t);var r=new d.Examples;if(!function(t){return!!(t&&t.position&&t.earth&&t.effect&&r.exist(t.effect))||(console.warn("[ParticleEffectsMarker] invalid init input",e,r.exist(t.effect)),!1)}(e)){var n;return n=void 0,o(a,n)}var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a._property.type="ParticleEffectsMarker",a._property.scale=e.scale,a._property.effect=e.effect,a._particleNumScale=e.scale?e.scale:1,a.examples=r,a.engine=null,a.effect=e.effect,a.setEffect(a.effect),a}return a(t,e),s(t,[{key:"setEffect",value:function(e){var t=this,r=this.examples.getEffect(e);if(r){r.particlesPerSecond=r.particlesPerSecond*this._particleNumScale;var n=r.particleTexturePath,i=new f.TextureLoader;i.setCrossOrigin(""),i.withCredentials=!0,i.load(n,function(n){r.particleTexture=n;var i=new f.Group;t.engine=null,t.engine=new h.ParticleEngine,t.engine.setValues(r),t.engine.initialize(),i.add(t.engine.particleMesh);var o=m.default.scale/5e5*.2;i.scale.multiplyScalar(o),t.unsetContent(),t.setContent(i),t.effectAnimating=!0,t._property.effect=e},function(e){},function(e){console.warn("[ParticleEffectsMarker] an error happened while loading "+n)})}}},{key:"animate",value:function(e){if(l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"animate",this).call(this,e),!0===this.effectAnimating){if(this.effectLastTime){var r=e.currentTime-this.effectLastTime;this.engine&&this.engine.update(r)}this.effectLastTime=e.currentTime}}},{key:"destruct",value:function(){if(this.interactable&&(this.interactable=!1),this.unsetContent(),this.engine){var e=this.engine.particleMesh;e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose(),this.engine=null}this.examples&&this.examples.destruct(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destruct",this).call(this)}}]),t}(c.default),g=v;t.default=g,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(v,"ParticleEffectsMarker","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/ParticleEffectsMarker.js"),__REACT_HOT_LOADER__.register(g,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/ParticleEffectsMarker.js"))}()},function(e,t,r){"use strict";function n(e){var t=new a(e),r=o(a.prototype.request,t);return i.extend(r,a.prototype,t),i.extend(r,t),r}var i=r(1),o=r(21),a=r(30),s=r(9),l=n(s);l.Axios=a,l.create=function(e){return n(i.merge(s,e))},l.Cancel=r(18),l.CancelToken=r(29),l.isCancel=r(19),l.all=function(e){return Promise.all(e)},l.spread=r(44),e.exports=l,e.exports.default=l},function(e,t,r){"use strict";function n(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var r=this;e(function(e){r.reason||(r.reason=new i(e),t(r.reason))})}var i=r(18);n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var e;return{token:new n(function(t){e=t}),cancel:e}},e.exports=n},function(e,t,r){"use strict";function n(e){this.defaults=e,this.interceptors={request:new a,response:new a}}var i=r(9),o=r(1),a=r(31),s=r(32),l=r(40),u=r(38);n.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),e=o.merge(i,this.defaults,{method:"get"},e),e.method=e.method.toLowerCase(),e.baseURL&&!l(e.url)&&(e.url=u(e.baseURL,e.url));var t=[s,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)r=r.then(t.shift(),t.shift());return r},o.forEach(["delete","get","head","options"],function(e){n.prototype[e]=function(t,r){return this.request(o.merge(r||{},{method:e,url:t}))}}),o.forEach(["post","put","patch"],function(e){n.prototype[e]=function(t,r,n){return this.request(o.merge(n||{},{method:e,url:t,data:r}))}}),e.exports=n},function(e,t,r){"use strict";function n(){this.handlers=[]}var i=r(1);n.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},n.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},n.prototype.forEach=function(e){i.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=n},function(e,t,r){"use strict";function n(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var i=r(1),o=r(35),a=r(19),s=r(9);e.exports=function(e){return n(e),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),i.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||s.adapter)(e).then(function(t){return n(e),t.data=o(t.data,t.headers,e.transformResponse),t},function(t){return a(t)||(n(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,r){"use strict";e.exports=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e}},function(e,t,r){"use strict";var n=r(20);e.exports=function(e,t,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},function(e,t,r){"use strict";var n=r(1);e.exports=function(e,t,r){return n.forEach(r,function(r){e=r(e,t)}),e}},function(e,t,r){"use strict";function n(){this.message="String contains an invalid character"}function i(e){for(var t,r,i=String(e),a="",s=0,l=o;i.charAt(0|s)||(l="=",s%1);a+=l.charAt(63&t>>8-s%1*8)){if((r=i.charCodeAt(s+=.75))>255)throw new n;t=t<<8|r}return a}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.code=5,n.prototype.name="InvalidCharacterError",e.exports=i},function(e,t,r){"use strict";function n(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var i=r(1);e.exports=function(e,t,r){if(!t)return e;var o;if(r)o=r(t);else if(i.isURLSearchParams(t))o=t.toString();else{var a=[];i.forEach(t,function(e,t){null!==e&&void 0!==e&&(i.isArray(e)&&(t+="[]"),i.isArray(e)||(e=[e]),i.forEach(e,function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),a.push(n(t)+"="+n(e))}))}),o=a.join("&")}return o&&(e+=(-1===e.indexOf("?")?"?":"&")+o),e}},function(e,t,r){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,r){"use strict";var n=r(1);e.exports=n.isStandardBrowserEnv()?function(){return{write:function(e,t,r,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(i)&&s.push("path="+i),n.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(e,t,r){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,r){"use strict";var n=r(1);e.exports=n.isStandardBrowserEnv()?function(){function e(e){var t=e;return r&&(i.setAttribute("href",t),t=i.href),i.setAttribute("href",t),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}var t,r=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");return t=e(window.location.href),function(r){var i=n.isString(r)?e(r):r;return i.protocol===t.protocol&&i.host===t.host}}():function(){return function(){return!0}}()},function(e,t,r){"use strict";var n=r(1);e.exports=function(e,t){n.forEach(e,function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])})}},function(e,t,r){"use strict";var n=r(1);e.exports=function(e){var t,r,i,o={};return e?(n.forEach(e.split("\n"),function(e){i=e.indexOf(":"),t=n.trim(e.substr(0,i)).toLowerCase(),r=n.trim(e.substr(i+1)),t&&(o[t]=o[t]?o[t]+", "+r:r)}),o):o}},function(e,t,r){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Color=t.Quaternion=t.OrthographicCamera=t.RGBAFormat=t.NearestFilter=t.WebGLRenderTarget=t.Sandbox=t.Sdk=t.Solution=t.drawGeoJson=t.AltizureProjectMarker=t.ParticleEffectsMarker=t.PolyLineMarker=t.PolygonMarker=t.TagMarker=t.OBJMarker=t.GeoCoord=t.LngLatAlt=t.Marker=t.Earth=void 0;var i=r(13),o=n(i),a=r(5),s=n(a),l=r(3),u=n(l),c=r(25),h=n(c),d=r(14),f=n(d),p=r(7),m=n(p),v=r(16),g=n(v),y=r(15),b=n(y),_=r(27),w=n(_),x=r(26),M=r(24),E=n(M),A=r(6),T=n(A),k=r(0),S=E.default,C=E.default;t.Earth=o.default,t.Marker=u.default,t.LngLatAlt=s.default,t.GeoCoord=h.default,t.OBJMarker=f.default,t.TagMarker=m.default,t.PolygonMarker=g.default,t.PolyLineMarker=b.default,t.ParticleEffectsMarker=w.default,t.AltizureProjectMarker=T.default,t.drawGeoJson=x.drawGeoJson,t.Solution=E.default,t.Sdk=S,t.Sandbox=C,t.WebGLRenderTarget=k.WebGLRenderTarget,t.NearestFilter=k.NearestFilter,t.RGBAFormat=k.RGBAFormat,t.OrthographicCamera=k.OrthographicCamera,t.Quaternion=k.Quaternion,t.Color=k.Color,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(S,"Sdk","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/Altizure.js"),__REACT_HOT_LOADER__.register(C,"Sandbox","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/Altizure.js"))}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=n.EarthBasic.HyperClasses.PMatrix,o=i;t.default=o,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"PMatrix","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/earth/PMatrix.js"),__REACT_HOT_LOADER__.register(o,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/earth/PMatrix.js"))}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=function(){function e(t){function r(){i.resizeTexture(window.innerWidth,window.innerHeight)}n(this,e),void 0!==t.scene&&void 0!==t.domElement||console.error("[GPUPicker] no scene/domElement provided",t),this.pickingScene=t.scene,this.pickingTexture=new o.WebGLRenderTarget,this.pickingTexture.texture.minFilter=o.LinearFilter,this.pickingTexture.texture.generateMipmaps=!1,this.domElement=t.domElement,this.debug=void 0!==t.debug&&t.debug,this.needUpdate=!0,t.renderer?this.setRenderer(t.renderer):console.warn("missing renderer"),t.camera?this.setCamera(t.camera):console.warn("missing camera"),this.mapping={},this.inverseMapping=[],this.visibilityMapping={},this.baseID=1;var i=this;window.addEventListener("resize",r,!1)}return i(e,[{key:"destruct",value:function(){this.pickingTexture.texture&&this.pickingTexture.texture.dispose(),this.pickingTexture&&this.pickingTexture.dispose()}},{key:"setRenderer",value:function(e){this.renderer=e;var t=e.getSize();this.resizeTexture(t.width,t.height),this.needUpdate=!0}},{key:"resizeTexture",value:function(e,t){this.pickingTexture.setSize(e,t),this.pixelBuffer=new Uint8Array(4*e*t),this.needUpdate=!0}},{key:"setCamera",value:function(e){this.camera=e,this.needUpdate=!0}},{key:"update",value:function(e){(e||this.needUpdate)&&(this.changeVisibility(),this.renderer.render(this.pickingScene,this.camera,this.pickingTexture),this.renderer.readRenderTargetPixels(this.pickingTexture,0,0,this.pickingTexture.width,this.pickingTexture.height,this.pixelBuffer),this.restoreVisibility(),this.needUpdate=!1,this.debug&&console.log("[GPUPicker] rendering updated"))}},{key:"changeVisibility",value:function(){var e=this;this.pickingScene.traverse(function(t){e.visibilityMapping[t.uuid]=t.visible,t.visible=!1});for(var t in this.mapping){var r=this.mapping[t];if(!0===r.added){r.pickingMesh.visible=!0;for(var n=r.pickingMesh.parent;n&&n.uuid!==this.pickingScene.uuid;)n.visible=!0,n=n.parent}}this.pickingScene.visible=!0}},{key:"restoreVisibility",value:function(){var e=this;this.pickingScene.traverse(function(t){t.visible=e.visibilityMapping[t.uuid]})}},{key:"addInteractableObject",value:function(t,r){if(this.debug&&console.log("[GPUPicker] add interactable object",t),t instanceof o.Mesh||t instanceof o.Sprite){var n=void 0,i=this.mapping[t.uuid];if(i)i.added=!0;else{i=this.mapping[t.uuid]={},n=i.colorID=this.baseID++;var a=new o.Color,s=t;if(t instanceof o.Sprite){a.setHex(n);var l=[255*a.r,255*a.g,255*a.b,255],u=new o.DataTexture(Uint8Array.from(l),1,1,o.RGBAFormat,o.UnsignedByteType,o.UVMapping);u.minFilter=u.magFilter=o.LinearFilter,u.needsUpdate=!0;var c=new o.SpriteMaterial({map:u,color:16777215,depthTest:!1});s.material=c,this.debug&&console.log("[gpupicker] material map",c,u)}else s.material=e.pickingMaterial.clone(),s.material.uniforms.color.value=a.setHex(n);i.pickingMesh=s,i.added=!0,this.inverseMapping.push(r)}this.needUpdate=!0}else console.error("[GPUPicker] object is not a Mesh",t)}},{key:"removeInteractableObject",value:function(e){if(this.debug&&console.log("[GPUPicker] remove interactable object",e),e instanceof o.Mesh||e instanceof o.Sprite){var t=this.mapping[e.uuid];t?(t.added=!1,this.needUpdate=!0,this.debug&&console.log("[GPUPicker] object removed from picking scene")):console.warn("[GPUPicker] object has not been added to the picker",e)}else console.error("[GPUPicker] object is not a Mesh",e)}},{key:"pick",value:function(e){this.update();var t=4*(e.x+(this.pickingTexture.height-e.y)*this.pickingTexture.width),r=255*this.pixelBuffer[t]*255|255*this.pixelBuffer[t+1]|this.pixelBuffer[t+2],n=this.inverseMapping[r-1];if(this.debug&&855309!==r&&console.log("[GPUPicker] pick id:",r,n),n)return n}}]),e}();a.pickingMaterial=new o.ShaderMaterial({uniforms:{color:{value:new o.Color}},vertexShader:"\n  void main(){\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }\n  ",fragmentShader:"\n  uniform vec3 color;\n  void main(){\n    gl_FragColor = vec4(color, 1.0);\n  }\n  "});var s=a;t.default=s,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(a,"GPUPicker","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/interact/GPUPicker.js"),__REACT_HOT_LOADER__.register(s,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/interact/GPUPicker.js"))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(66),s=n(a),l=r(47),u=n(l),c=function(){function e(t){function r(e){l(e,"mousedown")}function n(e){l(e,"mouseup")}function o(e){l(e,"mousemove")}function a(e){e.clientX=e.touches[0].pageX,e.clientY=e.touches[0].pageY,l(e,"mousedown")}function s(e){e.clientX=e.changedTouches[0].pageX,e.clientY=e.changedTouches[0].pageY,l(e,"mouseup")}function l(e,t){var r=e.clientX-c.mouseOffset.left,n=e.clientY-c.mouseOffset.top,i={x:r,y:n},o=c.gpuPicker.pick(i);if(o)if("mousemove"===t){if(c.hoveredMarkerID)if(c.hoveredMarkerID===o.ID){var a=c.listening.mouseover[c.hoveredMarkerID],s=a?a.handler:void 0;s&&s(e)}else{var l=c.listening.mouseleave[c.hoveredMarkerID],u=l?l.handler:void 0;u&&u(e),l=c.listening.mouseenter[o.ID],(u=l?l.handler:void 0)&&u(e)}else{var h=c.listening.mouseenter[o.ID],d=h?h.handler:void 0;d&&d(e)}c.hoveredMarkerID=o.ID}else{var f=c.listening[t][o.ID],p=f?f.handler:void 0;p&&p(e)}else{if(c.hoveredMarkerID){var m=c.listening.mouseleave[c.hoveredMarkerID],v=m?m.handler:void 0;v&&v(e)}c.hoveredMarkerID=void 0}}if(i(this,e),!function(){var e=!0,r={capacity:100};try{t=Object.assign({},r,t)}catch(t){console.error("MouseInteraction",t),e=!1}return e=e&&t.camera&&t.domElement&&t.scene&&t.renderer}())return void console.error("MouseInteraction invalid options.",t);this.capacity=t.capacity,this.camera=t.camera,this.listening=function(){for(var t={},r=e.MouseEventList,n=0;n<r.length;n++)t[r[n]]={};return t}(),this.domElement=t.domElement;var c=this;this.mouseOffset=function(){var e=c.domElement.getBoundingClientRect();return{left:e.left,top:e.top}}(),this.domElement.addEventListener("mousedown",r),this.domElement.addEventListener("mouseup",n),this.domElement.addEventListener("mousemove",o),this.domElement.addEventListener("touchstart",a),this.domElement.addEventListener("touchend",s),this.removeListeners=function(){c.domElement.removeEventListener("mousedown",r),c.domElement.removeEventListener("mouseup",n),c.domElement.removeEventListener("mousemove",o),c.domElement.removeEventListener("touchstart",a),c.domElement.removeEventListener("touchend",s)},this.gpuPicker=new u.default({scene:t.scene,renderer:t.renderer,debug:!1,camera:t.camera,domElement:t.domElement}),this.hoveredMarkerID=void 0}return o(e,[{key:"destruct",value:function(){this.removeListeners(),this.gpuPicker.destruct()}},{key:"register",value:function(e,t,r){return this._checkResponsibility(t)?void 0!==this.listening[t][e.ID]?(console.warn("[MouseInteraction.register] "+t+" is already registered for "+e.name+". Each event can only have one handler."),!1):(this.gpuPicker.addInteractableObject(e.interactShape,e),this.listening[t][e.ID]={handler:r},!0):(console.warn(t+" is not MouseInteraction responsibility."),!1)}},{key:"unregister",value:function(e,t){return this._checkResponsibility(t)?void 0!==this.listening[t][e.ID]?(this.gpuPicker.removeInteractableObject(e.interactShape),delete this.listening[t][e.ID]):(console.warn("[MouseInteraction.unregister] "+t+" was not registered for "+e.name),!1):(console.warn(t+" is not MouseInteraction responsibility."),!1)}},{key:"_checkResponsibility",value:function(t){var r=e.MouseEventList;return s.default.include(r,t)}}],[{key:"MouseEventList",get:function(){return["mousedown","mouseup","mouseover","mouseleave","mouseenter","mousewheel"]}}]),e}(),h=c;t.default=h,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(c,"MouseInteraction","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/interact/MouseInteraction.js"),__REACT_HOT_LOADER__.register(h,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/interact/MouseInteraction.js"))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=r(11),a=n(o),s=r(8),l=n(s),u=function(e){this.manager=void 0!==e?e:i.DefaultLoadingManager};u.prototype={constructor:u,load:function(e,t,r,n){var i=this;(0,l.default)({method:"get",url:e}).then(function(e){t(i.parse(e.data))}).catch(function(e){t(i.parse(""))})},setBaseUrl:function(e){this.baseUrl=e},setCrossOrigin:function(e){this.crossOrigin=e},setMaterialOptions:function(e){this.materialOptions=e},parse:function(e){for(var t=e.split("\n"),r={},n=/\s+/,i={},o=0;o<t.length;o++){var a=t[o];if(a=a.trim(),0!==a.length&&"#"!==a.charAt(0)){var s=a.indexOf(" "),l=s>=0?a.substring(0,s):a;l=l.toLowerCase();var c=s>=0?a.substring(s+1):"";if(c=c.trim(),"newmtl"===l)r={name:c},i[c]=r;else if(r)if("ka"===l||"kd"===l||"ks"===l){var h=c.split(n,3);r[l]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else r[l]=c}}var d=new u.MaterialCreator(this.baseUrl,this.materialOptions);return d.setCrossOrigin(this.crossOrigin),d.setManager(this.manager),d.setMaterials(i),d}},u.MaterialCreator=function(e,t){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:i.DoubleSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:i.RepeatWrapping},u.MaterialCreator.prototype={constructor:u.MaterialCreator,setCrossOrigin:function(e){this.crossOrigin=e},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var r in e){var n=e[r],i={};t[r]=i;for(var o in n){var a=!0,s=n[o],l=o.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[1]&&(a=!1);break;case"d":this.options&&this.options.invertTransparency&&(s=1-s)}a&&(i[l]=s)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var t=this.materialsInfo[e],r={name:e,side:this.side},n={name:e,side:this.side};for(var o in t){var s=t[o];switch(o.toLowerCase()){case"kd":r.color=(new i.Color).fromArray(s),n.kd=s.slice(0,3);break;case"ka":n.ka=s.slice(0,3);break;case"ks":r.specular=(new i.Color).fromArray(s),n.ks=s.slice(0,3);break;case"map_kd":r.map=this.loadTexture(this.baseUrl+s),r.map.wrapS=this.wrap,r.map.wrapT=this.wrap,n.map_kd=this.baseUrl+s;break;case"ns":r.shininess=parseFloat(s),n.ns=parseFloat(s);break;case"d":s<1&&(r.transparent=!0,r.opacity=s,n.d=s);break;case"map_bump":case"bump":if(r.bumpMap)break;void 0!==s&&""!==s&&(r.bumpMap=this.loadTexture(this.baseUrl+s),r.bumpMap.wrapS=this.wrap,r.bumpMap.wrapT=this.wrap,n.bump=this.baseUrl+s)}}return this.materials[e]=new a.default(n),this.materials[e]},loadTexture:function(e,t,r,n,o){var a,s=i.Loader.Handlers.get(e),l=void 0!==this.manager?this.manager:i.DefaultLoadingManager;return null!==s?a=s.load(e,r):(a=new i.Texture,s=new i.ImageLoader(l),s.setCrossOrigin(this.crossOrigin),s.load(e,function(e){a.image=u.ensurePowerOfTwo_(e),a.needsUpdate=!0,r&&r(a)},n,o)),void 0!==t&&(a.mapping=t),a}},u.ensurePowerOfTwo_=function(e){if(!i.Math.isPowerOfTwo(e.width)||!i.Math.isPowerOfTwo(e.height)){var t=document.createElement("canvas");return t.width=u.nextHighestPowerOfTwo_(e.width),t.height=u.nextHighestPowerOfTwo_(e.height),t.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),t}return e},u.nextHighestPowerOfTwo_=function(e){--e;for(var t=1;t<32;t<<=1)e|=e>>t;return e+1};var c=u;t.default=c,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(u,"MTLLoader","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/loader/MTLLoader.js"),__REACT_HOT_LOADER__.register(c,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/loader/MTLLoader.js"))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=new o.BufferGeometry;return t.addAttribute("position",new o.BufferAttribute(e.geometry.position,e.geometry.positionItemSize)),e.geometry.uv.length>0&&t.addAttribute("uv",new o.BufferAttribute(e.geometry.uv,e.geometry.uvItemSize)),e.geometry.normal.length>0&&t.addAttribute("normal",new o.BufferAttribute(e.geometry.normal,e.geometry.normalItemSize)),t}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(49),s=n(a),l=r(11),u=n(l),c=r(8),h=n(c),d=function(e){this.manager=void 0!==e?e:o.DefaultLoadingManager,this.pendingMesh=[]};d.prototype={constructor:d,load:function(e,t,n,a,l){var c=this,d=new s.default(this.manager);d.setBaseUrl(t.substr(0,t.lastIndexOf("/")+1)),d.setCrossOrigin(this.crossOrigin),d.load(t,function(t){var a=t;a.preload(),(0,h.default)({method:"get",url:e}).then(function(e){var t=r(71),s=0,l=new t;l.onmessage=function(e){if(e.data.isFinish){var t=new o.Group;c.pendingMesh.map(function(e){t.add(e)}),n(t),c.pendingMesh=[],l.terminate()}else{var r=e.data.mesh,h=i(r),d=r.meshName,f=r.materialName,p="material"+s;s+=1,f=f||p;var m=a.create(f);m=m||new u.default({name:f}),m.name=f;var v=new o.Mesh(h,m);d&&(v.name=d);var g={name:f,ka:m.uniforms.ka.value,kd:m.uniforms.kd.value,ks:m.uniforms.ks.value,map_kd:m.uniforms.mapKdPath.value,ns:m.uniforms.ns.value,bump:m.uniforms.bumpMapPath.value,d:m.uniforms.d.value};v.mtlParams=g,c.pendingMesh.push(v)}},l.onerror=function(e){console.warn("Worker runtime error",e.message)};var h={data:e.data};l.postMessage(h)}).catch(function(e){console.error("OBJMTLLoader",e),n()})},a,l)},setCrossOrigin:function(e){this.crossOrigin=e}};var f=d;t.default=f,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(d,"OBJMTLLoader","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/loader/OBJMTLLoader.js"),__REACT_HOT_LOADER__.register(i,"parseGeometryObjectData","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/loader/OBJMTLLoader.js"),__REACT_HOT_LOADER__.register(f,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/loader/OBJMTLLoader.js"))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){if(!function(){if("string"!=typeof e.objUrl||e.objUrl.length<=0)return t&&console.warn("[addMTLOBJ] Invalid obj url",e.objUrl),!1;var r={mtlUrl:"",upDir:new o.Vector3(0,0,1),center:!0,scale:1};try{e=Object.assign({},r,e)}catch(r){return t&&console.warn("[addMTLOBJ] read loadOptions failed",e),!1}return void 0===e.upDir||void 0===e.upDir.x||void 0===e.upDir.y||void 0===e.upDir.z?e.upDir=new o.Vector3(0,0,1):e.upDir.normalize(),!0}())return Promise.reject(new Error("Invalid loadOptions"));var t=!1;return new Promise(function(r,n){var i=function(e){if(t&&console.log(e),e.lengthComputable){var r=e.loaded/e.total*100;t&&console.log(Math.round(r,2)+"% downloaded")}},a=new u.default;a.setCrossOrigin("anonymous");var l=e.mtlUrl;a.load(e.objUrl,l,function(t){void 0!==t&&null!==t||n(new Error("empty"));for(var i=new o.Group,a=0;a<t.children.length;a++){var l=t.children[a];(l.geometry.attributes.position?l.geometry.attributes.position.count:0)>0?(i.add(l),a--):(l.geometry.dispose(),l.material.map&&l.material.map.dispose(),l.material.dispose())}t=i;var u=new o.Matrix4,c=new o.BoxHelper(t,16776960);c.geometry.computeBoundingBox();var h=new o.BoxGeometry(c.geometry.boundingBox.max.x-c.geometry.boundingBox.min.x,c.geometry.boundingBox.max.y-c.geometry.boundingBox.min.y,c.geometry.boundingBox.max.z-c.geometry.boundingBox.min.z),d=c.geometry.boundingBox.getCenter();u.makeTranslation(d.x,d.y,d.z),h.applyMatrix(u);var f=new o.MeshBasicMaterial({color:16776960,wireframe:!0}),p=new o.Mesh(h,f),m=new o.Group;m.add(t),e.center&&(u.makeTranslation(-d.x,-d.y,-d.z),m.applyMatrix(u));var v=new o.Vector3(0,0,1),g=e.upDir.clone().normalize();if(!g.equals(v)){var y=g.cross(v),b=g.angleTo(v);u.makeRotationAxis(y,b),m.applyMatrix(u)}g=e.upDir.normalize();var _=void 0;_=g.x>=g.y?g.x>=g.z?"x":"z":g.y>=g.z?"y":"z";var w=(c.geometry.boundingBox.max[_]-c.geometry.boundingBox.min[_])/2;u.makeTranslation(0,0,w),m.applyMatrix(u);var x=c.geometry.boundingBox.getSize(),M=Math.max(x.x,x.z,x.y),E=4/M,A=s.default.scale/s.default.EARTH_RADIUS*E;u.makeScale(A,A,A),m.applyMatrix(u),p.applyMatrix(m.matrix),m.objSpaceBBox=p,r(m)},i,function(e){n(e)})})}Object.defineProperty(t,"__esModule",{value:!0}),t.addMTLOBJ=i;var o=r(0),a=r(4),s=n(a),l=r(50),u=n(l);!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(i,"addMTLOBJ","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/loader/addMTLOBJ.js")}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=function(e){function t(e,r,o,s){function l(e,t,r,n){for(var i=0;i<t.length;++i)i%2==1&&(t[i]=t[i]*n);var o=new a.BufferGeometry;return o.addAttribute("position",new a.Float32BufferAttribute(new Float32Array(e),3)),o.addAttribute("uv",new a.Float32BufferAttribute(new Float32Array(t),2)),o.index=new a.Uint16BufferAttribute(new Uint16Array(r),1),o}n(this,t);var u=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),c=e/2,h=r/2,d=o/2,f=function(e){var t=[0,0,0,0,0,0,0,0].concat(e).concat(e),r=new a.DataTexture(Uint8Array.from(t),2,2,a.RGBAFormat,a.UnsignedByteType,a.UVMapping);return r.needsUpdate=!0,r.minFilter=r.magFilter=a.LinearFilter,r}([255,255,255,255]),p=new a.MeshBasicMaterial({color:s,transparent:!0,alphaMap:f,side:a.DoubleSide}),m=[0,-h,-d,0,-h,d,0,h,-d,0,h,d],v=[1,1,1,0,0,1,0,0],g=[0,1,2,1,2,3],y=l(m,v,g,.6),b=new a.Mesh(y,p);b.position.x-=c,b.renderOrder=1;var _=[0,-h,-d,0,-h,d,0,h,-d,0,h,d],w=[1,1,1,0,0,1,0,0],x=[0,1,2,1,2,3],M=l(_,w,x,.6),E=new a.Mesh(M,p);E.position.x+=c,E.renderOrder=1;var A=[-c,0,-d,-c,0,d,c,0,-d,c,0,d],T=[1,1,1,0,0,1,0,0],k=[0,1,2,1,2,3],S=l(A,T,k,.6),C=new a.Mesh(S,p);C.position.y-=h,C.renderOrder=1;var P=[-c,0,-d,-c,0,d,c,0,-d,c,0,d],O=[1,1,1,0,0,1,0,0],R=[0,1,2,1,2,3],L=l(P,O,R,.6),I=new a.Mesh(L,p);I.position.y+=h,I.renderOrder=1;var B=[-c,-h,0,-c,h,0,c,-h,0,c,h,0],D=[0,0,0,0,0,0,0,0],j=[0,1,2,1,2,3],z=l(B,D,j,.6),N=new a.Mesh(z,p);N.position.z-=d,N.renderOrder=2,u.add(b),u.add(E),u.add(C),u.add(I),u.add(N);for(var U=new a.BufferGeometry,F=[-c,-h,-d,-c,-h,d,-c,h,-d,-c,h,d,c,-h,-d,c,-h,d,c,h,-d,c,h,d],H=[p.color.r,p.color.g,p.color.b,.66],V=[p.color.r,p.color.g,p.color.b,0],G=[],W=0;W<4;++W)G=G.concat(H).concat(V);U.addAttribute("position",new a.BufferAttribute(new Float32Array(F),3)),U.addAttribute("vertexcolor",new a.BufferAttribute(new Float32Array(G),4));var X=new a.ShaderMaterial({uniforms:{},vertexShader:"attribute vec4 vertexcolor;varying vec4 vColor;void main(){gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);vColor=vertexcolor;}",fragmentShader:"varying vec4 vColor;void main(){gl_FragColor=vColor;}",blending:a.AdditiveBlending,depthTest:!0,transparent:!0}),Y=new a.LineSegments(U,X);return Y.renderOrder=3,u.add(Y),u}return o(t,e),t}(a.Object3D),l=s;t.default=l,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(s,"GLFence","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/GLFence.js"),__REACT_HOT_LOADER__.register(l,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/GLFence.js"))}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){var t={};for(var r in e){t[r]={};for(var n in e[r])e[r][n]instanceof a.Vector3?t[r][n]=e[r][n].clone():e[r][n]instanceof s.Tween?t[r][n]=e[r][n].clone():e[r][n]instanceof Array?t[r][n]=e[r][n].slice():e[r][n]instanceof String?t[r][n]=e[r][n]:(e[r][n],Number,t[r][n]=e[r][n])}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.Examples=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),s=r(22),l={smoke:{positionStyle:s.Type.CUBE,positionBase:new a.Vector3(0,0,0),positionSpread:new a.Vector3(2,2,0),velocityStyle:s.Type.CUBE,velocityBase:new a.Vector3(0,0,10),velocitySpread:new a.Vector3(5,5,5),accelerationBase:new a.Vector3(0,0,-1),particleTexture:null,particleTexturePath:"../images/smokeparticle.png",angleBase:0,angleSpread:720,angleVelocityBase:0,angleVelocitySpread:720,sizeTween:new s.Tween([0,1],[32,128]),opacityTween:new s.Tween([.8,2],[.5,0]),colorTween:new s.Tween([.4,1],[new a.Vector3(0,0,.2),new a.Vector3(0,0,.5)]),particlesPerSecond:400,particleDeathAge:2,emitterDeathAge:60},clouds:{positionStyle:s.Type.CUBE,positionBase:new a.Vector3(0,0,0),positionSpread:new a.Vector3(4,4,.2),velocityStyle:s.Type.CUBE,velocityBase:new a.Vector3(.4,0,0),velocitySpread:new a.Vector3(.2,0,0),particleTexture:null,particleTexturePath:"../images/smokeparticle.png",sizeBase:800,sizeSpread:400,colorBase:new a.Vector3(0,0,1),opacityTween:new s.Tween([0,1,4,5],[0,1,1,0]),particlesPerSecond:20,particleDeathAge:10,emitterDeathAge:60},snow:{positionStyle:s.Type.CUBE,positionBase:new a.Vector3(0,0,0),positionSpread:new a.Vector3(5,5,0),velocityStyle:s.Type.CUBE,velocityBase:new a.Vector3(0,0,-1),velocitySpread:new a.Vector3(1,1,.5),accelerationBase:new a.Vector3(0,0,-.5),angleBase:0,angleSpread:720,angleVelocityBase:0,angleVelocitySpread:60,particleTexture:null,particleTexturePath:"../images/snowflake.png",sizeTween:new s.Tween([0,.25],[40,80]),colorBase:new a.Vector3(.66,1,.9),opacityTween:new s.Tween([2,3],[.8,0]),particlesPerSecond:20,particleDeathAge:4,emitterDeathAge:60},rain:{positionStyle:s.Type.CUBE,positionBase:new a.Vector3(0,0,0),positionSpread:new a.Vector3(5,5,0),velocityStyle:s.Type.CUBE,velocityBase:new a.Vector3(0,0,-3),velocitySpread:new a.Vector3(1,1,2),accelerationBase:new a.Vector3(0,0,-2),particleTexture:null,particleTexturePath:"../images/raindrop2flip.png",sizeBase:60,sizeSpread:30,colorBase:new a.Vector3(.67,1,.4),colorSpread:new a.Vector3(0,0,.2),opacityBase:.6,particlesPerSecond:40,particleDeathAge:1.5,emitterDeathAge:60},candle:{positionStyle:s.Type.SPHERE,positionBase:new a.Vector3(0,0,0),positionRadius:1,velocityStyle:s.Type.CUBE,velocityBase:new a.Vector3(0,0,7),velocitySpread:new a.Vector3(2,2,0),particleTexture:null,particleTexturePath:"../images/smokeparticle.png",sizeTween:new s.Tween([0,.3,1.2],[20,150,1]),opacityTween:new s.Tween([.9,1.5],[1,0]),colorTween:new s.Tween([.5,1],[new a.Vector3(.02,1,.5),new a.Vector3(.05,1,0)]),blendStyle:a.AdditiveBlending,particlesPerSecond:600,particleDeathAge:12,emitterDeathAge:60}},u=function(){function e(){n(this,e),this.examples=i(l)}return o(e,[{key:"exist",value:function(e){return!!this.examples[e]}},{key:"getEffect",value:function(e){return this.examples[e]}},{key:"destruct",value:function(){for(var e in this.examples)this.examples[e].particleTexture&&(this.examples[e].particleTexture.dispose(),this.examples[e].particleTexture=null)}}]),e}();t.Examples=u,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(l,"examples","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/ParticleEngine/ParticleEngineExamples.js"),__REACT_HOT_LOADER__.register(i,"cloneExamples","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/ParticleEngine/ParticleEngineExamples.js"),__REACT_HOT_LOADER__.register(u,"Examples","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/ParticleEngine/ParticleEngineExamples.js"))}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=r(7),s=function(e){return e&&e.__esModule?e:{default:e}}(a),l=r(0),u=function(e){function t(e){if(n(this,t),!s.default.ImgTextureCacheExist("defaultPointMarkerImgUrl")){var r=[255,255,255,255],o=function(e){var t=[0,0,0,0],r=[];r=r.concat(t).concat(e).concat(e).concat(t),r=r.concat(e).concat(t).concat(t).concat(e),r=r.concat(e).concat(t).concat(t).concat(e),r=r.concat(t).concat(e).concat(e).concat(t);var n=new l.DataTexture(Uint8Array.from(r),4,4,l.RGBAFormat,l.UnsignedByteType,l.UVMapping);return n.minFilter=n.magFilter=l.LinearFilter,n.needsUpdate=!0,n}(r);s.default.cacheImgTexture("defaultPointMarkerImgUrl",o)}e.imgUrl=e.imgUrl?e.imgUrl:"defaultPointMarkerImgUrl",e.scale=e.scale?e.scale:.5;var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a._property.type="PointMarker",a._property.imgUrl=e.imgUrl,a._property.scale=e.scale,a}return o(t,e),t}(s.default),c=u;t.default=c,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(u,"PointMarker","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/PointMarker.js"),__REACT_HOT_LOADER__.register(c,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/PointMarker.js"))}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){n.MeshBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.side=n.FrontSide,this.transparent=!0,this.setValues(e),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(e){e?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};i.prototype=Object.create(n.MeshBasicMaterial.prototype),i.prototype.constructor=i;var o=function(e){n.LineBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.transparent=!0,this.linewidth=1,this.setValues(e),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(e){e?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};o.prototype=Object.create(n.LineBasicMaterial.prototype),o.prototype.constructor=o;var a=new i({visible:!1,transparent:!1,side:n.DoubleSide}),s=function(){this.init=function(){n.Object3D.call(this),this.handles=new n.Object3D,this.pickers=new n.Object3D,this.planes=new n.Object3D,this.add(this.handles),this.add(this.pickers),this.add(this.planes);var e=new n.PlaneBufferGeometry(50,50,2,2),t=new n.MeshBasicMaterial({visible:!1,side:n.DoubleSide}),r={XY:new n.Mesh(e,t),YZ:new n.Mesh(e,t),XZ:new n.Mesh(e,t),XYZE:new n.Mesh(e,t)};this.activePlane=r.XYZE,r.YZ.rotation.set(0,Math.PI/2,0),r.XZ.rotation.set(-Math.PI/2,0,0);for(var i in r)r[i].name=i,r[i].renderOrder=10,this.planes.add(r[i]),this.planes[i]=r[i];var o=function(e,t){for(var r in e)for(i=e[r].length;i--;){var n=e[r][i][0],o=e[r][i][1],a=e[r][i][2];n.name=r,n.renderOrder=10,o&&n.position.set(o[0],o[1],o[2]),a&&n.rotation.set(a[0],a[1],a[2]),t.add(n)}};o(this.handleGizmos,this.handles),o(this.pickerGizmos,this.pickers),this.traverse(function(e){if(e instanceof n.Mesh||e instanceof n.Line){e.updateMatrix();var t=e.geometry.clone();t.applyMatrix(e.matrix),e.geometry=t,e.position.set(0,0,0),e.rotation.set(0,0,0),e.scale.set(1,1,1)}})},this.highlight=function(e){this.traverse(function(t){t.material&&t.material.highlight&&(t.name===e?t.material.highlight(!0):t.material.highlight(!1))})}};s.prototype=Object.create(n.Object3D.prototype),s.prototype.constructor=s,s.prototype.update=function(e,t){var r=new n.Vector3(0,0,0),i=new n.Vector3(0,1,0),o=new n.Matrix4;this.traverse(function(n){-1!==n.name.search("E")?n.quaternion.setFromRotationMatrix(o.lookAt(t,r,i)):-1===n.name.search("X")&&-1===n.name.search("Y")&&-1===n.name.search("Z")||n.quaternion.setFromEuler(e)})};var l=function(){s.call(this);var e=new n.Geometry,t=new n.Mesh(new n.CylinderGeometry(0,.05,.2,12,1,!1));t.position.y=.5,t.updateMatrix(),e.merge(t.geometry,t.matrix);var r=new n.BufferGeometry;r.addAttribute("position",new n.Float32BufferAttribute([0,0,0,1,0,0],3));var l=new n.BufferGeometry;l.addAttribute("position",new n.Float32BufferAttribute([0,0,0,0,1,0],3));var u=new n.BufferGeometry;u.addAttribute("position",new n.Float32BufferAttribute([0,0,0,0,0,1],3)),this.handleGizmos={X:[[new n.Mesh(e,new i({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new n.Line(r,new o({color:16711680}))]],Y:[[new n.Mesh(e,new i({color:65280})),[0,.5,0]],[new n.Line(l,new o({color:65280}))]],Z:[[new n.Mesh(e,new i({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new n.Line(u,new o({color:255}))]],XYZ:[[new n.Mesh(new n.OctahedronGeometry(.1,0),new i({color:16777215,opacity:.25,visible:!1})),[0,0,0],[0,0,0]]],XY:[[new n.Mesh(new n.PlaneBufferGeometry(.29,.29),new i({color:16776960,opacity:.25,side:n.DoubleSide})),[.15,.15,0]]],YZ:[[new n.Mesh(new n.PlaneBufferGeometry(.29,.29),new i({color:65535,opacity:.25,side:n.DoubleSide})),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new n.Mesh(new n.PlaneBufferGeometry(.29,.29),new i({color:16711935,opacity:.25,side:n.DoubleSide})),[.15,0,.15],[-Math.PI/2,0,0]]]},this.pickerGizmos={X:[[new n.Mesh(new n.CylinderBufferGeometry(.2,0,1,4,1,!1),a),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new n.Mesh(new n.CylinderBufferGeometry(.2,0,1,4,1,!1),a),[0,.6,0]]],Z:[[new n.Mesh(new n.CylinderBufferGeometry(.2,0,1,4,1,!1),a),[0,0,.6],[Math.PI/2,0,0]]],XY:[[new n.Mesh(new n.PlaneBufferGeometry(.4,.4),a),[.2,.2,0]]],YZ:[[new n.Mesh(new n.PlaneBufferGeometry(.4,.4),a),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new n.Mesh(new n.PlaneBufferGeometry(.4,.4),a),[.2,0,.2],[-Math.PI/2,0,0]]]},this.setActivePlane=function(e,t){var r=new n.Matrix4;t.applyMatrix4(r.getInverse(r.extractRotation(this.planes.XY.matrixWorld))),"X"===e&&(this.activePlane=this.planes.XY,Math.abs(t.y)>Math.abs(t.z)&&(this.activePlane=this.planes.XZ)),"Y"===e&&(this.activePlane=this.planes.XY,Math.abs(t.x)>Math.abs(t.z)&&(this.activePlane=this.planes.YZ)),"Z"===e&&(this.activePlane=this.planes.XZ,Math.abs(t.x)>Math.abs(t.y)&&(this.activePlane=this.planes.YZ)),"XYZ"===e&&(this.activePlane=this.planes.XYZE),"XY"===e&&(this.activePlane=this.planes.XY),"YZ"===e&&(this.activePlane=this.planes.YZ),"XZ"===e&&(this.activePlane=this.planes.XZ)},this.init()};l.prototype=Object.create(s.prototype),l.prototype.constructor=l;var u=function(){s.call(this);var e=function(e,t,r){var i=new n.BufferGeometry,o=[];r=r||1;for(var a=0;a<=64*r;++a)"x"===t&&o.push(0,Math.cos(a/32*Math.PI)*e,Math.sin(a/32*Math.PI)*e),"y"===t&&o.push(Math.cos(a/32*Math.PI)*e,0,Math.sin(a/32*Math.PI)*e),"z"===t&&o.push(Math.sin(a/32*Math.PI)*e,Math.cos(a/32*Math.PI)*e,0);return i.addAttribute("position",new n.Float32BufferAttribute(o,3)),i};this.handleGizmos={X:[[new n.Line(new e(1,"x",.5),new o({color:16711680}))]],Y:[[new n.Line(new e(1,"y",.5),new o({color:65280}))]],Z:[[new n.Line(new e(1,"z",.5),new o({color:255}))]],E:[[new n.Line(new e(1.25,"z",1),new o({color:13421568}))]],XYZE:[[new n.Line(new e(1,"z",1),new o({color:7895160}))]]},this.pickerGizmos={X:[[new n.Mesh(new n.TorusBufferGeometry(1,.12,4,12,Math.PI),a),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new n.Mesh(new n.TorusBufferGeometry(1,.12,4,12,Math.PI),a),[0,0,0],[Math.PI/2,0,0]]],Z:[[new n.Mesh(new n.TorusBufferGeometry(1,.12,4,12,Math.PI),a),[0,0,0],[0,0,-Math.PI/2]]],E:[[new n.Mesh(new n.TorusBufferGeometry(1.25,.12,2,24),a)]],XYZE:[[new n.Mesh]]},this.setActivePlane=function(e){"E"===e&&(this.activePlane=this.planes.XYZE),"X"===e&&(this.activePlane=this.planes.YZ),"Y"===e&&(this.activePlane=this.planes.XZ),"Z"===e&&(this.activePlane=this.planes.XY)},this.update=function(e,t){s.prototype.update.apply(this,arguments);var r=(this.handles,this.pickers,new n.Matrix4),i=new n.Euler(0,0,1),o=new n.Quaternion,a=new n.Vector3(1,0,0),l=new n.Vector3(0,1,0),u=new n.Vector3(0,0,1),c=new n.Quaternion,h=new n.Quaternion,d=new n.Quaternion,f=t.clone();i.copy(this.planes.XY.rotation),o.setFromEuler(i),r.makeRotationFromQuaternion(o).getInverse(r),f.applyMatrix4(r),this.traverse(function(e){o.setFromEuler(i),"X"===e.name&&(c.setFromAxisAngle(a,Math.atan2(-f.y,f.z)),o.multiplyQuaternions(o,c),e.quaternion.copy(o)),"Y"===e.name&&(h.setFromAxisAngle(l,Math.atan2(f.x,f.z)),o.multiplyQuaternions(o,h),e.quaternion.copy(o)),"Z"===e.name&&(d.setFromAxisAngle(u,Math.atan2(f.y,f.x)),o.multiplyQuaternions(o,d),e.quaternion.copy(o))})},this.init()};u.prototype=Object.create(s.prototype),u.prototype.constructor=u;var c=function(){s.call(this);var e=new n.Geometry,t=new n.Mesh(new n.BoxGeometry(.125,.125,.125));t.position.y=.5,t.updateMatrix(),e.merge(t.geometry,t.matrix);var r=new n.BufferGeometry;r.addAttribute("position",new n.Float32BufferAttribute([0,0,0,1,0,0],3));var l=new n.BufferGeometry;l.addAttribute("position",new n.Float32BufferAttribute([0,0,0,0,1,0],3));var u=new n.BufferGeometry;u.addAttribute("position",new n.Float32BufferAttribute([0,0,0,0,0,1],3)),this.handleGizmos={X:[[new n.Mesh(e,new i({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new n.Line(r,new o({color:16711680}))]],Y:[[new n.Mesh(e,new i({color:65280})),[0,.5,0]],[new n.Line(l,new o({color:65280}))]],Z:[[new n.Mesh(e,new i({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new n.Line(u,new o({color:255}))]],XYZ:[[new n.Mesh(new n.BoxBufferGeometry(.125,.125,.125),new i({color:16777215,opacity:.25}))]]},this.pickerGizmos={X:[[new n.Mesh(new n.CylinderBufferGeometry(.2,0,1,4,1,!1),a),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new n.Mesh(new n.CylinderBufferGeometry(.2,0,1,4,1,!1),a),[0,.6,0]]],Z:[[new n.Mesh(new n.CylinderBufferGeometry(.2,0,1,4,1,!1),a),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new n.Mesh(new n.BoxBufferGeometry(.4,.4,.4),a)]]},this.setActivePlane=function(e,t){var r=new n.Matrix4;t.applyMatrix4(r.getInverse(r.extractRotation(this.planes.XY.matrixWorld))),"X"===e&&(this.activePlane=this.planes.XY,Math.abs(t.y)>Math.abs(t.z)&&(this.activePlane=this.planes.XZ)),"Y"===e&&(this.activePlane=this.planes.XY,Math.abs(t.x)>Math.abs(t.z)&&(this.activePlane=this.planes.YZ)),"Z"===e&&(this.activePlane=this.planes.XZ,Math.abs(t.x)>Math.abs(t.y)&&(this.activePlane=this.planes.YZ)),"XYZ"===e&&(this.activePlane=this.planes.XYZE)},this.init()};c.prototype=Object.create(s.prototype),c.prototype.constructor=c;var h=function(e,t){function r(e){if(void 0!==h.object&&!0!==f&&(void 0===e.button||0===e.button)){var t=e.changedTouches?e.changedTouches[0]:e,r=s(t,p[d].pickers.children),n=null;r&&(n=r.object.name,e.preventDefault()),h.axis!==n&&(h.axis=n,h.update(),h.dispatchEvent(g))}}function i(e){if(void 0!==h.object&&!0!==f&&(void 0===e.button||0===e.button)){var t=e.changedTouches?e.changedTouches[0]:e;if(0===t.button||void 0===t.button){var r=s(t,p[d].pickers.children);if(r){e.preventDefault(),e.stopPropagation(),h.dispatchEvent(y),h.axis=r.object.name,h.update(),C.copy(K).sub(X).normalize(),p[d].setActivePlane(h.axis,C);var n=s(t,[p[d].activePlane]);n&&(F.copy(h.object.position),H.copy(h.object.scale),V.extractRotation(h.object.matrix),q.extractRotation(h.object.matrixWorld),G.extractRotation(h.object.parent.matrixWorld),W.setFromMatrixScale(P.getInverse(h.object.parent.matrixWorld)),E.copy(n.point))}}f=!0}}function o(e){if(void 0!==h.object&&null!==h.axis&&!1!==f&&(void 0===e.button||0===e.button)){var t=e.changedTouches?e.changedTouches[0]:e,r=s(t,[p[d].activePlane]);!1!==r&&(e.preventDefault(),e.stopPropagation(),M.copy(r.point),"translate"===d?(M.sub(E),M.multiply(W),"local"===h.space&&(M.applyMatrix4(P.getInverse(q)),-1===h.axis.search("X")&&(M.x=0),-1===h.axis.search("Y")&&(M.y=0),-1===h.axis.search("Z")&&(M.z=0),M.applyMatrix4(V),h.object.position.copy(F),h.object.position.add(M)),"world"!==h.space&&-1===h.axis.search("XYZ")||(-1===h.axis.search("X")&&(M.x=0),-1===h.axis.search("Y")&&(M.y=0),-1===h.axis.search("Z")&&(M.z=0),M.applyMatrix4(P.getInverse(G)),h.object.position.copy(F),h.object.position.add(M)),null!==h.translationSnap&&("local"===h.space&&h.object.position.applyMatrix4(P.getInverse(q)),-1!==h.axis.search("X")&&(h.object.position.x=Math.round(h.object.position.x/h.translationSnap)*h.translationSnap),-1!==h.axis.search("Y")&&(h.object.position.y=Math.round(h.object.position.y/h.translationSnap)*h.translationSnap),-1!==h.axis.search("Z")&&(h.object.position.z=Math.round(h.object.position.z/h.translationSnap)*h.translationSnap),"local"===h.space&&h.object.position.applyMatrix4(q))):"scale"===d?(M.sub(E),M.multiply(W),"local"===h.space&&("XYZ"===h.axis?(k=1+M.y/Math.max(H.x,H.y,H.z),h.object.scale.x=H.x*k,h.object.scale.y=H.y*k,h.object.scale.z=H.z*k):(M.applyMatrix4(P.getInverse(q)),"X"===h.axis&&(h.object.scale.x=H.x*(1+M.x/H.x)),"Y"===h.axis&&(h.object.scale.y=H.y*(1+M.y/H.y)),"Z"===h.axis&&(h.object.scale.z=H.z*(1+M.z/H.z))))):"rotate"===d&&(M.sub(X),M.multiply(W),O.copy(E).sub(X),O.multiply(W),"E"===h.axis?(M.applyMatrix4(P.getInverse(S)),O.applyMatrix4(P.getInverse(S)),A.set(Math.atan2(M.z,M.y),Math.atan2(M.x,M.z),Math.atan2(M.y,M.x)),T.set(Math.atan2(O.z,O.y),Math.atan2(O.x,O.z),Math.atan2(O.y,O.x)),R.setFromRotationMatrix(P.getInverse(G)),U.setFromAxisAngle(C,A.z-T.z),D.setFromRotationMatrix(q),R.multiplyQuaternions(R,U),R.multiplyQuaternions(R,D),h.object.quaternion.copy(R)):"XYZE"===h.axis?(U.setFromEuler(M.clone().cross(O).normalize()),R.setFromRotationMatrix(P.getInverse(G)),j.setFromAxisAngle(U,-M.clone().angleTo(O)),D.setFromRotationMatrix(q),R.multiplyQuaternions(R,j),R.multiplyQuaternions(R,D),h.object.quaternion.copy(R)):"local"===h.space?(M.applyMatrix4(P.getInverse(q)),O.applyMatrix4(P.getInverse(q)),A.set(Math.atan2(M.z,M.y),Math.atan2(M.x,M.z),Math.atan2(M.y,M.x)),T.set(Math.atan2(O.z,O.y),Math.atan2(O.x,O.z),Math.atan2(O.y,O.x)),D.setFromRotationMatrix(V),null!==h.rotationSnap?(j.setFromAxisAngle(L,Math.round((A.x-T.x)/h.rotationSnap)*h.rotationSnap),z.setFromAxisAngle(I,Math.round((A.y-T.y)/h.rotationSnap)*h.rotationSnap),N.setFromAxisAngle(B,Math.round((A.z-T.z)/h.rotationSnap)*h.rotationSnap)):(j.setFromAxisAngle(L,A.x-T.x),z.setFromAxisAngle(I,A.y-T.y),N.setFromAxisAngle(B,A.z-T.z)),"X"===h.axis&&D.multiplyQuaternions(D,j),"Y"===h.axis&&D.multiplyQuaternions(D,z),"Z"===h.axis&&D.multiplyQuaternions(D,N),h.object.quaternion.copy(D)):"world"===h.space&&(A.set(Math.atan2(M.z,M.y),Math.atan2(M.x,M.z),Math.atan2(M.y,M.x)),T.set(Math.atan2(O.z,O.y),Math.atan2(O.x,O.z),Math.atan2(O.y,O.x)),R.setFromRotationMatrix(P.getInverse(G)),null!==h.rotationSnap?(j.setFromAxisAngle(L,Math.round((A.x-T.x)/h.rotationSnap)*h.rotationSnap),z.setFromAxisAngle(I,Math.round((A.y-T.y)/h.rotationSnap)*h.rotationSnap),N.setFromAxisAngle(B,Math.round((A.z-T.z)/h.rotationSnap)*h.rotationSnap)):(j.setFromAxisAngle(L,A.x-T.x),z.setFromAxisAngle(I,A.y-T.y),N.setFromAxisAngle(B,A.z-T.z)),D.setFromRotationMatrix(q),"X"===h.axis&&R.multiplyQuaternions(R,j),"Y"===h.axis&&R.multiplyQuaternions(R,z),"Z"===h.axis&&R.multiplyQuaternions(R,N),R.multiplyQuaternions(R,D),h.object.quaternion.copy(R))),h.update(),h.dispatchEvent(g),h.dispatchEvent(_))}}function a(e){e.preventDefault(),void 0!==e.button&&0!==e.button||(f&&null!==h.axis&&(b.mode=d,h.dispatchEvent(b)),f=!1,"TouchEvent"in window&&e instanceof TouchEvent?(h.axis=null,h.update(),h.dispatchEvent(g)):r(e))}function s(r,n){var i=t.getBoundingClientRect(),o=(r.clientX-i.left)/i.width,a=(r.clientY-i.top)/i.height;x.set(2*o-1,-2*a+1),w.setFromCamera(x,e);var s=w.intersectObjects(n,!0);return!!s[0]&&s[0]}n.Object3D.call(this),t=void 0!==t?t:document,this.object=void 0,this.visible=!1,this.translationSnap=null,this.rotationSnap=null,this.space="world",this.size=1,this.axis=null;var h=this,d="translate",f=!1,p={translate:new l,rotate:new u,scale:new c};for(var m in p){var v=p[m];v.visible=m===d,this.add(v)}var g={type:"change"},y={type:"mouseDown"},b={type:"mouseUp",mode:d},_={type:"objectChange"},w=new n.Raycaster,x=new n.Vector2,M=new n.Vector3,E=new n.Vector3,A=new n.Vector3,T=new n.Vector3,k=1,S=new n.Matrix4,C=new n.Vector3,P=new n.Matrix4,O=new n.Vector3,R=new n.Quaternion,L=new n.Vector3(1,0,0),I=new n.Vector3(0,1,0),B=new n.Vector3(0,0,1),D=new n.Quaternion,j=new n.Quaternion,z=new n.Quaternion,N=new n.Quaternion,U=new n.Quaternion,F=new n.Vector3,H=new n.Vector3,V=new n.Matrix4,G=new n.Matrix4,W=new n.Vector3,X=new n.Vector3,Y=new n.Euler,q=new n.Matrix4,K=new n.Vector3,Z=new n.Euler;t.addEventListener("mousedown",i,!1),t.addEventListener("touchstart",i,!1),t.addEventListener("mousemove",r,!1),t.addEventListener("touchmove",r,!1),t.addEventListener("mousemove",o,!1),t.addEventListener("touchmove",o,!1),t.addEventListener("mouseup",a,!1),t.addEventListener("mouseout",a,!1),t.addEventListener("touchend",a,!1),t.addEventListener("touchcancel",a,!1),t.addEventListener("touchleave",a,!1),this.dispose=function(){t.removeEventListener("mousedown",i),t.removeEventListener("touchstart",i),t.removeEventListener("mousemove",r),t.removeEventListener("touchmove",r),t.removeEventListener("mousemove",o),t.removeEventListener("touchmove",o),t.removeEventListener("mouseup",a),t.removeEventListener("mouseout",a),t.removeEventListener("touchend",a),t.removeEventListener("touchcancel",a),t.removeEventListener("touchleave",a)},this.attach=function(e){this.object=e,this.visible=!0,this.update()},this.detach=function(){this.object=void 0,this.visible=!1,this.axis=null},this.getMode=function(){return d},this.setMode=function(e){"scale"===(d=e||d)&&(h.space="local");for(var t in p)p[t].visible=t===d;this.update(),h.dispatchEvent(g)},this.setTranslationSnap=function(e){h.translationSnap=e},this.setRotationSnap=function(e){h.rotationSnap=e},this.setSize=function(e){h.size=e,this.update(),h.dispatchEvent(g)},this.setSpace=function(e){h.space=e,this.update(),h.dispatchEvent(g)},this.update=function(){void 0!==h.object&&(h.object.updateMatrixWorld(),X.setFromMatrixPosition(h.object.matrixWorld),Y.setFromRotationMatrix(P.extractRotation(h.object.matrixWorld)),e.updateMatrixWorld(),K.setFromMatrixPosition(e.matrixWorld),Z.setFromRotationMatrix(P.extractRotation(e.matrixWorld)),k=X.distanceTo(K)/6*h.size,this.position.copy(X),this.scale.set(k,k,k),e instanceof n.PerspectiveCamera?C.copy(K).sub(X).normalize():e instanceof n.OrthographicCamera&&C.copy(K).normalize(),"local"===h.space?p[d].update(Y,C):"world"===h.space&&p[d].update(new n.Euler,C),p[d].highlight(h.axis))}};h.prototype=Object.create(n.Object3D.prototype),h.prototype.constructor=h;var d=h;t.default=d,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"GizmoMaterial","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/TransformControls.js"),__REACT_HOT_LOADER__.register(o,"GizmoLineMaterial","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/TransformControls.js"),__REACT_HOT_LOADER__.register(a,"pickerMaterial","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/TransformControls.js"),__REACT_HOT_LOADER__.register(s,"TransformGizmo","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/TransformControls.js"),__REACT_HOT_LOADER__.register(l,"TransformGizmoTranslate","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/TransformControls.js"),__REACT_HOT_LOADER__.register(u,"TransformGizmoRotate","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/TransformControls.js"),__REACT_HOT_LOADER__.register(c,"TransformGizmoScale","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/TransformControls.js"),__REACT_HOT_LOADER__.register(h,"TransformControls","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/TransformControls.js"),__REACT_HOT_LOADER__.register(d,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/TransformControls.js"))}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i={uniforms:n.UniformsUtils.merge([n.UniformsLib.fog,{normalSampler:{type:"t",value:null},mirrorSampler:{type:"t",value:null},alpha:{type:"f",value:1},time:{type:"f",value:0},distortionScale:{type:"f",value:20},noiseScale:{type:"f",value:1},textureMatrix:{type:"m4",value:new n.Matrix4},sunColor:{type:"c",value:new n.Color(8355711)},sunDirection:{type:"v3",value:new n.Vector3(.70707,.70707,0)},eye:{type:"v3",value:new n.Vector3(0,0,0)},waterColor:{type:"c",value:new n.Color(5592405)},cropMask:{type:"t",value:null},useMask:{type:"b",value:!1}}]),vertexShader:["uniform mat4 textureMatrix;","uniform float time;","varying vec4 mirrorCoord;","varying vec3 worldPosition;","varying vec3 modelPosition;","varying vec3 surfaceX;","varying vec3 surfaceY;","varying vec3 surfaceZ;","varying vec2 vUv;","void main()","{","  mirrorCoord = modelMatrix * vec4(position, 1.0);","  worldPosition = mirrorCoord.xyz;","  modelPosition = vec3(uv * 512.0, 0);","  surfaceX = vec3( modelMatrix[0][0], modelMatrix[0][1], modelMatrix[0][2]);","  surfaceY = vec3( modelMatrix[1][0], modelMatrix[1][1], modelMatrix[1][2]);","  surfaceZ = vec3( modelMatrix[2][0], modelMatrix[2][1], modelMatrix[2][2]);","  vUv = uv;","  mirrorCoord = textureMatrix * mirrorCoord;","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["uniform sampler2D mirrorSampler;","uniform float alpha;","uniform float time;","uniform float distortionScale;","uniform float noiseScale;","uniform sampler2D normalSampler;","uniform vec3 sunColor;","uniform vec3 sunDirection;","uniform vec3 eye;","uniform vec3 waterColor;","varying vec4 mirrorCoord;","varying vec3 worldPosition;","varying vec3 modelPosition;","varying vec3 surfaceX;","varying vec3 surfaceY;","varying vec3 surfaceZ;","varying vec2 vUv;","uniform sampler2D cropMask;","uniform bool useMask;","void sunLight(const vec3 surfaceNormal, const vec3 eyeDirection, in float shiny, in float spec, in float diffuse, inout vec3 diffuseColor, inout vec3 specularColor)","{","  vec3 reflection = normalize(reflect(-sunDirection, surfaceNormal));","  float direction = max(0.0, dot(eyeDirection, reflection));","  specularColor += pow(direction, shiny) * sunColor * spec;","  diffuseColor += max(dot(sunDirection, surfaceNormal), 0.0) * sunColor * diffuse;","}","vec3 getNoise(in vec2 uv)","{","  vec2 uv0 = uv / (103.0 * noiseScale) + vec2(time / 17.0, time / 29.0);","  vec2 uv1 = uv / (107.0 * noiseScale) - vec2(time / -19.0, time / 31.0);","  vec2 uv2 = uv / (vec2(8907.0, 9803.0) * noiseScale) + vec2(time / 101.0, time /   97.0);","  vec2 uv3 = uv / (vec2(1091.0, 1027.0) * noiseScale) - vec2(time / 109.0, time / -113.0);","  vec4 noise = texture2D(normalSampler, uv0) +","    texture2D(normalSampler, uv1) +","    texture2D(normalSampler, uv2) +","    texture2D(normalSampler, uv3);","  return noise.xyz * 0.5 - 1.0;","}",n.ShaderChunk.common,n.ShaderChunk.fog_pars_fragment,"void main()","{","  vec3 worldToEye = eye - worldPosition;","  vec3 eyeDirection = normalize(worldToEye);","  if (useMask) {","    vec2 os_uv = vec2(vUv.x, 1.0 - vUv.y);","    float mask_val = texture2D(cropMask, os_uv).y;","    if(mask_val < 0.05) {","      discard;","    }","  }","  vec3 noise = getNoise(modelPosition.xy * 1.0);","  vec3 distordCoord = noise.x * surfaceX + noise.y * surfaceY;","  vec3 distordNormal = normalize(distordCoord + surfaceZ);","  if(dot(eyeDirection, surfaceZ) < 0.0)","    distordNormal = distordNormal * -1.0;","  vec3 diffuseLight = vec3(0.0);","  vec3 specularLight = vec3(0.0);","  sunLight(distordNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight);","  float distance = length(worldToEye);","  vec2 distortion = distordCoord.xy * distortionScale * sqrt(distance) * 0.07;"," vec3 mirrorDistord = mirrorCoord.xyz + vec3(distortion.x, distortion.y, distortionScale * sqrt(distance));"," vec3 reflectionSample = texture2DProj(mirrorSampler, mirrorDistord).xyz;","  float theta = max(dot(eyeDirection, distordNormal), 0.0);","  float reflectance = 0.3 + (1.0 - 0.3) * pow((1.0 - theta), 3.0);","  vec3 scatter = max(0.0, dot(distordNormal, eyeDirection)) * waterColor;","  vec3 albedo = mix(sunColor * diffuseLight * 0.3 + scatter, (vec3(0.1) + reflectionSample * 0.9 + reflectionSample * specularLight), reflectance);"," vec3 outgoingLight = albedo;",n.ShaderChunk.fog_fragment," gl_FragColor = vec4( outgoingLight, alpha );","}"].join("\n")},o=function(e,t,r,o){function a(e,t){return void 0!==e?e:t}n.Object3D.call(this),this.name="water_"+this.id,o=o||{},this.matrixNeedsUpdate=!0;var s=a(o.textureWidth,512),l=a(o.textureHeight,512);this.clipBias=a(o.clipBias,-1e-4),this.alpha=a(o.alpha,1),this.time=a(o.time,0),this.normalSampler=a(o.waterNormals,null),this.sunDirection=a(o.sunDirection,new n.Vector3(.70707,.70707,0)),this.sunColor=new n.Color(a(o.sunColor,16777215)),this.waterColor=new n.Color(a(o.waterColor,8355711)),this.eye=a(o.eye,new n.Vector3(0,0,0)),this.distortionScale=a(o.distortionScale,20),this.noiseScale=a(o.noiseScale,1),this.side=a(o.side,n.FrontSide),this.fog=a(o.fog,!1),this.renderer=e,this.scene=r,this.mirrorPlane=new n.Plane,this.normal=new n.Vector3(0,0,1),this.cameraWorldPosition=new n.Vector3,this.rotationMatrix=new n.Matrix4,this.lookAtPosition=new n.Vector3(0,0,-1),this.clipPlane=new n.Vector4,this.cropMask=a(o.cropMask,null),this.useMask=null!==this.cropMask,t instanceof n.PerspectiveCamera?this.camera=t:(this.camera=new n.PerspectiveCamera,console.warn(this.name+": camera is not a Perspective Camera!")),this.textureMatrix=new n.Matrix4,this.mirrorCamera=this.camera.clone(),this.texture=new n.WebGLRenderTarget(s,l),this.tempTexture=new n.WebGLRenderTarget(s,l);var u=i,c=n.UniformsUtils.clone(u.uniforms);this.material=new n.ShaderMaterial({fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,uniforms:c,transparent:!0,side:this.side,fog:this.fog}),this.mesh=new n.Object3D,this.material.uniforms.mirrorSampler.value=this.texture.texture,this.material.uniforms.textureMatrix.value=this.textureMatrix,this.material.uniforms.alpha.value=this.alpha,this.material.uniforms.time.value=this.time,this.material.uniforms.normalSampler.value=this.normalSampler,this.material.uniforms.sunColor.value=this.sunColor,this.material.uniforms.waterColor.value=this.waterColor,this.material.uniforms.sunDirection.value=this.sunDirection,this.material.uniforms.distortionScale.value=this.distortionScale,this.material.uniforms.noiseScale.value=this.noiseScale,this.material.uniforms.eye.value=this.eye,this.material.uniforms.cropMask.value=this.cropMask,this.material.uniforms.useMask.value=this.useMask,n.Math.isPowerOfTwo(s)&&n.Math.isPowerOfTwo(l)||(this.texture.generateMipmaps=!1,this.tempTexture.generateMipmaps=!1)};o.prototype=Object.create(n.Object3D.prototype),o.prototype.setMask=function(e){this.material.uniforms.cropMask.value=e,this.material.uniforms.useMask.value=null!==e},o.prototype.updateTextureMatrix=function(){function e(e){return e?e<0?-1:1:0}void 0!==this.parent&&(this.mesh=this.parent),this.updateMatrixWorld(),this.camera.updateMatrixWorld(),this.cameraWorldPosition.setFromMatrixPosition(this.camera.matrixWorld);var t=(new n.Vector3).setFromMatrixPosition(this.matrixWorld);this.rotationMatrix.extractRotation(this.matrixWorld),this.normal=new n.Vector3(0,0,1).applyEuler((new n.Euler).setFromRotationMatrix(this.rotationMatrix));var r=this.cameraWorldPosition.clone().sub(t);if(this.normal.dot(r)<0){var i=new n.Vector3(0,0,1).applyEuler((new n.Euler).setFromRotationMatrix(this.rotationMatrix));this.normal.reflect(i)}var o=t.clone().sub(this.cameraWorldPosition);o.reflect(this.normal).negate(),o.add(t),this.rotationMatrix.extractRotation(this.camera.matrixWorld),this.lookAtPosition.set(0,0,-1),this.lookAtPosition.applyMatrix4(this.rotationMatrix),this.lookAtPosition.add(this.cameraWorldPosition);var a=t.clone().sub(this.lookAtPosition);a.reflect(this.normal).negate(),a.add(t),this.up.set(0,-1,0),this.up.applyMatrix4(this.rotationMatrix),this.up.reflect(this.normal).negate(),this.mirrorCamera.near=1e-12,this.mirrorCamera.far=100,this.mirrorCamera.position.copy(o),this.mirrorCamera.up=this.up,this.mirrorCamera.lookAt(a),this.mirrorCamera.aspect=this.camera.aspect,this.mirrorCamera.updateProjectionMatrix(),this.mirrorCamera.updateMatrixWorld(),this.mirrorCamera.matrixWorldInverse.getInverse(this.mirrorCamera.matrixWorld),this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.mirrorCamera.projectionMatrix),this.textureMatrix.multiply(this.mirrorCamera.matrixWorldInverse),this.mirrorPlane.setFromNormalAndCoplanarPoint(this.normal,t),this.mirrorPlane.applyMatrix4(this.mirrorCamera.matrixWorldInverse),this.clipPlane.set(this.mirrorPlane.normal.x,this.mirrorPlane.normal.y,this.mirrorPlane.normal.z,this.mirrorPlane.constant);var s=new n.Vector4,l=this.mirrorCamera.projectionMatrix;s.x=(e(this.clipPlane.x)+l.elements[8])/l.elements[0],s.y=(e(this.clipPlane.y)+l.elements[9])/l.elements[5],s.z=-1,s.w=(1+l.elements[10])/l.elements[14];var u=new n.Vector4;u=this.clipPlane.multiplyScalar(2/this.clipPlane.dot(s)),l.elements[2]=u.x,l.elements[6]=u.y,l.elements[10]=u.z+1-this.clipBias,l.elements[14]=u.w;var c=new n.Vector3;c.setFromMatrixPosition(this.camera.matrixWorld),this.eye=c,this.material.uniforms.eye.value=this.eye},o.prototype.render=function(e){if(this.matrixNeedsUpdate&&this.updateTextureMatrix(),this.matrixNeedsUpdate=!0,void 0!==this.scene&&this.scene instanceof n.Scene){this.material.visible=!1;var t=void 0!==e&&e?this.tempTexture:this.texture;this.renderer.render(this.scene,this.mirrorCamera,t,!0),this.material.visible=!0,this.material.uniforms.mirrorSampler.value=t.texture}},o.prototype.getMirrorCamera=function(e){var t=void 0!==e&&e?this.tempTexture:this.texture;this.renderer.render(this.scene,this.mirrorCamera,t,!0);var r=this.renderer.getContext(),n=t.width,i=t.height,o=new Uint8Array(n*i*4);return r.readPixels(0,0,n,i,r.RGBA,r.UNSIGNED_BYTE,o),{mirrorCamera:this.mirrorCamera,renderTexture:t,imgArray:o}},o.prototype.addMirrorHelper=function(){this.camHelper=new n.CameraHelper(this.mirrorCamera),this.scene.add(this.camHelper)};var a=o;t.default=a,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"WaterGLSL","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/water/Water.js"),__REACT_HOT_LOADER__.register(o,"Water","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/water/Water.js"),__REACT_HOT_LOADER__.register(a,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/water/Water.js"))}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(58),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=r(2),c=function(e){function t(e){n(this,t),e.usage="water",e.MaskType=l.default;var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.sceneNode=e.sceneNode,r.normalTex=null,r.downloadSucess=!1,r.isDebug=!1,r.scene=e.scene,r.renderer=e.renderer,r.camera=e.camera,r}return o(t,e),a(t,[{key:"destruct",value:function(){this.directionalLight_water&&this.directionalLight_water.dispose(),u.MaskManager.prototype.destruct.call(this)}},{key:"downloadAll",value:function(){var e=this;return e.isDebug&&console.log("1. download normal tex ..."),new Promise(function(t,r){e.service.getNormalTex(function(r){r&&(e.normalTex=r,e.isDebug&&(console.log("normal tex loaded",e.normalTex),console.log("2. download water settings ...")),e._downloadSettings(l.default,function(){t()}))})})}},{key:"_defaultMaskOpts",value:function(e){var t=u.MaskManager.prototype._defaultMaskOpts.call(this);return t.sceneNode=this.sceneNode,t.scene=this.scene,t.renderer=this.renderer,t.camera=this.camera,t.show=!0,t.directionalLight_water=this.directionalLight_water,t.normalTex=this.normalTex,t.createDefault=!1,t.maskId=e,t}},{key:"renderWaters",value:function(){for(var e in this.maskSettings)this.maskSettings[e].render()}},{key:"removeWater",value:function(e){this.maskSettings[e]&&(this.maskSettings[e].remove(),delete this.maskSettings[e],this.isDebug&&console.log("after delete #",Object.keys(this.maskSettings)),this.nameCnt=0,this.isModified=!0)}}]),t}(u.MaskManager),h=c;t.default=h,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(c,"WaterManager","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/water/WaterManager.js"),__REACT_HOT_LOADER__.register(h,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/water/WaterManager.js"))}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),l=r(2),u=r(56),c=function(e){return e&&e.__esModule?e:{default:e}}(u),h=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.isShown=e.show,r.sceneNode=e.sceneNode,r.scene=e.scene,r.renderer=e.renderer,r.camera=e.camera,r.createDefault=e.createDefault,r.normalTex=e.normalTex,r.dynamic_water=null,r.aMeshMirror=null,r.isDebug=!1,r._speed=1,r._lastUpdateTime=null,r.water_properties={},r._setOrthoProperties(),r.default_properties={level:.5*(r.water_properties.max_level+r.water_properties.min_level),alpha:.9,color:2138762,wave:.2*r.water_properties.max_wave},r.manager.default_properties=r.default_properties,r.setPropoerties(),r._initLighting(),r.card_item=null,r.card_header=null,r}return o(t,e),a(t,[{key:"_setOrthoProperties",value:function(){this.water_properties.width=this.orthoInfo.max_bound.x-this.orthoInfo.min_bound.x,this.water_properties.height=this.orthoInfo.max_bound.z-this.orthoInfo.min_bound.z,this.water_properties.max_level=this.orthoInfo.max_bound.y,this.water_properties.min_level=this.orthoInfo.min_bound.y,this.water_properties.position=this.info.origin.clone().add(this.info.min_bound.clone().add(this.info.max_bound).multiplyScalar(.5)),this.water_properties.max_wave=Math.max(this.water_properties.width,this.water_properties.height)/100,this.water_properties.min_wave=0,this.water_properties.max_area=this.water_properties.width*this.water_properties.height}},{key:"setPropoerties",value:function(e){e?(this.water_properties.level=e.level,this.water_properties.color=e.color,this.water_properties.alpha=e.alpha,this.water_properties.wave=e.wave):(this.water_properties.level=this.default_properties.level,this.water_properties.color=this.default_properties.color,this.water_properties.alpha=this.default_properties.alpha,this.water_properties.wave=this.default_properties.wave)}},{key:"_initLighting",value:function(){if(this.directionalLight_water)return void console.warn("directionalLight_water already initialized");this.directionalLight_water=new s.DirectionalLight(16777045,1);var e=Math.max(this.water_properties.width,this.water_properties.height);this.directionalLight_water.position.set(-.2*e,.5*e,.2*e),this.directionalLight_water.position.add(this.water_properties.position)}},{key:"initMask",value:function(e,t){var r=this,n=function(){r.setPropoerties(e.property),r.createWaterTex(r.curMaskRGB),r.isDebug&&console.log("donwload water property",r.water_properties),t&&t()},i=function(){r.createDefault&&r.resetMask(t)};r.init(e,n,i)}},{key:"createWaterTex",value:function(e){var t=this.maskToTexture(e);this._createWaterMesh(this.normalTex,t)}},{key:"updateWaterTex",value:function(e){var t=this.maskToTexture(e);this.dynamic_water.setMask(t),this.aMeshMirror.material=this.dynamic_water.material,this.show()}},{key:"resetMask",value:function(e){var t=this;this.reset(function(r){t.dynamic_water?t.updateWaterTex(r):t.createWaterTex(r),e&&e(t)},"black")}},{key:"_createWaterMesh",value:function(e,t){var r=this,n=e;n.wrapS=n.wrapT=s.RepeatWrapping;var i={textureWidth:r.mask_size,textureHeight:r.mask_size,waterNormals:n,alpha:r.water_properties.alpha,sunDirection:new s.Vector3(-1,1,2).normalize(),sunColor:16777215,waterColor:r.water_properties.color,betaVersion:0,side:s.FrontSide,distortionScale:0,noiseScale:r.water_properties.wave,eye:r.camera.matrixWorld,cropMask:t,time:10};r.isDebug&&console.log("creater water properties",i),r.dynamic_water=new c.default(r.renderer,r.camera,r.scene,i),r.aMeshMirror=new s.Mesh(new s.PlaneBufferGeometry(r.water_properties.width,r.water_properties.height,10,10),r.dynamic_water.material),r.aMeshMirror.add(r.dynamic_water);var o=this.info.origin.clone().add(this.info.min_bound.clone().add(this.info.max_bound).multiplyScalar(.5)),a=this.info.origin.z+this.water_properties.level;o.setZ(a),r.aMeshMirror.position.copy(o),r.sceneNode.add(r.aMeshMirror),r.aMeshMirror.visible=r.isShown,r.dynamic_water.updateMatrixWorld(),r.directionalLight_water.target=r.dynamic_water,r.render()}},{key:"render",value:function(){var e=this;if(e.dynamic_water&&e.renderer){var t=(new Date).getTime(),r=0;r=this._lastUpdateTime?t-this._lastUpdateTime:1,e.dynamic_water.material.uniforms.time.value+=this.speed*r/2e3,e.dynamic_water.material.needsUpdate=!0,e.dynamic_water.render(),this._lastUpdateTime=t}}},{key:"show",value:function(){null!=this.aMeshMirror&&(this.aMeshMirror.visible=!0)}},{key:"hide",value:function(){null!=this.aMeshMirror&&(this.aMeshMirror.visible=!1)}},{key:"apply",value:function(e){var t=this,r=this.polygons;this.applyPolygon(r,function(){t.updateWaterTex(t.curMaskRGB)})}},{key:"updateMaskInfo",value:function(){l.MaskSetting.prototype.updateMaskInfo.call(this),this.maskInfo.property={level:this.water_properties.level,alpha:this.water_properties.alpha,color:this.water_properties.color,wave:this.water_properties.wave}}},{key:"active",value:function(){this.card_item&&(this.isDebug&&console.log("active ",this.maskId),this.card_item.addClass("water-active"))}},{key:"deactive",value:function(){this.card_item&&(this.isDebug&&console.log("deactive ",this.maskId),this.card_item.removeClass("water-active"))}},{key:"remove",value:function(){l.MaskSetting.prototype.remove.call(this),this.card_item&&this.card_item.remove(),this.sceneNode.remove(this.aMeshMirror)}},{key:"getWater",value:function(){return this.dynamic_water}},{key:"levelRange",get:function(){return this.water_properties.max_level-this.water_properties.min_level}},{key:"level",set:function(e){this.water_properties.level=e,this.aMeshMirror&&this.aMeshMirror.position.setY(this.water_properties.level)},get:function(){return this.water_properties.level}},{key:"minLevel",get:function(){return this.water_properties.min_level}},{key:"maxLevel",get:function(){return this.water_properties.max_level}},{key:"alpha",set:function(e){this.water_properties.alpha=e,this.dynamic_water&&(this.dynamic_water.material.uniforms.alpha.value=this.water_properties.alpha)},get:function(){return this.water_properties.alpha}},{key:"color",set:function(e){this.isDebug&&console.log("set color",e),this.water_properties.color=e,this.dynamic_water&&(this.dynamic_water.material.uniforms.waterColor.value=new s.Color(e))},get:function(){return this.water_properties.color}},{key:"wave",set:function(e){this.water_properties.wave=e,this.dynamic_water&&(this.dynamic_water.material.uniforms.noiseScale.value=this.water_properties.wave)}},{key:"wavePercent",set:function(e){this.water_properties.wave=e*(this.water_properties.max_wave-this.water_properties.min_wave)+this.water_properties.min_wave,this.dynamic_water&&(this.dynamic_water.material.uniforms.noiseScale.value=this.water_properties.wave),this.isDebug&&console.log("set wave ",this.water_properties.wave)},get:function(){return(this.water_properties.wave-this.water_properties.min_wave)/(this.water_properties.max_wave-this.water_properties.min_wave)}},{key:"speed",set:function(e){(e<=0||e>1e4)&&console.warn("Invalid water speed",e),this._speed=e},get:function(){return this._speed}},{key:"center",get:function(){console.warn("WaterSetting::center not defined.")}}]),t}(l.MaskSetting),d=h;t.default=d,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(h,"WaterSetting","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/water/WaterSetting.js"),__REACT_HOT_LOADER__.register(d,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/marker/water/WaterSetting.js"))}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),l=r(12),u={uniforms:{bumpMapUsed:{type:"f",value:0},bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1},bumpMapPath:{value:null},normalMapUsed:{type:"f",value:0},normalMap:{type:"t",value:null},normalScale:{type:"v2",value:[1,1]},normalMapPath:{value:null},displacementMapUsed:{type:"f",value:0},displacementMap:{type:"t",value:null},displacementScale:{type:"f",value:0},displacementBias:{type:"f",value:0},displacementMapPath:{value:null},ka:{type:"v3",value:[.2,.2,.2]},mapKaUsed:{type:"f",value:0},mapKa:{type:"t",value:null},mapKaPath:{value:null},mapKaWidth:{type:"f",value:1},mapKaHeight:{type:"f",value:1},kd:{type:"v3",value:[.1,.1,1]},mapKdUsed:{type:"f",value:0},mapKd:{type:"t",value:null},mapKdPath:{value:null},mapKdWidth:{type:"f",value:1},mapKdHeight:{type:"f",value:1},ks:{type:"v3",value:[1,.1,.1]},mapKsUsed:{type:"f",value:0},mapKs:{type:"t",value:null},mapKsPath:{value:null},mapKsWidth:{type:"f",value:1},mapKsHeight:{type:"f",value:1},ns:{type:"f",value:20},d:{type:"f",value:1},MatcapTextureUsed:{type:"f",value:0},MatcapTexture:{type:"t",value:null},MatcapTexturePath:{value:null},fraction:{type:"v3",value:[1,1,1]}},vertexShader:"\nvarying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vViewPosition;\n"+l.SelfShaderChunks.DisplacementMapPositionCalculation_vertex+"\nvoid main()\n{\n  // passing texture to fragment shader\n  vUv = uv;\n  vNormal = normalize(normalMatrix * normal);\n  vViewPosition = -(modelViewMatrix * vec4(position, 1.0)).xyz;\n\n  vec3 transformedPosition = position + displacementMapOffset(normal, uv);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(transformedPosition,1.0);\n}\n",fragmentShader:"\n#define USE_BUMPMAP\n#define USE_NORMALMAP\nvarying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vViewPosition;\n\nuniform sampler2D MatcapTexture;\nuniform float MatcapTextureUsed;\n\nuniform float bumpMapUsed;\nuniform float normalMapUsed;\n\nuniform vec3 fraction;\n"+s.ShaderChunk.bumpmap_pars_fragment+s.ShaderChunk.normalmap_pars_fragment+"\nvoid main() {\n  vec3 modelPosition = -vViewPosition;\n  vec3 treatedNormal = normalize(vNormal);\n  if(bumpMapUsed>0.5)treatedNormal = perturbNormalArb(modelPosition, treatedNormal, dHdxy_fwd());\n  if(normalMapUsed>0.5)treatedNormal = perturbNormal2Arb( modelPosition, treatedNormal );\n  vec3 r = reflect(treatedNormal, normalize(modelPosition));\n  float m = 2.0 * sqrt(pow(r.x,2.0)+pow(r.y,2.0)+pow(r.z+1.5,2.0));\n  vec2 matcapuv = r.xy / m + 0.5;  \n\n  vec3 base = fraction;\n  if(MatcapTextureUsed > 0.5){\n    base *= texture2D(MatcapTexture, matcapuv).rgb;\n  }\n\n  gl_FragColor = vec4(base,1.0);\n}\n"},c=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.uniforms=JSON.parse(JSON.stringify(u.uniforms)),r.vertexShader=u.vertexShader,r.fragmentShader=u.fragmentShader,r.transparent=!0,r.extensions.derivatives=!0,r.description={},r.description.type="MTLMatcapShaderMaterial",r.loadMTLOptions(e),r}return o(t,e),a(t,[{key:"loadMTLOptions",value:function(e){if(null!==e&&void 0!==e&&Object.keys(e).length>0){this.name=e.name,this.description.name=e.name;var t=e.bump;void 0!==t&&null!==t&&(this._loadTexture(t,this.uniforms.bumpMap,this.uniforms.bumpMapUsed,this.uniforms.bumpMapPath),this.description.bump=t);var r=e.MatcapTexturePath;void 0!==r&&null!==r&&(this._loadTexture(r,this.uniforms.MatcapTexture,this.uniforms.MatcapTextureUsed,this.uniforms.MatcapTexturePath),this.description.MatcapTexturePath=r),e.fraction&&(this.uniforms.fraction.value=e.fraction,this.description.fraction=e.fraction)}}},{key:"loadMatcapTexture",value:function(e){this._loadTexture(e,this.uniforms.MatcapTexture,this.uniforms.MatcapTextureUsed,this.uniforms.MatcapTexturePath),this.description.MatcapTexturePath=e}},{key:"_loadTexture",value:function(e,t,r,n){if(""===e)return void(r.value=0);var i=new s.TextureLoader;i.setCrossOrigin(""),i.withCredentials=!0,i.load(e,function(i){t.value=i,n.value=e,r.value=1},function(e){},function(t){console.warn("an error happened while loading "+e)})}},{key:"getMatcapTexturePath",value:function(){return{value:this.uniforms.MatcapTexturePath.value}}},{key:"setMatcapTextureFraction",value:function(e){this.uniforms.fraction.value=e,this.description.fraction=e}},{key:"getFraction",value:function(){return{value:this.array2Hex(this.uniforms.fraction.value)}}},{key:"array2Hex",value:function(e){return"#"+Math.round(255*e[0]).toString(16)+Math.round(255*e[1]).toString(16)+Math.round(255*e[2]).toString(16)}},{key:"clone",value:function(){return new this.constructor(this.description)}}]),t}(s.ShaderMaterial),h=c;t.default=h,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(u,"MatcapSelfShaderMaterialParameters","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/MTLMatcapShaderMaterial.js"),__REACT_HOT_LOADER__.register(c,"MTLMatcapShaderMaterial","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/MTLMatcapShaderMaterial.js"),__REACT_HOT_LOADER__.register(h,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/MTLMatcapShaderMaterial.js"))}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),l=r(12),u={uniforms:{bumpMapUsed:{type:"f",value:0},bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1},bumpMapPath:{value:null},normalMapUsed:{type:"f",value:0},normalMap:{type:"t",value:null},normalScale:{type:"v2",value:[1,1]},normalMapPath:{value:null},displacementMapUsed:{type:"f",value:0},displacementMap:{type:"t",value:null},displacementScale:{type:"f",value:0},displacementBias:{type:"f",value:0},displacementMapPath:{value:null},ka:{type:"v3",value:[.2,.2,.2]},mapKaUsed:{type:"f",value:0},mapKa:{type:"t",value:null},mapKaPath:{value:null},mapKaWidth:{type:"f",value:1},mapKaHeight:{type:"f",value:1},kd:{type:"v3",value:[.1,.1,1]},mapKdUsed:{type:"f",value:0},mapKd:{type:"t",value:null},mapKdPath:{value:null},mapKdWidth:{type:"f",value:1},mapKdHeight:{type:"f",value:1},ks:{type:"v3",value:[1,.1,.1]},mapKsUsed:{type:"f",value:0},mapKs:{type:"t",value:null},mapKsPath:{value:null},mapKsWidth:{type:"f",value:1},mapKsHeight:{type:"f",value:1},ns:{type:"f",value:20},d:{type:"f",value:1},perceptualRoughness:{type:"f",value:1},metallic:{type:"f",value:0},f0:{type:"v3",value:[.04,.04,.04]},baseColorPercentage:{type:"f",value:100}},vertexShader:"\nvarying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vViewPosition;\n"+l.SelfShaderChunks.DisplacementMapPositionCalculation_vertex+s.ShaderChunk.common+s.ShaderChunk.bsdfs+s.ShaderChunk.lights_pars+"\nvoid main(){\n  vUv = uv;\n  vNormal = normalize(normalMatrix * normal);\n  vViewPosition = -(modelViewMatrix * vec4(position, 1.0)).xyz;\n  vec3 transformedPosition = position + displacementMapOffset(normal, uv);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(transformedPosition, 1.0);\n}\n",fragmentShader:"\n#define USE_BUMPMAP\n#define USE_NORMALMAP\nvarying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vViewPosition;\n\nuniform float perceptualRoughness;\nuniform float metallic;\nuniform vec3 f0;\nuniform float baseColorPercentage;\n\nuniform float bumpMapUsed;\nuniform float normalMapUsed;\n\nuniform vec3 ka;\nuniform float mapKaUsed;\nuniform sampler2D mapKa;\nuniform vec3 kd;\nuniform float mapKdUsed;\nuniform sampler2D mapKd;\nuniform vec3 ks;\nuniform float mapKsUsed;\nuniform sampler2D mapKs;\nuniform float ns;\nuniform float d;\n"+s.ShaderChunk.common+s.ShaderChunk.bsdfs+s.ShaderChunk.lights_pars+s.ShaderChunk.bumpmap_pars_fragment+s.ShaderChunk.normalmap_pars_fragment+"\n#define minRoughness 0.04\n\nvec3 F_Schlick2(vec3 specularColor, float VdotH)\n{\n  float maxColor = max(max(specularColor.r, specularColor.g), specularColor.b);\n  vec3 r90 = vec3(1.0) * maxColor;\n  return specularColor + (r90 - specularColor) * pow(1.0 - VdotH, 5.0);\n}\n\n// Simplified implementation of fresnel from “An Inexpensive BRDF Model for Physically based Rendering” by Christophe Schlick\nvec3 F_Schlick3(float metalness, float VdotH)\n{\n  return metalness + (vec3(1.0) - metalness) * pow(1.0 - VdotH, 5.0);\n}\n\n// The following equations model the geometric occlusion term of the spec equation  (aka G())\n// Implementation from “A Reflectance Model for Computer Graphics” by Robert Cook and Kenneth Torrance,\nfloat geometricOcclusionCookTorrance(float NdotV, float NdotH, float VdotH, float NdotL)\n{\n  return min(min(2.0 * NdotV * NdotH / VdotH, 2.0 * NdotL * NdotH / VdotH), 1.0);\n}\n\n// implementation of microfacet occlusion from “An Inexpensive BRDF Model for Physically based Rendering” by Christophe Schlick\nfloat geometricOcclusionSchlick(float roughness, float LdotH, float NdotH)\n{\n  float k = roughness * 0.79788; // 0.79788 = sqrt(2.0/3.1415);\n  // alternately, k can be defined with\n  // float k = (roughness + 1) * (roughness + 1) / 8;\n\n  float l = LdotH / (LdotH * (1.0 - k) + k);\n  float n = NdotH / (NdotH * (1.0 - k) + k);\n  return l * n;\n}\n\n// the following Smith implementations are from “Geometrical Shadowing of a Random Rough Surface” by Bruce G. Smith\nfloat geometricOcclusionSmith(float roughness2, float NdotL, float NdotV)\n{\n  float NdotL2 = NdotL * NdotL;\n  float NdotV2 = NdotV * NdotV;\n  float v = ( -1.0 + sqrt ( roughness2 * (1.0 - NdotL2 ) / NdotL2 + 1.)) * 0.5;\n  float l = ( -1.0 + sqrt ( roughness2 * (1.0 - NdotV2 ) / NdotV2 + 1.)) * 0.5;\n  return (1.0 / max((1.0 + v + l ), 0.000001));\n}\n\nfloat SmithG1_var2(float NdotV, float r)\n{\n  float tanSquared = (1.0 - NdotV * NdotV) / max((NdotV * NdotV), 0.00001);\n  return 2.0 / (1.0 + sqrt(1.0 + r * r * tanSquared));\n}\n\nfloat SmithG1(float NdotV, float r)\n{\n  return 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n}\n\nfloat geometricOcclusionSmithGGX(float roughness2, float NdotL, float NdotV)\n{\n  return SmithG1_var2(NdotL, roughness2) * SmithG1_var2(NdotV, roughness2);\n}\n\n// The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\n// implementation from “Average Irregularity Representation of a Roughened Surface for Ray Reflection” by T. S. Trowbridge, and K. P. Reitz\nfloat GGX(float roughness2, float NdotH)\n{\n  float roughness4 = roughness2 * roughness2;\n  float f = (NdotH * roughness4 - NdotH) * NdotH + 1.0;\n  return roughness4 * RECIPROCAL_PI / (f * f);\n}\n\nvec3 getDiffuse(vec3 N, vec3 L, vec3 lightColor, vec3 diffuseColor){\n  float NdotL = saturate(dot(N, L));\n  return NdotL * lightColor * diffuseColor;\n}\n\nvec3 getSpecular(vec3 N, vec3 L, vec3 V, vec3 H, vec3 lightColor, vec3 specularColor, float roughness){\n  float roughness2 = pow(roughness, 2.0);\n  float NdotL = saturate(dot(N, L));\n  float NdotV = saturate(dot(N, V));\n  float NdotH = saturate(dot(N, H));\n  float LdotH = saturate(dot(L, H));\n  float VdotH = saturate(dot(V, H));\n  // vec3 F = F_Schlick( specularColor, LdotH );\n  vec3 F = F_Schlick2(specularColor, VdotH);\n  // vec3 F = F_Schlick3(metalness, VdotH);\n  // float G = G_GGX_SmithCorrelated( roughness2, NdotL, NdotV );\n  float G = geometricOcclusionSmithGGX(roughness2, NdotL, NdotV);\n  // float G = geometricOcclusionSmith(roughness2, NdotL, NdotV);\n  // float G = geometricOcclusionSchlick(roughness, LdotH, NdotH);\n  // float G = geometricOcclusionCookTorrance(NdotV, NdotH, VdotH, NdotL);\n  // float D = D_GGX( roughness2, NdotH );\n  float D = GGX(roughness2, NdotH);\n  return NdotL * lightColor * F * G * D;\n}\n\nvoid main(){\n  vec3 modelPosition = -vViewPosition;\n  vec3 N = normalize(vNormal);\n  if(bumpMapUsed>0.5)N=perturbNormalArb(modelPosition, N, dHdxy_fwd());\n  if(normalMapUsed>0.5)N = perturbNormal2Arb( modelPosition, N );\n  vec3 V = normalize(cameraPosition - modelPosition);\n\n  vec3 diffuseResultColor = vec3(0.0);\n  vec3 specularResultColor = vec3(0.0);\n  vec3 diffuseColor = kd;\n  if(mapKdUsed>0.5)diffuseColor *= texture2D(mapKd, vUv).rgb;\n  diffuseColor *= baseColorPercentage / 100.0;\n  float roughness = clamp(perceptualRoughness, minRoughness, 1.0);\n  float metal = clamp(metallic, 0.0, 1.0);\n  vec3 backGroundColor = mix(diffuseColor, vec3(0.04, 0.04, 0.04), 0.6);\n  vec3 specularColor = mix(f0, diffuseColor, metal);\n  diffuseColor = mix(diffuseColor, backGroundColor, metal);\n\n  #if NUM_POINT_LIGHTS > 0\n    for(int i=0;i<NUM_POINT_LIGHTS;++i){\n      vec3 L = normalize(pointLights[i].position - modelPosition);\n      vec3 H = normalize(V+L);\n      diffuseResultColor += getDiffuse(N, L, pointLights[i].color, diffuseColor);\n      specularResultColor += getSpecular(N, L, V, H, pointLights[i].color, specularColor, roughness);\n    }\n  #endif\n  #if NUM_DIR_LIGHTS > 0\n    for(int i=0;i<NUM_DIR_LIGHTS;++i){\n      vec3 L = normalize(directionalLights[i].direction);\n      vec3 H = normalize(V+L);\n      diffuseResultColor += getDiffuse(N, L, directionalLights[i].color, diffuseColor);\n      specularResultColor += getSpecular(N, L, V, H, directionalLights[i].color, specularColor, roughness);\n    }\n  #endif\n  diffuseResultColor += diffuseColor * RECIPROCAL_PI; // indirect diffuse color\n\n  vec3 color = vec3(0.0);\n  color += diffuseResultColor;\n  color += specularResultColor;\n\n  gl_FragColor = vec4(color, d);\n}\n"},c=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),o=JSON.parse(JSON.stringify(u.uniforms));return r.uniforms=s.UniformsUtils.merge([s.UniformsLib.lights,o]),r.vertexShader=u.vertexShader,r.fragmentShader=u.fragmentShader,r.transparent=!0,r.extensions.derivatives=!0,r.lights=!0,r.description={},r.description.type="MTLPBRShaderMaterial",r.loadMTLOptions(e),r}return o(t,e),a(t,[{key:"loadMTLOptions",value:function(e){if(void 0!==e&&null!==e&&Object.keys(e).length>0){if(this.name=e.name,this.description.name=e.name,e.ka&&(this.uniforms.ka.value=e.ka,this.description.ka=e.ka),e.kd&&(this.uniforms.kd.value=e.kd,this.description.kd=e.kd),e.ks&&(this.uniforms.ks.value=e.ks,this.description.ks=e.ks),e.ns){var t=l.SelfHelperFunctions.getFloatStringPair(e.ns);t&&(this.uniforms.ns.value=t.f,this.description.ns=t.s)}if(e.d){var r=l.SelfHelperFunctions.getFloatStringPair(e.ns);r&&(this.uniforms.d.value=r.f,this.description.d=r.s)}var n=e.bump,i=e.map_kd;if(void 0!==i&&null!==i&&(this._loadTexture(i,this.uniforms.mapKd,this.uniforms.mapKdUsed,this.uniforms.mapKdPath,this.uniforms.mapKdWidth,this.uniforms.mapKdHeight),this.description.map_kd=i),void 0!==n&&null!==n&&(this._loadTexture(n,this.uniforms.bumpMap,this.uniforms.bumpMapUsed,this.uniforms.bumpMapPath),this.description.bump=n),e.metallic){var o=l.SelfHelperFunctions.getFloatStringPair(e.metallic);o&&(this.uniforms.metallic.value=o.f,this.description.metallic=o.s)}if(e.perceptualRoughness){var a=l.SelfHelperFunctions.getFloatStringPair(e.perceptualRoughness);a&&(this.uniforms.perceptualRoughness.value=a.f,this.description.perceptualRoughness=a.s)}if(e.f0&&(this.uniforms.f0.value=e.f0,this.description.f0=e.f0),e.baseColorPercentage){var s=l.SelfHelperFunctions.getFloatStringPair(e.baseColorPercentage);s&&(this.uniforms.baseColorPercentage.value=s.f,this.description.baseColorPercentage=s.s)}}}},{key:"_loadTexture",value:function(e,t,r,n,i,o){if(""===e)return void(r.value=0);var a=new s.TextureLoader;a.setCrossOrigin("anonymous"),a.withCredentials=!0,a.load(e,function(a){t.value=a,i&&(i.value=parseFloat(a.image.width)),o&&(o.value=parseFloat(a.image.height)),n.value=e,r.value=1},function(e){},function(t){console.warn("an error happened while loading "+e)})}},{key:"setMetallic",value:function(e){var t=l.SelfHelperFunctions.getFloatStringPair(e);t&&(this.uniforms.metallic.value=t.f,this.description.metallic=t.s)}},{key:"setRoughness",value:function(e){var t=l.SelfHelperFunctions.getFloatStringPair(e);t&&(this.uniforms.perceptualRoughness.value=t.f,this.description.perceptualRoughness=t.s)}},{key:"setSpecularF0",value:function(e){this.uniforms.f0.value=e,this.description.f0=e}},{key:"setBaseColor",value:function(e){this.uniforms.kd.value=e.slice(0,3),this.description.kd=e.slice(0,3)}},{key:"setBaseColorTexture",value:function(e){this._loadTexture(e,this.uniforms.mapKd,this.uniforms.mapKdUsed,this.uniforms.mapKdPath,this.uniforms.mapKdWidth,this.uniforms.mapKdHeight),this.description.map_kd=e}},{key:"setBaseColorPercentage",value:function(e){var t=l.SelfHelperFunctions.getFloatStringPair(e);t&&(this.uniforms.baseColorPercentage.value=t.f,this.description.baseColorPercentage=t.s)}},{key:"getMetallic",value:function(){return{value:this.uniforms.metallic.value}}},{key:"getRoughness",value:function(){return{value:this.uniforms.perceptualRoughness.value}}},{key:"getSpecularF0",value:function(){return{value:this.uniforms.f0.value}}},{key:"getBaseColor",value:function(){return{color:this.array2Hex(this.uniforms.kd.value),textureUsed:this.uniforms.mapKdUsed.value,texturePath:this.uniforms.mapKdPath.value,percentage:this.uniforms.baseColorPercentage.value}}},{key:"array2Hex",value:function(e){return"#"+Math.round(255*e[0]).toString(16)+Math.round(255*e[1]).toString(16)+Math.round(255*e[2]).toString(16)}},{key:"clone",value:function(){return new this.constructor(this.description)}}]),t}(s.ShaderMaterial),h=c;t.default=h,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(u,"MTLPBRShaderMaterialParameters","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/MTLPBRShaderMaterial.js"),__REACT_HOT_LOADER__.register(c,"MTLPBRShaderMaterial","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/MTLPBRShaderMaterial.js"),__REACT_HOT_LOADER__.register(h,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/MTLPBRShaderMaterial.js"))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(59),s=n(a),l=r(11),u=n(l),c=r(60),h=n(c),d=r(63),f=n(d),p=r(62),m=n(p),v=function(){function e(){i(this,e),this.materials={mtlmatcapshadermaterial:s.default,mtlphongshadermaterial:u.default,mtlpbrshadermaterial:h.default,suggestivecontoursshadermaterial:f.default},this.setObjectMaterial=this.setObjectMaterial.bind(this)}return o(e,[{key:"setObjectMaterial",value:function(e,t,r){var n=this.materials[t.toLowerCase()],i=[];if(r instanceof Array){if(r.map(function(t){var r=new n(t);e.changeMaterial(r),i.push(r)}),"suggestivecontoursshadermaterial"===t.toLowerCase()){var o=e.shapeHolder.children[0].children[0].children[0].children[0].geometry,a=new m.default;a.calculateForGeometry(o),e.shapeHolder.children[0].children[0].children[0].children[0].geometry=a.getBufferGeometry()}return i}console.error("[materialmanager] options error",r)}}]),e}(),g=v;t.default=g,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(v,"MaterialManager","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/MaterialManager.js"),__REACT_HOT_LOADER__.register(g,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/MaterialManager.js"))}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),s=function(){function e(){n(this,e),this.positions=null,this.faces=null,this.verticesNumber=0,this.facesNumber=0,this.pointareas=null,this.cornerareas=null,this.pdir1=null,this.pdir2=null,this.curv1=null,this.curv2=null,this.dcurv=null,this.bufferGeometry=null,this.calculated=!1}return o(e,[{key:"calculateForGeometry",value:function(e){var t=(new Date).getTime();console.log("Calculation Start..."),this.initForGeometry(e),this.compute(),this.bufferGeometry=(new a.BufferGeometry).fromGeometry(e),this.addToBufferGeometry(this.bufferGeometry),t=(new Date).getTime()-t,console.log("Calculation Done, total time (in milliseconds): ",t),this.calculated=!0}},{key:"doCurvaturesSmoothing",value:function(){if(this.calculated){for(var e=new Array(this.verticesNumber),t=new Array(this.verticesNumber),r=new Array(this.verticesNumber),n=new Array(this.verticesNumber),i=0;i<this.verticesNumber;++i)r[i]=1,n[i]=1,e[i]=this.curv1[i],t[i]=this.curv2[i];for(var o=0;o<this.facesNumber;++o){var a=this.faces[o];e[a.a]+=this.curv1[a.b]+this.curv1[a.c],e[a.b]+=this.curv1[a.a]+this.curv1[a.c],e[a.c]+=this.curv1[a.a]+this.curv1[a.b],t[a.a]+=this.curv2[a.b]+this.curv2[a.c],t[a.b]+=this.curv2[a.a]+this.curv2[a.c],t[a.c]+=this.curv2[a.a]+this.curv2[a.b],r[a.a]+=2,r[a.b]+=2,r[a.c]+=2,n[a.a]+=2,n[a.b]+=2,n[a.c]+=2}for(var s=0;s<this.verticesNumber;++s)e[s]/=r[s],t[s]/=n[s];this.curv1=e,this.curv2=t}}},{key:"getBufferGeometry",value:function(){return this.bufferGeometry}},{key:"initForGeometry",value:function(e){this.clearCalculator(),e.computeVertexNormals(!0),this.positions=e.vertices,this.faces=e.faces,this.verticesNumber=this.positions.length,this.facesNumber=this.faces.length,this.pointareas=new Array(this.verticesNumber);for(var t=0;t<this.verticesNumber;++t)this.pointareas[t]=0;this.cornerareas=new Array(this.facesNumber);for(var r=0;r<this.facesNumber;++r)this.cornerareas[r]=[0,0,0];this.pdir1=new Array(this.verticesNumber);for(var n=0;n<this.verticesNumber;++n)this.pdir1[n]=new a.Vector3;this.pdir2=new Array(this.verticesNumber);for(var i=0;i<this.verticesNumber;++i)this.pdir2[i]=new a.Vector3;this.curv1=new Array(this.verticesNumber);for(var o=0;o<this.verticesNumber;++o)this.curv1[o]=0;this.curv2=new Array(this.verticesNumber);for(var s=0;s<this.verticesNumber;++s)this.curv2[s]=0;this.dcurv=new Array(this.verticesNumber);for(var l=0;l<this.verticesNumber;++l)this.dcurv[l]=[0,0,0,0]}},{key:"compute",value:function(){this.needPointareas(),this.needCurvatures(),this.needDcurv()}},{key:"addToBufferGeometry",value:function(e){for(var t=3*this.facesNumber,r=new Float32Array(3*t),n=new Float32Array(3*t),i=new Float32Array(t),o=new Float32Array(t),s=new Float32Array(4*t),l=0;l<this.facesNumber;++l)for(var u=this.faces[l],c=0;c<3;++c){var h=u.a;0===c?h=u.a:1===c?h=u.b:2===c&&(h=u.c),r[3*l*3+3*c]=this.pdir1[h].x,r[3*l*3+3*c+1]=this.pdir1[h].y,r[3*l*3+3*c+2]=this.pdir1[h].z,n[3*l*3+3*c]=this.pdir2[h].x,n[3*l*3+3*c+1]=this.pdir2[h].y,n[3*l*3+3*c+2]=this.pdir2[h].z,i[3*l+c]=this.curv1[h],o[3*l+c]=this.curv2[h],s[3*l*4+4*c]=this.dcurv[h][0],s[3*l*4+4*c+1]=this.dcurv[h][1],s[3*l*4+4*c+2]=this.dcurv[h][2],s[3*l*4+4*c+3]=this.dcurv[h][3]}e.addAttribute("pdir1",new a.BufferAttribute(r,3)),e.addAttribute("pdir2",new a.BufferAttribute(n,3)),e.addAttribute("curv1",new a.BufferAttribute(i,1)),e.addAttribute("curv2",new a.BufferAttribute(o,1)),e.addAttribute("dcurv",new a.BufferAttribute(s,4))}},{key:"clearCalculator",value:function(){this.positions=null,this.faces=null,this.verticesNumber=0,this.facesNumber=0,this.pointareas=null,this.cornerareas=null,this.pdir1=null,this.pdir2=null,this.curv1=null,this.curv2=null,this.dcurv=null}},{key:"ldltdc",value:function(e,t){for(var r=i(e,2),n=r[0],o=r[1],a=new Array(t-1),s=0;s<t-1;s++)a[s]=0;for(var l=0;l<t;l++){for(var u=0;u<l;u++)a[u]=n[l][u]*o[u];for(var c=l;c<t;c++){for(var h=n[l][c],d=0;d<l;d++)h-=a[d]*n[c][d];if(l===c){if(h<=0)return[!1,n,o];o[l]=1/h}else n[c][l]=h}}return[!0,n,o]}},{key:"ldltsl",value:function(e,t,r,n,i){for(var o=0;o<i;o++){for(var a=r[o],s=0;s<o;s++)a-=e[o][s]*n[s];n[o]=a*t[o]}for(var l=i-1;l>=0;l--){for(var u=0,c=l+1;c<i;c++)u+=e[c][l]*n[c];n[l]-=u*t[l]}return n}},{key:"rotCoordSys",value:function(e){var t=i(e,5),r=t[0],n=t[1],o=t[2],a=t[3],s=t[4];a=r.clone(),s=n.clone();var l=r.clone().cross(n),u=l.clone().dot(o);if(u<=-1)return s=s.clone().multiplyScalar(-1),a=a.clone().multiplyScalar(-1),[r,n,o,a,s];var c=o.clone().sub(l.clone().multiplyScalar(u)),h=l.clone().add(o.clone()).multiplyScalar(1/(1+u));return a=a.clone().sub(h.clone().multiplyScalar(a.clone().dot(c))),s=s.clone().sub(h.clone().multiplyScalar(s.clone().dot(c))),[r,n,o,a,s]}},{key:"projCurv",value:function(e,t,r,n,o){var s=i(e,2),l=s[0],u=s[1],c=i(o,5),h=c[0],d=c[1],f=c[2],p=c[3],m=c[4],v=new a.Vector3,g=new a.Vector3,y=this.rotCoordSys([h,d,l.clone().cross(u),v,g]);h=y[0],d=y[1],v=y[3],g=y[4];var b=v.clone().dot(l),_=v.clone().dot(u),w=g.clone().dot(l),x=g.clone().dot(u);return f=t*b*b+r*(2*b*_)+n*_*_,p=t*b*w+r*(b*x+w*_)+n*_*x,m=t*w*w+r*(2*w*x)+n*x*x,[l,u,h,d,f,p,m]}},{key:"projDcurv",value:function(e,t,r){var n,o,a=i(e,2),s=a[0],l=a[1],u=i(r,3),c=u[0],h=u[1],d=u[2],f=this.rotCoordSys([c,h,s.clone().cross(l),n,o]);c=f[0],h=f[1],n=f[3],o=f[4];var p=n.clone().dot(s),m=n.clone().dot(l),v=o.clone().dot(s),g=o.clone().dot(l);return d[0]=t[0]*p*p*p+3*t[1]*p*p*m+3*t[2]*p*m*m+t[3]*m*m*m,d[1]=t[0]*p*p*v+t[1]*(p*p*g+2*v*p*m)+t[2]*(v*m*m+2*p*m*g)+t[3]*m*m*g,d[2]=t[0]*p*v*v+t[1]*(v*v*m+2*p*v*g)+t[2]*(p*g*g+2*v*g*m)+t[3]*m*g*g,d[3]=t[0]*v*v*v+3*t[1]*v*v*g+3*t[2]*v*g*g+t[3]*g*g*g,[s,l,c,h,d]}},{key:"diagonalizeCurv",value:function(e,t,r,n,o){var a,s,l=i(e,2),u=l[0],c=l[1],h=i(o,5),d=h[0],f=h[1],p=h[2],m=h[3],v=h[4],g=this.rotCoordSys([u,c,d,a,s]),y=i(g,5);u=y[0],c=y[1],d=y[2],a=y[3],s=y[4];var b=1,_=0,w=0;if(0!==r){var x=.5*(n-t)/r;w=x<0?1/(x-Math.sqrt(1+x*x)):1/(x+Math.sqrt(1+x*x)),b=1/Math.sqrt(1+w*w),_=w*b}if(m=t-w*r,v=n+w*r,Math.abs(m)>=Math.abs(v))f=a.clone().multiplyScalar(b).sub(s.clone().multiplyScalar(_));else{var M=m;m=v,v=M,f=a.clone().multiplyScalar(_).add(s.clone().multiplyScalar(b))}return p=d.clone().cross(f),[u,c,d,f,p,m,v]}},{key:"needCurvatures",value:function(){console.log("Computing curvatures...");for(var e=new Array(this.verticesNumber),t=0;t<this.verticesNumber;++t)e[t]=0;for(var r=0;r<this.facesNumber;++r){var n=this.faces[r];this.pdir1[n.a]=this.positions[n.b].clone().sub(this.positions[n.a]),this.pdir1[n.b]=this.positions[n.c].clone().sub(this.positions[n.b]),this.pdir1[n.c]=this.positions[n.a].clone().sub(this.positions[n.c])}for(var i=0;i<this.facesNumber;++i){var o=this.faces[i],a=o.vertexNormals[0],s=o.vertexNormals[1],l=o.vertexNormals[2];this.pdir1[o.a]=this.pdir1[o.a].clone().cross(a),this.pdir1[o.a].normalize(),this.pdir2[o.a]=a.clone().cross(this.pdir1[o.a]),this.pdir1[o.b]=this.pdir1[o.b].clone().cross(s),this.pdir1[o.b].normalize(),this.pdir2[o.b]=s.clone().cross(this.pdir1[o.b]),this.pdir1[o.c]=this.pdir1[o.c].clone().cross(l),this.pdir1[o.c].normalize(),this.pdir2[o.c]=l.clone().cross(this.pdir1[o.c])}for(var u=0;u<this.facesNumber;++u){var c=this.faces[u],h=[this.positions[c.c].clone().sub(this.positions[c.b]),this.positions[c.a].clone().sub(this.positions[c.c]),this.positions[c.b].clone().sub(this.positions[c.a])],d=h[0];d.normalize();var f=h[0].clone().cross(h[1]),p=f.clone().cross(d);p.normalize();for(var m=[0,0,0],v=[[0,0,0],[0,0,0],[0,0,0]],g=0;g<3;++g){var y=h[g].clone().dot(d),b=h[g].clone().dot(p);v[0][0]+=y*y,v[0][1]+=y*b,v[2][2]+=b*b;var _=g>0?g-1:g+2,w=g<2?g+1:g-2,x=c.vertexNormals[_].clone().sub(c.vertexNormals[w]),M=x.clone().dot(d),E=x.clone().dot(p);m[0]+=M*y,m[1]+=M*b+E*y,m[2]+=E*b}v[1][1]=v[0][0]+v[2][2],v[1][2]=v[0][1];var A,T=[0,0,0],k=this.ldltdc([v,T],3);if(A=k[0],v=k[1],T=k[2],A){var S=[m[0],m[1],m[2]];m=this.ldltsl(v,T,S,m,3);for(var C=0;C<3;++C){var P=c.a;0===C?P=c.a:1===C?P=c.b:2===C&&(P=c.c);var O=0,R=0,L=0,I=this.pdir1[P].clone(),B=this.pdir2[P].clone(),D=this.projCurv([d,p],m[0],m[1],m[2],[I,B,O,R,L]);d=D[0],p=D[1],I=D[2],B=D[3],O=D[4],R=D[5],L=D[6],this.pdir1[P]=I,this.pdir2[P]=B;var j=this.cornerareas[u][C]/this.pointareas[P];this.curv1[P]+=j*O,e[P]+=j*R,this.curv2[P]+=j*L}}else console.log("Fail to ldltdc!")}for(var z=0;z<this.facesNumber;++z)for(var N=this.faces[z],U=0;U<3;++U){var F=N.vertexNormals[U],H=N.a;0===U?H=N.a:1===U?H=N.b:2===U&&(H=N.c);var V=this.diagonalizeCurv([this.pdir1[H],this.pdir2[H]],this.curv1[H],e[H],this.curv2[H],[F,this.pdir1[H],this.pdir2[H],this.curv1[H],this.curv2[H]]);this.pdir1[H]=V[0],this.pdir2[H]=V[1],F=V[2],this.pdir1[H]=V[3],this.pdir2[H]=V[4],this.curv1[H]=V[5],this.curv2[H]=V[6]}console.log("Done...")}},{key:"needDcurv",value:function(){console.log("Computing dcurv...");for(var e=0;e<this.facesNumber;++e){var t=this.faces[e],r=[this.positions[t.c].clone().sub(this.positions[t.b]),this.positions[t.a].clone().sub(this.positions[t.c]),this.positions[t.b].clone().sub(this.positions[t.a])],n=r[0];n.normalize();var i=r[0].clone().cross(r[1]),o=i.clone().cross(n);o.normalize();for(var a=[[0,0,0],[0,0,0],[0,0,0]],s=0;s<3;++s){var l=t.a;0===s?l=t.a:1===s?l=t.b:2===s&&(l=t.c);var u=this.projCurv([this.pdir1[l],this.pdir2[l]],this.curv1[l],0,this.curv2[l],[n,o,a[s][0],a[s][1],a[s][2]]);this.pdir1[l]=u[0],this.pdir2[l]=u[1],n=u[2],o=u[3],a[s][0]=u[4],a[s][1]=u[5],a[s][2]=u[6]}for(var c=[0,0,0,0],h=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],d=0;d<3;++d){for(var f=d>0?d-1:d+2,p=d<2?d+1:d-2,m=[0,0,0],v=0;v<3;++v)m[v]=a[f][v]-a[p][v];var g=r[d].clone().dot(n),y=r[d].clone().dot(o),b=g*g,_=y*y,w=g*y;h[0][0]+=b,h[0][1]+=w,h[3][3]+=_,c[0]+=g*m[0],c[1]+=y*m[0]+2*g*m[1],c[2]+=2*y*m[1]+g*m[2],c[3]+=y*m[2]}h[1][1]=2*h[0][0]+h[3][3],h[1][2]=2*h[0][1],h[2][2]=h[0][0]+2*h[3][3],h[2][3]=h[0][1];var x,M=[0,0,0,0],E=this.ldltdc([h,M],4);if(x=E[0],h=E[1],M=E[2],x){var A=[c[0],c[1],c[2],c[3]];c=this.ldltsl(h,M,A,c,4);for(var T=[c[0],c[1],c[2],c[3]],k=0;k<3;++k){var S=t.a;0===k?S=t.a:1===k?S=t.b:2===k&&(S=t.c);var C=[0,0,0,0],P=this.projDcurv([n,o],T,[this.pdir1[S],this.pdir2[S],C]);n=P[0],o=P[1],this.pdir1[S]=P[2],this.pdir2[S]=P[3],C=P[4];for(var O=this.cornerareas[e][k]/this.pointareas[S],R=0;R<4;++R)this.dcurv[S][R]+=O*C[R]}}else console.log("Fail to ldltdc!")}console.log("Done...")}},{key:"needPointareas",value:function(){console.log("Computing pointareas...");for(var e=0;e<this.facesNumber;++e){var t=this.faces[e],r=[this.positions[t.c].clone().sub(this.positions[t.b]),this.positions[t.a].clone().sub(this.positions[t.c]),this.positions[t.b].clone().sub(this.positions[t.a])],n=.5*r[0].clone().cross(r[1]).length(),i=[r[0].clone().lengthSq(),r[1].clone().lengthSq(),r[2].clone().lengthSq()],o=[i[0]*(i[1]+i[2]-i[0]),i[1]*(i[2]+i[0]-i[1]),i[2]*(i[0]+i[1]-i[2])];if(o[0]<=0)this.cornerareas[e][1]=-.25*i[2]*n/r[0].clone().dot(r[2]),this.cornerareas[e][2]=-.25*i[1]*n/r[0].clone().dot(r[1]),this.cornerareas[e][0]=n-this.cornerareas[e][1]-this.cornerareas[e][2];else if(o[1]<=0)this.cornerareas[e][2]=-.25*i[0]*n/r[1].clone().dot(r[0]),this.cornerareas[e][0]=-.25*i[2]*n/r[1].clone().dot(r[2]),this.cornerareas[e][1]=n-this.cornerareas[e][0]-this.cornerareas[e][2];else if(o[2]<=0)this.cornerareas[e][0]=-.25*i[1]*n/r[2].clone().dot(r[1]),this.cornerareas[e][1]=-.25*i[0]*n/r[2].clone().dot(r[0]),this.cornerareas[e][2]=n-this.cornerareas[e][0]-this.cornerareas[e][1];else for(var a=.5*n/(o[0]+o[1]+o[2]),s=0;s<3;++s)this.cornerareas[e][s]=a*(o[(s+1)%3]+o[(s+2)%3]);this.pointareas[t.a]+=this.cornerareas[e][0],this.pointareas[t.b]+=this.cornerareas[e][1],this.pointareas[t.c]+=this.cornerareas[e][2]}console.log("Done...")}}]),e}(),l=s;t.default=l,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(s,"SuggestiveContoursCalculator","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/SuggestiveContoursCalculator.js"),__REACT_HOT_LOADER__.register(l,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/SuggestiveContoursCalculator.js"))}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s={uniforms:{fz:{type:"f",value:5},c_limit:{type:"f",value:1},sc_limit:{type:"f",value:1},dwkr_limit:{type:"f",value:2e-4},limit:{type:"f",value:1}},vertexShader:"\n// Object Space Suggestive Contours vertex shader\n// Jeroen Baert - www.forceflow.be\n\nattribute vec3 pdir1;\nattribute vec3 pdir2;\nattribute float curv1;\nattribute float curv2;\nattribute vec4 dcurv;\n\n// OUT: variables for fragment shader\nvarying float ndotv;\nvarying float kr;\nvarying float dwkr2;\n\nvarying float contoursZeroCrossingParas;\n\nuniform float fz;\n\nvoid main()\n{\n  // attributes parameters should be precalculated and put in attributes of BufferGeometry\n  // without transformation, it will be view-independent and relatively clean\n  // vec3 modelPosition = position;\n  // vec3 unitNormal = normalize(normal);\n  // vec3 modelpdir1 = normalize(pdir1);\n  // vec3 modelpdir2 = normalize(pdir2);\n\n  // after transformation, it will be relative dirty and view-dependent\n  vec3 modelPosition = (modelViewMatrix * vec4(position, 1.0)).xyz;\n  vec3 unitNormal = normalize(normalMatrix * normal);\n  vec3 modelpdir1 = normalize(normalMatrix * pdir1);\n  vec3 modelpdir2 = normalize(normalMatrix * pdir2);\n\n  // compute vector to camera\n  vec3 view = normalize(cameraPosition - modelPosition);\n\n  // compute ndotv (and normalize view)\n  ndotv = dot(unitNormal,view);\n\n  contoursZeroCrossingParas = 1.0;\n\n  // optimalisation: if this vector points away from cam, don't even bother computing the rest.\n  // the data will not be used in computing pixel color\n  if(!(ndotv < 0.0))\n  {\n    // compute kr\n    vec3 w = normalize(view - unitNormal * dot(view, unitNormal));\n    float u = dot(w, normalize(modelpdir1));\n    float v = dot(w, normalize(modelpdir2));\n    float u2 = u*u;\n    float v2 = v*v;\n    float t_kr = (curv1*u2) + (curv2*v2);\n    // and dwkr\n    float uv = u*v;\n    float dwII = (u2*u*dcurv.x) + (3.0*u*uv*dcurv.y) + (3.0*uv*v*dcurv.z) + (v*v2*dcurv.w);\n    // extra term due to second derivative\n    float t_dwkr = dwII + 2.0 * curv1 * curv2 * ndotv/sqrt((1.0 - pow(ndotv, 2.0)));\n\n    // use feature size\n    kr = fz*(t_kr); // absolute value to use it in limits\n    float dwkr = fz*fz*t_dwkr; // two times fz because derivative\n    dwkr2 = (dwkr-dwkr*pow(ndotv, 2.0)) / length(w);\n\n    if(kr>0.0){\n      contoursZeroCrossingParas = 1.0;\n    }else if(kr<0.0){\n      contoursZeroCrossingParas = -1.0;\n    }else{\n      contoursZeroCrossingParas = 0.0;\n    }\n  }\n\n  // position transformation\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n} \n",fragmentShader:"\n// Object Space Suggestive Contours vertex shader\n// Jeroen Baert - www.forceflow.be\n\n// IN: computed values from vertex shader\nvarying float ndotv;\nvarying float kr;\nvarying float dwkr2;\n\nvarying float contoursZeroCrossingParas;\n\n// IN: uniform values\nuniform float dwkr_limit;\nuniform float limit;\nuniform float c_limit;\nuniform float sc_limit;\n\nvoid main()\n{\n  // base color\n  vec4 color = vec4(1.0); \n  \n  if(ndotv<0.0){\n    gl_FragColor = color;\n  }else{\n    if(contoursZeroCrossingParas<1.0 && contoursZeroCrossingParas>-1.0){\n      // compute limits\n      float contour_limit = c_limit*(pow(ndotv, 2.0)/(kr));\n      float sucontour_limit = sc_limit*((kr)/dwkr2);\n      contour_limit = abs(contour_limit);\n      sucontour_limit = abs(sucontour_limit);\n\n      // contours\n      if(contour_limit<limit)\n      {\n        color.xyz = min(color.xyz, vec3(contour_limit, contour_limit, contour_limit));\n      }\n      // suggestive contours\n      if((sucontour_limit<limit) && dwkr2>dwkr_limit)\n      {\n        color.xyz = min(color.xyz, vec3(sucontour_limit, sucontour_limit, sucontour_limit));\n      }\n    }\n\n    gl_FragColor = color;\n  }\n} \n"},l=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.uniforms=JSON.parse(JSON.stringify(s.uniforms)),r.vertexShader=s.vertexShader,r.fragmentShader=s.fragmentShader,r.extensions.derivatives=!0,r.transparent=!0,e.name&&(r.name=e.name),r}return o(t,e),t}(a.ShaderMaterial),u=l;t.default=u,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(s,"SuggestiveContourSelfShaderMaterialParameters","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/SuggestiveContoursShaderMaterial.js"),__REACT_HOT_LOADER__.register(l,"SuggestiveContoursShaderMaterial","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/SuggestiveContoursShaderMaterial.js"),__REACT_HOT_LOADER__.register(u,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/materials/SuggestiveContoursShaderMaterial.js"))}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=n.EarthBasic.HyperClasses.HyperNode,o=i;t.default=o,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"HyperNode","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/sceneGraph/HyperNode.js"),__REACT_HOT_LOADER__.register(o,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/sceneGraph/HyperNode.js"))}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(2),u=r(3),c=n(u),h=r(6),d=n(h),f=function(e){function t(e,r){i(this,t);var n=r,a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,c.default,n));return a._property.type="MarkerLayer",a}return a(t,e),s(t,[{key:"sceneUpdated",value:function(e){this.applyToChildren(function(e,t){e instanceof d.default||e.sceneUpdated(t)},e),d.default._forest&&d.default._forest.sceneUpdated(e)}}]),t}(l.HyperLayer),p=f;t.default=p,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(f,"MarkerLayer","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/sceneGraph/MarkerLayer.js"),__REACT_HOT_LOADER__.register(p,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/sceneGraph/MarkerLayer.js"))}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={include:Array.prototype.indexOf?function(e,t){return-1!==e.indexOf(t)}:function(e,t){for(var r=-1,n=e.length;++r<n;)if(e[r]===t)return!0;return!1},getIndex:Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1}},i=n;t.default=i,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(n,"DataStructureUtils","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/util/DataStructureUtils.js"),__REACT_HOT_LOADER__.register(i,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/util/DataStructureUtils.js"))}()},function(e,t,r){"use strict";function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(){function e(){o(this,e)}return a(e,[{key:"get",value:function(e,t){var r=this._doGet(e);return void 0===r||null===r?t:r}},{key:"set",value:function(e,t){if(void 0===e||null===e)throw new Error("Invalid argument");this._doSet(e,t)}}]),e}(),l=function(e){function t(){o(this,t);var e=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.cache={},e}return i(t,e),a(t,[{key:"_doGet",value:function(e){var t=this.cache[e];if(t){var r=t.clone();return r.objSpaceBBox=t.objSpaceBBox.clone(),this.deepCloneMaterial(t.objSpaceBBox,r.objSpaceBBox),this.deepCloneMaterial(t,r),r}}},{key:"_doSet",value:function(e,t){var r=t.clone();r.objSpaceBBox=t.objSpaceBBox.clone(),this.deepCloneMaterial(t,r),this.cache[e]=r}},{key:"deepCloneMaterial",value:function(e,t){if("Group"===e.type)for(var r=0;r<e.children.length;r+=1)this.deepCloneMaterial(e.children[r],t.children[r]);else"Mesh"===e.type?e.material instanceof Array?t.material=e.material.map(function(e){return e.clone()}):(t.material=e.material.clone(),e.mtlParams&&(t.mtlParams=JSON.parse(JSON.stringify(e.mtlParams)))):console.warn("deepCloneMaterial",e)}}]),t}(s),u=l;t.default=u,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(s,"Cache","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/util/ObjCache.js"),__REACT_HOT_LOADER__.register(l,"ObjCache","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/util/ObjCache.js"),__REACT_HOT_LOADER__.register(u,"default","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/util/ObjCache.js"))}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t){n(this,e),this.id=t.id,this.name=t.name,this.scene=t.scene,this.owner=t.owner,this.visibility=t.visibility,this.description=t.description,this.views=t.views,this.stars=t.stars,this.createDate=t.createDate,this.modifiedDate=t.modifiedDate,this.spaceUsage=t.spaceUsage,this.allowComment=t.allowComment,this.allowLocation=t.allowLocation,this.showAltiLogo=t.showAltiLogo,this.tags=t.tags,this.onEarth=t.onEarth,this.history=t.history,this.solutionType=t.solutionType}return i(e,[{key:"destruct",value:function(){this.id=void 0,this.name=void 0,this.scene=void 0,this.owner=void 0}},{key:"update",value:function(e){if(!function(){return!!(e&&e instanceof Object)&&!(!e.id||!e.name)}())return!1}}]),e}();t.default=o,function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(o,"ProjectSolutionInfo","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/util/info/ProjectSolutionInfo.js")}()},function(e,t){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function n(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}e.exports=function(e){return null!=e&&(r(e)||n(e)||!!e._isBuffer)}},function(e,t){var r=window.URL||window.webkitURL;e.exports=function(e,t){try{try{var n;try{var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;n=new i,n.append(e),n=n.getBlob()}catch(t){n=new Blob([e])}return new Worker(r.createObjectURL(n))}catch(t){return new Worker("data:application/javascript,"+encodeURIComponent(e))}}catch(e){if(!t)throw Error("Inline worker is not supported");return new Worker(t)}}},function(e,t,r){e.exports=function(){return r(70)('!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){"use strict";var i=n(2),o=function(t,e){this.name="PointError",this.points=e=e||[],this.message=t||"Invalid Points!";for(var n=0;n<e.length;n++)this.message+=" "+i.toString(e[n])};o.prototype=new Error,o.prototype.constructor=o,t.exports=o},function(t,e,n){"use strict";var i=n(2),o=function(t,e,n){this.points_=[t,e,n],this.neighbors_=[null,null,null],this.interior_=!1,this.constrained_edge=[!1,!1,!1],this.delaunay_edge=[!1,!1,!1]},r=i.toString;o.prototype.toString=function(){return"["+r(this.points_[0])+r(this.points_[1])+r(this.points_[2])+"]"},o.prototype.getPoint=function(t){return this.points_[t]},o.prototype.GetPoint=o.prototype.getPoint,o.prototype.getPoints=function(){return this.points_},o.prototype.getNeighbor=function(t){return this.neighbors_[t]},o.prototype.containsPoint=function(t){var e=this.points_;return t===e[0]||t===e[1]||t===e[2]},o.prototype.containsEdge=function(t){return this.containsPoint(t.p)&&this.containsPoint(t.q)},o.prototype.containsPoints=function(t,e){return this.containsPoint(t)&&this.containsPoint(e)},o.prototype.isInterior=function(){return this.interior_},o.prototype.setInterior=function(t){return this.interior_=t,this},o.prototype.markNeighborPointers=function(t,e,n){var i=this.points_;if(t===i[2]&&e===i[1]||t===i[1]&&e===i[2])this.neighbors_[0]=n;else if(t===i[0]&&e===i[2]||t===i[2]&&e===i[0])this.neighbors_[1]=n;else{if(!(t===i[0]&&e===i[1]||t===i[1]&&e===i[0]))throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call");this.neighbors_[2]=n}},o.prototype.markNeighbor=function(t){var e=this.points_;t.containsPoints(e[1],e[2])?(this.neighbors_[0]=t,t.markNeighborPointers(e[1],e[2],this)):t.containsPoints(e[0],e[2])?(this.neighbors_[1]=t,t.markNeighborPointers(e[0],e[2],this)):t.containsPoints(e[0],e[1])&&(this.neighbors_[2]=t,t.markNeighborPointers(e[0],e[1],this))},o.prototype.clearNeighbors=function(){this.neighbors_[0]=null,this.neighbors_[1]=null,this.neighbors_[2]=null},o.prototype.clearDelaunayEdges=function(){this.delaunay_edge[0]=!1,this.delaunay_edge[1]=!1,this.delaunay_edge[2]=!1},o.prototype.pointCW=function(t){var e=this.points_;return t===e[0]?e[2]:t===e[1]?e[0]:t===e[2]?e[1]:null},o.prototype.pointCCW=function(t){var e=this.points_;return t===e[0]?e[1]:t===e[1]?e[2]:t===e[2]?e[0]:null},o.prototype.neighborCW=function(t){return t===this.points_[0]?this.neighbors_[1]:t===this.points_[1]?this.neighbors_[2]:this.neighbors_[0]},o.prototype.neighborCCW=function(t){return t===this.points_[0]?this.neighbors_[2]:t===this.points_[1]?this.neighbors_[0]:this.neighbors_[1]},o.prototype.getConstrainedEdgeCW=function(t){return t===this.points_[0]?this.constrained_edge[1]:t===this.points_[1]?this.constrained_edge[2]:this.constrained_edge[0]},o.prototype.getConstrainedEdgeCCW=function(t){return t===this.points_[0]?this.constrained_edge[2]:t===this.points_[1]?this.constrained_edge[0]:this.constrained_edge[1]},o.prototype.getConstrainedEdgeAcross=function(t){return t===this.points_[0]?this.constrained_edge[0]:t===this.points_[1]?this.constrained_edge[1]:this.constrained_edge[2]},o.prototype.setConstrainedEdgeCW=function(t,e){t===this.points_[0]?this.constrained_edge[1]=e:t===this.points_[1]?this.constrained_edge[2]=e:this.constrained_edge[0]=e},o.prototype.setConstrainedEdgeCCW=function(t,e){t===this.points_[0]?this.constrained_edge[2]=e:t===this.points_[1]?this.constrained_edge[0]=e:this.constrained_edge[1]=e},o.prototype.getDelaunayEdgeCW=function(t){return t===this.points_[0]?this.delaunay_edge[1]:t===this.points_[1]?this.delaunay_edge[2]:this.delaunay_edge[0]},o.prototype.getDelaunayEdgeCCW=function(t){return t===this.points_[0]?this.delaunay_edge[2]:t===this.points_[1]?this.delaunay_edge[0]:this.delaunay_edge[1]},o.prototype.setDelaunayEdgeCW=function(t,e){t===this.points_[0]?this.delaunay_edge[1]=e:t===this.points_[1]?this.delaunay_edge[2]=e:this.delaunay_edge[0]=e},o.prototype.setDelaunayEdgeCCW=function(t,e){t===this.points_[0]?this.delaunay_edge[2]=e:t===this.points_[1]?this.delaunay_edge[0]=e:this.delaunay_edge[1]=e},o.prototype.neighborAcross=function(t){return t===this.points_[0]?this.neighbors_[0]:t===this.points_[1]?this.neighbors_[1]:this.neighbors_[2]},o.prototype.oppositePoint=function(t,e){var n=t.pointCW(e);return this.pointCW(n)},o.prototype.legalize=function(t,e){var n=this.points_;if(t===n[0])n[1]=n[0],n[0]=n[2],n[2]=e;else if(t===n[1])n[2]=n[1],n[1]=n[0],n[0]=e;else{if(t!==n[2])throw new Error("poly2tri Invalid Triangle.legalize() call");n[0]=n[2],n[2]=n[1],n[1]=e}},o.prototype.index=function(t){var e=this.points_;if(t===e[0])return 0;if(t===e[1])return 1;if(t===e[2])return 2;throw new Error("poly2tri Invalid Triangle.index() call")},o.prototype.edgeIndex=function(t,e){var n=this.points_;if(t===n[0]){if(e===n[1])return 2;if(e===n[2])return 1}else if(t===n[1]){if(e===n[2])return 0;if(e===n[0])return 2}else if(t===n[2]){if(e===n[0])return 1;if(e===n[1])return 0}return-1},o.prototype.markConstrainedEdgeByIndex=function(t){this.constrained_edge[t]=!0},o.prototype.markConstrainedEdgeByEdge=function(t){this.markConstrainedEdgeByPoints(t.p,t.q)},o.prototype.markConstrainedEdgeByPoints=function(t,e){var n=this.points_;e===n[0]&&t===n[1]||e===n[1]&&t===n[0]?this.constrained_edge[2]=!0:e===n[0]&&t===n[2]||e===n[2]&&t===n[0]?this.constrained_edge[1]=!0:(e===n[1]&&t===n[2]||e===n[2]&&t===n[1])&&(this.constrained_edge[0]=!0)},t.exports=o},function(t,e,n){"use strict";function i(t){return"("+t.x+";"+t.y+")"}function o(t){var e=t.toString();return"[object Object]"===e?i(t):e}function r(t,e){return t.y===e.y?t.x-e.x:t.y-e.y}function s(t,e){return t.x===e.x&&t.y===e.y}t.exports={toString:o,toStringBase:i,compare:r,equals:s}},function(t,e,n){"use strict";var i=function(t,e){this.point=t,this.triangle=e||null,this.next=null,this.prev=null,this.value=t.x},o=function(t,e){this.head_=t,this.tail_=e,this.search_node_=t};o.prototype.head=function(){return this.head_},o.prototype.setHead=function(t){this.head_=t},o.prototype.tail=function(){return this.tail_},o.prototype.setTail=function(t){this.tail_=t},o.prototype.search=function(){return this.search_node_},o.prototype.setSearch=function(t){this.search_node_=t},o.prototype.findSearchNode=function(){return this.search_node_},o.prototype.locateNode=function(t){var e=this.search_node_;if(t<e.value){for(;e=e.prev;)if(t>=e.value)return this.search_node_=e,e}else for(;e=e.next;)if(t<e.value)return this.search_node_=e.prev,e.prev;return null},o.prototype.locatePoint=function(t){var e=t.x,n=this.findSearchNode(e),i=n.point.x;if(e===i){if(t!==n.point)if(t===n.prev.point)n=n.prev;else{if(t!==n.next.point)throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call");n=n.next}}else if(e<i)for(;(n=n.prev)&&t!==n.point;);else for(;(n=n.next)&&t!==n.point;);return n&&(this.search_node_=n),n},t.exports=o,t.exports.Node=i},function(t,e,n){"use strict";var i=n(2),o=function(t,e){this.x=+t||0,this.y=+e||0,this._p2t_edge_list=null};o.prototype.toString=function(){return i.toStringBase(this)},o.prototype.toJSON=function(){return{x:this.x,y:this.y}},o.prototype.clone=function(){return new o(this.x,this.y)},o.prototype.set_zero=function(){return this.x=0,this.y=0,this},o.prototype.set=function(t,e){return this.x=+t||0,this.y=+e||0,this},o.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},o.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},o.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},o.prototype.mul=function(t){return this.x*=t,this.y*=t,this},o.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},o.prototype.normalize=function(){var t=this.length();return this.x/=t,this.y/=t,t},o.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},o.negate=function(t){return new o(-t.x,-t.y)},o.add=function(t,e){return new o(t.x+e.x,t.y+e.y)},o.sub=function(t,e){return new o(t.x-e.x,t.y-e.y)},o.mul=function(t,e){return new o(t*e.x,t*e.y)},o.cross=function(t,e){return"number"==typeof t?"number"==typeof e?t*e:new o(-t*e.y,t*e.x):"number"==typeof e?new o(e*t.y,-e*t.x):t.x*e.y-t.y*e.x},o.toString=i.toString,o.compare=i.compare,o.cmp=i.compare,o.equals=i.equals,o.dot=function(t,e){return t.x*e.x+t.y*e.y},t.exports=o},function(t,e,n){"use strict";function i(t){t.initTriangulation(),t.createAdvancingFront(),o(t),r(t)}function o(t){var e,n=t.pointCount();for(e=1;e<n;++e)for(var i=t.getPoint(e),o=s(t,i),r=i._p2t_edge_list,p=0;r&&p<r.length;++p)a(t,r[p],o)}function r(t){for(var e=t.front().head().next.triangle,n=t.front().head().next.point;!e.getConstrainedEdgeCW(n);)e=e.neighborCCW(n);t.meshClean(e)}function s(t,e){var n=t.locateNode(e),i=u(t,e,n);return e.x<=n.point.x+V&&d(t,n),l(t,i),i}function a(t,e,n){t.edge_event.constrained_edge=e,t.edge_event.right=e.p.x>e.q.x,h(n.triangle,e.p,e.q)||(C(t,e,n),p(t,e.p,e.q,n.triangle,e.q))}function p(t,e,n,i,o){if(!h(i,e,n)){var r=i.pointCCW(o),s=R(n,r,e);if(s===L.COLLINEAR)throw new k("poly2tri EdgeEvent: Collinear not supported!",[n,r,e]);var a=i.pointCW(o),u=R(n,a,e);if(u===L.COLLINEAR)throw new k("poly2tri EdgeEvent: Collinear not supported!",[n,a,e]);s===u?(i=s===L.CW?i.neighborCCW(o):i.neighborCW(o),p(t,e,n,i,o)):z(t,e,n,i,o)}}function h(t,e,n){var i=t.edgeIndex(e,n);if(-1!==i){t.markConstrainedEdgeByIndex(i);var o=t.getNeighbor(i);return o&&o.markConstrainedEdgeByPoints(e,n),!0}return!1}function u(t,e,n){var i=new q(e,n.point,n.next.point);i.markNeighbor(n.triangle),t.addToMap(i);var o=new D(e);return o.next=n.next,o.prev=n,n.next.prev=o,n.next=o,f(t,i)||t.mapTriangleToNodes(i),o}function d(t,e){var n=new q(e.prev.point,e.point,e.next.point);n.markNeighbor(e.prev.triangle),n.markNeighbor(e.triangle),t.addToMap(n),e.prev.next=e.next,e.next.prev=e.prev,f(t,n)||t.mapTriangleToNodes(n)}function l(t,e){for(var n=e.next;n.next&&!B(n.point,n.next.point,n.prev.point);)d(t,n),n=n.next;for(n=e.prev;n.prev&&!B(n.point,n.next.point,n.prev.point);)d(t,n),n=n.prev;e.next&&e.next.next&&c(e)&&_(t,e)}function c(t){var e=t.point.x-t.next.next.point.x,n=t.point.y-t.next.next.point.y;return S(n>=0,"unordered y"),e>=0||Math.abs(e)<n}function f(t,e){for(var n=0;n<3;++n)if(!e.delaunay_edge[n]){var i=e.getNeighbor(n);if(i){var o=e.getPoint(n),r=i.oppositePoint(e,o),s=i.index(r);if(i.constrained_edge[s]||i.delaunay_edge[s]){e.constrained_edge[n]=i.constrained_edge[s];continue}var a=g(o,e.pointCCW(o),e.pointCW(o),r);if(a){e.delaunay_edge[n]=!0,i.delaunay_edge[s]=!0,y(e,o,i,r);var p=!f(t,e);return p&&t.mapTriangleToNodes(e),p=!f(t,i),p&&t.mapTriangleToNodes(i),e.delaunay_edge[n]=!1,i.delaunay_edge[s]=!1,!0}}}return!1}function g(t,e,n,i){var o=t.x-i.x,r=t.y-i.y,s=e.x-i.x,a=e.y-i.y,p=o*a,h=s*r,u=p-h;if(u<=0)return!1;var d=n.x-i.x,l=n.y-i.y,c=d*r,f=o*l,g=c-f;return!(g<=0)&&(o*o+r*r)*(s*l-d*a)+(s*s+a*a)*g+(d*d+l*l)*u>0}function y(t,e,n,i){var o,r,s,a;o=t.neighborCCW(e),r=t.neighborCW(e),s=n.neighborCCW(i),a=n.neighborCW(i);var p,h,u,d;p=t.getConstrainedEdgeCCW(e),h=t.getConstrainedEdgeCW(e),u=n.getConstrainedEdgeCCW(i),d=n.getConstrainedEdgeCW(i);var l,c,f,g;l=t.getDelaunayEdgeCCW(e),c=t.getDelaunayEdgeCW(e),f=n.getDelaunayEdgeCCW(i),g=n.getDelaunayEdgeCW(i),t.legalize(e,i),n.legalize(i,e),n.setDelaunayEdgeCCW(e,l),t.setDelaunayEdgeCW(e,c),t.setDelaunayEdgeCCW(i,f),n.setDelaunayEdgeCW(i,g),n.setConstrainedEdgeCCW(e,p),t.setConstrainedEdgeCW(e,h),t.setConstrainedEdgeCCW(i,u),n.setConstrainedEdgeCW(i,d),t.clearNeighbors(),n.clearNeighbors(),o&&n.markNeighbor(o),r&&t.markNeighbor(r),s&&t.markNeighbor(s),a&&n.markNeighbor(a),t.markNeighbor(n)}function _(t,e){for(R(e.point,e.next.point,e.next.next.point)===L.CCW?t.basin.left_node=e.next.next:t.basin.left_node=e.next,t.basin.bottom_node=t.basin.left_node;t.basin.bottom_node.next&&t.basin.bottom_node.point.y>=t.basin.bottom_node.next.point.y;)t.basin.bottom_node=t.basin.bottom_node.next;if(t.basin.bottom_node!==t.basin.left_node){for(t.basin.right_node=t.basin.bottom_node;t.basin.right_node.next&&t.basin.right_node.point.y<t.basin.right_node.next.point.y;)t.basin.right_node=t.basin.right_node.next;t.basin.right_node!==t.basin.bottom_node&&(t.basin.width=t.basin.right_node.point.x-t.basin.left_node.point.x,t.basin.left_highest=t.basin.left_node.point.y>t.basin.right_node.point.y,x(t,t.basin.bottom_node))}}function x(t,e){if(!v(t,e)){d(t,e);if(e.prev!==t.basin.left_node||e.next!==t.basin.right_node){if(e.prev===t.basin.left_node){if(R(e.point,e.next.point,e.next.next.point)===L.CW)return;e=e.next}else if(e.next===t.basin.right_node){if(R(e.point,e.prev.point,e.prev.prev.point)===L.CCW)return;e=e.prev}else e=e.prev.point.y<e.next.point.y?e.prev:e.next;x(t,e)}}}function v(t,e){var n;return n=t.basin.left_highest?t.basin.left_node.point.y-e.point.y:t.basin.right_node.point.y-e.point.y,t.basin.width>n}function C(t,e,n){t.edge_event.right?b(t,e,n):W(t,e,n)}function b(t,e,n){for(;n.next.point.x<e.p.x;)R(e.q,n.next.point,e.p)===L.CCW?m(t,e,n):n=n.next}function m(t,e,n){n.point.x<e.p.x&&(R(n.point,n.next.point,n.next.next.point)===L.CCW?E(t,e,n):(w(t,e,n),m(t,e,n)))}function E(t,e,n){d(t,n.next),n.next.point!==e.p&&R(e.q,n.next.point,e.p)===L.CCW&&R(n.point,n.next.point,n.next.next.point)===L.CCW&&E(t,e,n)}function w(t,e,n){R(n.next.point,n.next.next.point,n.next.next.next.point)===L.CCW?E(t,e,n.next):R(e.q,n.next.next.point,e.p)===L.CCW&&w(t,e,n.next)}function W(t,e,n){for(;n.prev.point.x>e.p.x;)R(e.q,n.prev.point,e.p)===L.CW?P(t,e,n):n=n.prev}function P(t,e,n){n.point.x>e.p.x&&(R(n.point,n.prev.point,n.prev.prev.point)===L.CW?I(t,e,n):(N(t,e,n),P(t,e,n)))}function N(t,e,n){R(n.prev.point,n.prev.prev.point,n.prev.prev.prev.point)===L.CW?I(t,e,n.prev):R(e.q,n.prev.prev.point,e.p)===L.CW&&N(t,e,n.prev)}function I(t,e,n){d(t,n.prev),n.prev.point!==e.p&&R(e.q,n.prev.point,e.p)===L.CW&&R(n.point,n.prev.point,n.prev.prev.point)===L.CW&&I(t,e,n)}function z(t,e,n,i,o){var r=i.neighborAcross(o);S(r,"FLIP failed due to missing triangle!");var s=r.oppositePoint(i,o);if(i.getConstrainedEdgeAcross(o)){var a=i.index(o);throw new k("poly2tri Intersecting Constraints",[o,s,i.getPoint((a+1)%3),i.getPoint((a+2)%3)])}if(j(o,i.pointCCW(o),i.pointCW(o),s))if(y(i,o,r,s),t.mapTriangleToNodes(i),t.mapTriangleToNodes(r),o===n&&s===e)n===t.edge_event.constrained_edge.q&&e===t.edge_event.constrained_edge.p&&(i.markConstrainedEdgeByPoints(e,n),r.markConstrainedEdgeByPoints(e,n),f(t,i),f(t,r));else{var h=R(n,s,e);i=T(t,h,i,r,o,s),z(t,e,n,i,o)}else{O(t,e,n,i,r,A(e,n,r,s)),p(t,e,n,i,o)}}function T(t,e,n,i,o,r){var s;return e===L.CCW?(s=i.edgeIndex(o,r),i.delaunay_edge[s]=!0,f(t,i),i.clearDelaunayEdges(),n):(s=n.edgeIndex(o,r),n.delaunay_edge[s]=!0,f(t,n),n.clearDelaunayEdges(),i)}function A(t,e,n,i){var o=R(e,i,t);if(o===L.CW)return n.pointCCW(i);if(o===L.CCW)return n.pointCW(i);throw new k("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[e,i,t])}function O(t,e,n,i,o,r){var s=o.neighborAcross(r);S(s,"FLIP failed due to missing triangle");var a=s.oppositePoint(o,r);if(j(n,i.pointCCW(n),i.pointCW(n),a))z(t,n,a,s,a);else{O(t,e,n,i,s,A(e,n,s,a))}}var S=n(10),k=n(0),q=n(1),D=n(3).Node,F=n(12),V=F.EPSILON,L=F.Orientation,R=F.orient2d,j=F.inScanArea,B=F.isAngleObtuse;e.triangulate=i},function(t,e,n){"use strict";function i(t,e){this.x=t||0,this.y=e||0}function o(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function r(t,e,n){return{r:t,g:e,b:n}}function s(t,e,n,i,s,a){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new o,this.vertexNormals=Array.isArray(i)?i:[],this.color=s&&s.isColor?s:new r(1,1,1),this.vertexColors=Array.isArray(s)?s:[],this.materialIndex=void 0!==a?a:0}Object.defineProperty(e,"__esModule",{value:!0}),Object.assign(i.prototype,{constructor:i,isVector2:!0,clone:function(){return new this.constructor(this.x,this.y)}}),Object.assign(o.prototype,{constructor:o,isVector3:!0,clone:function(){return new this.constructor(this.x,this.y,this.z)},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},normalize:function(){return this.divideScalar(this.length()||1)},divideScalar:function(t){return this.multiplyScalar(1/t)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var n=this.x,i=this.y,o=this.z;return this.x=i*t.z-o*t.y,this.y=o*t.x-n*t.z,this.z=n*t.y-i*t.x,this},crossVectors:function(t,e){var n=t.x,i=t.y,o=t.z,r=e.x,s=e.y,a=e.z;return this.x=i*a-o*s,this.y=o*r-n*a,this.z=n*s-i*r,this}}),Object.assign(r.prototype,{isColor:!0}),e.Vector2=i,e.Vector3=o,e.Face3=s,e.Color=r;!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"Vector2","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/loader/OBJParserInclude.js"),__REACT_HOT_LOADER__.register(o,"Vector3","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/loader/OBJParserInclude.js"),__REACT_HOT_LOADER__.register(r,"Color","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/loader/OBJParserInclude.js"),__REACT_HOT_LOADER__.register(s,"Face3","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/loader/OBJParserInclude.js"))}()},function(t,e,n){"use strict";(function(t){var i=t.poly2tri;e.noConflict=function(){return t.poly2tri=i,e},e.VERSION=n(9).version,e.PointError=n(0),e.Point=n(4),e.Triangle=n(1),e.SweepContext=n(11);var o=n(5);e.triangulate=o.triangulate,e.sweep={Triangulate:o.triangulate}}).call(e,n(13))},function(t,e,n){"use strict";function i(t,e){function n(t,e,n){return new o.Vector3(t,e,n)}function i(t,e,n,i){return new o.Face3(t,e,n,i)}function r(t,n){if(c.length>0){l.vertices=c;for(var i=[],o=[],r=[],s=0;s<l.faces.length;++s){var a=l.faces[s];i.push(l.vertices[a.a].x),i.push(l.vertices[a.a].y),i.push(l.vertices[a.a].z),i.push(l.vertices[a.b].x),i.push(l.vertices[a.b].y),i.push(l.vertices[a.b].z),i.push(l.vertices[a.c].x),i.push(l.vertices[a.c].y),i.push(l.vertices[a.c].z),3===a.vertexNormals.length?(r.push(a.vertexNormals[0].x),r.push(a.vertexNormals[0].y),r.push(a.vertexNormals[0].z),r.push(a.vertexNormals[1].x),r.push(a.vertexNormals[1].y),r.push(a.vertexNormals[1].z),r.push(a.vertexNormals[2].x),r.push(a.vertexNormals[2].y),r.push(a.vertexNormals[2].z)):(r.push(a.normal.x),r.push(a.normal.y),r.push(a.normal.z),r.push(a.normal.x),r.push(a.normal.y),r.push(a.normal.z),r.push(a.normal.x),r.push(a.normal.y),r.push(a.normal.z))}for(var p=0;p<l.faceVertexUvs[0].length;++p){var h=l.faceVertexUvs[0][p];o.push(h[0].x),o.push(h[0].y),o.push(h[1].x),o.push(h[1].y),o.push(h[2].x),o.push(h[2].y)}d.geometry={normal:new Float32Array(r),uv:new Float32Array(o),position:new Float32Array(i),normalItemSize:3,positionItemSize:3,uvItemSize:2},e(d),l={faces:[],faceVertexUvs:[[]],vertices:[]}}void 0!==t&&(d.meshName=t),void 0!==n&&(d.materialName=n)}function a(t,e,n,o){void 0===o?l.faces.push(i(parseInt(t)-(u+1),parseInt(e)-(u+1),parseInt(n)-(u+1))):l.faces.push(i(parseInt(t)-(u+1),parseInt(e)-(u+1),parseInt(n)-(u+1),[f[parseInt(o[0])-1].clone(),f[parseInt(o[1])-1].clone(),f[parseInt(o[2])-1].clone()]))}function p(t,e,n){l.faceVertexUvs[0].push([g[parseInt(t)-1].clone(),g[parseInt(e)-1].clone(),g[parseInt(n)-1].clone()])}function h(t,e,n){void 0===t[3]?(a(t[0],t[1],t[2],n),void 0!==e&&e.length>0&&p(e[0],e[1],e[2])):(void 0!==n&&n.length>0?(a(t[0],t[1],t[3],[n[0],n[1],n[3]]),a(t[1],t[2],t[3],[n[1],n[2],n[3]])):(a(t[0],t[1],t[3]),a(t[1],t[2],t[3])),void 0!==e&&e.length>0&&(p(e[0],e[1],e[3]),p(e[1],e[2],e[3])))}for(var u=0,d={},l={faces:[],faceVertexUvs:[[]],vertices:[]},c=[],f=[],g=[],y=/v( +[\\d|\\.|\\+|\\-|e]+)( +[\\d|\\.|\\+|\\-|e]+)( +[\\d|\\.|\\+|\\-|e]+)/,_=/vn( +[\\d|\\.|\\+|\\-|e]+)( +[\\d|\\.|\\+|\\-|e]+)( +[\\d|\\.|\\+|\\-|e]+)/,x=/vt( +[\\d|\\.|\\+|\\-|e]+)( +[\\d|\\.|\\+|\\-|e]+)/,v=/f( +\\d+)( +\\d+)( +\\d+)( +\\d+)?/,C=/f( +(\\d+)\\/(\\d+))( +(\\d+)\\/(\\d+))( +(\\d+)\\/(\\d+))( +(\\d+)\\/(\\d+))?/,b=/f( +(\\d+)\\/(\\d+)\\/(\\d+))( +(\\d+)\\/(\\d+)\\/(\\d+))( +(\\d+)\\/(\\d+)\\/(\\d+))( +(\\d+)\\/(\\d+)\\/(\\d+))?/,m=/f( +(\\d+)\\/\\/(\\d+))( +(\\d+)\\/\\/(\\d+))( +(\\d+)\\/\\/(\\d+))( +(\\d+)\\/\\/(\\d+))?/,E=/f( +(\\d+)\\/(\\d+)\\/(\\d+)){5,}?/,w=t.split("\\n"),W=null,P=0;P<w.length;P++){var N=w[P];N=N.trim();var I;if(0!==N.length&&"#"!==N.charAt(0))if(null!==(I=y.exec(N))){if(null===W){var z=I[1].split(".")[1]?I[1].split(".")[1].length:0;z>7&&(z=7),W=Math.pow(10,z)}c.push(n(parseFloat(I[1]),parseFloat(I[2]),parseFloat(I[3])))}else if(null!==(I=_.exec(N)))f.push(n(parseFloat(I[1]),parseFloat(I[2]),parseFloat(I[3])));else if(null!==(I=x.exec(N)))g.push(function(t,e){return new o.Vector2(t,e)}(parseFloat(I[1]),parseFloat(I[2])));else if(null!==(I=v.exec(N)))h([I[1],I[2],I[3],I[4]]);else if(null!==(I=C.exec(N)))h([I[2],I[5],I[8],I[11]],[I[3],I[6],I[9],I[12]]);else if(null!==(I=E.exec(N))){for(var T=N.split(" "),A=/(\\d+)\\/(\\d+)\\/(\\d+)/,O=[],S=[],k=[],q=[],D=null,F=null,V=null,L=null,R=1;R<T.length;R++){var j=void 0;if(null!==(j=A.exec(T[R]))){S.push(parseInt(j[1])),k.push(parseInt(j[2])),q.push(parseInt(j[3]));var B=c[parseInt(j[1])-1].clone();if(null===V&&(V=f[parseInt(j[3])-1]),null===L)L=B.clone(),O.push({x:0,y:0,id:0});else if(null===D){var H=B.clone().add(L.clone().negate());D=H.clone(),D.normalize(),F=D.clone().cross(V.clone()),F.normalize(),O.push({x:H.length()*W,y:0,id:1}),0===D.lengthSq()&&console.error("model contains duplicate points")}else{var M=B.clone().add(L.clone().negate());O.push({x:M.dot(D)*W,y:M.dot(F)*W,id:R-1})}}}try{var U=new s.SweepContext(O);U.triangulate();var J=U.getTriangles();J.map(function(t){var e=t.getPoints().map(function(t){return t.id});a(S[e[0]],S[e[1]],S[e[2]],[q[e[0]],q[e[1]],q[e[2]]]),p(k[e[0]],k[e[1]],k[e[2]])})}catch(t){console.error("error",t)}}else null!==(I=b.exec(N))?h([I[2],I[6],I[10],I[14]],[I[3],I[7],I[11],I[15]],[I[4],I[8],I[12],I[16]]):null!==(I=m.exec(N))?h([I[2],I[5],I[8],I[11]],[],[I[3],I[6],I[9],I[12]]):/^o /.test(N)?(r(),u+=c.length,c=[]):/^g /.test(N)?r(N.substring(2).trim(),void 0):/^usemtl /.test(N)?r(void 0,N.substring(7).trim()):/^mtllib /.test(N)||/^s /.test(N)||console.warn("OBJMTLLoader: Unhandled line "+N)}r(void 0,void 0),e("finish")}var o=n(6),r=n(7),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r);onmessage=function(t){i(t.data.data,function(t){var e=!1,n=null;"finish"===t?e=!0:n=t,postMessage({mesh:n,isFinish:e})})},onerror=function(t){throw console.error("BundleLoader error",t),t};!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(i,"parse","/home/jingbo/Documents/Code/restruct/altizure.sdk/src/loader/OBJParser.js")}()},function(t,e){t.exports={version:"1.5.0"}},function(t,e,n){"use strict";function i(t,e){if(!t)throw new Error(e||"Assert Failed")}t.exports=i},function(t,e,n){"use strict";var i=n(0),o=n(4),r=n(1),s=n(5),a=n(3),p=a.Node,h=function(t,e){if(this.p=t,this.q=e,t.y>e.y)this.q=t,this.p=e;else if(t.y===e.y)if(t.x>e.x)this.q=t,this.p=e;else if(t.x===e.x)throw new i("poly2tri Invalid Edge constructor: repeated points!",[t]);this.q._p2t_edge_list||(this.q._p2t_edge_list=[]),this.q._p2t_edge_list.push(this)},u=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};u.prototype.clear=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};var d=function(){this.constrained_edge=null,this.right=!1},l=function(t,e){e=e||{},this.triangles_=[],this.map_=[],this.points_=e.cloneArrays?t.slice(0):t,this.edge_list=[],this.pmin_=this.pmax_=null,this.front_=null,this.head_=null,this.tail_=null,this.af_head_=null,this.af_middle_=null,this.af_tail_=null,this.basin=new u,this.edge_event=new d,this.initEdges(this.points_)};l.prototype.addHole=function(t){this.initEdges(t);var e,n=t.length;for(e=0;e<n;e++)this.points_.push(t[e]);return this},l.prototype.AddHole=l.prototype.addHole,l.prototype.addHoles=function(t){var e,n=t.length;for(e=0;e<n;e++)this.initEdges(t[e]);return this.points_=this.points_.concat.apply(this.points_,t),this},l.prototype.addPoint=function(t){return this.points_.push(t),this},l.prototype.AddPoint=l.prototype.addPoint,l.prototype.addPoints=function(t){return this.points_=this.points_.concat(t),this},l.prototype.triangulate=function(){return s.triangulate(this),this},l.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}},l.prototype.getTriangles=function(){return this.triangles_},l.prototype.GetTriangles=l.prototype.getTriangles,l.prototype.front=function(){return this.front_},l.prototype.pointCount=function(){return this.points_.length},l.prototype.head=function(){return this.head_},l.prototype.setHead=function(t){this.head_=t},l.prototype.tail=function(){return this.tail_},l.prototype.setTail=function(t){this.tail_=t},l.prototype.getMap=function(){return this.map_},l.prototype.initTriangulation=function(){var t,e=this.points_[0].x,n=this.points_[0].x,i=this.points_[0].y,r=this.points_[0].y,s=this.points_.length;for(t=1;t<s;t++){var a=this.points_[t];a.x>e&&(e=a.x),a.x<n&&(n=a.x),a.y>i&&(i=a.y),a.y<r&&(r=a.y)}this.pmin_=new o(n,r),this.pmax_=new o(e,i);var p=.3*(e-n),h=.3*(i-r);this.head_=new o(e+p,r-h),this.tail_=new o(n-p,r-h),this.points_.sort(o.compare)},l.prototype.initEdges=function(t){var e,n=t.length;for(e=0;e<n;++e)this.edge_list.push(new h(t[e],t[(e+1)%n]))},l.prototype.getPoint=function(t){return this.points_[t]},l.prototype.addToMap=function(t){this.map_.push(t)},l.prototype.locateNode=function(t){return this.front_.locateNode(t.x)},l.prototype.createAdvancingFront=function(){var t,e,n,i=new r(this.points_[0],this.tail_,this.head_);this.map_.push(i),t=new p(i.getPoint(1),i),e=new p(i.getPoint(0),i),n=new p(i.getPoint(2)),this.front_=new a(t,n),t.next=e,e.next=n,e.prev=t,n.prev=e},l.prototype.removeNode=function(t){},l.prototype.mapTriangleToNodes=function(t){for(var e=0;e<3;++e)if(!t.getNeighbor(e)){var n=this.front_.locatePoint(t.pointCW(t.getPoint(e)));n&&(n.triangle=t)}},l.prototype.removeFromMap=function(t){var e,n=this.map_,i=n.length;for(e=0;e<i;e++)if(n[e]===t){n.splice(e,1);break}},l.prototype.meshClean=function(t){for(var e,n,i=[t];e=i.pop();)if(!e.isInterior())for(e.setInterior(!0),this.triangles_.push(e),n=0;n<3;n++)e.constrained_edge[n]||i.push(e.getNeighbor(n))},t.exports=l},function(t,e,n){"use strict";function i(t,e,n){var i=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),r=i-o;return r>-s&&r<s?a.COLLINEAR:r>0?a.CCW:a.CW}function o(t,e,n,i){return!((t.x-e.x)*(i.y-e.y)-(i.x-e.x)*(t.y-e.y)>=-s)&&!((t.x-n.x)*(i.y-n.y)-(i.x-n.x)*(t.y-n.y)<=s)}function r(t,e,n){var i=e.x-t.x,o=e.y-t.y;return i*(n.x-t.x)+o*(n.y-t.y)<0}var s=1e-12;e.EPSILON=s;var a={CW:1,CCW:-1,COLLINEAR:0};e.Orientation=a,e.orient2d=i,e.inScanArea=o,e.isAngleObtuse=r},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n}]);',r.p+"OBJParser.js")}}])})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(121),h=r(283),d=n(h),f=r(18),p=n(f),m={picker:{margin:"3px",border:"1px solid black",width:"30px",height:"30px"},wrapper:{margin:"0 0 0 0"}},v=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.changeHandler=r.changeHandler.bind(r),r.selectTexture=r.selectTexture.bind(r),r.blockMouseUpEvent=r.blockMouseUpEvent.bind(r);var n=e.texturePath?e.texturePath:"";return r.state={color:e.value,openTooltip:!1,activeSelector:0,texture:n},r}return a(t,e),s(t,[{key:"componentDidMount",value:function(){this.setState({mounted:!0})}},{key:"changeHandler",value:function(e,t){this.props.onChangeColor(e),this.setState({color:e.hex,texture:""})}},{key:"selectTexture",value:function(e){this.props.onTexture(e.target.value),this.setState({texture:e.target.value})}},{key:"componentWillReceiveProps",value:function(e){e.value!==this.state.color&&this.setState({color:e.value})}},{key:"blockMouseUpEvent",value:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),window.dispatchEvent(new Event("mouseup"))}},{key:"render",value:function(){var e=this,t={style:{background:"#2a2b2d"},arrowStyle:{color:"#2a2b2d",borderColor:!1}},r=void 0;if(0===this.state.activeSelector)r=u.default.createElement(c.ChromePicker,{color:this.state.color,onChange:this.changeHandler,disableAlpha:!0});else if(1===this.state.activeSelector){var n=void 0;this.props.textures&&(n=this.props.textures.map(function(e,t){return u.default.createElement("option",{key:t+1,value:e.path},e.name)})),r=u.default.createElement("div",{className:"my-select",style:{paddingLeft:"5px"}},u.default.createElement("select",{value:this.state.texture,onChange:this.selectTexture},u.default.createElement("option",{key:0,value:""},"None"),n))}return u.default.createElement("div",{className:"picker-wrapper",style:m.wrapper},u.default.createElement("div",{className:"picker",style:Object.assign({},m.picker,{backgroundColor:this.state.color}),ref:"target",onClick:function(){return e.setState({openTooltip:!e.state.openTooltip})},onMouseLeave:function(){return e.setState({openTooltip:!1})}}),this.state.mounted&&u.default.createElement(d.default,{active:this.state.openTooltip,position:"bottom",arrow:"left",parent:this.refs.target,style:t},u.default.createElement("div",{style:{width:"230px",backgroundColor:"#2a2b2d"},onMouseUp:this.blockMouseUpEvent},u.default.createElement(p.default,{buttons:["COLOR","TEXTURE"],activeIndex:this.state.activeSelector,click:function(t){e.setState({openTooltip:!1}),e.setState({activeSelector:t,openTooltip:!0})}}),r)))}}]),t}(u.default.Component);t.default=v},function(e,t,r){function n(e){return null==e?void 0===e?l:s:u&&u in Object(e)?o(e):a(e)}var i=r(19),o=r(125),a=r(126),s="[object Null]",l="[object Undefined]",u=i?i.toStringTag:void 0;e.exports=n},function(e,t){function r(e){return null!=e&&"object"==typeof e}e.exports=r},function(e,t,r){function n(e,t){var r=o(e,t);return i(r)?r:void 0}var i=r(151),o=r(154);e.exports=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(51),h=n(c),d=r(94),f=n(d),p={collapseBoard:{WebkitTouchCallout:"none",WebkitUserSelect:"none",KhtmlUserSelect:"none",MozUserSelect:"none",MsUserSelect:"none",UserSelect:"none"},panel:{border:"none",boxShadow:"none",marginBottom:"0"},panelHeading:{backgroundColor:"#2a2b2d",border:"1px solid #000",borderRadius:"0",color:"#fff",cursor:"pointer",height:"30px",padding:"4px 10px 4px 4px"},panelBody:{borderRadius:"0",backgroundColor:"#595959",color:"#fff",border:"none",padding:"0 0 0 0"},panelTitle:{paddingLeft:"5px",fontSize:"15px"},collapseBoardDisable:{backgroundColor:"#111",opacity:"0.8",pointerEvents:"none"}},m=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={collapsed:e.collapsed||!1,button:e.buttonON||!1},r}return a(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({collapsed:e.collapsed||!1,button:e.buttonON||!1})}},{key:"render",value:function(){var e=this,t=this.state.collapsed?"fa fa-caret-right":"fa fa-caret-right fa-rotate-90",r=u.default.createElement(f.default,{checked:this.state.button,onChange:function(t){e.props.onToggle&&e.props.onToggle(t),e.setState({button:t})}});return u.default.createElement("div",{style:p.collapseBoard},u.default.createElement("div",{className:"panel panel-default",style:p.panel},u.default.createElement("div",{className:"panel-heading",style:p.panelHeading},u.default.createElement("div",{className:"row",style:p.panelTitle},u.default.createElement("div",{className:"col-sm-9",onClick:function(t){e.props.handleCollapse&&e.props.handleCollapse(!e.state.collapsed),e.setState({collapsed:!e.state.collapsed})}},u.default.createElement("span",null,u.default.createElement("i",{className:t,"aria-hidden":"true"}),"  ",this.props.heading||"NULL","  ",u.default.createElement("i",{className:"fa fa-question-circle","aria-hidden":"true","data-for":this.props.heading,"data-tip":!0})),u.default.createElement(h.default,{className:"custome-tooltip",id:this.props.heading,getContent:function(){return e.props.info||""},effect:"solid",place:"bottom",type:"info",delayShow:100})),u.default.createElement("div",{className:"col-sm-3"},this.props.hasButton&&r))),u.default.createElement("div",null,!this.state.collapsed&&u.default.createElement("div",{className:"panel-body",style:Object.assign({},p.panelBody,!this.state.button&&this.props.hasButton&&p.collapseBoardDisable)},this.props.children))))}}]),t}(u.default.Component);t.default=m},function(e,t){e.exports=ReactDOM},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(51),h=n(c),d={tool:{width:"40px",display:"inline-block"},buttonStyle:{width:"40px",height:"40px",borderRadius:"0",backgroundColor:"#2a2b2d",border:"1px solid black",outline:"none"},buttonHover:{backgroundColor:"#454d54"},buttonUnHover:{backgroundColor:"#2a2b2d"},buttonClick:{backgroundColor:"#595959"}},f=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._handleClick=r._handleClick.bind(r),r._handleHover=r._handleHover.bind(r),r._handleUnHover=r._handleUnHover.bind(r),r._handleMouseUp=r._handleMouseUp.bind(r),r.state={hovered:!1},r}return a(t,e),s(t,[{key:"_handleClick",value:function(){this.props.selectTool(this.props.index)}},{key:"_handleHover",value:function(){this.setState({hovered:!0})}},{key:"_handleUnHover",value:function(){this.setState({hovered:!1})}},{key:"_handleMouseUp",value:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},{key:"render",value:function(){var e=this,t=Object.assign({},d.buttonStyle,this.state.hovered?d.buttonHover:d.buttonUnHover,this.props.selected&&d.buttonClick);return u.default.createElement("div",{style:d.tool},u.default.createElement("button",{type:"button",className:"btn btn-primary",style:t,onMouseEnter:this._handleHover,onMouseLeave:this._handleUnHover,onClick:this._handleClick,onMouseUp:this._handleMouseUp,"data-for":this.props.kind,"data-tip":!0},u.default.createElement("i",{className:this.props.icon,"aria-hidden":"true"})),u.default.createElement(h.default,{id:this.props.kind,getContent:function(){return e.props.kind},effect:"solid",place:this.props.tooltipPlace||"left",delayShow:100}))}}]),t}(u.default.Component);t.default=f},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u={buttonActive:{color:"#1caad9",backgroundColor:"black",outlineColor:"#2a2b2d"}},c=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={active:e.activeIndex},r}return o(t,e),a(t,[{key:"componentWillReceiveProps",value:function(e){e.activeIndex!==this.state.active&&this.setState({active:e.activeIndex})}},{key:"render",value:function(){var e=this,t=this.props.buttons.map(function(t,r){var n={};return r===e.state.active&&(n=u.buttonActive),l.default.createElement("div",{key:r,className:"btn-group",onClick:function(){e.props.click&&e.props.click(r),e.setState({active:r})}},l.default.createElement("button",{type:"button",className:"btn btn-secondary",style:n},t))});return l.default.createElement("div",{style:{width:"80%",margin:"0 auto"}},l.default.createElement("div",{className:"btn-group btn-group-justified",role:"group"},t))}}]),t}(l.default.Component);t.default=c},function(e,t,r){var n=r(4),i=n.Symbol;e.exports=i},function(e,t,r){function n(e){return a(e)?i(e):o(e)}var i=r(58),o=r(135),a=r(21);e.exports=n},function(e,t,r){function n(e){return null!=e&&o(e.length)&&!i(e)}var i=r(63),o=r(36);e.exports=n},function(e,t,r){function n(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var i=r(141),o=r(142),a=r(143),s=r(144),l=r(145);n.prototype.clear=i,n.prototype.delete=o,n.prototype.get=a,n.prototype.has=s,n.prototype.set=l,e.exports=n},function(e,t,r){function n(e,t){for(var r=e.length;r--;)if(i(e[r][0],t))return r;return-1}var i=r(40);e.exports=n},function(e,t,r){var n=r(14),i=n(Object,"create");e.exports=i},function(e,t,r){function n(e,t){var r=e.__data__;return i(t)?r["string"==typeof t?"string":"hash"]:r.map}var i=r(163);e.exports=n},function(e,t,r){function n(e){return"symbol"==typeof e||o(e)&&i(e)==a}var i=r(12),o=r(13),a="[object Symbol]";e.exports=n},function(e,t,r){function n(e){if("string"==typeof e||i(e))return e;var t=e+"";return"0"==t&&1/e==-o?"-0":t}var i=r(26),o=1/0;e.exports=n},function(e,t,r){function n(e,t,r,n){var a=!r;r||(r={});for(var s=-1,l=t.length;++s<l;){var u=t[s],c=n?n(r[u],e[u],u,r,e):void 0;void 0===c&&(c=e[u]),a?o(r,u,c):i(r,u,c)}return r}var i=r(84),o=r(85);e.exports=n},function(e,t,r){"use strict";function n(e){return function(){return e}}var i=function(){};i.thatReturns=n,i.thatReturnsFalse=n(!1),i.thatReturnsTrue=n(!0),i.thatReturnsNull=n(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(e){return e},e.exports=i},function(e,t,r){"use strict";(function(t){function r(e,t,r,i,o,a,s,l){if(n(t),!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,i,o,a,s,l],h=0;u=new Error(t.replace(/%s/g,function(){return c[h++]})),u.name="Invariant Violation"}throw u.framesToPop=1,u}}var n=function(e){};"production"!==t.env.NODE_ENV&&(n=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")}),e.exports=r}).call(t,r(5))},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){function n(e){return"string"==typeof e||!o(e)&&a(e)&&i(e)==s}var i=r(12),o=r(3),a=r(13),s="[object String]";e.exports=n},function(e,t,r){function n(e,t){return e&&i(e,o(t))}var i=r(57),o=r(64);e.exports=n},function(e,t,r){(function(e){var n=r(4),i=r(131),o="object"==typeof t&&t&&!t.nodeType&&t,a=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===o,l=s?n.Buffer:void 0,u=l?l.isBuffer:void 0,c=u||i;e.exports=c}).call(t,r(35)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){function r(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}var n=9007199254740991;e.exports=r},function(e,t){function r(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}var n=Object.prototype;e.exports=r},function(e,t,r){var n=r(62),i=n(Object.getPrototypeOf,Object);e.exports=i},function(e,t,r){function n(e){var t=this.__data__=new i(e);this.size=t.size}var i=r(22),o=r(146),a=r(147),s=r(148),l=r(149),u=r(150);n.prototype.clear=o,n.prototype.delete=a,n.prototype.get=s,n.prototype.has=l,n.prototype.set=u,e.exports=n},function(e,t){function r(e,t){return e===t||e!==e&&t!==t}e.exports=r},function(e,t,r){var n=r(14),i=r(4),o=n(i,"Map");e.exports=o},function(e,t,r){function n(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var i=r(155),o=r(162),a=r(164),s=r(165),l=r(166);n.prototype.clear=i,n.prototype.delete=o,n.prototype.get=a,n.prototype.has=s,n.prototype.set=l,e.exports=n},function(e,t,r){var n=r(175),i=r(76),o=Object.prototype,a=o.propertyIsEnumerable,s=Object.getOwnPropertySymbols,l=s?function(e){return null==e?[]:(e=Object(e),n(s(e),function(t){return a.call(e,t)}))}:i;e.exports=l},function(e,t,r){function n(e,t){if(i(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!o(e))||(s.test(e)||!a.test(e)||null!=t&&e in Object(t))}var i=r(3),o=r(26),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=n},function(e,t,r){function n(e){var t=new e.constructor(e.byteLength);return new i(t).set(new i(e)),t}var i=r(70);e.exports=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(251),o=n(i),a=r(255),s=n(a),l=r(256),u=n(l);t.Raised=o.default,t.Tile=s.default,t.Tabs=u.default},function(e,t,r){(function(t){if("production"!==t.env.NODE_ENV){var n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,i=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n};e.exports=r(252)(i,!0)}else e.exports=r(254)()}).call(t,r(5))},function(e,t,r){"use strict";function n(e){return function(){return e}}var i=function(){};i.thatReturns=n,i.thatReturnsFalse=n(!1),i.thatReturnsTrue=n(!0),i.thatReturnsNull=n(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(e){return e},e.exports=i},function(e,t,r){"use strict";(function(t){function r(e,t,r,i,o,a,s,l){if(n(t),!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,i,o,a,s,l],h=0;u=new Error(t.replace(/%s/g,function(){return c[h++]})),u.name="Invariant Violation"}throw u.framesToPop=1,u}}var n=function(e){};"production"!==t.env.NODE_ENV&&(n=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")}),e.exports=r}).call(t,r(5))},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s,l,u,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),d=r(0),f=n(d),p=r(52),m=n(p),v=r(16),g=n(v),y=r(107),b=n(y),_=r(108),w=n(_),x=r(109),M=n(x),E=r(110),A=n(E),T=r(111),k=n(T),S=r(112),C=n(S),P=r(113),O=n(P),R=r(114),L=n(R),I=r(115),B=n(I),D=r(116),j=r(117),z=n(j),N=r(118),U=n(N),F=(0,w.default)(s=(0,M.default)(s=(0,A.default)(s=(0,k.default)(s=(0,C.default)(s=(0,O.default)((u=l=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={place:"top",type:"dark",effect:"float",show:!1,border:!1,placeholder:"",offset:{},extraClass:"",html:!1,delayHide:0,delayShow:0,event:e.event||null,eventOff:e.eventOff||null,currentEvent:null,currentTarget:null,ariaProps:(0,D.parseAria)(e),isEmptyTip:!1,disable:!1},r.bind(["showTooltip","updateTooltip","hideTooltip","globalRebuild","globalShow","globalHide","onWindowResize"]),r.mount=!0,r.delayShowLoop=null,r.delayHideLoop=null,r.intervalUpdateContent=null,r}return a(t,e),h(t,[{key:"bind",value:function(e){var t=this;e.forEach(function(e){t[e]=t[e].bind(t)})}},{key:"componentDidMount",value:function(){var e=this.props,t=e.insecure,r=e.resizeHide;t&&this.setStyleHeader(),this.bindListener(),this.bindWindowEvents(r)}},{key:"componentWillReceiveProps",value:function(e){var t=this.state.ariaProps,r=(0,D.parseAria)(e);Object.keys(r).some(function(e){return r[e]!==t[e]})&&this.setState({ariaProps:r})}},{key:"componentWillUnmount",value:function(){this.mount=!1,this.clearTimer(),this.unbindListener(),this.removeScrollListener(),this.unbindWindowEvents()}},{key:"getTargetArray",value:function(e){var t=void 0;if(e){var r=e.replace(/\\/g,"\\\\").replace(/"/g,'\\"');t=document.querySelectorAll('[data-tip][data-for="'+r+'"]')}else t=document.querySelectorAll("[data-tip]:not([data-for])");return(0,z.default)(t)}},{key:"bindListener",value:function(){var e=this,t=this.props,r=t.id,n=t.globalEventOff;this.getTargetArray(r).forEach(function(t){var r=e.isCapture(t),n=e.getEffect(t);if(null===t.getAttribute("currentItem")&&t.setAttribute("currentItem","false"),e.unbindBasicListener(t),e.isCustomEvent(t))return void e.customBindListener(t);t.addEventListener("mouseenter",e.showTooltip,r),"float"===n&&t.addEventListener("mousemove",e.updateTooltip,r),t.addEventListener("mouseleave",e.hideTooltip,r)}),n&&(window.removeEventListener(n,this.hideTooltip),window.addEventListener(n,this.hideTooltip,!1)),this.bindRemovalTracker()}},{key:"unbindListener",value:function(){var e=this,t=this.props,r=t.id,n=t.globalEventOff;this.getTargetArray(r).forEach(function(t){e.unbindBasicListener(t),e.isCustomEvent(t)&&e.customUnbindListener(t)}),n&&window.removeEventListener(n,this.hideTooltip),this.unbindRemovalTracker()}},{key:"unbindBasicListener",value:function(e){var t=this.isCapture(e);e.removeEventListener("mouseenter",this.showTooltip,t),e.removeEventListener("mousemove",this.updateTooltip,t),e.removeEventListener("mouseleave",this.hideTooltip,t)}},{key:"showTooltip",value:function(e,t){var r=this;if(t){if(!this.getTargetArray(this.props.id).some(function(t){return t===e.currentTarget})||this.state.show)return}var n=this.props,i=n.children,o=n.multiline,a=n.getContent,s=e.currentTarget.getAttribute("data-tip"),l=e.currentTarget.getAttribute("data-multiline")||o||!1,u=void 0;a&&(u=Array.isArray(a)?a[0]&&a[0]():a());var c=(0,B.default)(s,i,u,l),h="string"==typeof c&&""===c||null===c,d=e instanceof window.FocusEvent||t,f=!0;e.currentTarget.getAttribute("data-scroll-hide")?f="true"===e.currentTarget.getAttribute("data-scroll-hide"):null!=this.props.scrollHide&&(f=this.props.scrollHide),this.clearTimer(),this.setState({placeholder:c,isEmptyTip:h,place:e.currentTarget.getAttribute("data-place")||this.props.place||"top",type:e.currentTarget.getAttribute("data-type")||this.props.type||"dark",effect:d&&"solid"||this.getEffect(e.currentTarget),offset:e.currentTarget.getAttribute("data-offset")||this.props.offset||{},html:e.currentTarget.getAttribute("data-html")?"true"===e.currentTarget.getAttribute("data-html"):this.props.html||!1,delayShow:e.currentTarget.getAttribute("data-delay-show")||this.props.delayShow||0,delayHide:e.currentTarget.getAttribute("data-delay-hide")||this.props.delayHide||0,border:e.currentTarget.getAttribute("data-border")?"true"===e.currentTarget.getAttribute("data-border"):this.props.border||!1,extraClass:e.currentTarget.getAttribute("data-class")||this.props.class||this.props.className||"",disable:e.currentTarget.getAttribute("data-tip-disable")?"true"===e.currentTarget.getAttribute("data-tip-disable"):this.props.disable||!1},function(){f&&r.addScrollListener(e),r.updateTooltip(e),a&&Array.isArray(a)&&(r.intervalUpdateContent=setInterval(function(){if(r.mount){var e=r.props.getContent,t=(0,B.default)(s,e[0](),l),n="string"==typeof t&&""===t;r.setState({placeholder:t,isEmptyTip:n})}},a[1]))})}},{key:"updateTooltip",value:function(e){var t=this,r=this.state,n=r.delayShow,i=r.show,o=r.isEmptyTip,a=r.disable,s=this.props.afterShow,l=this.state.placeholder,u=i?0:parseInt(n,10),c=e.currentTarget;if(!o&&!a){var h=function(){if(Array.isArray(l)&&l.length>0||l){var r=!t.state.show;t.setState({currentEvent:e,currentTarget:c,show:!0},function(){t.updatePosition(),r&&s&&s()})}};clearTimeout(this.delayShowLoop),n?this.delayShowLoop=setTimeout(h,u):h()}}},{key:"hideTooltip",value:function(e,t){var r=this,n=this.state,i=n.delayHide,o=n.isEmptyTip,a=n.disable,s=this.props.afterHide;if(this.mount&&!o&&!a){if(t){if(!this.getTargetArray(this.props.id).some(function(t){return t===e.currentTarget})||!this.state.show)return}var l=function(){var e=r.state.show;r.setState({show:!1},function(){r.removeScrollListener(),e&&s&&s()})};this.clearTimer(),i?this.delayHideLoop=setTimeout(l,parseInt(i,10)):l()}}},{key:"addScrollListener",value:function(e){var t=this.isCapture(e.currentTarget);window.addEventListener("scroll",this.hideTooltip,t)}},{key:"removeScrollListener",value:function(){window.removeEventListener("scroll",this.hideTooltip)}},{key:"updatePosition",value:function(){var e=this,t=this.state,r=t.currentEvent,n=t.currentTarget,i=t.place,o=t.effect,a=t.offset,s=g.default.findDOMNode(this),l=(0,L.default)(r,n,s,i,o,a);if(l.isNewState)return this.setState(l.newState,function(){e.updatePosition()});s.style.left=l.position.left+"px",s.style.top=l.position.top+"px"}},{key:"setStyleHeader",value:function(){if(!document.getElementsByTagName("head")[0].querySelector('style[id="react-tooltip"]')){var e=document.createElement("style");e.id="react-tooltip",e.innerHTML=U.default,document.getElementsByTagName("head")[0].appendChild(e)}}},{key:"clearTimer",value:function(){clearTimeout(this.delayShowLoop),clearTimeout(this.delayHideLoop),clearInterval(this.intervalUpdateContent)}},{key:"render",value:function(){var e=this.state,r=e.placeholder,n=e.extraClass,i=e.html,o=e.ariaProps,a=e.disable,s=e.isEmptyTip,l=(0,b.default)("__react_component_tooltip",{show:this.state.show&&!a&&!s},{border:this.state.border},{"place-top":"top"===this.state.place},{"place-bottom":"bottom"===this.state.place},{"place-left":"left"===this.state.place},{"place-right":"right"===this.state.place},{"type-dark":"dark"===this.state.type},{"type-success":"success"===this.state.type},{"type-warning":"warning"===this.state.type},{"type-error":"error"===this.state.type},{"type-info":"info"===this.state.type},{"type-light":"light"===this.state.type}),u=this.props.wrapper;return t.supportedWrappers.indexOf(u)<0&&(u=t.defaultProps.wrapper),i?f.default.createElement(u,c({className:l+" "+n},o,{"data-id":"tooltip",dangerouslySetInnerHTML:{__html:r}})):f.default.createElement(u,c({className:l+" "+n},o,{"data-id":"tooltip"}),r)}}]),t}(d.Component),l.propTypes={children:m.default.any,place:m.default.string,type:m.default.string,effect:m.default.string,offset:m.default.object,multiline:m.default.bool,border:m.default.bool,insecure:m.default.bool,class:m.default.string,className:m.default.string,id:m.default.string,html:m.default.bool,delayHide:m.default.number,delayShow:m.default.number,event:m.default.string,eventOff:m.default.string,watchWindow:m.default.bool,isCapture:m.default.bool,globalEventOff:m.default.string,getContent:m.default.any,afterShow:m.default.func,afterHide:m.default.func,disable:m.default.bool,scrollHide:m.default.bool,resizeHide:m.default.bool,wrapper:m.default.string},l.defaultProps={insecure:!0,resizeHide:!0,wrapper:"div"},l.supportedWrappers=["div","span"],s=u))||s)||s)||s)||s)||s)||s;e.exports=F},function(e,t,r){(function(t){if("production"!==t.env.NODE_ENV){var n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,i=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n};e.exports=r(104)(i,!0)}else e.exports=r(106)()}).call(t,r(5))},function(e,t,r){"use strict";(function(t){var n=r(29),i=n;if("production"!==t.env.NODE_ENV){var o=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=0,o="Warning: "+e.replace(/%s/g,function(){return r[i++]});"undefined"!=typeof console&&console.error(o);try{throw new Error(o)}catch(e){}};i=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];o.apply(void 0,[t].concat(n))}}}e.exports=i}).call(t,r(5))},function(e,t,r){"use strict";function n(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,s,l=n(e),u=1;u<arguments.length;u++){r=Object(arguments[u]);for(var c in r)o.call(r,c)&&(l[c]=r[c]);if(i){s=i(r);for(var h=0;h<s.length;h++)a.call(r,s[h])&&(l[s[h]]=r[s[h]])}}return l}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={GLOBAL:{HIDE:"__react_tooltip_hide_event",REBUILD:"__react_tooltip_rebuild_event",SHOW:"__react_tooltip_show_event"}}},function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.exports=r}).call(t,r(124))},function(e,t,r){function n(e,t){return e&&i(e,t,o)}var i=r(127),o=r(20);e.exports=n},function(e,t,r){function n(e,t){var r=a(e),n=!r&&o(e),c=!r&&!n&&s(e),d=!r&&!n&&!c&&u(e),f=r||n||c||d,p=f?i(e.length,String):[],m=p.length;for(var v in e)!t&&!h.call(e,v)||f&&("length"==v||c&&("offset"==v||"parent"==v)||d&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||l(v,m))||p.push(v);return p}var i=r(129),o=r(59),a=r(3),s=r(34),l=r(60),u=r(61),c=Object.prototype,h=c.hasOwnProperty;e.exports=n},function(e,t,r){var n=r(130),i=r(13),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(e){return i(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},function(e,t){function r(e,t){return!!(t=null==t?n:t)&&("number"==typeof e||i.test(e))&&e>-1&&e%1==0&&e<t}var n=9007199254740991,i=/^(?:0|[1-9]\d*)$/;e.exports=r},function(e,t,r){var n=r(132),i=r(133),o=r(134),a=o&&o.isTypedArray,s=a?i(a):n;e.exports=s},function(e,t){function r(e,t){return function(r){return e(t(r))}}e.exports=r},function(e,t,r){function n(e){if(!o(e))return!1;var t=i(e);return t==s||t==l||t==a||t==u}var i=r(12),o=r(7),a="[object AsyncFunction]",s="[object Function]",l="[object GeneratorFunction]",u="[object Proxy]";e.exports=n},function(e,t,r){function n(e){return"function"==typeof e?e:i}var i=r(65);e.exports=n},function(e,t){function r(e){return e}e.exports=r},function(e,t){function r(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}e.exports=r},function(e,t){function r(e){if(null!=e){try{return i.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var n=Function.prototype,i=n.toString;e.exports=r},function(e,t,r){function n(e,t,r,a,s){return e===t||(null==e||null==t||!o(e)&&!o(t)?e!==e&&t!==t:i(e,t,r,a,n,s))}var i=r(167),o=r(13);e.exports=n},function(e,t,r){function n(e,t,r,n,u,c){var h=r&s,d=e.length,f=t.length;if(d!=f&&!(h&&f>d))return!1;var p=c.get(e);if(p&&c.get(t))return p==t;var m=-1,v=!0,g=r&l?new i:void 0;for(c.set(e,t),c.set(t,e);++m<d;){var y=e[m],b=t[m];if(n)var _=h?n(b,y,m,t,e,c):n(y,b,m,e,t,c);if(void 0!==_){if(_)continue;v=!1;break}if(g){if(!o(t,function(e,t){if(!a(g,t)&&(y===e||u(y,e,r,n,c)))return g.push(t)})){v=!1;break}}else if(y!==b&&!u(y,b,r,n,c)){v=!1;break}}return c.delete(e),c.delete(t),v}var i=r(168),o=r(171),a=r(172),s=1,l=2;e.exports=n},function(e,t,r){var n=r(4),i=n.Uint8Array;e.exports=i},function(e,t){function r(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}e.exports=r},function(e,t){function r(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}e.exports=r},function(e,t,r){function n(e){return i(e,a,o)}var i=r(74),o=r(43),a=r(20);e.exports=n},function(e,t,r){function n(e,t,r){var n=t(e);return o(e)?n:i(n,r(e))}var i=r(75),o=r(3);e.exports=n},function(e,t){function r(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}e.exports=r},function(e,t){function r(){return[]}e.exports=r},function(e,t,r){var n=r(176),i=r(41),o=r(177),a=r(178),s=r(179),l=r(12),u=r(67),c=u(n),h=u(i),d=u(o),f=u(a),p=u(s),m=l;(n&&"[object DataView]"!=m(new n(new ArrayBuffer(1)))||i&&"[object Map]"!=m(new i)||o&&"[object Promise]"!=m(o.resolve())||a&&"[object Set]"!=m(new a)||s&&"[object WeakMap]"!=m(new s))&&(m=function(e){var t=l(e),r="[object Object]"==t?e.constructor:void 0,n=r?u(r):"";if(n)switch(n){case c:return"[object DataView]";case h:return"[object Map]";case d:return"[object Promise]";case f:return"[object Set]";case p:return"[object WeakMap]"}return t}),e.exports=m},function(e,t,r){function n(e){return e===e&&!i(e)}var i=r(7);e.exports=n},function(e,t){function r(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}e.exports=r},function(e,t,r){function n(e,t){t=i(t,e);for(var r=0,n=t.length;null!=e&&r<n;)e=e[o(t[r++])];return r&&r==n?e:void 0}var i=r(81),o=r(27);e.exports=n},function(e,t,r){function n(e,t){return i(e)?e:o(e,t)?[e]:a(s(e))}var i=r(3),o=r(44),a=r(183),s=r(186);e.exports=n},function(e,t,r){var n=r(57),i=r(195),o=i(n);e.exports=o},function(e,t){function r(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}e.exports=r},function(e,t,r){function n(e,t,r){var n=e[t];s.call(e,t)&&o(n,r)&&(void 0!==r||t in e)||i(e,t,r)}var i=r(85),o=r(40),a=Object.prototype,s=a.hasOwnProperty;e.exports=n},function(e,t,r){function n(e,t,r){"__proto__"==t&&i?i(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var i=r(199);e.exports=n},function(e,t,r){function n(e){return a(e)?i(e,!0):o(e)}var i=r(58),o=r(202),a=r(21);e.exports=n},function(e,t,r){var n=r(75),i=r(38),o=r(43),a=r(76),s=Object.getOwnPropertySymbols,l=s?function(e){for(var t=[];e;)n(t,o(e)),e=i(e);return t}:a;e.exports=l},function(e,t){function r(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}e.exports=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Checkboard=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(227),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),c=t.Checkboard=function(e){var t=e.white,r=e.grey,n=e.size,i=e.renderers,a=e.borderRadius,l=e.boxShadow,c=(0,s.default)({default:{grid:{borderRadius:a,boxShadow:l,absolute:"0px 0px 0px 0px",background:"url("+u.get(t,r,n,i.canvas)+") center left"}}});return o.default.createElement("div",{style:c.grid})};c.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}},t.default=c},function(e,t,r){function n(e,t,r){function n(t){var r=y,n=b;return y=b=void 0,E=t,w=e.apply(n,r)}function c(e){return E=e,x=setTimeout(f,t),A?n(e):w}function h(e){var r=e-M,n=e-E,i=t-r;return T?u(i,_-n):i}function d(e){var r=e-M,n=e-E;return void 0===M||r>=t||r<0||T&&n>=_}function f(){var e=o();if(d(e))return p(e);x=setTimeout(f,h(e))}function p(e){return x=void 0,k&&y?n(e):(y=b=void 0,w)}function m(){void 0!==x&&clearTimeout(x),E=0,y=M=b=x=void 0}function v(){return void 0===x?w:p(o())}function g(){var e=o(),r=d(e);if(y=arguments,b=this,M=e,r){if(void 0===x)return c(M);if(T)return x=setTimeout(f,t),n(M)}return void 0===x&&(x=setTimeout(f,t)),w}var y,b,_,w,x,M,E=0,A=!1,T=!1,k=!0;if("function"!=typeof e)throw new TypeError(s);return t=a(t)||0,i(r)&&(A=!!r.leading,T="maxWait"in r,_=T?l(a(r.maxWait)||0,t):_,k="trailing"in r?!!r.trailing:k),g.cancel=m,g.flush=v,g}var i=r(7),o=r(233),a=r(234),s="Expected a function",l=Math.max,u=Math.min;e.exports=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ColorWrap=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),c=n(u),h=r(90),d=n(h),f=r(8),p=n(f),m=t.ColorWrap=function(e){var t=function(t){function r(e){i(this,r);var t=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return t.handleChange=function(e,r){if(p.default.simpleCheckForValidColor(e)){var n=p.default.toState(e,e.h||t.state.oldHue);t.setState(n),t.props.onChangeComplete&&t.debounce(t.props.onChangeComplete,n,r),t.props.onChange&&t.props.onChange(n,r)}},t.handleSwatchHover=function(e,r){if(p.default.simpleCheckForValidColor(e)){var n=p.default.toState(e,e.h||t.state.oldHue);t.setState(n),t.props.onSwatchHover&&t.props.onSwatchHover(n,r)}},t.state=s({},p.default.toState(e.color,0)),t.debounce=(0,d.default)(function(e,t,r){e(t,r)},100),t}return a(r,t),l(r,[{key:"componentWillReceiveProps",value:function(e){this.setState(s({},p.default.toState(e.color,this.state.oldHue)))}},{key:"render",value:function(){var t={};return this.props.onSwatchHover&&(t.onSwatchHover=this.handleSwatchHover),c.default.createElement(e,s({},this.props,this.state,{onChange:this.handleChange},t))}}]),r}(u.PureComponent||u.Component);return t.defaultProps={color:{h:250,s:.5,l:.2,a:1}},t};t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"red",function(){return n}),r.d(t,"pink",function(){return i}),r.d(t,"purple",function(){return o}),r.d(t,"deepPurple",function(){return a}),r.d(t,"indigo",function(){return s}),r.d(t,"blue",function(){return l}),r.d(t,"lightBlue",function(){return u}),r.d(t,"cyan",function(){return c}),r.d(t,"teal",function(){return h}),r.d(t,"green",function(){return d}),r.d(t,"lightGreen",function(){return f}),r.d(t,"lime",function(){return p}),r.d(t,"yellow",function(){return m}),r.d(t,"amber",function(){return v}),r.d(t,"orange",function(){return g}),r.d(t,"deepOrange",function(){return y}),r.d(t,"brown",function(){return b}),r.d(t,"grey",function(){return _}),r.d(t,"blueGrey",function(){return w}),r.d(t,"darkText",function(){return x}),r.d(t,"lightText",function(){return M}),r.d(t,"darkIcons",function(){return E}),r.d(t,"lightIcons",function(){return A}),r.d(t,"white",function(){return T}),r.d(t,"black",function(){return k});var n={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",a100:"#ff8a80",a200:"#ff5252",a400:"#ff1744",a700:"#d50000"},i={50:"#fce4ec",100:"#f8bbd0",200:"#f48fb1",300:"#f06292",400:"#ec407a",500:"#e91e63",600:"#d81b60",700:"#c2185b",800:"#ad1457",900:"#880e4f",a100:"#ff80ab",a200:"#ff4081",a400:"#f50057",a700:"#c51162"},o={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",a100:"#ea80fc",a200:"#e040fb",a400:"#d500f9",a700:"#aa00ff"},a={50:"#ede7f6",100:"#d1c4e9",200:"#b39ddb",300:"#9575cd",400:"#7e57c2",500:"#673ab7",600:"#5e35b1",700:"#512da8",800:"#4527a0",900:"#311b92",a100:"#b388ff",a200:"#7c4dff",a400:"#651fff",a700:"#6200ea"},s={50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",a100:"#8c9eff",a200:"#536dfe",a400:"#3d5afe",a700:"#304ffe"},l={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",a100:"#82b1ff",a200:"#448aff",a400:"#2979ff",a700:"#2962ff"},u={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",a100:"#80d8ff",a200:"#40c4ff",a400:"#00b0ff",a700:"#0091ea"},c={50:"#e0f7fa",100:"#b2ebf2",200:"#80deea",300:"#4dd0e1",400:"#26c6da",500:"#00bcd4",600:"#00acc1",700:"#0097a7",800:"#00838f",900:"#006064",a100:"#84ffff",a200:"#18ffff",a400:"#00e5ff",a700:"#00b8d4"},h={50:"#e0f2f1",100:"#b2dfdb",200:"#80cbc4",300:"#4db6ac",400:"#26a69a",500:"#009688",600:"#00897b",700:"#00796b",800:"#00695c",900:"#004d40",a100:"#a7ffeb",a200:"#64ffda",a400:"#1de9b6",a700:"#00bfa5"},d={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",a100:"#b9f6ca",a200:"#69f0ae",a400:"#00e676",a700:"#00c853"},f={50:"#f1f8e9",100:"#dcedc8",200:"#c5e1a5",300:"#aed581",400:"#9ccc65",500:"#8bc34a",600:"#7cb342",700:"#689f38",800:"#558b2f",900:"#33691e",a100:"#ccff90",a200:"#b2ff59",a400:"#76ff03",a700:"#64dd17"},p={50:"#f9fbe7",100:"#f0f4c3",200:"#e6ee9c",300:"#dce775",400:"#d4e157",500:"#cddc39",600:"#c0ca33",700:"#afb42b",800:"#9e9d24",900:"#827717",a100:"#f4ff81",a200:"#eeff41",a400:"#c6ff00",a700:"#aeea00"},m={50:"#fffde7",100:"#fff9c4",200:"#fff59d",300:"#fff176",400:"#ffee58",500:"#ffeb3b",600:"#fdd835",700:"#fbc02d",800:"#f9a825",900:"#f57f17",a100:"#ffff8d",a200:"#ffff00",a400:"#ffea00",a700:"#ffd600"},v={50:"#fff8e1",100:"#ffecb3",200:"#ffe082",300:"#ffd54f",400:"#ffca28",500:"#ffc107",600:"#ffb300",700:"#ffa000",800:"#ff8f00",900:"#ff6f00",a100:"#ffe57f",a200:"#ffd740",a400:"#ffc400",a700:"#ffab00"},g={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",a100:"#ffd180",a200:"#ffab40",a400:"#ff9100",a700:"#ff6d00"},y={50:"#fbe9e7",100:"#ffccbc",200:"#ffab91",300:"#ff8a65",400:"#ff7043",500:"#ff5722",600:"#f4511e",700:"#e64a19",800:"#d84315",900:"#bf360c",a100:"#ff9e80",a200:"#ff6e40",a400:"#ff3d00",a700:"#dd2c00"},b={50:"#efebe9",100:"#d7ccc8",200:"#bcaaa4",300:"#a1887f",400:"#8d6e63",500:"#795548",600:"#6d4c41",700:"#5d4037",800:"#4e342e",900:"#3e2723"},_={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121"},w={50:"#eceff1",100:"#cfd8dc",200:"#b0bec5",300:"#90a4ae",400:"#78909c",500:"#607d8b",600:"#546e7a",700:"#455a64",800:"#37474f",900:"#263238"},x={primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",dividers:"rgba(0, 0, 0, 0.12)"},M={primary:"rgba(255, 255, 255, 1)",secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",dividers:"rgba(255, 255, 255, 0.12)"},E={active:"rgba(0, 0, 0, 0.54)",inactive:"rgba(0, 0, 0, 0.38)"},A={active:"rgba(255, 255, 255, 1)",inactive:"rgba(255, 255, 255, 0.5)"},T="#ffffff",k="#000000";t.default={red:n,pink:i,purple:o,deepPurple:a,indigo:s,blue:l,lightBlue:u,cyan:c,teal:h,green:d,lightGreen:f,lime:p,yellow:m,amber:v,orange:g,deepOrange:y,brown:b,grey:_,blueGrey:w,darkText:x,lightText:M,darkIcons:E,lightIcons:A,white:T,black:k}},function(e,t,r){"use strict";(function(t){var n=r(48),i=n;if("production"!==t.env.NODE_ENV){var o=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=0,o="Warning: "+e.replace(/%s/g,function(){return r[i++]});"undefined"!=typeof console&&console.error(o);try{throw new Error(o)}catch(e){}};i=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];o.apply(void 0,[t].concat(n))}}}e.exports=i}).call(t,r(5))},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u={mycheckbox:{width:"50px",height:"21px",margin:"0px",position:"relative",background:"#111",border:"1px solid black",boxShadow:"inset 0px 1px 1px rgba(0,0,0,0.5), 0px 1px 0px rgba(255,255,255,0.2)"},mycheckboxlabel:{display:"block",width:"30px",height:"19px",cursor:"pointer",background:"#555",border:"1px solid black",transition:"all 0.4s ease",boxShadow:"0px 2px 5px 0px rgba(0,0,0,0.3)",font:"8px/13px Arial, sans-serif",fontWeight:"bold",textShadow:"1px 1px 0px rgba(255,255,255,.15)",textAlign:"center",verticleAlign:"middle",lineHeight:"19px"},mycheckboxinput:{visibility:"hidden"}},c=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onChangeHandler=r.onChangeHandler.bind(r),r.state={checked:!!e.checked&&e.checked},r}return o(t,e),a(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({checked:!!e.checked&&e.checked})}},{key:"onChangeHandler",value:function(e){var t=!this.state.checked;if(this.props.onChange)try{this.props.onChange(t)}catch(e){return}this.setState({checked:t})}},{key:"render",value:function(){var e=this.state.checked?"ON":"OFF",t=this.state.checked?{paddingLeft:"20px"}:{paddingLeft:"0px"},r=this.state.checked?{color:"#1111aa"}:{color:"#111"};return l.default.createElement("div",{style:Object.assign({},u.mycheckbox,t),onClick:this.onChangeHandler},l.default.createElement("label",{style:Object.assign({},u.mycheckboxlabel,r)},e))}}]),t}(l.default.Component);t.default=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var i=r(0),o=n(i),a=r(16),s=n(a),l=r(96),u=n(l);s.default.render(o.default.createElement(u.default,{sandboxOptions:{altizureApi:{key:"ohO1y6HuBotONHi8hVCrAW9vws0HjvSATmvr6j9",token:"kBhWa7yYKVAXyubwRfKvCKqf4QMhu4LinHYtL2t7ZVSduozEGCTOF B9ZQTEruNX17ZJceVVWwQwkKPABc3DtNcbU0F7wTWkQpyE9HXJf8xIVZN2XZolOu03v3Bd7"},camera:{poseTo:{alt:319.02169601663104,lat:22.5364271949327,lng:113.93977612840078,north:56.82289356559219,tilt:56.19205822511624},flyTo:{alt:319.02169601663104,lat:22.5364271949327,lng:113.93977612840078,north:56.82289356559219,tilt:56.19205822511624}},renderItems:{earth:!0,earthUseTexture:!0,featureInView:!1,orbitRing:!0}}}),document.getElementById("root"))},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(10),h=r(16),d=n(h),f=r(97),p=r(102),m=n(p),v=r(296),g=n(v),y=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.sandbox=null,r.serviceManager=null,r.pageContent=u.default.createElement("div",{id:"page-content",style:{height:"100vh",padding:"0px"}}),r.toolboxContent=u.default.createElement("div",{id:"toolbox-content"}),r}return a(t,e),s(t,[{key:"componentDidMount",value:function(){this.sandbox=new c.Sandbox("page-content",this.props.sandboxOptions);var e=this.sandbox;this.serviceManager=new g.default({earth:e}),e.add("AltizureProjectMarker",{pid:"5849104597b73e0b090c01e8"});var t=document.getElementById("toolbox-content");d.default.render(u.default.createElement(f.AppContainer,null,u.default.createElement(m.default,{earth:e,serviceManager:this.serviceManager})),t)}},{key:"componentWillUnmount",value:function(){this.sandbox.destruct()}},{key:"render",value:function(){return u.default.createElement("div",null,this.pageContent,this.toolboxContent)}}]),t}(u.default.Component);t.default=y},function(e,t,r){e.exports=r(98)},function(e,t,r){"use strict";e.exports=r(99)},function(e,t,r){"use strict";e.exports.AppContainer=r(100)},function(e,t,r){"use strict";e.exports=r(101)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),l=s.Component,u=function(e){function t(){return n(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"render",value:function(){return this.props.component?s.createElement(this.props.component,this.props.props):s.Children.only(this.props.children)}}]),t}(l);e.exports=u},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(103),h=n(c),d=r(120),f=n(d),p=r(285),m=n(p),v=r(286),g=n(v),y=r(290),b=n(y),_=r(291),w=n(_),x=r(292),M=n(x),E=r(295),A=n(E),T=[{kind:"insert",icon:"fa fa-plus",serviceName:"insertservice",UIComponent:f.default},{kind:"draw",icon:"fa fa-pencil",serviceName:"drawservice",UIComponent:m.default},{kind:"remove",icon:"fa fa-minus",serviceName:"removeservice"},{kind:"poseture",icon:"fa fa-hand-grab-o",serviceName:"posetureservice",UIComponent:b.default},{kind:"shader",icon:"fa fa-adjust",serviceName:"shaderservice",UIComponent:g.default},{kind:"camera animation",icon:"fa fa-camera",serviceName:"cameraservice",UIComponent:w.default},{kind:"marker panel",icon:"fa fa-slack",serviceName:"markerservice",UIComponent:M.default},{kind:"save scene",icon:"fa fa-floppy-o",serviceName:"savesceneservice"},{kind:"measurements",icon:"fa fa-arrows-alt",serviceName:"measureservice",UIComponent:A.default}],k=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={},r}return a(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"main_view"},u.default.createElement(h.default,{tools:T,serviceManager:this.props.serviceManager,earth:this.props.earth}))}}]),t}(u.default.Component);t.default=k},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(17),h=n(c),d=r(119),f=n(d),p={toolBox:{position:"absolute",top:"20px",right:"10px",width:"40px",backgroundColor:"#000033",zIndex:10,padding:"0 0 0 0",marginBottom:0}},m=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.handleSelectTool=r.handleSelectTool.bind(r),r._handleDeactive=r._handleDeactive.bind(r),document.addEventListener("deactive_tool",r._handleDeactive,!1);var n=e.tools.map(function(e,t){return e.key=t,e});return r.state={tools:n,selectedTool:void 0},r.extra={},r}return a(t,e),s(t,[{key:"componentWillUnmount",value:function(){document.removeEventListener("deactive_tool",this._handleDeactive,!1)}},{key:"_handleDeactive",value:function(e){this.props.serviceManager.stopCurrentService(),this.setState({selectedTool:void 0})}},{key:"handleSelectTool",value:function(e){void 0!==this.state.selectedTool?(this.props.serviceManager.stopCurrentService(),this.state.selectedTool!==e?this.setState({selectedTool:e}):this.setState({selectedTool:void 0})):this.setState({selectedTool:e})}},{key:"render",value:function(){var e=this,t=parseInt(p.toolBox.width)*this.state.tools.length+"px",r=this.state.tools.map(function(t,r){var n=e.state.selectedTool===r;return u.default.createElement(h.default,{key:r,index:t.key,kind:t.kind,icon:t.icon,selectTool:e.handleSelectTool,selected:n})}),n=!1,i=null,o=null;if(void 0!==this.state.selectedTool){var a=this.state.tools[this.state.selectedTool];a.serviceName&&(i=this.props.serviceManager.getServiceByName(a.serviceName)),a.UIComponent&&(n=!0,o=a.UIComponent)}return u.default.createElement("div",null,u.default.createElement("div",{style:Object.assign({},p.toolBox,{height:t})},r),n&&u.default.createElement(f.default,{show:n,extra:this.extra,earth:this.props.earth},u.default.createElement(o,{service:i,extra:this.extra,earth:this.props.earth})))}}]),t}(u.default.Component);t.default=m},function(e,t,r){"use strict";(function(t){var n=r(29),i=r(30),o=r(53),a=r(54),s=r(31),l=r(105);e.exports=function(e,r){function u(e){var t=e&&(k&&e[k]||e[S]);if("function"==typeof t)return t}function c(e,t){return e===t?0!==e||1/e==1/t:e!==e&&t!==t}function h(e){this.message=e,this.stack=""}function d(e){function n(n,u,c,d,f,p,m){if(d=d||C,p=p||c,m!==s)if(r)i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if("production"!==t.env.NODE_ENV&&"undefined"!=typeof console){var v=d+":"+c;!a[v]&&l<3&&(o(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",p,d),a[v]=!0,l++)}return null==u[c]?n?new h(null===u[c]?"The "+f+" `"+p+"` is marked as required in `"+d+"`, but its value is `null`.":"The "+f+" `"+p+"` is marked as required in `"+d+"`, but its value is `undefined`."):null:e(u,c,d,f,p)}if("production"!==t.env.NODE_ENV)var a={},l=0;var u=n.bind(null,!1);return u.isRequired=n.bind(null,!0),u}function f(e){function t(t,r,n,i,o,a){var s=t[r];if(M(s)!==e)return new h("Invalid "+i+" `"+o+"` of type `"+E(s)+"` supplied to `"+n+"`, expected `"+e+"`.");return null}return d(t)}function p(e){function t(t,r,n,i,o){if("function"!=typeof e)return new h("Property `"+o+"` of component `"+n+"` has invalid PropType notation inside arrayOf.");var a=t[r];if(!Array.isArray(a)){return new h("Invalid "+i+" `"+o+"` of type `"+M(a)+"` supplied to `"+n+"`, expected an array.")}for(var l=0;l<a.length;l++){var u=e(a,l,n,i,o+"["+l+"]",s);if(u instanceof Error)return u}return null}return d(t)}function m(e){function t(t,r,n,i,o){if(!(t[r]instanceof e)){var a=e.name||C;return new h("Invalid "+i+" `"+o+"` of type `"+T(t[r])+"` supplied to `"+n+"`, expected instance of `"+a+"`.")}return null}return d(t)}function v(e){function r(t,r,n,i,o){for(var a=t[r],s=0;s<e.length;s++)if(c(a,e[s]))return null;return new h("Invalid "+i+" `"+o+"` of value `"+a+"` supplied to `"+n+"`, expected one of "+JSON.stringify(e)+".")}return Array.isArray(e)?d(r):("production"!==t.env.NODE_ENV&&o(!1,"Invalid argument supplied to oneOf, expected an instance of array."),n.thatReturnsNull)}function g(e){function t(t,r,n,i,o){if("function"!=typeof e)return new h("Property `"+o+"` of component `"+n+"` has invalid PropType notation inside objectOf.");var a=t[r],l=M(a);if("object"!==l)return new h("Invalid "+i+" `"+o+"` of type `"+l+"` supplied to `"+n+"`, expected an object.");for(var u in a)if(a.hasOwnProperty(u)){var c=e(a,u,n,i,o+"."+u,s);if(c instanceof Error)return c}return null}return d(t)}function y(e){function r(t,r,n,i,o){for(var a=0;a<e.length;a++){if(null==(0,e[a])(t,r,n,i,o,s))return null}return new h("Invalid "+i+" `"+o+"` supplied to `"+n+"`.")}if(!Array.isArray(e))return"production"!==t.env.NODE_ENV&&o(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),n.thatReturnsNull;for(var i=0;i<e.length;i++){var a=e[i];if("function"!=typeof a)return o(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",A(a),i),n.thatReturnsNull}return d(r)}function b(e){function t(t,r,n,i,o){var a=t[r],l=M(a);if("object"!==l)return new h("Invalid "+i+" `"+o+"` of type `"+l+"` supplied to `"+n+"`, expected `object`.");for(var u in e){var c=e[u];if(c){var d=c(a,u,n,i,o+"."+u,s);if(d)return d}}return null}return d(t)}function _(e){function t(t,r,n,i,o){var l=t[r],u=M(l);if("object"!==u)return new h("Invalid "+i+" `"+o+"` of type `"+u+"` supplied to `"+n+"`, expected `object`.");var c=a({},t[r],e);for(var d in c){var f=e[d];if(!f)return new h("Invalid "+i+" `"+o+"` key `"+d+"` supplied to `"+n+"`.\nBad object: "+JSON.stringify(t[r],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var p=f(l,d,n,i,o+"."+d,s);if(p)return p}return null}return d(t)}function w(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(w);if(null===t||e(t))return!0;var r=u(t);if(!r)return!1;var n,i=r.call(t);if(r!==t.entries){for(;!(n=i.next()).done;)if(!w(n.value))return!1}else for(;!(n=i.next()).done;){var o=n.value;if(o&&!w(o[1]))return!1}return!0;default:return!1}}function x(e,t){return"symbol"===e||("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}function M(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":x(t,e)?"symbol":t}function E(e){if(void 0===e||null===e)return""+e;var t=M(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function A(e){var t=E(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}function T(e){return e.constructor&&e.constructor.name?e.constructor.name:C}var k="function"==typeof Symbol&&Symbol.iterator,S="@@iterator",C="<<anonymous>>",P={array:f("array"),bool:f("boolean"),func:f("function"),number:f("number"),object:f("object"),string:f("string"),symbol:f("symbol"),any:function(){return d(n.thatReturnsNull)}(),arrayOf:p,element:function(){function t(t,r,n,i,o){var a=t[r];if(!e(a)){return new h("Invalid "+i+" `"+o+"` of type `"+M(a)+"` supplied to `"+n+"`, expected a single ReactElement.")}return null}return d(t)}(),instanceOf:m,node:function(){function e(e,t,r,n,i){return w(e[t])?null:new h("Invalid "+n+" `"+i+"` supplied to `"+r+"`, expected a ReactNode.")}return d(e)}(),objectOf:g,oneOf:v,oneOfType:y,shape:b,exact:_};return h.prototype=Error.prototype,P.checkPropTypes=l,P.PropTypes=P,P}}).call(t,r(5))},function(e,t,r){"use strict";(function(t){function n(e,r,n,l,u){if("production"!==t.env.NODE_ENV)for(var c in e)if(e.hasOwnProperty(c)){var h;try{i("function"==typeof e[c],"%s: %s type `%s` is invalid; it must be a function, usually from the `prop-types` package, but received `%s`.",l||"React class",n,c,typeof e[c]),h=e[c](r,c,l,n,null,a)}catch(e){h=e}if(o(!h||h instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",l||"React class",n,c,typeof h),h instanceof Error&&!(h.message in s)){s[h.message]=!0;var d=u?u():"";o(!1,"Failed %s type: %s%s",n,h.message,null!=d?d:"")}}}if("production"!==t.env.NODE_ENV)var i=r(30),o=r(53),a=r(31),s={};e.exports=n}).call(t,r(5))},function(e,t,r){"use strict";var n=r(29),i=r(30),o=r(31);e.exports=function(){function e(e,t,r,n,a,s){s!==o&&i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return r.checkPropTypes=n,r.PropTypes=r,r}},function(e,t,r){var n,i;/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n))e.push(r.apply(null,n));else if("object"===i)for(var a in n)o.call(n,a)&&n[a]&&e.push(a)}}return e.join(" ")}var o={}.hasOwnProperty;void 0!==e&&e.exports?e.exports=r:(n=[],void 0!==(i=function(){return r}.apply(t,n))&&(e.exports=i))}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.hide=function(e){o(i.default.GLOBAL.HIDE,{target:e})},e.rebuild=function(){o(i.default.GLOBAL.REBUILD)},e.show=function(e){o(i.default.GLOBAL.SHOW,{target:e})},e.prototype.globalRebuild=function(){this.mount&&(this.unbindListener(),this.bindListener())},e.prototype.globalShow=function(e){if(this.mount){var t={currentTarget:e.detail.target};this.showTooltip(t,!0)}},e.prototype.globalHide=function(e){if(this.mount){var t=e&&e.detail&&e.detail.target&&!0||!1;this.hideTooltip({currentTarget:t&&e.detail.target},t)}}};var n=r(55),i=function(e){return e&&e.__esModule?e:{default:e}}(n),o=function(e,t){var r=void 0;"function"==typeof window.CustomEvent?r=new window.CustomEvent(e,{detail:t}):(r=document.createEvent("Event"),r.initEvent(e,!1,!0),r.detail=t),window.dispatchEvent(r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.prototype.bindWindowEvents=function(e){window.removeEventListener(i.default.GLOBAL.HIDE,this.globalHide),window.addEventListener(i.default.GLOBAL.HIDE,this.globalHide,!1),window.removeEventListener(i.default.GLOBAL.REBUILD,this.globalRebuild),window.addEventListener(i.default.GLOBAL.REBUILD,this.globalRebuild,!1),window.removeEventListener(i.default.GLOBAL.SHOW,this.globalShow),window.addEventListener(i.default.GLOBAL.SHOW,this.globalShow,!1),e&&(window.removeEventListener("resize",this.onWindowResize),window.addEventListener("resize",this.onWindowResize,!1))},e.prototype.unbindWindowEvents=function(){window.removeEventListener(i.default.GLOBAL.HIDE,this.globalHide),window.removeEventListener(i.default.GLOBAL.REBUILD,this.globalRebuild),window.removeEventListener(i.default.GLOBAL.SHOW,this.globalShow),window.removeEventListener("resize",this.onWindowResize)},e.prototype.onWindowResize=function(){this.mount&&this.hideTooltip()}};var n=r(55),i=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.prototype.isCustomEvent=function(e){return this.state.event||!!e.getAttribute("data-event")},e.prototype.customBindListener=function(e){var t=this,r=this.state,i=r.event,a=r.eventOff,s=e.getAttribute("data-event")||i,l=e.getAttribute("data-event-off")||a;s.split(" ").forEach(function(r){e.removeEventListener(r,o),o=n.bind(t,l),e.addEventListener(r,o,!1)}),l&&l.split(" ").forEach(function(r){e.removeEventListener(r,t.hideTooltip),e.addEventListener(r,t.hideTooltip,!1)})},e.prototype.customUnbindListener=function(e){var t=this.state,r=t.event,n=t.eventOff,i=r||e.getAttribute("data-event"),a=n||e.getAttribute("data-event-off");e.removeEventListener(i,o),a&&e.removeEventListener(a,this.hideTooltip)}};var n=function(e,t){var r=this.state.show,n=this.props.id,o=t.currentTarget.getAttribute("data-iscapture"),a=o&&"true"===o||this.props.isCapture,s=t.currentTarget.getAttribute("currentItem");a||t.stopPropagation(),r&&"true"===s?e||this.hideTooltip(t):(t.currentTarget.setAttribute("currentItem","true"),i(t.currentTarget,this.getTargetArray(n)),this.showTooltip(t))},i=function(e,t){for(var r=0;r<t.length;r++)e!==t[r]?t[r].setAttribute("currentItem","false"):t[r].setAttribute("currentItem","true")},o=void 0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.prototype.isCapture=function(e){var t=e.getAttribute("data-iscapture");return t&&"true"===t||this.props.isCapture||!1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.prototype.getEffect=function(e){return e.getAttribute("data-effect")||this.props.effect||"float"}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.prototype.bindRemovalTracker=function(){var e=this,t=n();if(null!=t){var r=new t(function(t){var r=!0,n=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var s=o.value,l=!0,u=!1,c=void 0;try{for(var h,d=s.removedNodes[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){if(h.value===e.state.currentTarget)return void e.hideTooltip()}}catch(e){u=!0,c=e}finally{try{!l&&d.return&&d.return()}finally{if(u)throw c}}}}catch(e){n=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(n)throw i}}});r.observe(window.document,{childList:!0,subtree:!0}),this.removalTracker=r}},e.prototype.unbindRemovalTracker=function(){this.removalTracker&&(this.removalTracker.disconnect(),this.removalTracker=null)}};var n=function(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,s,l,u){var c=r.clientWidth,h=r.clientHeight,d=n(e,t,l),f=d.mouseX,p=d.mouseY,m=i(l,t.clientWidth,t.clientHeight,c,h),v=o(u),g=v.extraOffset_X,y=v.extraOffset_Y,b=window.innerWidth,_=window.innerHeight,w=a(r),x=w.parentTop,M=w.parentLeft,E=function(e){var t=m[e].l;return f+t+g},A=function(e){var t=m[e].r;return f+t+g},T=function(e){var t=m[e].t;return p+t+y},k=function(e){var t=m[e].b;return p+t+y},S=function(){var e=!1,t=void 0;return T("left")<0&&k("left")<=_&&k("bottom")<=_?(e=!0,t="bottom"):k("left")>_&&T("left")>=0&&T("top")>=0&&(e=!0,t="top"),{result:e,newPlace:t}},C=function(){var e=!1,t=void 0;return E("top")<0&&A("top")<=b&&A("right")<=b?(e=!0,t="right"):A("top")>b&&E("top")>=0&&E("left")>=0&&(e=!0,t="left"),{result:e,newPlace:t}},P=function(){var e=S(),t=e.result,r=e.newPlace;return t&&C().result?{result:!1}:(!t&&E("left")<0&&A("right")<=b&&(t=!0,r="right"),{result:t,newPlace:r})}(),O=function(){var e=S(),t=e.result,r=e.newPlace;return t&&C().result?{result:!1}:(!t&&A("right")>b&&E("left")>=0&&(t=!0,r="left"),{result:t,newPlace:r})}(),R=function(){var e=C(),t=e.result,r=e.newPlace;return t&&S().result?{result:!1}:(!t&&T("top")<0&&k("bottom")<=_&&(t=!0,r="bottom"),{result:t,newPlace:r})}(),L=function(){var e=C(),t=e.result,r=e.newPlace;return t&&S().result?{result:!1}:(!t&&k("bottom")>_&&T("top")>=0&&(t=!0,r="top"),{result:t,newPlace:r})}();return"left"===s&&P.result?{isNewState:!0,newState:{place:P.newPlace}}:"right"===s&&O.result?{isNewState:!0,newState:{place:O.newPlace}}:"top"===s&&R.result?{isNewState:!0,newState:{place:R.newPlace}}:"bottom"===s&&L.result?{isNewState:!0,newState:{place:L.newPlace}}:{isNewState:!1,position:{left:parseInt(E(s)-M,10),top:parseInt(T(s)-x,10)}}};var n=function(e,t,r){var n=t.getBoundingClientRect(),i=n.top,o=n.left,a=t.clientWidth,s=t.clientHeight;return"float"===r?{mouseX:e.clientX,mouseY:e.clientY}:{mouseX:o+a/2,mouseY:i+s/2}},i=function(e,t,r,n,i){var o=void 0,a=void 0,s=void 0,l=void 0;return"float"===e?(o={l:-n/2,r:n/2,t:-(i+3+2),b:-3},s={l:-n/2,r:n/2,t:15,b:i+3+2+12},l={l:-(n+3+2),r:-3,t:-i/2,b:i/2},a={l:3,r:n+3+2,t:-i/2,b:i/2}):"solid"===e&&(o={l:-n/2,r:n/2,t:-(r/2+i+2),b:-r/2},s={l:-n/2,r:n/2,t:r/2,b:r/2+i+2},l={l:-(n+t/2+2),r:-t/2,t:-i/2,b:i/2},a={l:t/2,r:n+t/2+2,t:-i/2,b:i/2}),{top:o,bottom:s,left:l,right:a}},o=function(e){var t=0,r=0;"[object String]"===Object.prototype.toString.apply(e)&&(e=JSON.parse(e.toString().replace(/\'/g,'"')));for(var n in e)"top"===n?r-=parseInt(e[n],10):"bottom"===n?r+=parseInt(e[n],10):"left"===n?t-=parseInt(e[n],10):"right"===n&&(t+=parseInt(e[n],10));return{extraOffset_X:t,extraOffset_Y:r}},a=function(e){for(var t=e;t&&"none"===window.getComputedStyle(t).getPropertyValue("transform");)t=t.parentElement;return{parentTop:t&&t.getBoundingClientRect().top||0,parentLeft:t&&t.getBoundingClientRect().left||0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,n){if(t)return t;if(void 0!==r&&null!==r)return r;if(null===r)return null;var o=/<br\s*\/?>/;return n&&"false"!==n&&o.test(e)?e.split(o).map(function(e,t){return i.default.createElement("span",{key:t,className:"multi-line"},e)}):e};var n=r(0),i=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,r){"use strict";function n(e){var t={};return Object.keys(e).filter(function(e){return/(^aria-\w+$|^role$)/.test(e)}).forEach(function(r){t[r]=e[r]}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.parseAria=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.length;return e.hasOwnProperty?Array.prototype.slice.call(e):new Array(t).fill().map(function(t){return e[t]})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default='.__react_component_tooltip{border-radius:3px;display:inline-block;font-size:13px;left:-999em;opacity:0;padding:8px 21px;position:fixed;pointer-events:none;transition:opacity 0.3s ease-out;top:-999em;visibility:hidden;z-index:999}.__react_component_tooltip:before,.__react_component_tooltip:after{content:"";width:0;height:0;position:absolute}.__react_component_tooltip.show{opacity:0.9;margin-top:0px;margin-left:0px;visibility:visible}.__react_component_tooltip.type-dark{color:#fff;background-color:#222}.__react_component_tooltip.type-dark.place-top:after{border-top-color:#222;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-dark.place-bottom:after{border-bottom-color:#222;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-dark.place-left:after{border-left-color:#222;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-dark.place-right:after{border-right-color:#222;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-dark.border{border:1px solid #fff}.__react_component_tooltip.type-dark.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-dark.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-dark.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-dark.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-success{color:#fff;background-color:#8DC572}.__react_component_tooltip.type-success.place-top:after{border-top-color:#8DC572;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-success.place-bottom:after{border-bottom-color:#8DC572;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-success.place-left:after{border-left-color:#8DC572;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-success.place-right:after{border-right-color:#8DC572;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-success.border{border:1px solid #fff}.__react_component_tooltip.type-success.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-success.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-success.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-success.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-warning{color:#fff;background-color:#F0AD4E}.__react_component_tooltip.type-warning.place-top:after{border-top-color:#F0AD4E;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-warning.place-bottom:after{border-bottom-color:#F0AD4E;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-warning.place-left:after{border-left-color:#F0AD4E;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-warning.place-right:after{border-right-color:#F0AD4E;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-warning.border{border:1px solid #fff}.__react_component_tooltip.type-warning.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-warning.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-warning.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-warning.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-error{color:#fff;background-color:#BE6464}.__react_component_tooltip.type-error.place-top:after{border-top-color:#BE6464;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-error.place-bottom:after{border-bottom-color:#BE6464;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-error.place-left:after{border-left-color:#BE6464;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-error.place-right:after{border-right-color:#BE6464;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-error.border{border:1px solid #fff}.__react_component_tooltip.type-error.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-error.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-error.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-error.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-info{color:#fff;background-color:#337AB7}.__react_component_tooltip.type-info.place-top:after{border-top-color:#337AB7;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-info.place-bottom:after{border-bottom-color:#337AB7;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-info.place-left:after{border-left-color:#337AB7;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-info.place-right:after{border-right-color:#337AB7;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-info.border{border:1px solid #fff}.__react_component_tooltip.type-info.border.place-top:before{border-top:8px solid #fff}.__react_component_tooltip.type-info.border.place-bottom:before{border-bottom:8px solid #fff}.__react_component_tooltip.type-info.border.place-left:before{border-left:8px solid #fff}.__react_component_tooltip.type-info.border.place-right:before{border-right:8px solid #fff}.__react_component_tooltip.type-light{color:#222;background-color:#fff}.__react_component_tooltip.type-light.place-top:after{border-top-color:#fff;border-top-style:solid;border-top-width:6px}.__react_component_tooltip.type-light.place-bottom:after{border-bottom-color:#fff;border-bottom-style:solid;border-bottom-width:6px}.__react_component_tooltip.type-light.place-left:after{border-left-color:#fff;border-left-style:solid;border-left-width:6px}.__react_component_tooltip.type-light.place-right:after{border-right-color:#fff;border-right-style:solid;border-right-width:6px}.__react_component_tooltip.type-light.border{border:1px solid #222}.__react_component_tooltip.type-light.border.place-top:before{border-top:8px solid #222}.__react_component_tooltip.type-light.border.place-bottom:before{border-bottom:8px solid #222}.__react_component_tooltip.type-light.border.place-left:before{border-left:8px solid #222}.__react_component_tooltip.type-light.border.place-right:before{border-right:8px solid #222}.__react_component_tooltip.place-top{margin-top:-10px}.__react_component_tooltip.place-top:before{border-left:10px solid transparent;border-right:10px solid transparent;bottom:-8px;left:50%;margin-left:-10px}.__react_component_tooltip.place-top:after{border-left:8px solid transparent;border-right:8px solid transparent;bottom:-6px;left:50%;margin-left:-8px}.__react_component_tooltip.place-bottom{margin-top:10px}.__react_component_tooltip.place-bottom:before{border-left:10px solid transparent;border-right:10px solid transparent;top:-8px;left:50%;margin-left:-10px}.__react_component_tooltip.place-bottom:after{border-left:8px solid transparent;border-right:8px solid transparent;top:-6px;left:50%;margin-left:-8px}.__react_component_tooltip.place-left{margin-left:-10px}.__react_component_tooltip.place-left:before{border-top:6px solid transparent;border-bottom:6px solid transparent;right:-8px;top:50%;margin-top:-5px}.__react_component_tooltip.place-left:after{border-top:5px solid transparent;border-bottom:5px solid transparent;right:-6px;top:50%;margin-top:-4px}.__react_component_tooltip.place-right{margin-left:10px}.__react_component_tooltip.place-right:before{border-top:6px solid transparent;border-bottom:6px solid transparent;left:-8px;top:50%;margin-top:-5px}.__react_component_tooltip.place-right:after{border-top:5px solid transparent;border-bottom:5px solid transparent;left:-6px;top:50%;margin-top:-4px}.__react_component_tooltip .multi-line{display:block;padding:2px 0px;text-align:center}'},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u={panel:{position:"absolute",top:"20px",left:"20px",width:"300px",height:"500px",zIndex:10,padding:"0 0 0 0",marginBottom:0,backgroundColor:"#595959",borderRadius:"4px",opacity:.9},panelHovered:{opacity:.9}},c=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.panelClick=r.panelClick.bind(r),r.state={hovered:!1},r.height=500,r.setHeight=r.setHeight.bind(r),r.props.extra.setPanelHeight=r.setHeight,r}return o(t,e),a(t,[{key:"panelClick",value:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},{key:"setHeight",value:function(e){this.height=e,this.forceUpdate()}},{key:"render",value:function(){return l.default.createElement("div",{className:"container",style:Object.assign({},u.panel,this.state.hovered&&u.panelHovered,{display:this.props.show?"block":"none",height:this.height}),onMouseUp:this.panelClick},this.props.children)}}]),t}(l.default.Component);t.default=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),c=n(u),h=r(17),d=n(h),f=r(18),p=n(f),m=r(6),v=n(m),g=r(11),y=(n(g),{wrapper:{fontFamily:"Open Sans, sans-serif",fontSize:"1.5rem",height:"100%",zIndex:20},container:{padding:"0 0 0 0",width:"100%",height:"100%"},form:{width:"90%",padding:"10px 0 30px 0",margin:"0 auto",color:"white",letterSpacing:"1px"},submitBtn:{float:"right"},label:{width:"100%"},input:{width:"100%",fontSize:"12px",backgroundColor:"#2a2b2d",border:"none",borderRadius:"3px",height:"25px"},tabs:{width:"100%",margin:"none",padding:"0 0 0 0",height:"40px",borderBottomStyle:"solid",borderBottomColor:"black"}}),b=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleSubmit=r.handleSubmit.bind(r),r.handleInputChange=r.handleInputChange.bind(r),r.handleChange=r.handleChange.bind(r),r.setOBJMarkerScaleHandler=r.setOBJMarkerScaleHandler.bind(r),r.setTagMarkerScaleHandler=r.setTagMarkerScaleHandler.bind(r),r.tabDescription=[{kind:"URL",icon:"fa fa-link"},{kind:"Project ID",icon:"fa fa-product-hunt"},{kind:"SCENES",icon:"fa fa-picture-o"},{kind:"Tag Marker",icon:"fa fa-map-marker"}],r.initState={mode:0,name:"",objURL:"",mtlURL:"",projectID:"",scene:"",upDirection:2,scale:1,tagImgUrl:"",tagName:"",tagScale:1},r.state=r.initState,r}return s(t,e),l(t,[{key:"handleChange",value:function(e){if(this.setState({upDirection:e}),0===this.state.mode&&this.state.name.length>0&&this.state.objURL.length>0){var t={x:0,y:0,z:0};0===e?t.x=1:1===e?t.y=1:2===e&&(t.z=1);var r={type:"OBJMarker",name:this.state.name,objUrl:this.state.objURL,mtlUrl:this.state.mtlURL,upDir:t,scale:this.state.scale};this.props.service.insertObject(r)}}},{key:"setOBJMarkerScaleHandler",value:function(e){this.setState({scale:e}),this.props.service.updateCurrentRollOverMarker("OBJMarker",{scale:e})}},{key:"setTagMarkerScaleHandler",value:function(e){this.setState({tagScale:e}),this.props.service.updateCurrentRollOverMarker("TagMarker",{tagScale:e})}},{key:"handleSubmit",value:function(e){if(e.preventDefault(),this.props.service){var t=void 0;if(0===this.state.mode&&this.state.name.length>0&&this.state.objURL.length>0){var r={x:0,y:0,z:0};0===this.state.upDirection?r.x=1:1===this.state.upDirection?r.y=1:2===this.state.upDirection&&(r.z=1),t={type:"OBJMarker",name:this.state.name,objUrl:this.state.objURL,mtlUrl:this.state.mtlURL,upDir:r,scale:this.state.scale}}else if(1===this.state.mode&&this.state.projectID.length>0)t={type:"AltizureProjectMarker",projectID:this.state.projectID};else{if(2===this.state.mode&&this.state.scene.length>0)return this.props.earth.importFromServer(this.state.scene),console.log("load scene"),this.props.service.disableAllTools(),void this.setState(this.initState);3===this.state.mode&&(t={type:"TagMarker",tagImgUrl:this.state.tagImgUrl,tagScale:this.state.tagScale,tagName:this.state.tagName})}this.props.service.insertObject(t)}else console.error("[InsertPanel] service is not defined")}},{key:"handleInputChange",value:function(e,t){this.setState(i({},e,t))}},{key:"render",value:function(){var e=this,t=c.default.createElement("div",null,c.default.createElement("label",{style:y.label},"Name:",c.default.createElement("br",null),c.default.createElement("input",{key:0,style:y.input,type:"text",ref:"name",defaultValue:this.state.name,onInput:function(t){e.handleInputChange("name",t.target.value)},onClick:function(){e.refs.name.focus()}})),c.default.createElement("br",null),c.default.createElement("label",{style:y.label},"Object URL:",c.default.createElement("br",null),c.default.createElement("input",{key:1,style:y.input,type:"text",ref:"objURL",defaultValue:this.state.objURL,onChange:function(t){e.handleInputChange("objURL",t.target.value)},onClick:function(){e.refs.objURL.focus()}})),c.default.createElement("br",null),c.default.createElement("label",{style:y.label},"MTL URL:",c.default.createElement("br",null),c.default.createElement("input",{key:2,style:y.input,type:"text",ref:"mtlURL",defaultValue:this.state.mtlURL,onChange:function(t){e.handleInputChange("mtlURL",t.target.value)},onClick:function(){e.refs.mtlURL.focus()}})),c.default.createElement("br",null),c.default.createElement("div",null,"Obj up direction:",c.default.createElement(p.default,{buttons:["X","Y","Z"],activeIndex:this.state.upDirection,click:this.handleChange})),c.default.createElement("br",null),c.default.createElement("div",null,"Scale:",c.default.createElement(v.default,{min:"0.1",max:"10",step:"0.1",defaultValue:this.state.scale,handler:this.setOBJMarkerScaleHandler})),c.default.createElement("br",null),c.default.createElement("input",{type:"submit",value:"INSERT",className:"btn btn-success",style:y.submitBtn,onClick:this.handleSubmit})),r=c.default.createElement("div",null,c.default.createElement("label",{style:y.label},"Project ID:",c.default.createElement("br",null),c.default.createElement("input",{key:3,style:y.input,type:"text",ref:"project",defaultValue:this.state.projectID,onInput:function(t){e.handleInputChange("projectID",t.target.value)},onClick:function(){e.refs.project.focus()}})),c.default.createElement("br",null),c.default.createElement("br",null),c.default.createElement("input",{type:"submit",value:"INSERT",className:"btn btn-success",style:y.submitBtn,onClick:this.handleSubmit})),n=c.default.createElement("div",null,c.default.createElement("label",{style:y.label},"Scene file (.*json):",c.default.createElement("br",null),c.default.createElement("input",{key:4,style:y.input,type:"text",ref:"file",defaultValue:this.state.scene,onInput:function(t){e.handleInputChange("scene",t.target.value)},onClick:function(){e.refs.file.focus()}})),c.default.createElement("br",null),c.default.createElement("br",null),c.default.createElement("input",{type:"submit",value:"LOAD SCENE",className:"btn btn-success",style:y.submitBtn,onClick:this.handleSubmit})),i=c.default.createElement("div",null,c.default.createElement("label",{style:y.label},"Tag Marker Image URL:",c.default.createElement("br",null),c.default.createElement("input",{key:5,style:y.input,type:"text",ref:"tagImgUrl",defaultValue:this.state.tagImgUrl,onInput:function(t){e.handleInputChange("tagImgUrl",t.target.value)},onClick:function(){e.refs.tagImgUrl.focus()}})),c.default.createElement("label",{style:y.label},"Tag Name:",c.default.createElement("br",null),c.default.createElement("input",{key:6,style:y.input,type:"text",ref:"tagName",defaultValue:this.state.tagName,onInput:function(t){e.handleInputChange("tagName",t.target.value)},onClick:function(){e.refs.tagName.focus()}})),c.default.createElement("br",null),c.default.createElement("div",null,"Scale:",c.default.createElement(v.default,{min:"0.1",max:"10",step:"0.1",defaultValue:this.state.tagScale,handler:this.setTagMarkerScaleHandler})),c.default.createElement("br",null),c.default.createElement("input",{type:"submit",value:"INSERT",className:"btn btn-success",style:y.submitBtn,onClick:this.handleSubmit})),o=void 0;0===this.state.mode?o=t:1===this.state.mode?o=r:2===this.state.mode?o=n:3===this.state.mode&&(o=i);var a=this.tabDescription.map(function(t,r){var n=e.state.mode===r;return c.default.createElement(d.default,{key:r,index:r,kind:t.kind,icon:t.icon,selectTool:function(t){e.setState({mode:t})},selected:n,tooltipPlace:"bottom"})});return c.default.createElement("div",{className:"insert-panel",style:y.wrapper},c.default.createElement("div",{className:"container",style:y.container},c.default.createElement("div",{className:"tabs",style:y.tabs},a),c.default.createElement("div",{className:"insert-form",style:y.form},o)))}}]),t}(c.default.Component);t.default=b},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CustomPicker=t.TwitterPicker=t.SwatchesPicker=t.SliderPicker=t.SketchPicker=t.PhotoshopPicker=t.MaterialPicker=t.HuePicker=t.GithubPicker=t.CompactPicker=t.ChromePicker=t.default=t.CirclePicker=t.BlockPicker=t.AlphaPicker=void 0;var i=r(122);Object.defineProperty(t,"AlphaPicker",{enumerable:!0,get:function(){return n(i).default}});var o=r(242);Object.defineProperty(t,"BlockPicker",{enumerable:!0,get:function(){return n(o).default}});var a=r(244);Object.defineProperty(t,"CirclePicker",{enumerable:!0,get:function(){return n(a).default}});var s=r(246);Object.defineProperty(t,"ChromePicker",{enumerable:!0,get:function(){return n(s).default}});var l=r(250);Object.defineProperty(t,"CompactPicker",{enumerable:!0,get:function(){return n(l).default}});var u=r(261);Object.defineProperty(t,"GithubPicker",{enumerable:!0,get:function(){return n(u).default}});var c=r(263);Object.defineProperty(t,"HuePicker",{enumerable:!0,get:function(){return n(c).default}});var h=r(265);Object.defineProperty(t,"MaterialPicker",{enumerable:!0,get:function(){return n(h).default}});var d=r(266);Object.defineProperty(t,"PhotoshopPicker",{enumerable:!0,get:function(){return n(d).default}});var f=r(272);Object.defineProperty(t,"SketchPicker",{enumerable:!0,get:function(){return n(f).default}});var p=r(275);Object.defineProperty(t,"SliderPicker",{enumerable:!0,get:function(){return n(p).default}});var m=r(279);Object.defineProperty(t,"SwatchesPicker",{enumerable:!0,get:function(){return n(m).default}});var v=r(282);Object.defineProperty(t,"TwitterPicker",{enumerable:!0,get:function(){return n(v).default}});var g=r(91);Object.defineProperty(t,"CustomPicker",{enumerable:!0,get:function(){return n(g).default}});var y=n(s);t.default=y.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.AlphaPicker=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=r(0),a=n(o),s=r(1),l=n(s),u=r(2),c=r(241),h=n(c),d=t.AlphaPicker=function(e){var t=e.rgb,r=e.hsl,n=e.width,o=e.height,s=e.onChange,c=e.direction,h=e.style,d=e.renderers,f=e.pointer,p=(0,l.default)({default:{picker:{position:"relative",width:n,height:o},alpha:{radius:"2px",style:h}}});return a.default.createElement("div",{style:p.picker,className:"alpha-picker"},a.default.createElement(u.Alpha,i({},p.alpha,{rgb:t,hsl:r,pointer:f,renderers:d,onChange:s,direction:c})))};d.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:h.default},t.default=(0,u.ColorWrap)(d)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.flattenNames=void 0;var i=r(32),o=n(i),a=r(33),s=n(a),l=r(137),u=n(l),c=r(9),h=n(c),d=t.flattenNames=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=[];return(0,h.default)(t,function(t){Array.isArray(t)?e(t).map(function(e){return r.push(e)}):(0,u.default)(t)?(0,s.default)(t,function(e,t){!0===e&&r.push(t),r.push(t+"-"+e)}):(0,o.default)(t)&&r.push(t)}),r};t.default=d},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){function n(e){var t=a.call(e,l),r=e[l];try{e[l]=void 0;var n=!0}catch(e){}var i=s.call(e);return n&&(t?e[l]=r:delete e[l]),i}var i=r(19),o=Object.prototype,a=o.hasOwnProperty,s=o.toString,l=i?i.toStringTag:void 0;e.exports=n},function(e,t){function r(e){return i.call(e)}var n=Object.prototype,i=n.toString;e.exports=r},function(e,t,r){var n=r(128),i=n();e.exports=i},function(e,t){function r(e){return function(t,r,n){for(var i=-1,o=Object(t),a=n(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===r(o[l],l,o))break}return t}}e.exports=r},function(e,t){function r(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}e.exports=r},function(e,t,r){function n(e){return o(e)&&i(e)==a}var i=r(12),o=r(13),a="[object Arguments]";e.exports=n},function(e,t){function r(){return!1}e.exports=r},function(e,t,r){function n(e){return a(e)&&o(e.length)&&!!s[i(e)]}var i=r(12),o=r(36),a=r(13),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=n},function(e,t){function r(e){return function(t){return e(t)}}e.exports=r},function(e,t,r){(function(e){var n=r(56),i="object"==typeof t&&t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=o&&o.exports===i,s=a&&n.process,l=function(){try{return s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=l}).call(t,r(35)(e))},function(e,t,r){function n(e){if(!i(e))return o(e);var t=[];for(var r in Object(e))s.call(e,r)&&"constructor"!=r&&t.push(r);return t}var i=r(37),o=r(136),a=Object.prototype,s=a.hasOwnProperty;e.exports=n},function(e,t,r){var n=r(62),i=n(Object.keys,Object);e.exports=i},function(e,t,r){function n(e){if(!a(e)||i(e)!=s)return!1;var t=o(e);if(null===t)return!0;var r=h.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&c.call(r)==d}var i=r(12),o=r(38),a=r(13),s="[object Object]",l=Function.prototype,u=Object.prototype,c=l.toString,h=u.hasOwnProperty,d=c.call(Object);e.exports=n},function(e,t,r){function n(e){return"function"==typeof e?e:null==e?a:"object"==typeof e?s(e)?o(e[0],e[1]):i(e):l(e)}var i=r(139),o=r(181),a=r(65),s=r(3),l=r(191);e.exports=n},function(e,t,r){function n(e){var t=o(e);return 1==t.length&&t[0][2]?a(t[0][0],t[0][1]):function(r){return r===e||i(r,e,t)}}var i=r(140),o=r(180),a=r(79);e.exports=n},function(e,t,r){function n(e,t,r,n){var l=r.length,u=l,c=!n;if(null==e)return!u;for(e=Object(e);l--;){var h=r[l];if(c&&h[2]?h[1]!==e[h[0]]:!(h[0]in e))return!1}for(;++l<u;){h=r[l];var d=h[0],f=e[d],p=h[1];if(c&&h[2]){if(void 0===f&&!(d in e))return!1}else{var m=new i;if(n)var v=n(f,p,d,e,t,m);if(!(void 0===v?o(p,f,a|s,n,m):v))return!1}}return!0}var i=r(39),o=r(68),a=1,s=2;e.exports=n},function(e,t){function r(){this.__data__=[],this.size=0}e.exports=r},function(e,t,r){function n(e){var t=this.__data__,r=i(t,e);return!(r<0)&&(r==t.length-1?t.pop():a.call(t,r,1),--this.size,!0)}var i=r(23),o=Array.prototype,a=o.splice;e.exports=n},function(e,t,r){function n(e){var t=this.__data__,r=i(t,e);return r<0?void 0:t[r][1]}var i=r(23);e.exports=n},function(e,t,r){function n(e){return i(this.__data__,e)>-1}var i=r(23);e.exports=n},function(e,t,r){function n(e,t){var r=this.__data__,n=i(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var i=r(23);e.exports=n},function(e,t,r){function n(){this.__data__=new i,this.size=0}var i=r(22);e.exports=n},function(e,t){function r(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}e.exports=r},function(e,t){function r(e){return this.__data__.get(e)}e.exports=r},function(e,t){function r(e){return this.__data__.has(e)}e.exports=r},function(e,t,r){function n(e,t){var r=this.__data__;if(r instanceof i){var n=r.__data__;if(!o||n.length<s-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new a(n)}return r.set(e,t),this.size=r.size,this}var i=r(22),o=r(41),a=r(42),s=200;e.exports=n},function(e,t,r){function n(e){return!(!a(e)||o(e))&&(i(e)?p:u).test(s(e))}var i=r(63),o=r(152),a=r(7),s=r(67),l=/[\\^$.*+?()[\]{}|]/g,u=/^\[object .+?Constructor\]$/,c=Function.prototype,h=Object.prototype,d=c.toString,f=h.hasOwnProperty,p=RegExp("^"+d.call(f).replace(l,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=n},function(e,t,r){function n(e){return!!o&&o in e}var i=r(153),o=function(){var e=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=n},function(e,t,r){var n=r(4),i=n["__core-js_shared__"];e.exports=i},function(e,t){function r(e,t){return null==e?void 0:e[t]}e.exports=r},function(e,t,r){function n(){this.size=0,this.__data__={hash:new i,map:new(a||o),string:new i}}var i=r(156),o=r(22),a=r(41);e.exports=n},function(e,t,r){function n(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var i=r(157),o=r(158),a=r(159),s=r(160),l=r(161);n.prototype.clear=i,n.prototype.delete=o,n.prototype.get=a,n.prototype.has=s,n.prototype.set=l,e.exports=n},function(e,t,r){function n(){this.__data__=i?i(null):{},this.size=0}var i=r(24);e.exports=n},function(e,t){function r(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}e.exports=r},function(e,t,r){function n(e){var t=this.__data__;if(i){var r=t[e];return r===o?void 0:r}return s.call(t,e)?t[e]:void 0}var i=r(24),o="__lodash_hash_undefined__",a=Object.prototype,s=a.hasOwnProperty;e.exports=n},function(e,t,r){function n(e){var t=this.__data__;return i?void 0!==t[e]:a.call(t,e)}var i=r(24),o=Object.prototype,a=o.hasOwnProperty;e.exports=n},function(e,t,r){function n(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=i&&void 0===t?o:t,this}var i=r(24),o="__lodash_hash_undefined__";e.exports=n},function(e,t,r){function n(e){var t=i(this,e).delete(e);return this.size-=t?1:0,t}var i=r(25);e.exports=n},function(e,t){function r(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}e.exports=r},function(e,t,r){function n(e){return i(this,e).get(e)}var i=r(25);e.exports=n},function(e,t,r){function n(e){return i(this,e).has(e)}var i=r(25);e.exports=n},function(e,t,r){function n(e,t){var r=i(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var i=r(25);e.exports=n},function(e,t,r){function n(e,t,r,n,v,y){var b=u(e),_=u(t),w=b?p:l(e),x=_?p:l(t);w=w==f?m:w,x=x==f?m:x;var M=w==m,E=x==m,A=w==x;if(A&&c(e)){if(!c(t))return!1;b=!0,M=!1}if(A&&!M)return y||(y=new i),b||h(e)?o(e,t,r,n,v,y):a(e,t,w,r,n,v,y);if(!(r&d)){var T=M&&g.call(e,"__wrapped__"),k=E&&g.call(t,"__wrapped__");if(T||k){var S=T?e.value():e,C=k?t.value():t;return y||(y=new i),v(S,C,r,n,y)}}return!!A&&(y||(y=new i),s(e,t,r,n,v,y))}var i=r(39),o=r(69),a=r(173),s=r(174),l=r(77),u=r(3),c=r(34),h=r(61),d=1,f="[object Arguments]",p="[object Array]",m="[object Object]",v=Object.prototype,g=v.hasOwnProperty;e.exports=n},function(e,t,r){function n(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new i;++t<r;)this.add(e[t])}var i=r(42),o=r(169),a=r(170);n.prototype.add=n.prototype.push=o,n.prototype.has=a,e.exports=n},function(e,t){function r(e){return this.__data__.set(e,n),this}var n="__lodash_hash_undefined__";e.exports=r},function(e,t){function r(e){return this.__data__.has(e)}e.exports=r},function(e,t){function r(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}e.exports=r},function(e,t){function r(e,t){return e.has(t)}e.exports=r},function(e,t,r){function n(e,t,r,n,i,M,A){switch(r){case x:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case w:return!(e.byteLength!=t.byteLength||!M(new o(e),new o(t)));case d:case f:case v:return a(+e,+t);case p:return e.name==t.name&&e.message==t.message;case g:case b:return e==t+"";case m:var T=l;case y:var k=n&c;if(T||(T=u),e.size!=t.size&&!k)return!1;var S=A.get(e);if(S)return S==t;n|=h,A.set(e,t);var C=s(T(e),T(t),n,i,M,A);return A.delete(e),C;case _:if(E)return E.call(e)==E.call(t)}return!1}var i=r(19),o=r(70),a=r(40),s=r(69),l=r(71),u=r(72),c=1,h=2,d="[object Boolean]",f="[object Date]",p="[object Error]",m="[object Map]",v="[object Number]",g="[object RegExp]",y="[object Set]",b="[object String]",_="[object Symbol]",w="[object ArrayBuffer]",x="[object DataView]",M=i?i.prototype:void 0,E=M?M.valueOf:void 0;e.exports=n},function(e,t,r){function n(e,t,r,n,a,l){var u=r&o,c=i(e),h=c.length;if(h!=i(t).length&&!u)return!1;for(var d=h;d--;){var f=c[d];if(!(u?f in t:s.call(t,f)))return!1}var p=l.get(e);if(p&&l.get(t))return p==t;var m=!0;l.set(e,t),l.set(t,e);for(var v=u;++d<h;){f=c[d];var g=e[f],y=t[f];if(n)var b=u?n(y,g,f,t,e,l):n(g,y,f,e,t,l);if(!(void 0===b?g===y||a(g,y,r,n,l):b)){m=!1;break}v||(v="constructor"==f)}if(m&&!v){var _=e.constructor,w=t.constructor;_!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof w&&w instanceof w)&&(m=!1)}return l.delete(e),l.delete(t),m}var i=r(73),o=1,a=Object.prototype,s=a.hasOwnProperty;e.exports=n},function(e,t){function r(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}e.exports=r},function(e,t,r){var n=r(14),i=r(4),o=n(i,"DataView");e.exports=o},function(e,t,r){var n=r(14),i=r(4),o=n(i,"Promise");e.exports=o},function(e,t,r){var n=r(14),i=r(4),o=n(i,"Set");e.exports=o},function(e,t,r){var n=r(14),i=r(4),o=n(i,"WeakMap");e.exports=o},function(e,t,r){function n(e){for(var t=o(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,i(a)]}return t}var i=r(78),o=r(20);e.exports=n},function(e,t,r){function n(e,t){return s(e)&&l(t)?u(c(e),t):function(r){var n=o(r,e);return void 0===n&&n===t?a(r,e):i(t,n,h|d)}}var i=r(68),o=r(182),a=r(188),s=r(44),l=r(78),u=r(79),c=r(27),h=1,d=2;e.exports=n},function(e,t,r){function n(e,t,r){var n=null==e?void 0:i(e,t);return void 0===n?r:n}var i=r(80);e.exports=n},function(e,t,r){var n=r(184),i=/^\./,o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,s=n(function(e){var t=[];return i.test(e)&&t.push(""),e.replace(o,function(e,r,n,i){t.push(n?i.replace(a,"$1"):r||e)}),t});e.exports=s},function(e,t,r){function n(e){var t=i(e,function(e){return r.size===o&&r.clear(),e}),r=t.cache;return t}var i=r(185),o=500;e.exports=n},function(e,t,r){function n(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(o);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(n.Cache||i),r}var i=r(42),o="Expected a function";n.Cache=i,e.exports=n},function(e,t,r){function n(e){return null==e?"":i(e)}var i=r(187);e.exports=n},function(e,t,r){function n(e){if("string"==typeof e)return e;if(a(e))return o(e,n)+"";if(s(e))return c?c.call(e):"";var t=e+"";return"0"==t&&1/e==-l?"-0":t}var i=r(19),o=r(66),a=r(3),s=r(26),l=1/0,u=i?i.prototype:void 0,c=u?u.toString:void 0;e.exports=n},function(e,t,r){function n(e,t){return null!=e&&o(e,t,i)}var i=r(189),o=r(190);e.exports=n},function(e,t){function r(e,t){return null!=e&&t in Object(e)}e.exports=r},function(e,t,r){function n(e,t,r){t=i(t,e);for(var n=-1,c=t.length,h=!1;++n<c;){var d=u(t[n]);if(!(h=null!=e&&r(e,d)))break;e=e[d]}return h||++n!=c?h:!!(c=null==e?0:e.length)&&l(c)&&s(d,c)&&(a(e)||o(e))}var i=r(81),o=r(59),a=r(3),s=r(60),l=r(36),u=r(27);e.exports=n},function(e,t,r){function n(e){return a(e)?i(s(e)):o(e)}var i=r(192),o=r(193),a=r(44),s=r(27);e.exports=n},function(e,t){function r(e){return function(t){return null==t?void 0:t[e]}}e.exports=r},function(e,t,r){function n(e){return function(t){return i(t,e)}}var i=r(80);e.exports=n},function(e,t,r){function n(e,t){var r=-1,n=o(e)?Array(e.length):[];return i(e,function(e,i,o){n[++r]=t(e,i,o)}),n}var i=r(82),o=r(21);e.exports=n},function(e,t,r){function n(e,t){return function(r,n){if(null==r)return r;if(!i(r))return e(r,n);for(var o=r.length,a=t?o:-1,s=Object(r);(t?a--:++a<o)&&!1!==n(s[a],a,s););return r}}var i=r(21);e.exports=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.mergeClasses=void 0;var i=r(33),o=n(i),a=r(197),s=n(a),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=t.mergeClasses=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e.default&&(0,s.default)(e.default)||{};return t.map(function(t){var n=e[t];return n&&(0,o.default)(n,function(e,t){r[t]||(r[t]={}),r[t]=l({},r[t],n[t])}),t}),r};t.default=u},function(e,t,r){function n(e){return i(e,o|a)}var i=r(198),o=1,a=4;e.exports=n},function(e,t,r){function n(e,t,r,O,R,L){var I,B=t&M,D=t&E,j=t&A;if(r&&(I=R?r(e,O,R,L):r(e)),void 0!==I)return I;if(!w(e))return e;var z=b(e);if(z){if(I=v(e),!B)return c(e,I)}else{var N=m(e),U=N==k||N==S;if(_(e))return u(e,B);if(N==C||N==T||U&&!R){if(I=D||U?{}:y(e),!B)return D?d(e,l(I,e)):h(e,s(I,e))}else{if(!P[N])return R?e:{};I=g(e,N,n,B)}}L||(L=new i);var F=L.get(e);if(F)return F;L.set(e,I);var H=j?D?p:f:D?keysIn:x,V=z?void 0:H(e);return o(V||e,function(i,o){V&&(o=i,i=e[o]),a(I,o,n(i,t,r,o,e,L))}),I}var i=r(39),o=r(83),a=r(84),s=r(200),l=r(201),u=r(204),c=r(205),h=r(206),d=r(207),f=r(73),p=r(208),m=r(77),v=r(209),g=r(210),y=r(219),b=r(3),_=r(34),w=r(7),x=r(20),M=1,E=2,A=4,T="[object Arguments]",k="[object Function]",S="[object GeneratorFunction]",C="[object Object]",P={};P[T]=P["[object Array]"]=P["[object ArrayBuffer]"]=P["[object DataView]"]=P["[object Boolean]"]=P["[object Date]"]=P["[object Float32Array]"]=P["[object Float64Array]"]=P["[object Int8Array]"]=P["[object Int16Array]"]=P["[object Int32Array]"]=P["[object Map]"]=P["[object Number]"]=P[C]=P["[object RegExp]"]=P["[object Set]"]=P["[object String]"]=P["[object Symbol]"]=P["[object Uint8Array]"]=P["[object Uint8ClampedArray]"]=P["[object Uint16Array]"]=P["[object Uint32Array]"]=!0,P["[object Error]"]=P[k]=P["[object WeakMap]"]=!1,e.exports=n},function(e,t,r){var n=r(14),i=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},function(e,t,r){function n(e,t){return e&&i(t,o(t),e)}var i=r(28),o=r(20);e.exports=n},function(e,t,r){function n(e,t){return e&&i(t,o(t),e)}var i=r(28),o=r(86);e.exports=n},function(e,t,r){function n(e){if(!i(e))return a(e);var t=o(e),r=[];for(var n in e)("constructor"!=n||!t&&l.call(e,n))&&r.push(n);return r}var i=r(7),o=r(37),a=r(203),s=Object.prototype,l=s.hasOwnProperty;e.exports=n},function(e,t){function r(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}e.exports=r},function(e,t,r){(function(e){function n(e,t){if(t)return e.slice();var r=e.length,n=u?u(r):new e.constructor(r);return e.copy(n),n}var i=r(4),o="object"==typeof t&&t&&!t.nodeType&&t,a=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===o,l=s?i.Buffer:void 0,u=l?l.allocUnsafe:void 0;e.exports=n}).call(t,r(35)(e))},function(e,t){function r(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}e.exports=r},function(e,t,r){function n(e,t){return i(e,o(e),t)}var i=r(28),o=r(43);e.exports=n},function(e,t,r){function n(e,t){return i(e,o(e),t)}var i=r(28),o=r(87);e.exports=n},function(e,t,r){function n(e){return i(e,a,o)}var i=r(74),o=r(87),a=r(86);e.exports=n},function(e,t){function r(e){var t=e.length,r=e.constructor(t);return t&&"string"==typeof e[0]&&i.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var n=Object.prototype,i=n.hasOwnProperty;e.exports=r},function(e,t,r){function n(e,t,r,n){var P=e.constructor;switch(t){case b:return i(e);case h:case d:return new P(+e);case _:return o(e,n);case w:case x:case M:case E:case A:case T:case k:case S:case C:return c(e,n);case f:return a(e,n,r);case p:case g:return new P(e);case m:return s(e);case v:return l(e,n,r);case y:return u(e)}}var i=r(45),o=r(211),a=r(212),s=r(214),l=r(215),u=r(217),c=r(218),h="[object Boolean]",d="[object Date]",f="[object Map]",p="[object Number]",m="[object RegExp]",v="[object Set]",g="[object String]",y="[object Symbol]",b="[object ArrayBuffer]",_="[object DataView]",w="[object Float32Array]",x="[object Float64Array]",M="[object Int8Array]",E="[object Int16Array]",A="[object Int32Array]",T="[object Uint8Array]",k="[object Uint8ClampedArray]",S="[object Uint16Array]",C="[object Uint32Array]";e.exports=n},function(e,t,r){function n(e,t){var r=t?i(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var i=r(45);e.exports=n},function(e,t,r){function n(e,t,r){var n=t?r(a(e),s):a(e);return o(n,i,new e.constructor)}var i=r(213),o=r(88),a=r(71),s=1;e.exports=n},function(e,t){function r(e,t){return e.set(t[0],t[1]),e}e.exports=r},function(e,t){function r(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}var n=/\w*$/;e.exports=r},function(e,t,r){function n(e,t,r){var n=t?r(a(e),s):a(e);return o(n,i,new e.constructor)}var i=r(216),o=r(88),a=r(72),s=1;e.exports=n},function(e,t){function r(e,t){return e.add(t),e}e.exports=r},function(e,t,r){function n(e){return a?Object(a.call(e)):{}}var i=r(19),o=i?i.prototype:void 0,a=o?o.valueOf:void 0;e.exports=n},function(e,t,r){function n(e,t){var r=t?i(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var i=r(45);e.exports=n},function(e,t,r){function n(e){return"function"!=typeof e.constructor||a(e)?{}:i(o(e))}var i=r(220),o=r(38),a=r(37);e.exports=n},function(e,t,r){var n=r(7),i=Object.create,o=function(){function e(){}return function(t){if(!n(t))return{};if(i)return i(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autoprefix=void 0;var n=r(33),i=function(e){return e&&e.__esModule?e:{default:e}}(n),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a={borderRadius:function(e){return{msBorderRadius:e,MozBorderRadius:e,OBorderRadius:e,WebkitBorderRadius:e,borderRadius:e}},boxShadow:function(e){return{msBoxShadow:e,MozBoxShadow:e,OBoxShadow:e,WebkitBoxShadow:e,boxShadow:e}},userSelect:function(e){return{WebkitTouchCallout:e,KhtmlUserSelect:e,MozUserSelect:e,msUserSelect:e,WebkitUserSelect:e,userSelect:e}},flex:function(e){return{WebkitBoxFlex:e,MozBoxFlex:e,WebkitFlex:e,msFlex:e,flex:e}},flexBasis:function(e){return{WebkitFlexBasis:e,flexBasis:e}},justifyContent:function(e){return{WebkitJustifyContent:e,justifyContent:e}},transition:function(e){return{msTransition:e,MozTransition:e,OTransition:e,WebkitTransition:e,transition:e}},transform:function(e){return{msTransform:e,MozTransform:e,OTransform:e,WebkitTransform:e,transform:e}},absolute:function(e){var t=e&&e.split(" ");return{position:"absolute",top:t&&t[0],right:t&&t[1],bottom:t&&t[2],left:t&&t[3]}},extend:function(e,t){var r=t[e];return r||{extend:e}}},s=t.autoprefix=function(e){var t={};return(0,i.default)(e,function(e,r){var n={};(0,i.default)(e,function(e,t){var r=a[t];r?n=o({},n,r(e)):n[t]=e}),t[r]=n}),t};t.default=s},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.hover=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=r(0),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=t.hover=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(r){function s(){var r,o,u,c;n(this,s);for(var h=arguments.length,d=Array(h),f=0;f<h;f++)d[f]=arguments[f];return o=u=i(this,(r=s.__proto__||Object.getPrototypeOf(s)).call.apply(r,[this].concat(d))),u.state={hover:!1},u.handleMouseOver=function(){return u.setState({hover:!0})},u.handleMouseOut=function(){return u.setState({hover:!1})},u.render=function(){return l.default.createElement(t,{onMouseOver:u.handleMouseOver,onMouseOut:u.handleMouseOut},l.default.createElement(e,a({},u.props,u.state)))},c=o,i(u,c)}return o(s,r),s}(l.default.Component)};t.default=u},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.active=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=r(0),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=t.active=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(r){function s(){var r,o,u,c;n(this,s);for(var h=arguments.length,d=Array(h),f=0;f<h;f++)d[f]=arguments[f];return o=u=i(this,(r=s.__proto__||Object.getPrototypeOf(s)).call.apply(r,[this].concat(d))),u.state={active:!1},u.handleMouseDown=function(){return u.setState({active:!0})},u.handleMouseUp=function(){return u.setState({active:!1})},u.render=function(){return l.default.createElement(t,{onMouseDown:u.handleMouseDown,onMouseUp:u.handleMouseUp},l.default.createElement(e,a({},u.props,u.state)))},c=o,i(u,c)}return o(s,r),s}(l.default.Component)};t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){var r={},n=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];r[e]=t};return 0===e&&n("first-child"),e===t-1&&n("last-child"),(0===e||e%2==0)&&n("even"),1===Math.abs(e%2)&&n("odd"),n("nth-child",e),r};t.default=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Alpha=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),c=n(u),h=r(1),d=n(h),f=r(226),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(f),m=r(89),v=n(m),g=t.Alpha=function(e){function t(){var e,r,n,a;i(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.handleChange=function(e,t){var r=p.calculateChange(e,t,n.props,n.container);r&&n.props.onChange&&n.props.onChange(r,e)},n.handleMouseDown=function(e){n.handleChange(e,!0),window.addEventListener("mousemove",n.handleChange),window.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},n.unbindEventListeners=function(){window.removeEventListener("mousemove",n.handleChange),window.removeEventListener("mouseup",n.handleMouseUp)},a=r,o(n,a)}return a(t,e),l(t,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var e=this,t=this.props.rgb,r=(0,d.default)({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden"},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+t.r+","+t.g+","+t.b+", 0) 0%,\n           rgba("+t.r+","+t.g+","+t.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:100*t.a+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+t.r+","+t.g+","+t.b+", 0) 0%,\n           rgba("+t.r+","+t.g+","+t.b+", 1) 100%)"},pointer:{left:0,top:100*t.a+"%"}},overwrite:s({},this.props.style)},{vertical:"vertical"===this.props.direction,overwrite:!0});return c.default.createElement("div",{style:r.alpha},c.default.createElement("div",{style:r.checkboard},c.default.createElement(v.default,{renderers:this.props.renderers})),c.default.createElement("div",{style:r.gradient}),c.default.createElement("div",{style:r.container,ref:function(t){return e.container=t},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},c.default.createElement("div",{style:r.pointer},this.props.pointer?c.default.createElement(this.props.pointer,this.props):c.default.createElement("div",{style:r.slider}))))}}]),t}(u.PureComponent||u.Component);t.default=g},function(e,t,r){"use strict";function n(e,t,r,n){!t&&e.preventDefault();var i=n.clientWidth,o=n.clientHeight,a="number"==typeof e.pageX?e.pageX:e.touches[0].pageX,s="number"==typeof e.pageY?e.pageY:e.touches[0].pageY,l=a-(n.getBoundingClientRect().left+window.pageXOffset),u=s-(n.getBoundingClientRect().top+window.pageYOffset);if("vertical"===r.direction){var c=void 0;if(c=u<0?0:u>o?1:Math.round(100*u/o)/100,r.hsl.a!==c)return{h:r.hsl.h,s:r.hsl.s,l:r.hsl.l,a:c,source:"rgb"}}else{var h=void 0;if(h=l<0?0:l>i?1:Math.round(100*l/i)/100,r.a!==h)return{h:r.hsl.h,s:r.hsl.s,l:r.hsl.l,a:h,source:"rgb"}}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.calculateChange=n},function(e,t,r){"use strict";function n(e,t,r,n){if("undefined"==typeof document&&!n)return null;var i=n?new n:document.createElement("canvas");i.width=2*r,i.height=2*r;var o=i.getContext("2d");return o?(o.fillStyle=e,o.fillRect(0,0,i.width,i.height),o.fillStyle=t,o.fillRect(0,0,r,r),o.translate(r,r),o.fillRect(0,0,r,r),i.toDataURL()):null}function i(e,t,r,i){var a=e+"-"+t+"-"+r+(i?"-server":""),s=n(e,t,r,i);return o[a]?o[a]:(o[a]=s,s)}Object.defineProperty(t,"__esModule",{value:!0}),t.render=n,t.get=i;var o={}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.EditableInput=void 0;var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),c=n(u),h=r(1),d=n(h),f=t.EditableInput=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.handleBlur=function(){r.state.blurValue&&r.setState({value:r.state.blurValue,blurValue:null})},r.handleChange=function(e){r.props.label?r.props.onChange&&r.props.onChange(i({},r.props.label,e.target.value),e):r.props.onChange&&r.props.onChange(e.target.value,e),r.setState({value:e.target.value})},r.handleKeyDown=function(e){var t=Number(e.target.value);if(!isNaN(t)){var n=r.props.arrowOffset||1;38===e.keyCode&&(null!==r.props.label?r.props.onChange&&r.props.onChange(i({},r.props.label,t+n),e):r.props.onChange&&r.props.onChange(t+n,e),r.setState({value:t+n})),40===e.keyCode&&(null!==r.props.label?r.props.onChange&&r.props.onChange(i({},r.props.label,t-n),e):r.props.onChange&&r.props.onChange(t-n,e),r.setState({value:t-n}))}},r.handleDrag=function(e){if(r.props.dragLabel){var t=Math.round(r.props.value+e.movementX);t>=0&&t<=r.props.dragMax&&r.props.onChange&&r.props.onChange(i({},r.props.label,t),e)}},r.handleMouseDown=function(e){r.props.dragLabel&&(e.preventDefault(),r.handleDrag(e),window.addEventListener("mousemove",r.handleDrag),window.addEventListener("mouseup",r.handleMouseUp))},r.handleMouseUp=function(){r.unbindEventListeners()},r.unbindEventListeners=function(){window.removeEventListener("mousemove",r.handleDrag),window.removeEventListener("mouseup",r.handleMouseUp)},r.state={value:String(e.value).toUpperCase(),blurValue:String(e.value).toUpperCase()},r}return s(t,e),l(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.input;e.value!==this.state.value&&(t===document.activeElement?this.setState({blurValue:String(e.value).toUpperCase()}):this.setState({value:String(e.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var e=this,t=(0,d.default)({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return c.default.createElement("div",{style:t.wrap},c.default.createElement("input",{style:t.input,ref:function(t){return e.input=t},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label?c.default.createElement("span",{style:t.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),t}(u.PureComponent||u.Component);t.default=f},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Hue=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(1),h=n(c),d=r(230),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(d),p=t.Hue=function(e){function t(){var e,r,n,a;i(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.handleChange=function(e,t){var r=f.calculateChange(e,t,n.props,n.container);r&&n.props.onChange&&n.props.onChange(r,e)},n.handleMouseDown=function(e){n.handleChange(e,!0),window.addEventListener("mousemove",n.handleChange),window.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},a=r,o(n,a)}return a(t,e),s(t,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var e=this,t=(0,h.default)({default:{hue:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%,\n            #0ff 50%, #00f 67%, #f0f 83%, #f00 100%)",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{margin:"0 2px",position:"relative",height:"100%"},pointer:{position:"absolute",left:100*this.props.hsl.h/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{hue:{background:"linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,\n            #0ff 50%, #00f 67%, #f0f 83%, #f00 100%)"},pointer:{left:"0px",top:-100*this.props.hsl.h/360+100+"%"}}},{vertical:"vertical"===this.props.direction});return u.default.createElement("div",{style:t.hue},u.default.createElement("div",{style:t.container,ref:function(t){return e.container=t},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},u.default.createElement("div",{style:t.pointer},this.props.pointer?u.default.createElement(this.props.pointer,this.props):u.default.createElement("div",{style:t.slider}))))}}]),t}(l.PureComponent||l.Component);t.default=p},function(e,t,r){"use strict";function n(e,t,r,n){!t&&e.preventDefault();var i=n.clientWidth,o=n.clientHeight,a="number"==typeof e.pageX?e.pageX:e.touches[0].pageX,s="number"==typeof e.pageY?e.pageY:e.touches[0].pageY,l=a-(n.getBoundingClientRect().left+window.pageXOffset),u=s-(n.getBoundingClientRect().top+window.pageYOffset);if("vertical"===r.direction){var c=void 0;if(u<0)c=359;else if(u>o)c=0;else{var h=-100*u/o+100;c=360*h/100}if(r.hsl.h!==c)return{h:c,s:r.hsl.s,l:r.hsl.l,a:r.hsl.a,source:"rgb"}}else{var d=void 0;if(l<0)d=0;else if(l>i)d=359;else{var f=100*l/i;d=360*f/100}if(r.hsl.h!==d)return{h:d,s:r.hsl.s,l:r.hsl.l,a:r.hsl.a,source:"rgb"}}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.calculateChange=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Saturation=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(1),h=n(c),d=r(232),f=n(d),p=r(235),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(p),v=t.Saturation=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleChange=function(e,t){r.props.onChange&&r.throttle(r.props.onChange,m.calculateChange(e,t,r.props,r.container),e)},r.handleMouseDown=function(e){r.handleChange(e,!0),window.addEventListener("mousemove",r.handleChange),window.addEventListener("mouseup",r.handleMouseUp)},r.handleMouseUp=function(){r.unbindEventListeners()},r.throttle=(0,f.default)(function(e,t,r){e(t,r)},50),r}return a(t,e),s(t,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var e=this,t=this.props.style||{},r=t.color,n=t.white,i=t.black,o=t.pointer,a=t.circle,s=(0,h.default)({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, #fff, rgba(255,255,255,0))"},black:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to top, #000, rgba(0,0,0,0))",boxShadow:this.props.shadow},pointer:{position:"absolute",top:-100*this.props.hsv.v+100+"%",left:100*this.props.hsv.s+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:"0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),\n            0 0 1px 2px rgba(0,0,0,.4)",borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:r,white:n,black:i,pointer:o,circle:a}},{custom:!!this.props.style});return u.default.createElement("div",{style:s.color,ref:function(t){return e.container=t},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},u.default.createElement("div",{style:s.white},u.default.createElement("div",{style:s.black}),u.default.createElement("div",{style:s.pointer},this.props.pointer?u.default.createElement(this.props.pointer,this.props):u.default.createElement("div",{style:s.circle}))))}}]),t}(l.PureComponent||l.Component);t.default=v},function(e,t,r){function n(e,t,r){var n=!0,s=!0;if("function"!=typeof e)throw new TypeError(a);return o(r)&&(n="leading"in r?!!r.leading:n,s="trailing"in r?!!r.trailing:s),i(e,t,{leading:n,maxWait:t,trailing:s})}var i=r(90),o=r(7),a="Expected a function";e.exports=n},function(e,t,r){var n=r(4),i=function(){return n.Date.now()};e.exports=i},function(e,t,r){function n(e){if("number"==typeof e)return e;if(o(e))return a;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var r=u.test(e);return r||c.test(e)?h(e.slice(2),r?2:8):l.test(e)?a:+e}var i=r(7),o=r(26),a=NaN,s=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,h=parseInt;e.exports=n},function(e,t,r){"use strict";function n(e,t,r,n){!t&&e.preventDefault();var i=n.clientWidth,o=n.clientHeight,a="number"==typeof e.pageX?e.pageX:e.touches[0].pageX,s="number"==typeof e.pageY?e.pageY:e.touches[0].pageY,l=a-(n.getBoundingClientRect().left+window.pageXOffset),u=s-(n.getBoundingClientRect().top+window.pageYOffset);l<0?l=0:l>i?l=i:u<0?u=0:u>o&&(u=o);var c=100*l/i,h=-100*u/o+100;return{h:r.hsl.h,s:c,v:h,a:r.hsl.a,source:"rgb"}}Object.defineProperty(t,"__esModule",{value:!0}),t.calculateChange=n},function(e,t,r){e.exports=r(237)},function(e,t,r){function n(e,t){return(s(e)?i:o)(e,a(t))}var i=r(83),o=r(82),a=r(64),s=r(3);e.exports=n},function(e,t,r){var n;!function(){function i(e,t){if(e=e||"",t=t||{},e instanceof i)return e;if(!(this instanceof i))return new i(e,t);var r=o(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=H(100*this._a)/100,this._format=t.format||r.format,this._gradientType=t.gradientType,this._r<1&&(this._r=H(this._r)),this._g<1&&(this._g=H(this._g)),this._b<1&&(this._b=H(this._b)),this._ok=r.ok,this._tc_id=U++}function o(e){var t={r:0,g:0,b:0},r=1,n=!1,i=!1;if("string"==typeof e&&(e=D(e)),"object"==typeof e){if(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b"))t=a(e.r,e.g,e.b),n=!0,i="%"===String(e.r).substr(-1)?"prgb":"rgb";else if(e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")){var o=L(e.s,1),s=L(e.v,1);t=c(e.h,o,s),n=!0,i="hsv"}else if(e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")){var o=L(e.s),u=L(e.l);t=l(e.h,o,u),n=!0,i="hsl"}e.hasOwnProperty("a")&&(r=e.a)}return r=T(r),{ok:n,format:e.format||i,r:V(255,G(t.r,0)),g:V(255,G(t.g,0)),b:V(255,G(t.b,0)),a:r}}function a(e,t,r){return{r:255*k(e,255),g:255*k(t,255),b:255*k(r,255)}}function s(e,t,r){e=k(e,255),t=k(t,255),r=k(r,255);var n,i,o=G(e,t,r),a=V(e,t,r),s=(o+a)/2;if(o==a)n=i=0;else{var l=o-a;switch(i=s>.5?l/(2-o-a):l/(o+a),o){case e:n=(t-r)/l+(t<r?6:0);break;case t:n=(r-e)/l+2;break;case r:n=(e-t)/l+4}n/=6}return{h:n,s:i,l:s}}function l(e,t,r){function n(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}var i,o,a;if(e=k(e,360),t=k(t,100),r=k(r,100),0===t)i=o=a=r;else{var s=r<.5?r*(1+t):r+t-r*t,l=2*r-s;i=n(l,s,e+1/3),o=n(l,s,e),a=n(l,s,e-1/3)}return{r:255*i,g:255*o,b:255*a}}function u(e,t,r){e=k(e,255),t=k(t,255),r=k(r,255);var n,i,o=G(e,t,r),a=V(e,t,r),s=o,l=o-a;if(i=0===o?0:l/o,o==a)n=0;else{switch(o){case e:n=(t-r)/l+(t<r?6:0);break;case t:n=(r-e)/l+2;break;case r:n=(e-t)/l+4}n/=6}return{h:n,s:i,v:s}}function c(e,t,r){e=6*k(e,360),t=k(t,100),r=k(r,100);var n=F.floor(e),i=e-n,o=r*(1-t),a=r*(1-i*t),s=r*(1-(1-i)*t),l=n%6;return{r:255*[r,a,o,o,s,r][l],g:255*[s,r,r,a,o,o][l],b:255*[o,o,s,r,r,a][l]}}function h(e,t,r,n){var i=[R(H(e).toString(16)),R(H(t).toString(16)),R(H(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function d(e,t,r,n){return[R(I(n)),R(H(e).toString(16)),R(H(t).toString(16)),R(H(r).toString(16))].join("")}function f(e,t){t=0===t?0:t||10;var r=i(e).toHsl();return r.s-=t/100,r.s=S(r.s),i(r)}function p(e,t){t=0===t?0:t||10;var r=i(e).toHsl();return r.s+=t/100,r.s=S(r.s),i(r)}function m(e){return i(e).desaturate(100)}function v(e,t){t=0===t?0:t||10;var r=i(e).toHsl();return r.l+=t/100,r.l=S(r.l),i(r)}function g(e,t){t=0===t?0:t||10;var r=i(e).toRgb();return r.r=G(0,V(255,r.r-H(-t/100*255))),r.g=G(0,V(255,r.g-H(-t/100*255))),r.b=G(0,V(255,r.b-H(-t/100*255))),i(r)}function y(e,t){t=0===t?0:t||10;var r=i(e).toHsl();return r.l-=t/100,r.l=S(r.l),i(r)}function b(e,t){var r=i(e).toHsl(),n=(H(r.h)+t)%360;return r.h=n<0?360+n:n,i(r)}function _(e){var t=i(e).toHsl();return t.h=(t.h+180)%360,i(t)}function w(e){var t=i(e).toHsl(),r=t.h;return[i(e),i({h:(r+120)%360,s:t.s,l:t.l}),i({h:(r+240)%360,s:t.s,l:t.l})]}function x(e){var t=i(e).toHsl(),r=t.h;return[i(e),i({h:(r+90)%360,s:t.s,l:t.l}),i({h:(r+180)%360,s:t.s,l:t.l}),i({h:(r+270)%360,s:t.s,l:t.l})]}function M(e){var t=i(e).toHsl(),r=t.h;return[i(e),i({h:(r+72)%360,s:t.s,l:t.l}),i({h:(r+216)%360,s:t.s,l:t.l})]}function E(e,t,r){t=t||6,r=r||30;var n=i(e).toHsl(),o=360/r,a=[i(e)];for(n.h=(n.h-(o*t>>1)+720)%360;--t;)n.h=(n.h+o)%360,a.push(i(n));return a}function A(e,t){t=t||6;for(var r=i(e).toHsv(),n=r.h,o=r.s,a=r.v,s=[],l=1/t;t--;)s.push(i({h:n,s:o,v:a})),a=(a+l)%1;return s}function T(e){var t=parseFloat(e);return(isNaN(t)||t<0||t>1)&&(t=1),t}function k(e,t){P(e)&&(e="100%");var r=O(e);return e=V(t,G(0,parseFloat(e))),r&&(e=parseInt(e*t,10)/100),F.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function S(e){return V(1,G(0,e))}function C(e){return parseInt(e,16)}function P(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)}function O(e){return"string"==typeof e&&-1!=e.indexOf("%")}function R(e){return 1==e.length?"0"+e:""+e}function L(e,t){return t=t||100,e<=1&&(e=e*t+"%"),e}function I(e){return Math.round(255*parseFloat(e)).toString(16)}function B(e){return C(e)/255}function D(e){e=e.replace(z,"").replace(N,"").toLowerCase();var t=!1;if(X[e])e=X[e],t=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=q.rgb.exec(e))?{r:r[1],g:r[2],b:r[3]}:(r=q.rgba.exec(e))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=q.hsl.exec(e))?{h:r[1],s:r[2],l:r[3]}:(r=q.hsla.exec(e))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=q.hsv.exec(e))?{h:r[1],s:r[2],v:r[3]}:(r=q.hsva.exec(e))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=q.hex8.exec(e))?{a:B(r[1]),r:C(r[2]),g:C(r[3]),b:C(r[4]),format:t?"name":"hex8"}:(r=q.hex6.exec(e))?{r:C(r[1]),g:C(r[2]),b:C(r[3]),format:t?"name":"hex"}:!!(r=q.hex3.exec(e))&&{r:C(r[1]+""+r[1]),g:C(r[2]+""+r[2]),b:C(r[3]+""+r[3]),format:t?"name":"hex"}}function j(e){var t,r;return e=e||{level:"AA",size:"small"},t=(e.level||"AA").toUpperCase(),r=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA"),"small"!==r&&"large"!==r&&(r="small"),{level:t,size:r}}var z=/^[\s,#]+/,N=/\s+$/,U=0,F=Math,H=F.round,V=F.min,G=F.max,W=F.random;i.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,r,n,i,o,a=this.toRgb();return e=a.r/255,t=a.g/255,r=a.b/255,n=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4),i=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4),o=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4),.2126*n+.7152*i+.0722*o},setAlpha:function(e){return this._a=T(e),this._roundA=H(100*this._a)/100,this},toHsv:function(){var e=u(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=u(this._r,this._g,this._b),t=H(360*e.h),r=H(100*e.s),n=H(100*e.v);return 1==this._a?"hsv("+t+", "+r+"%, "+n+"%)":"hsva("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var e=s(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=s(this._r,this._g,this._b),t=H(360*e.h),r=H(100*e.s),n=H(100*e.l);return 1==this._a?"hsl("+t+", "+r+"%, "+n+"%)":"hsla("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHex:function(e){return h(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return d(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:H(this._r),g:H(this._g),b:H(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+H(this._r)+", "+H(this._g)+", "+H(this._b)+")":"rgba("+H(this._r)+", "+H(this._g)+", "+H(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:H(100*k(this._r,255))+"%",g:H(100*k(this._g,255))+"%",b:H(100*k(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+H(100*k(this._r,255))+"%, "+H(100*k(this._g,255))+"%, "+H(100*k(this._b,255))+"%)":"rgba("+H(100*k(this._r,255))+"%, "+H(100*k(this._g,255))+"%, "+H(100*k(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(Y[h(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+d(this._r,this._g,this._b,this._a),r=t,n=this._gradientType?"GradientType = 1, ":"";if(e){r=i(e).toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+t+",endColorstr="+r+")"},toString:function(e){var t=!!e;e=e||this._format;var r=!1,n=this._a<1&&this._a>=0;return t||!n||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"name"!==e?("rgb"===e&&(r=this.toRgbString()),"prgb"===e&&(r=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(r=this.toHexString()),"hex3"===e&&(r=this.toHexString(!0)),"hex8"===e&&(r=this.toHex8String()),"name"===e&&(r=this.toName()),"hsl"===e&&(r=this.toHslString()),"hsv"===e&&(r=this.toHsvString()),r||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},_applyModification:function(e,t){var r=e.apply(null,[this].concat([].slice.call(t)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(v,arguments)},brighten:function(){return this._applyModification(g,arguments)},darken:function(){return this._applyModification(y,arguments)},desaturate:function(){return this._applyModification(f,arguments)},saturate:function(){return this._applyModification(p,arguments)},greyscale:function(){return this._applyModification(m,arguments)},spin:function(){return this._applyModification(b,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(E,arguments)},complement:function(){return this._applyCombination(_,arguments)},monochromatic:function(){return this._applyCombination(A,arguments)},splitcomplement:function(){return this._applyCombination(M,arguments)},triad:function(){return this._applyCombination(w,arguments)},tetrad:function(){return this._applyCombination(x,arguments)}},i.fromRatio=function(e,t){if("object"==typeof e){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]="a"===n?e[n]:L(e[n]));e=r}return i(e,t)},i.equals=function(e,t){return!(!e||!t)&&i(e).toRgbString()==i(t).toRgbString()},i.random=function(){return i.fromRatio({r:W(),g:W(),b:W()})},i.mix=function(e,t,r){r=0===r?0:r||50;var n,o=i(e).toRgb(),a=i(t).toRgb(),s=r/100,l=2*s-1,u=a.a-o.a;n=l*u==-1?l:(l+u)/(1+l*u),n=(n+1)/2;var c=1-n;return i({r:a.r*n+o.r*c,g:a.g*n+o.g*c,b:a.b*n+o.b*c,a:a.a*s+o.a*(1-s)})},i.readability=function(e,t){var r=i(e),n=i(t);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)},i.isReadable=function(e,t,r){var n,o,a=i.readability(e,t);switch(o=!1,n=j(r),n.level+n.size){case"AAsmall":case"AAAlarge":o=a>=4.5;break;case"AAlarge":o=a>=3;break;case"AAAsmall":o=a>=7}return o},i.mostReadable=function(e,t,r){var n,o,a,s,l=null,u=0;r=r||{},o=r.includeFallbackColors,a=r.level,s=r.size;for(var c=0;c<t.length;c++)(n=i.readability(e,t[c]))>u&&(u=n,l=i(t[c]));return i.isReadable(e,l,{level:a,size:s})||!o?l:(r.includeFallbackColors=!1,i.mostReadable(e,["#fff","#000"],r))};var X=i.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Y=i.hexNames=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t}(X),q=function(){var e="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",t="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",r="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?";return{rgb:new RegExp("rgb"+t),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+t),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+t),hsva:new RegExp("hsva"+r),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();void 0!==e&&e.exports?e.exports=i:void 0!==(n=function(){return i}.call(t,r,t,e))&&(e.exports=n)}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Swatch=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=r(0),a=n(o),s=r(1),l=n(s),u=r(240),c=r(2),h=t.Swatch=function(e){var t=e.color,r=e.style,n=e.onClick,o=void 0===n?function(){}:n,s=e.onHover,u=e.title,h=void 0===u?t:u,d=e.children,f=e.focus,p=e.focusStyle,m=void 0===p?{}:p,v="transparent"===t,g=(0,l.default)({default:{swatch:i({background:t,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},r,f?m:{})}}),y=function(e){return o(t,e)},b=function(e){return 13===e.keyCode&&o(t,e)},_=function(e){return s(t,e)},w={};return s&&(w.onMouseOver=_),a.default.createElement("div",i({style:g.swatch,onClick:y,title:h,tabIndex:0,onKeyDown:b},w),d,v&&a.default.createElement(c.Checkboard,{borderRadius:g.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};t.default=(0,u.handleFocus)(h)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.handleFocus=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=r(0),l=function(e){return e&&e.__esModule?e:{default:e}}(s);t.handleFocus=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(r){function s(){var r,o,u,c;n(this,s);for(var h=arguments.length,d=Array(h),f=0;f<h;f++)d[f]=arguments[f];return o=u=i(this,(r=s.__proto__||Object.getPrototypeOf(s)).call.apply(r,[this].concat(d))),u.state={focus:!1},u.handleFocus=function(){return u.setState({focus:!0})},u.handleBlur=function(){return u.setState({focus:!1})},u.render=function(){return l.default.createElement(t,{onFocus:u.handleFocus,onBlur:u.handleBlur},l.default.createElement(e,a({},u.props,u.state)))},c=o,i(u,c)}return o(s,r),s}(l.default.Component)}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.AlphaPointer=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=t.AlphaPointer=function(e){var t=e.direction,r=(0,s.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:"vertical"===t});return o.default.createElement("div",{style:r.picker})};t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Block=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(8),u=n(l),c=r(2),h=r(243),d=n(h),f=t.Block=function(e){var t=e.onChange,r=e.onSwatchHover,n=e.hex,i=e.colors,a=e.width,l=e.triangle,h="transparent"===n,f=function(e,r){u.default.isValidHex(e)&&t({hex:e,source:"hex"},r)},p=(0,s.default)({default:{card:{width:a,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:n,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:h?"rgba(0,0,0,0.4)":"#fff",position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+n+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},{"hide-triangle":"hide"===l});return o.default.createElement("div",{style:p.card,className:"block-picker"},o.default.createElement("div",{style:p.triangle}),o.default.createElement("div",{style:p.head},h&&o.default.createElement(c.Checkboard,{borderRadius:"6px 6px 0 0"}),o.default.createElement("div",{style:p.label},n)),o.default.createElement("div",{style:p.body},o.default.createElement(d.default,{colors:i,onClick:f,onSwatchHover:r}),o.default.createElement(c.EditableInput,{style:{input:p.input},value:n,onChange:f})))};f.defaultProps={width:"170px",colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top"},t.default=(0,c.ColorWrap)(f)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.BlockSwatches=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(9),u=n(l),c=r(2),h=t.BlockSwatches=function(e){var t=e.colors,r=e.onClick,n=e.onSwatchHover,i=(0,s.default)({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return o.default.createElement("div",{style:i.swatches},(0,u.default)(t,function(e){return o.default.createElement(c.Swatch,{key:e,color:e,style:i.swatch,onClick:r,onHover:n,focusStyle:{boxShadow:"0 0 4px "+e}})}),o.default.createElement("div",{style:i.clear}))};t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Circle=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(9),u=n(l),c=r(92),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(c),d=r(2),f=r(245),p=n(f),m=t.Circle=function(e){var t=e.width,r=e.onChange,n=e.onSwatchHover,i=e.colors,a=e.hex,l=e.circleSize,c=e.circleSpacing,h=(0,s.default)({default:{card:{width:t,display:"flex",flexWrap:"wrap",marginRight:-c,marginBottom:-c}}}),d=function(e,t){return r({hex:e,source:"hex"},t)};return o.default.createElement("div",{style:h.card,className:"circle-picker"},(0,u.default)(i,function(e){return o.default.createElement(p.default,{key:e,color:e,onClick:d,onSwatchHover:n,active:a===e.toLowerCase(),circleSize:l,circleSpacing:c})}))};m.defaultProps={width:"252px",circleSize:28,circleSpacing:14,colors:[h.red[500],h.pink[500],h.purple[500],h.deepPurple[500],h.indigo[500],h.blue[500],h.lightBlue[500],h.cyan[500],h.teal[500],h.green[500],h.lightGreen[500],h.lime[500],h.yellow[500],h.amber[500],h.orange[500],h.deepOrange[500],h.brown[500],h.blueGrey[500]]},t.default=(0,d.ColorWrap)(m)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CircleSwatch=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(2),u=t.CircleSwatch=function(e){var t=e.color,r=e.onClick,n=e.onSwatchHover,i=e.hover,a=e.active,u=e.circleSize,c=e.circleSpacing,h=(0,s.default)({default:{swatch:{width:u,height:u,marginRight:c,marginBottom:c,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+u/2+"px "+t,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+t}}},{hover:i,active:a});return o.default.createElement("div",{style:h.swatch},o.default.createElement(l.Swatch,{style:h.Swatch,color:t,onClick:r,onHover:n,focusStyle:{boxShadow:h.Swatch.boxShadow+", 0 0 5px "+t}}))};u.defaultProps={circleSize:28,circleSpacing:14},t.default=(0,a.handleHover)(u)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(2),u=r(247),c=n(u),h=r(248),d=n(h),f=r(249),p=n(f),m=t.Chrome=function(e){var t=e.onChange,r=e.disableAlpha,n=e.rgb,i=e.hsl,a=e.hsv,u=e.hex,h=e.renderers,f=(0,s.default)({default:{picker:{background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",width:"225px",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+n.r+", "+n.g+", "+n.b+", "+n.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},{disableAlpha:r});return o.default.createElement("div",{style:f.picker,className:"chrome-picker"},o.default.createElement("div",{style:f.saturation},o.default.createElement(l.Saturation,{style:f.Saturation,hsl:i,hsv:a,pointer:p.default,onChange:t})),o.default.createElement("div",{style:f.body},o.default.createElement("div",{style:f.controls,className:"flexbox-fix"},o.default.createElement("div",{style:f.color},o.default.createElement("div",{style:f.swatch},o.default.createElement("div",{style:f.active}),o.default.createElement(l.Checkboard,{renderers:h}))),o.default.createElement("div",{style:f.toggles},o.default.createElement("div",{style:f.hue},o.default.createElement(l.Hue,{style:f.Hue,hsl:i,pointer:d.default,onChange:t})),o.default.createElement("div",{style:f.alpha},o.default.createElement(l.Alpha,{style:f.Alpha,rgb:n,hsl:i,pointer:d.default,renderers:h,onChange:t})))),o.default.createElement(c.default,{rgb:n,hsl:i,hex:u,onChange:t,disableAlpha:r})))};t.default=(0,l.ColorWrap)(m)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ChromeFields=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(1),h=n(c),d=r(8),f=n(d),p=r(2),m=t.ChromeFields=function(e){function t(){var e,r,n,a;i(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={view:""},n.toggleViews=function(){"hex"===n.state.view?n.setState({view:"rgb"}):"rgb"===n.state.view?n.setState({view:"hsl"}):"hsl"===n.state.view&&(1===n.props.hsl.a?n.setState({view:"hex"}):n.setState({view:"rgb"}))},n.handleChange=function(e,t){e.hex?f.default.isValidHex(e.hex)&&n.props.onChange({hex:e.hex,source:"hex"},t):e.r||e.g||e.b?n.props.onChange({r:e.r||n.props.rgb.r,g:e.g||n.props.rgb.g,b:e.b||n.props.rgb.b,source:"rgb"},t):e.a?(e.a<0?e.a=0:e.a>1&&(e.a=1),n.props.onChange({h:n.props.hsl.h,s:n.props.hsl.s,l:n.props.hsl.l,a:Math.round(100*e.a)/100,source:"rgb"},t)):(e.h||e.s||e.l)&&n.props.onChange({h:e.h||n.props.hsl.h,s:e.s&&e.s.replace("%","")||n.props.hsl.s,l:e.l&&e.l.replace("%","")||n.props.hsl.l,source:"hsl"},t)},n.showHighlight=function(e){e.target.style.background="#eee"},n.hideHighlight=function(e){e.target.style.background="transparent"},a=r,o(n,a)}return a(t,e),s(t,[{key:"componentDidMount",value:function(){1===this.props.hsl.a&&"hex"!==this.state.view?this.setState({view:"hex"}):"rgb"!==this.state.view&&"hsl"!==this.state.view&&this.setState({view:"rgb"})}},{key:"componentWillReceiveProps",value:function(e){1!==e.hsl.a&&"hex"===this.state.view&&this.setState({view:"rgb"})}},{key:"render",value:function(){var e=this,t=(0,h.default)({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),r=void 0;return"hex"===this.state.view?r=u.default.createElement("div",{style:t.fields,className:"flexbox-fix"},u.default.createElement("div",{style:t.field},u.default.createElement(p.EditableInput,{style:{input:t.input,label:t.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):"rgb"===this.state.view?r=u.default.createElement("div",{style:t.fields,className:"flexbox-fix"},u.default.createElement("div",{style:t.field},u.default.createElement(p.EditableInput,{style:{input:t.input,label:t.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),u.default.createElement("div",{style:t.field},u.default.createElement(p.EditableInput,{style:{input:t.input,label:t.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),u.default.createElement("div",{style:t.field},u.default.createElement(p.EditableInput,{style:{input:t.input,label:t.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),u.default.createElement("div",{style:t.alpha},u.default.createElement(p.EditableInput,{style:{input:t.input,label:t.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):"hsl"===this.state.view&&(r=u.default.createElement("div",{style:t.fields,className:"flexbox-fix"},u.default.createElement("div",{style:t.field},u.default.createElement(p.EditableInput,{style:{input:t.input,label:t.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),u.default.createElement("div",{style:t.field},u.default.createElement(p.EditableInput,{style:{input:t.input,label:t.label},label:"s",value:Math.round(100*this.props.hsl.s)+"%",onChange:this.handleChange})),u.default.createElement("div",{style:t.field},u.default.createElement(p.EditableInput,{style:{input:t.input,label:t.label},label:"l",value:Math.round(100*this.props.hsl.l)+"%",onChange:this.handleChange})),u.default.createElement("div",{style:t.alpha},u.default.createElement(p.EditableInput,{style:{input:t.input,label:t.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),u.default.createElement("div",{style:t.wrap,className:"flexbox-fix"},r,u.default.createElement("div",{style:t.toggle},u.default.createElement("div",{style:t.icon,onClick:this.toggleViews,ref:function(t){return e.icon=t}},u.default.createElement("svg",{style:t.svg,viewBox:"0 0 24 24",onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight},u.default.createElement("path",{ref:function(t){return e.iconUp=t},fill:"#333",d:"M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}),u.default.createElement("path",{ref:function(t){return e.iconDown=t},fill:"#333",d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15Z"})))))}}]),t}(u.default.Component);t.default=m},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ChromePointer=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=t.ChromePointer=function(){var e=(0,s.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return o.default.createElement("div",{style:e.picker})};t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ChromePointerCircle=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=t.ChromePointerCircle=function(){var e=(0,s.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return o.default.createElement("div",{style:e.picker})};t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Compact=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(9),u=n(l),c=r(8),h=n(c),d=r(46),f=r(2),p=r(259),m=n(p),v=r(260),g=n(v),y=t.Compact=function(e){var t=e.onChange,r=e.onSwatchHover,n=e.colors,i=e.hex,a=e.rgb,l=(0,s.default)({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}}),c=function(e,r){e.hex?h.default.isValidHex(e.hex)&&t({hex:e.hex,source:"hex"},r):t(e,r)};return o.default.createElement(d.Raised,{style:l.Compact},o.default.createElement("div",{style:l.compact,className:"compact-picker"},o.default.createElement("div",null,(0,u.default)(n,function(e){return o.default.createElement(m.default,{key:e,color:e,active:e.toLowerCase()===i,onClick:c,onSwatchHover:r})}),o.default.createElement("div",{style:l.clear})),o.default.createElement(g.default,{hex:i,rgb:a,onChange:c})))};y.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"]},t.default=(0,f.ColorWrap)(y)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(47),h=n(c),d=r(1),f=n(d),p=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"render",value:function(){var e=(0,f.default)({default:{wrap:{position:"relative"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 ${ this.props.zDepth }px ${ this.props.zDepth * 4 }px rgba(0,0,0,.24)",borderRadius:this.props.radius,background:this.props.background}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},this.props);return u.default.createElement("div",{style:e.wrap},u.default.createElement("div",{style:e.bg}),u.default.createElement("div",{style:e.content},this.props.children))}}]),t}(u.default.Component);p.propTypes={background:h.default.string,zDepth:h.default.oneOf(["0","1","2","3","4","5",0,1,2,3,4,5]),radius:h.default.oneOfType([h.default.string,h.default.number])},p.defaultProps={background:"#fff",zDepth:"1",radius:"2px"},t.default=p},function(e,t,r){"use strict";(function(t){var n=r(48),i=r(49),o=r(93),a=r(50),s=r(253);e.exports=function(e,r){function l(e){var t=e&&(A&&e[A]||e[T]);if("function"==typeof t)return t}function u(e,t){return e===t?0!==e||1/e==1/t:e!==e&&t!==t}function c(e){this.message=e,this.stack=""}function h(e){function n(n,u,h,d,f,p,m){if(d=d||k,p=p||h,m!==a)if(r)i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if("production"!==t.env.NODE_ENV&&"undefined"!=typeof console){var v=d+":"+h;!s[v]&&l<3&&(o(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",p,d),s[v]=!0,l++)}return null==u[h]?n?new c(null===u[h]?"The "+f+" `"+p+"` is marked as required in `"+d+"`, but its value is `null`.":"The "+f+" `"+p+"` is marked as required in `"+d+"`, but its value is `undefined`."):null:e(u,h,d,f,p)}if("production"!==t.env.NODE_ENV)var s={},l=0;var u=n.bind(null,!1);return u.isRequired=n.bind(null,!0),u}function d(e){function t(t,r,n,i,o,a){var s=t[r];if(w(s)!==e)return new c("Invalid "+i+" `"+o+"` of type `"+x(s)+"` supplied to `"+n+"`, expected `"+e+"`.");return null}return h(t)}function f(e){function t(t,r,n,i,o){if("function"!=typeof e)return new c("Property `"+o+"` of component `"+n+"` has invalid PropType notation inside arrayOf.");var s=t[r];if(!Array.isArray(s)){return new c("Invalid "+i+" `"+o+"` of type `"+w(s)+"` supplied to `"+n+"`, expected an array.")}for(var l=0;l<s.length;l++){var u=e(s,l,n,i,o+"["+l+"]",a);if(u instanceof Error)return u}return null}return h(t)}function p(e){function t(t,r,n,i,o){if(!(t[r]instanceof e)){var a=e.name||k;return new c("Invalid "+i+" `"+o+"` of type `"+E(t[r])+"` supplied to `"+n+"`, expected instance of `"+a+"`.")}return null}return h(t)}function m(e){function r(t,r,n,i,o){for(var a=t[r],s=0;s<e.length;s++)if(u(a,e[s]))return null;return new c("Invalid "+i+" `"+o+"` of value `"+a+"` supplied to `"+n+"`, expected one of "+JSON.stringify(e)+".")}return Array.isArray(e)?h(r):("production"!==t.env.NODE_ENV&&o(!1,"Invalid argument supplied to oneOf, expected an instance of array."),n.thatReturnsNull)}function v(e){function t(t,r,n,i,o){if("function"!=typeof e)return new c("Property `"+o+"` of component `"+n+"` has invalid PropType notation inside objectOf.");var s=t[r],l=w(s);if("object"!==l)return new c("Invalid "+i+" `"+o+"` of type `"+l+"` supplied to `"+n+"`, expected an object.");for(var u in s)if(s.hasOwnProperty(u)){var h=e(s,u,n,i,o+"."+u,a);if(h instanceof Error)return h}return null}return h(t)}function g(e){function r(t,r,n,i,o){for(var s=0;s<e.length;s++){if(null==(0,e[s])(t,r,n,i,o,a))return null}return new c("Invalid "+i+" `"+o+"` supplied to `"+n+"`.")}if(!Array.isArray(e))return"production"!==t.env.NODE_ENV&&o(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),n.thatReturnsNull;for(var i=0;i<e.length;i++){var s=e[i];if("function"!=typeof s)return o(!1,"Invalid argument supplid to oneOfType. Expected an array of check functions, but received %s at index %s.",M(s),i),n.thatReturnsNull}return h(r)}function y(e){function t(t,r,n,i,o){var s=t[r],l=w(s);if("object"!==l)return new c("Invalid "+i+" `"+o+"` of type `"+l+"` supplied to `"+n+"`, expected `object`.");for(var u in e){var h=e[u];if(h){var d=h(s,u,n,i,o+"."+u,a);if(d)return d}}return null}return h(t)}function b(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(b);if(null===t||e(t))return!0;var r=l(t);if(!r)return!1;var n,i=r.call(t);if(r!==t.entries){for(;!(n=i.next()).done;)if(!b(n.value))return!1}else for(;!(n=i.next()).done;){var o=n.value;if(o&&!b(o[1]))return!1}return!0;default:return!1}}function _(e,t){return"symbol"===e||("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}function w(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":_(t,e)?"symbol":t}function x(e){if(void 0===e||null===e)return""+e;var t=w(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function M(e){var t=x(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}function E(e){return e.constructor&&e.constructor.name?e.constructor.name:k}var A="function"==typeof Symbol&&Symbol.iterator,T="@@iterator",k="<<anonymous>>",S={array:d("array"),bool:d("boolean"),func:d("function"),number:d("number"),object:d("object"),string:d("string"),symbol:d("symbol"),any:function(){return h(n.thatReturnsNull)}(),arrayOf:f,element:function(){function t(t,r,n,i,o){var a=t[r];if(!e(a)){return new c("Invalid "+i+" `"+o+"` of type `"+w(a)+"` supplied to `"+n+"`, expected a single ReactElement.")}return null}return h(t)}(),instanceOf:p,node:function(){function e(e,t,r,n,i){return b(e[t])?null:new c("Invalid "+n+" `"+i+"` supplied to `"+r+"`, expected a ReactNode.")}return h(e)}(),objectOf:v,oneOf:m,oneOfType:g,shape:y};return c.prototype=Error.prototype,S.checkPropTypes=s,S.PropTypes=S,S}}).call(t,r(5))},function(e,t,r){"use strict";(function(t){function n(e,r,n,l,u){if("production"!==t.env.NODE_ENV)for(var c in e)if(e.hasOwnProperty(c)){var h;try{i("function"==typeof e[c],"%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",l||"React class",n,c),h=e[c](r,c,l,n,null,a)}catch(e){h=e}if(o(!h||h instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",l||"React class",n,c,typeof h),h instanceof Error&&!(h.message in s)){s[h.message]=!0;var d=u?u():"";o(!1,"Failed %s type: %s%s",n,h.message,null!=d?d:"")}}}if("production"!==t.env.NODE_ENV)var i=r(49),o=r(93),a=r(50),s={};e.exports=n}).call(t,r(5))},function(e,t,r){"use strict";var n=r(48),i=r(49),o=r(50);e.exports=function(){function e(e,t,r,n,a,s){s!==o&&i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t};return r.checkPropTypes=n,r.PropTypes=r,r}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),c=n(u),h=r(1),d=n(h),f=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"render",value:function(){var e=(0,d.default)({default:{tile:{fontSize:"16px",padding:"16px",display:"flex",justifyContent:"space-between",color:this.props.color},primary:{display:"flex",width:"100%"},sidebar:{minWidth:"56px",maxWidth:"56px",flexBasis:"56px"},content:{background:"none",flex:"1",overflow:"auto"},secondary:{flexBasis:"42",textAlign:"center"},sidebarIcon:{marginTop:"-12px",marginLeft:"-12px",marginBottom:"-12px"}},divider:{tile:{boxShadow:"inset 0 -1px 0 rgba(0,0,0,.12)"}},condensed:{tile:{paddingBottom:"0px",paddingTop:"0px",paddingRight:"0px"},sidebar:{minWidth:"28px",maxWidth:"28px",flexBasis:"28px"}}},{clickable:this.props.onClick},this.props),t=s(this.props.children,2),r=t[0],n=t[1];return c.default.createElement("div",{style:e.tile,className:"flexbox-fix"},c.default.createElement("div",{style:e.primary,className:"flexbox-fix"},c.default.createElement("div",{style:e.sidebar,key:"sidebar-#{ sidebar }"},r),c.default.createElement("div",{style:e.content,key:"content-#{ content }"},n)))}}]),t}(c.default.Component);t.default=f},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(1),h=n(c),d=r(32),f=n(d),p=r(257),m=n(p),v=r(258),g=n(v),y=function(e){function t(e){i(this,t);var r,n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r=e.selectedTab<(e.tabs&&e.tabs.length)?e.selectedTab:0,n.state={selectedTab:r},n.handleClick=n.handleClick.bind(n),n.slide=n.slide.bind(n),n}return a(t,e),s(t,[{key:"handleClick",value:function(e){this.props.onChange&&this.props.onChange(e),this.setState({selectedTab:e})}},{key:"slide",value:function(){if(this.props.tabs.length){var e=this.refs.tabs.getDOMNode(),t=e.scrollLeft,r=e.offsetWidth+e.scrollLeft,n=this.refs["tab-"+this.state.selectedTab]&&this.refs["tab-"+this.state.selectedTab].getDOMNode(),i=n&&n.getBoundingClientRect().left-e.getBoundingClientRect().left+e.scrollLeft,o=n&&i+n.offsetWidth;o>r&&(e.scrollLeft+=o-r),i<t&&(e.scrollLeft-=t-i);var a=this.refs.indicator;a.style.left=i+"px",a.style.width=n.offsetWidth+"px",a.style.height="2px"}}},{key:"componentDidMount",value:function(){this.slide()}},{key:"componentWillReceiveProps",value:function(e){e.selectedTab!==this.state.selectedTab&&this.setState({selectedTab:e.selectedTab})}},{key:"componentWillUpdate",value:function(e,t){t.selectedTab>=(e.tabs&&e.tabs.length)&&(t.selectedTab=e.tabs.length-1)}},{key:"componentDidUpdate",value:function(){this.slide()}},{key:"render",value:function(){for(var e=(0,h.default)({default:{tabs:{position:"relative",background:this.props.background},tabWrap:{display:"flex"},tab:{justifyContent:"flex-start",minWidth:"68px",maxWidth:"240px"},Tab:{color:this.props.color,inactive:this.props.inactive,capitalize:this.props.capitalize},indicator:{height:"0",position:"absolute",bottom:"0",left:"0",background:this.props.color,transition:"all 200ms linear"}},scrollable:{tabs:{overflowX:"scroll"},tabWrap:{paddingLeft:"60px",justifyContent:"flex-start",width:"400%"},tab:{width:"auto"}},"align-justify":{tabWrap:{justifyContent:"space-between"},tab:{width:100/this.props.tabs.length+"%"}},"align-left":{tabWrap:{paddingLeft:"60px",justifyContent:"flex-start"},tab:{width:"auto"}},"align-center":{tabWrap:{justifyContent:"center"},tab:{width:"auto"}}},{scrollable:this.props.width/this.props.tabs.length<72},this.props,this.state),t=[],r=0;r<this.props.tabs.length;r++){var n,i,o,a,s=this.props.tabs[r];(0,f.default)(s)?(n=s,i=null):(n=s.label,i=s.onClick,o=s.callbackValue,a=s.newTab),t.push(u.default.createElement("div",{style:e.tab,ref:"tab-"+r,key:r},u.default.createElement(g.default,{onClick:i,callbackValue:o,newTab:a},u.default.createElement(m.default,{style:e.Tab,tab:r,selected:this.state.selectedTab===r,selectable:s.selectable,onClick:this.handleClick},n))))}return u.default.createElement("div",{style:e.tabs,ref:"tabs"},u.default.createElement("div",{style:e.tabWrap,className:"flexbox-fix"},t),u.default.createElement("div",{style:e.indicator,ref:"indicator"}))}}]),t}(u.default.Component);y.defaultProps={selectedTab:0,background:"transparent",color:"#fff"},t.default=y},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(47),h=n(c),d=r(1),f=n(d),p=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.handleClick=e.handleClick.bind(e),e}return a(t,e),s(t,[{key:"handleClick",value:function(){!1!==this.props.selectable&&this.props.onClick(this.props.tab)}},{key:"render",value:function(){var e=(0,f.default)({default:{tab:{color:this.props.inactive||this.props.color,cursor:"pointer",paddingLeft:"12px",paddingRight:"12px",height:"48px",lineHeight:"48px",textAlign:"center",fontSize:"14px",textTransform:!1===this.props.capitalize?"":"uppercase",fontWeight:"500",whiteSpace:"nowrap",opacity:".47",transition:"opacity 100ms linear"}},selected:{tab:{color:this.props.color,opacity:".87"}}},this.props);return u.default.createElement("div",{style:e.tab,onClick:this.handleClick},this.props.children)}}]),t}(u.default.Component);p.propTypes={selected:h.default.bool},p.defaultProps={selected:!1,color:"#fff"},t.default=p},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(32),h=n(c),d=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.handleClick=e.handleClick.bind(e),e}return a(t,e),s(t,[{key:"handleClick",value:function(e){this.props.onClick&&this.props.onClick(e,this.props.callbackValue)}},{key:"render",value:function(){return(0,h.default)(this.props.onClick)?u.default.createElement("a",{style:{textDecoration:"none"},href:this.props.onClick,target:this.props.newTab&&"_blank"},this.props.children):u.default.createElement("a",{style:{textDecoration:"none"},onClick:this.handleClick},this.props.children)}}]),t}(u.default.Component);d.defaultProps={newTab:!1},t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CompactColor=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(2),u=t.CompactColor=function(e){var t=e.color,r=e.onClick,n=void 0===r?function(){}:r,i=e.onSwatchHover,a=e.active,u=(0,s.default)({default:{color:{background:t,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:"#fff",borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:a,"color-#FFFFFF":"#FFFFFF"===t,transparent:"transparent"===t});return o.default.createElement(l.Swatch,{style:u.color,color:t,onClick:n,onHover:i,focusStyle:{boxShadow:"0 0 4px "+t}},o.default.createElement("div",{style:u.dot}))};t.default=u},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CompactFields=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(2),u=t.CompactFields=function(e){var t=e.hex,r=e.rgb,n=e.onChange,i=(0,s.default)({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:t},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),a=function(e,t){e.r||e.g||e.b?n({r:e.r||r.r,g:e.g||r.g,b:e.b||r.b,source:"rgb"},t):n({hex:e.hex,source:"hex"},t)};return o.default.createElement("div",{style:i.fields,className:"flexbox-fix"},o.default.createElement("div",{style:i.active}),o.default.createElement(l.EditableInput,{style:{wrap:i.HEXwrap,input:i.HEXinput,label:i.HEXlabel},label:"hex",value:t,onChange:a}),o.default.createElement(l.EditableInput,{style:{wrap:i.RGBwrap,input:i.RGBinput,label:i.RGBlabel},label:"r",value:r.r,onChange:a}),o.default.createElement(l.EditableInput,{style:{wrap:i.RGBwrap,input:i.RGBinput,label:i.RGBlabel},label:"g",value:r.g,onChange:a}),o.default.createElement(l.EditableInput,{style:{wrap:i.RGBwrap,input:i.RGBinput,label:i.RGBlabel},label:"b",value:r.b,onChange:a}))};t.default=u},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Github=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(9),u=n(l),c=r(2),h=r(262),d=n(h),f=t.Github=function(e){var t=e.width,r=e.colors,n=e.onChange,i=e.onSwatchHover,a=e.triangle,l=(0,s.default)({default:{card:{width:t,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},{"hide-triangle":"hide"===a,"top-left-triangle":"top-left"===a,"top-right-triangle":"top-right"===a,"bottom-right-triangle":"bottom-right"===a}),c=function(e,t){return n({hex:e,source:"hex"},t)};return o.default.createElement("div",{style:l.card,className:"github-picker"},o.default.createElement("div",{style:l.triangleShadow}),o.default.createElement("div",{style:l.triangle}),(0,u.default)(r,function(e){return o.default.createElement(d.default,{color:e,key:e,onClick:c,onSwatchHover:i})}))};f.defaultProps={width:"200px",colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left"},t.default=(0,c.ColorWrap)(f)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.GithubSwatch=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(2),u=t.GithubSwatch=function(e){var t=e.hover,r=e.color,n=e.onClick,i=e.onSwatchHover,a={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},u=(0,s.default)({default:{swatch:{width:"25px",height:"25px"}},hover:{swatch:a}},{hover:t});return o.default.createElement("div",{style:u.swatch},o.default.createElement(l.Swatch,{color:r,onClick:n,onHover:i,focusStyle:a}))};t.default=(0,a.handleHover)(u)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.HuePicker=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=r(0),a=n(o),s=r(1),l=n(s),u=r(2),c=r(264),h=n(c),d=t.HuePicker=function(e){var t=e.width,r=e.height,n=e.onChange,o=e.hsl,s=e.direction,c=e.pointer,h=(0,l.default)({default:{picker:{position:"relative",width:t,height:r},hue:{radius:"2px"}}}),d=function(e){return n({a:1,h:e.h,l:.5,s:1})};return a.default.createElement("div",{style:h.picker,className:"hue-picker"},a.default.createElement(u.Hue,i({},h.hue,{hsl:o,pointer:c,onChange:d,direction:s})))};d.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:h.default},t.default=(0,u.ColorWrap)(d)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SliderPointer=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=t.SliderPointer=function(e){var t=e.direction,r=(0,s.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:"vertical"===t});return o.default.createElement("div",{style:r.picker})};t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Material=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(8),u=n(l),c=r(46),h=r(2),d=t.Material=function(e){var t=e.onChange,r=e.hex,n=e.rgb,i=(0,s.default)({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+r,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}}),a=function(e,r){e.hex?u.default.isValidHex(e.hex)&&t({hex:e.hex,source:"hex"},r):(e.r||e.g||e.b)&&t({r:e.r||n.r,g:e.g||n.g,b:e.b||n.b,source:"rgb"},r)};return o.default.createElement(c.Raised,null,o.default.createElement("div",{style:i.material,className:"material-picker"},o.default.createElement(h.EditableInput,{style:{wrap:i.HEXwrap,input:i.HEXinput,label:i.HEXlabel},label:"hex",value:r,onChange:a}),o.default.createElement("div",{style:i.split,className:"flexbox-fix"},o.default.createElement("div",{style:i.third},o.default.createElement(h.EditableInput,{style:{wrap:i.RGBwrap,input:i.RGBinput,label:i.RGBlabel},label:"r",value:n.r,onChange:a})),o.default.createElement("div",{style:i.third},o.default.createElement(h.EditableInput,{style:{wrap:i.RGBwrap,input:i.RGBinput,label:i.RGBlabel},label:"g",value:n.g,onChange:a})),o.default.createElement("div",{style:i.third},o.default.createElement(h.EditableInput,{style:{wrap:i.RGBwrap,input:i.RGBinput,label:i.RGBlabel},label:"b",value:n.b,onChange:a})))))};t.default=(0,h.ColorWrap)(d)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Photoshop=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(1),h=n(c),d=r(2),f=r(267),p=n(f),m=r(268),v=n(m),g=r(269),y=n(g),b=r(270),_=n(b),w=r(271),x=n(w),M=t.Photoshop=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.state={currentColor:e.hex},r}return a(t,e),s(t,[{key:"render",value:function(){var e=(0,h.default)({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}});return u.default.createElement("div",{style:e.picker,className:"photoshop-picker"},u.default.createElement("div",{style:e.head},this.props.header),u.default.createElement("div",{style:e.body,className:"flexbox-fix"},u.default.createElement("div",{style:e.saturation},u.default.createElement(d.Saturation,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:v.default,onChange:this.props.onChange})),u.default.createElement("div",{style:e.hue},u.default.createElement(d.Hue,{direction:"vertical",hsl:this.props.hsl,pointer:y.default,onChange:this.props.onChange})),u.default.createElement("div",{style:e.controls},u.default.createElement("div",{style:e.top,className:"flexbox-fix"},u.default.createElement("div",{style:e.previews},u.default.createElement(x.default,{rgb:this.props.rgb,currentColor:this.state.currentColor})),u.default.createElement("div",{style:e.actions},u.default.createElement(_.default,{label:"OK",onClick:this.props.onAccept,active:!0}),u.default.createElement(_.default,{label:"Cancel",onClick:this.props.onCancel}),u.default.createElement(p.default,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),t}(u.default.Component);M.defaultProps={header:"Color Picker"},t.default=(0,d.ColorWrap)(M)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoshopPicker=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(8),u=n(l),c=r(2),h=t.PhotoshopPicker=function(e){var t=e.onChange,r=e.rgb,n=e.hsv,i=e.hex,a=(0,s.default)({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),l=function(e,i){e["#"]?u.default.isValidHex(e["#"])&&t({hex:e["#"],source:"hex"},i):e.r||e.g||e.b?t({r:e.r||r.r,g:e.g||r.g,b:e.b||r.b,source:"rgb"},i):(e.h||e.s||e.v)&&t({h:e.h||n.h,s:e.s||n.s,v:e.v||n.v,source:"hsv"},i)};return o.default.createElement("div",{style:a.fields},o.default.createElement(c.EditableInput,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"h",value:Math.round(n.h),onChange:l}),o.default.createElement(c.EditableInput,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"s",value:Math.round(100*n.s),onChange:l}),o.default.createElement(c.EditableInput,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"v",value:Math.round(100*n.v),onChange:l}),o.default.createElement("div",{style:a.divider}),o.default.createElement(c.EditableInput,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"r",value:r.r,onChange:l}),o.default.createElement(c.EditableInput,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"g",value:r.g,onChange:l}),o.default.createElement(c.EditableInput,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"b",value:r.b,onChange:l}),o.default.createElement("div",{style:a.divider}),o.default.createElement(c.EditableInput,{style:{wrap:a.HEXwrap,input:a.HEXinput,label:a.HEXlabel},label:"#",value:i.replace("#",""),onChange:l}),o.default.createElement("div",{style:a.fieldSymbols},o.default.createElement("div",{style:a.symbol},"°"),o.default.createElement("div",{style:a.symbol},"%"),o.default.createElement("div",{style:a.symbol},"%")))};t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoshopPointerCircle=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=t.PhotoshopPointerCircle=function(e){var t=e.hsl,r=(0,s.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":t.l>.5});return o.default.createElement("div",{style:r.picker})};t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoshopPointerCircle=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=t.PhotoshopPointerCircle=function(){var e=(0,s.default)({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return o.default.createElement("div",{style:e.pointer},o.default.createElement("div",{style:e.left},o.default.createElement("div",{style:e.leftInside})),o.default.createElement("div",{style:e.right},o.default.createElement("div",{style:e.rightInside})))};t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoshopBotton=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=t.PhotoshopBotton=function(e){var t=e.onClick,r=e.label,n=e.children,i=e.active,a=(0,s.default)({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:i});return o.default.createElement("div",{style:a.button,onClick:t},r||n)};t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoshopPreviews=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=t.PhotoshopPreviews=function(e){var t=e.rgb,r=e.currentColor,n=(0,s.default)({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+t.r+","+t.g+", "+t.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:r,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return o.default.createElement("div",null,o.default.createElement("div",{style:n.label},"new"),o.default.createElement("div",{style:n.swatches},o.default.createElement("div",{style:n.new}),o.default.createElement("div",{style:n.current})),o.default.createElement("div",{style:n.label},"current"))};t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Sketch=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(2),u=r(273),c=n(u),h=r(274),d=n(h),f=t.Sketch=function(e){var t=e.width,r=e.rgb,n=e.hex,i=e.hsv,a=e.hsl,u=e.onChange,h=e.onSwatchHover,f=e.disableAlpha,p=e.presetColors,m=e.renderers,v=(0,s.default)({default:{picker:{width:t,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+r.r+","+r.g+","+r.b+","+r.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},{disableAlpha:f});return o.default.createElement("div",{style:v.picker,className:"sketch-picker"},o.default.createElement("div",{style:v.saturation},o.default.createElement(l.Saturation,{style:v.Saturation,hsl:a,hsv:i,onChange:u})),o.default.createElement("div",{style:v.controls,className:"flexbox-fix"},o.default.createElement("div",{style:v.sliders},o.default.createElement("div",{style:v.hue},o.default.createElement(l.Hue,{style:v.Hue,hsl:a,onChange:u})),o.default.createElement("div",{style:v.alpha},o.default.createElement(l.Alpha,{style:v.Alpha,rgb:r,hsl:a,renderers:m,onChange:u}))),o.default.createElement("div",{style:v.color},o.default.createElement(l.Checkboard,null),o.default.createElement("div",{style:v.activeColor}))),o.default.createElement(c.default,{rgb:r,hsl:a,hex:n,onChange:u,disableAlpha:f}),o.default.createElement(d.default,{colors:p,onClick:u,onSwatchHover:h}))};f.defaultProps={presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"],width:200},t.default=(0,l.ColorWrap)(f)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ShetchFields=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(8),u=n(l),c=r(2),h=t.ShetchFields=function(e){var t=e.onChange,r=e.rgb,n=e.hsl,i=e.hex,a=e.disableAlpha,l=(0,s.default)({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:a}),h=function(e,i){e.hex?u.default.isValidHex(e.hex)&&t({hex:e.hex,source:"hex"},i):e.r||e.g||e.b?t({r:e.r||r.r,g:e.g||r.g,b:e.b||r.b,a:r.a,source:"rgb"},i):e.a&&(e.a<0?e.a=0:e.a>100&&(e.a=100),e.a=e.a/100,t({h:n.h,s:n.s,l:n.l,a:e.a,source:"rgb"},i))};return o.default.createElement("div",{style:l.fields,className:"flexbox-fix"},o.default.createElement("div",{style:l.double},o.default.createElement(c.EditableInput,{style:{input:l.input,label:l.label},label:"hex",value:i.replace("#",""),onChange:h})),o.default.createElement("div",{style:l.single},o.default.createElement(c.EditableInput,{style:{input:l.input,label:l.label},label:"r",value:r.r,onChange:h,dragLabel:"true",dragMax:"255"})),o.default.createElement("div",{style:l.single},o.default.createElement(c.EditableInput,{style:{input:l.input,label:l.label},label:"g",value:r.g,onChange:h,dragLabel:"true",dragMax:"255"})),o.default.createElement("div",{style:l.single},o.default.createElement(c.EditableInput,{style:{input:l.input,label:l.label},label:"b",value:r.b,onChange:h,dragLabel:"true",dragMax:"255"})),o.default.createElement("div",{style:l.alpha},o.default.createElement(c.EditableInput,{style:{input:l.input,label:l.label},label:"a",value:Math.round(100*r.a),onChange:h,dragLabel:"true",dragMax:"100"})))};t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SketchPresetColors=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=r(0),a=n(o),s=r(47),l=n(s),u=r(1),c=n(u),h=r(2),d=t.SketchPresetColors=function(e){var t=e.colors,r=e.onClick,n=void 0===r?function(){}:r,o=e.onSwatchHover,s=(0,c.default)({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!t||!t.length}),l=function(e,t){n({hex:e,source:"hex"},t)};return a.default.createElement("div",{style:s.colors,className:"flexbox-fix"},t.map(function(e){var t="string"==typeof e?{color:e}:e;return a.default.createElement("div",{key:t.color,style:s.swatchWrap},a.default.createElement(h.Swatch,i({},t,{style:s.swatch,onClick:l,onHover:o,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+t.color}})))}))};d.propTypes={colors:l.default.arrayOf(l.default.oneOfType([l.default.string,l.default.shape({color:l.default.string,title:l.default.string})]))},t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Slider=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(2),u=r(276),c=n(u),h=r(278),d=n(h),f=t.Slider=function(e){var t=e.hsl,r=e.onChange,n=e.pointer,i=(0,s.default)({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}});return o.default.createElement("div",{className:"slider-picker"},o.default.createElement("div",{style:i.hue},o.default.createElement(l.Hue,{style:i.Hue,hsl:t,pointer:n,onChange:r})),o.default.createElement("div",{style:i.swatches},o.default.createElement(c.default,{hsl:t,onClick:r})))};f.defaultProps={pointer:d.default},t.default=(0,l.ColorWrap)(f)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SliderSwatches=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(277),u=n(l),c=t.SliderSwatches=function(e){var t=e.onClick,r=e.hsl,n=(0,s.default)({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}});return o.default.createElement("div",{style:n.swatches},o.default.createElement("div",{style:n.swatch},o.default.createElement(u.default,{hsl:r,offset:".80",active:Math.round(100*r.l)/100==.8&&Math.round(100*r.s)/100==.5,onClick:t,first:!0})),o.default.createElement("div",{style:n.swatch},o.default.createElement(u.default,{hsl:r,offset:".65",active:Math.round(100*r.l)/100==.65&&Math.round(100*r.s)/100==.5,onClick:t})),o.default.createElement("div",{style:n.swatch},o.default.createElement(u.default,{hsl:r,offset:".50",active:Math.round(100*r.l)/100==.5&&Math.round(100*r.s)/100==.5,onClick:t})),o.default.createElement("div",{style:n.swatch},o.default.createElement(u.default,{hsl:r,offset:".35",active:Math.round(100*r.l)/100==.35&&Math.round(100*r.s)/100==.5,onClick:t})),o.default.createElement("div",{style:n.swatch},o.default.createElement(u.default,{hsl:r,offset:".20",active:Math.round(100*r.l)/100==.2&&Math.round(100*r.s)/100==.5,onClick:t,last:!0})),o.default.createElement("div",{style:n.clear}))};t.default=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SliderSwatch=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=t.SliderSwatch=function(e){var t=e.hsl,r=e.offset,n=e.onClick,i=void 0===n?function(){}:n,a=e.active,l=e.first,u=e.last,c=(0,s.default)({default:{swatch:{height:"12px",background:"hsl("+t.h+", 50%, "+100*r+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:a,first:l,last:u}),h=function(e){return i({h:t.h,s:.5,l:r,source:"hsl"},e)};return o.default.createElement("div",{style:c.swatch,onClick:h})};t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SliderPointer=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=t.SliderPointer=function(){var e=(0,s.default)({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return o.default.createElement("div",{style:e.picker})};t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Swatches=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(9),u=n(l),c=r(8),h=n(c),d=r(92),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(d),p=r(2),m=r(46),v=r(280),g=n(v),y=t.Swatches=function(e){var t=e.width,r=e.height,n=e.onChange,i=e.onSwatchHover,a=e.colors,l=e.hex,c=(0,s.default)({default:{picker:{width:t,height:r},overflow:{height:r,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}}),d=function(e,t){h.default.isValidHex(e)&&n({hex:e,source:"hex"},t)};return o.default.createElement("div",{style:c.picker,className:"swatches-picker"},o.default.createElement(m.Raised,null,o.default.createElement("div",{style:c.overflow},o.default.createElement("div",{style:c.body},(0,u.default)(a,function(e){return o.default.createElement(g.default,{key:e.toString(),group:e,active:l,onClick:d,onSwatchHover:i})}),o.default.createElement("div",{style:c.clear})))))};y.defaultProps={width:320,height:240,colors:[[f.red[900],f.red[700],f.red[500],f.red[300],f.red[100]],[f.pink[900],f.pink[700],f.pink[500],f.pink[300],f.pink[100]],[f.purple[900],f.purple[700],f.purple[500],f.purple[300],f.purple[100]],[f.deepPurple[900],f.deepPurple[700],f.deepPurple[500],f.deepPurple[300],f.deepPurple[100]],[f.indigo[900],f.indigo[700],f.indigo[500],f.indigo[300],f.indigo[100]],[f.blue[900],f.blue[700],f.blue[500],f.blue[300],f.blue[100]],[f.lightBlue[900],f.lightBlue[700],f.lightBlue[500],f.lightBlue[300],f.lightBlue[100]],[f.cyan[900],f.cyan[700],f.cyan[500],f.cyan[300],f.cyan[100]],[f.teal[900],f.teal[700],f.teal[500],f.teal[300],f.teal[100]],["#194D33",f.green[700],f.green[500],f.green[300],f.green[100]],[f.lightGreen[900],f.lightGreen[700],f.lightGreen[500],f.lightGreen[300],f.lightGreen[100]],[f.lime[900],f.lime[700],f.lime[500],f.lime[300],f.lime[100]],[f.yellow[900],f.yellow[700],f.yellow[500],f.yellow[300],f.yellow[100]],[f.amber[900],f.amber[700],f.amber[500],f.amber[300],f.amber[100]],[f.orange[900],f.orange[700],f.orange[500],f.orange[300],f.orange[100]],[f.deepOrange[900],f.deepOrange[700],f.deepOrange[500],f.deepOrange[300],f.deepOrange[100]],[f.brown[900],f.brown[700],f.brown[500],f.brown[300],f.brown[100]],[f.blueGrey[900],f.blueGrey[700],f.blueGrey[500],f.blueGrey[300],f.blueGrey[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]]},t.default=(0,p.ColorWrap)(y)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SwatchesGroup=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(9),u=n(l),c=r(281),h=n(c),d=t.SwatchesGroup=function(e){var t=e.onClick,r=e.onSwatchHover,n=e.group,i=e.active,a=(0,s.default)({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return o.default.createElement("div",{style:a.group},(0,u.default)(n,function(e,a){return o.default.createElement(h.default,{key:e,color:e,active:e.toLowerCase()===i,first:0===a,last:a===n.length-1,onClick:t,onSwatchHover:r})}))};t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SwatchesColor=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(2),u=t.SwatchesColor=function(e){var t=e.color,r=e.onClick,n=void 0===r?function(){}:r,i=e.onSwatchHover,a=e.first,u=e.last,c=e.active,h=(0,s.default)({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:t,marginBottom:"1px"},check:{fill:"#fff",marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{fill:"#333"}},transparent:{check:{fill:"#333"}}},{first:a,last:u,active:c,"color-#FFFFFF":"#FFFFFF"===t,transparent:"transparent"===t});return o.default.createElement(l.Swatch,{color:t,style:h.color,onClick:n,onHover:i,focusStyle:{boxShadow:"0 0 4px "+t}},o.default.createElement("div",{style:h.check},o.default.createElement("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},o.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))))};t.default=u},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Twitter=void 0;var i=r(0),o=n(i),a=r(1),s=n(a),l=r(9),u=n(l),c=r(8),h=n(c),d=r(2),f=t.Twitter=function(e){var t=e.onChange,r=e.onSwatchHover,n=e.hex,i=e.colors,a=e.width,l=e.triangle,c=(0,s.default)({default:{card:{width:a,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},{"hide-triangle":"hide"===l,"top-left-triangle":"top-left"===l,"top-right-triangle":"top-right"===l}),f=function(e,r){h.default.isValidHex(e)&&t({hex:e,source:"hex"},r)};return o.default.createElement("div",{style:c.card,className:"twitter-picker"},o.default.createElement("div",{style:c.triangleShadow}),o.default.createElement("div",{style:c.triangle}),o.default.createElement("div",{style:c.body},(0,u.default)(i,function(e,t){return o.default.createElement(d.Swatch,{key:t,color:e,hex:e,style:c.swatch,onClick:f,onHover:r,focusStyle:{boxShadow:"0 0 4px "+e}})}),o.default.createElement("div",{style:c.hash},"#"),o.default.createElement(d.EditableInput,{style:{input:c.input},value:n.replace("#",""),onChange:f}),o.default.createElement("div",{style:c.clear})))};f.defaultProps={width:"276px",colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left"},t.default=(0,d.ColorWrap)(f)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function(e,t,r){for(var n=!0;n;){var i=e,o=t,a=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,r=a,n=!0,s=u=void 0}},h=r(0),d=r(52),f=n(h),p=r(16),m=n(p),v=r(284),g=n(v),y=r(54),b=n(y),_=function(e){function t(){o(this,t),c(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments),this.state={hover:!1,transition:"opacity",width:0,height:0},this.margin=15,this.defaultArrowStyle={color:"#fff",borderColor:"rgba(0,0,0,.4)"}}return a(t,e),u(t,[{key:"getStyle",value:function(e,t){var r=this.props.parentEl,n=r.getBoundingClientRect(),i=(window.scrollY||window.pageYOffset)+n.top,o=(window.scrollX||window.pageXOffset)+n.left,a={};switch(e){case"left":if(a.top=i+r.offsetHeight/2-this.state.height/2,a.left=o-this.state.width-this.margin,t)switch(t){case"top":a.top=i+r.offsetHeight/2-this.margin,a.left=o-this.state.width-this.margin;break;case"bottom":a.top=i+r.offsetHeight/2-this.state.height+this.margin,a.left=o-this.state.width-this.margin}break;case"right":if(a.top=i+r.offsetHeight/2-this.state.height/2,a.left=o+r.offsetWidth+this.margin,t)switch(t){case"top":a.top=i+r.offsetHeight/2-this.margin,a.left=o+r.offsetWidth+this.margin;break;case"bottom":a.top=i+r.offsetHeight/2-this.state.height+this.margin,a.left=o+r.offsetWidth+this.margin}break;case"top":if(a.left=o-this.state.width/2+r.offsetWidth/2,a.top=i-this.state.height-this.margin,t)switch(t){case"right":a.left=o-this.state.width+r.offsetWidth/2+this.margin,a.top=i-this.state.height-this.margin;break;case"left":a.left=o+r.offsetWidth/2-this.margin,a.top=i-this.state.height-this.margin}break;case"bottom":if(a.left=o-this.state.width/2+r.offsetWidth/2,a.top=i+r.offsetHeight+this.margin,t)switch(t){case"right":a.left=o-this.state.width+r.offsetWidth/2+this.margin,a.top=i+r.offsetHeight+this.margin;break;case"left":a.left=o+r.offsetWidth/2-this.margin,a.top=i+r.offsetHeight+this.margin}}return a}},{key:"checkWindowPosition",value:function(e,t){if("top"===this.props.position||"bottom"===this.props.position)if(e.left<0){var r=e.left;e.left=this.margin,t.fgStyle.marginLeft+=r,t.bgStyle.marginLeft+=r,"right"===this.props.arrow?(t.fgStyle.marginRight=-(r-this.margin+10),t.bgStyle.marginRight=-(r-this.margin+10)):(t.fgStyle.marginLeft+=r-this.margin,t.bgStyle.marginLeft+=r-this.margin)}else{var n=e.left+this.state.width-window.innerWidth;if(n>0){var i=e.left;e.left=window.innerWidth-this.state.width-this.margin,t.fgStyle.marginLeft+=i-e.left,t.bgStyle.marginLeft+=i-e.left}}return{style:e,arrowStyle:t}}},{key:"mergeStyle",value:function(e,t){if(t){var r=(t.position,t.top,t.left,t.right,t.bottom,t.marginLeft,t.marginRight,i(t,["position","top","left","right","bottom","marginLeft","marginRight"]));return(0,b.default)(e,r)}return e}},{key:"handleMouseEnter",value:function(){this.props.active&&this.setState({hover:!0})}},{key:"handleMouseLeave",value:function(){this.setState({hover:!1})}},{key:"componentDidMount",value:function(){this.updateSize()}},{key:"componentWillReceiveProps",value:function(){this.updateSize(),this.setState({transition:this.state.hover||this.props.active?"all":"opacity"})}},{key:"updateSize",value:function(){var e=m.default.findDOMNode(this);this.setState({width:e.offsetWidth,height:e.offsetHeight})}},{key:"render",value:function(){var e=this.checkWindowPosition(this.style,this.arrowStyle),t=e.style,r=e.arrowStyle;return f.default.createElement("div",{style:t,onMouseEnter:this.handleMouseEnter.bind(this),onMouseLeave:this.handleMouseLeave.bind(this)},this.props.arrow?f.default.createElement("div",null,f.default.createElement("span",{style:r.fgStyle}),f.default.createElement("span",{style:r.bgStyle})):null,this.props.children)}},{key:"style",get:function(){if(!this.props.parentEl)return{display:"none"};var e={position:"absolute",padding:"5px",background:"#fff",boxShadow:"0 0 8px rgba(0,0,0,.3)",borderRadius:"3px",transition:this.state.transition+" .3s ease-in-out, visibility .3s ease-in-out",opacity:this.state.hover||this.props.active?1:0,visibility:this.state.hover||this.props.active?"visible":"hidden",zIndex:50};return(0,b.default)(e,this.getStyle(this.props.position,this.props.arrow)),this.mergeStyle(e,this.props.style.style)}},{key:"baseArrowStyle",get:function(){return{position:"absolute",content:'""',transition:"all .3s ease-in-out"}}},{key:"arrowStyle",get:function(){var e=this.baseArrowStyle,t=this.baseArrowStyle;e.zIndex=60,t.zIndex=55;var r=(0,b.default)(this.defaultArrowStyle,this.props.style.arrowStyle),n=r.borderColor?r.borderColor:"transparent",o="10px solid "+r.color,a="8px solid transparent",s="11px solid "+n,l="9px solid transparent",u=this.props,c=u.position,h=u.arrow;"left"===c||"right"===c?(e.top="50%",e.borderTop=a,e.borderBottom=a,e.marginTop=-7,t.borderTop=l,t.borderBottom=l,t.top="50%",t.marginTop=-8,"left"===c?(e.right=-10,e.borderLeft=o,t.right=-11,t.borderLeft=s):(e.left=-10,e.borderRight=o,t.left=-11,t.borderRight=s),"top"===h&&(e.top=this.margin,t.top=this.margin),"bottom"===h&&(e.top=null,e.bottom=this.margin+1,t.top=null,t.bottom=this.margin)):(e.left="50%",e.marginLeft=-10,e.borderLeft=a,e.borderRight=a,t.left="50%",t.marginLeft=-11,t.borderLeft=l,t.borderRight=l,"top"===c?(e.bottom=-10,e.borderTop=o,t.bottom=-11,t.borderTop=s):(e.top=-10,e.borderBottom=o,t.top=-11,t.borderBottom=s),"right"===h&&(e.left=null,e.right=this.margin+1,e.marginLeft=0,t.left=null,t.right=this.margin,t.marginLeft=0),"left"===h&&(e.left=this.margin+1,e.marginLeft=0,t.left=this.margin,t.marginLeft=0));var d=this.props.style.arrowStyle,f=(d.color,d.borderColor,i(d,["color","borderColor"]));return{fgStyle:this.mergeStyle(e,f),bgStyle:this.mergeStyle(t,f)}}}],[{key:"PropTypes",value:{active:d.PropTypes.bool,position:d.PropTypes.oneOf(["top","right","bottom","left"]),arrow:d.PropTypes.oneOf([null,"center","top","right","bottom","left"]),style:d.PropTypes.object},enumerable:!0},{key:"defaultProps",value:{active:!1,position:"right",arrow:null,style:{style:{},arrowStyle:{}}},enumerable:!0}]),t}(f.default.Component),w={},x=function(e){function t(){o(this,t),c(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),u(t,[{key:"componentDidMount",value:function(){this.props.active&&(0,g.default)()&&this.renderPortal(this.props)}},{key:"componentWillReceiveProps",value:function(e){var t=this;if((w[this.props.group]||e.active)&&(this.props.active||e.active)){var r=(0,b.default)({},e),n=(0,b.default)({},e);w[this.props.group]&&w[this.props.group].timeout&&clearTimeout(w[this.props.group].timeout),this.props.active&&!r.active&&(n.active=!0,w[this.props.group].timeout=setTimeout(function(){r.active=!1,t.renderPortal(r)},100)),this.renderPortal(n)}}},{key:"componentWillUnmount",value:function(){w[this.props.group]&&m.default.unmountComponentAtNode(w[this.props.group].node)}},{key:"createPortal",value:function(){w[this.props.group]={node:document.createElement("div"),timeout:!1},w[this.props.group].node.className="ToolTipPortal",document.body.appendChild(w[this.props.group].node)}},{key:"renderPortal",value:function(e){w[this.props.group]||this.createPortal();var t=e.parent,r=i(e,["parent"]),n=t;(0,p.unstable_renderSubtreeIntoContainer)(this,f.default.createElement(_,l({parentEl:n},r)),w[this.props.group].node)}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return null}}],[{key:"defaultProps",value:{active:!1,group:"main"},enumerable:!0},{key:"propTypes",value:{active:d.PropTypes.bool,group:d.PropTypes.string},enumerable:!0}]),t}(f.default.Component);t.default=x,e.exports=t.default},function(e,t){function r(){return"undefined"!=typeof window}e.exports=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(11),h=n(c),d=r(17),f=n(d),p=r(18),m=(n(p),r(6)),v=n(m),g={wrapper:{fontFamily:"Open Sans, sans-serif",fontSize:"1.5rem",height:"100%",zIndex:20},container:{padding:"0 0 0 0",width:"100%",height:"100%"},form:{width:"90%",padding:"10px 0 30px 0",margin:"0 auto",color:"white",letterSpacing:"1px"},floatRight:{float:"right"},floatLeft:{float:"left"},label:{width:"100%"},input:{width:"100%",fontSize:"12px",backgroundColor:"#2a2b2d",border:"none",borderRadius:"3px",height:"25px"},tabs:{width:"100%",margin:"none",padding:"0 0 0 0",height:"40px",borderBottomStyle:"solid",borderBottomColor:"black"}},y=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleNew=r.handleNew.bind(r),r.handleFinish=r.handleFinish.bind(r),r.handlePolygonName=r.handlePolygonName.bind(r),r.handlePolygonTop=r.handlePolygonTop.bind(r),r.handlePolygonBottom=r.handlePolygonBottom.bind(r),r.handlePolygonOpacity=r.handlePolygonOpacity.bind(r),r.handlePolygonColor=r.handlePolygonColor.bind(r),r.handlePolyLineName=r.handlePolyLineName.bind(r),r.handlePolyLineLineWidth=r.handlePolyLineLineWidth.bind(r),r.handlePolyLineColor=r.handlePolyLineColor.bind(r),r.tabDescription=[{kind:"PolyLine Marker",icon:"fa fa-map-o"},{kind:"Polygon Marker",icon:"fa fa-cube"}],r.state={mode:0,polygonName:"",polygonTop:40,polygonBottom:0,polygonOpacity:.1,polygonColor:"#F18100",polyLineName:"",polyLineLineWidth:1,polyLineColor:"#FFFFFF"},r.props.service.panelState=r.state,r}return a(t,e),s(t,[{key:"handleNew",value:function(e){if(e.preventDefault(),this.props.service){var t=null;0===this.state.mode?t={drawObjectType:"PolyLineMarker"}:1===this.state.mode&&(t={drawObjectType:"PolygonMarker"}),this.props.service.setDrawObjectState(t)}else console.warn("[DrawPanel] service not defined")}},{key:"handleFinish",value:function(e){e.preventDefault(),this.props.service?this.props.service.finishCurrentDrawing():console.warn("[DrawPanel] service not defined")}},{key:"handlePolygonName",value:function(e){this.setState({polygonName:e.target.value}),this.props.service.updateState("PolygonMarker",{polygonName:e.target.value})}},{key:"handlePolygonTop",value:function(e){e>this.state.polygonBottom?(this.setState({polygonTop:e}),this.props.service.updateState("PolygonMarker",{polygonTop:e})):this.forceUpdate()}},{key:"handlePolygonBottom",value:function(e){e<this.state.polygonTop?(this.setState({polygonBottom:e}),this.props.service.updateState("PolygonMarker",{polygonBottom:e})):this.forceUpdate()}},{key:"handlePolygonOpacity",value:function(e){this.setState({polygonOpacity:e}),this.props.service.updateState("PolygonMarker",{polygonOpacity:e})}},{key:"handlePolygonColor",value:function(e){this.setState({polygonColor:e.hex}),this.props.service.updateState("PolygonMarker",{polygonColor:e.hex})}},{key:"handlePolyLineName",value:function(e){this.setState({polyLineName:e.target.value}),this.props.service.updateState("PolyLineMarker",{polyLineName:e.target.value})}},{key:"handlePolyLineLineWidth",value:function(e){this.setState({polyLineLineWidth:e}),this.props.service.updateState("PolyLineMarker",{polyLineLineWidth:e})}},{key:"handlePolyLineColor",value:function(e){this.setState({polyLineColor:e.hex}),this.props.service.updateState("PolyLineMarker",{polyLineColor:e.hex})}},{key:"render",value:function(){var e=this,t=u.default.createElement("div",{className:"row",style:{margin:"auto"}},u.default.createElement("div",{className:"col-sm-6"},u.default.createElement("input",{type:"submit",value:"NEW",className:"btn btn-success",style:g.floatLeft,onClick:this.handleNew})),u.default.createElement("div",{className:"col-sm-6"},u.default.createElement("input",{type:"submit",value:"FINISH",className:"btn btn-success",style:g.floatRight,onClick:this.handleFinish}))),r=u.default.createElement("div",null,t,u.default.createElement("br",null),u.default.createElement("label",{style:g.label},"Polygon Marker Name:",u.default.createElement("br",null),u.default.createElement("input",{key:7,style:g.input,type:"text",ref:"polygonName",defaultValue:this.state.polygonName,onInput:this.handlePolygonName,onClick:function(){e.refs.polygonName.focus()}})),u.default.createElement("div",null,"Top:",u.default.createElement(v.default,{min:"0",max:"100",step:"1",defaultValue:this.state.polygonTop,handler:this.handlePolygonTop})),u.default.createElement("div",null,"Bottom:",u.default.createElement(v.default,{min:"0",max:"100",step:"1",defaultValue:this.state.polygonBottom,handler:this.handlePolygonBottom})),u.default.createElement("div",null,"Opacity:",u.default.createElement(v.default,{min:"0",max:"1",step:"0.05",defaultValue:this.state.polygonOpacity,handler:this.handlePolygonOpacity})),u.default.createElement("div",null,"Color:",u.default.createElement(h.default,{value:this.state.polygonColor,onChangeColor:this.handlePolygonColor,textures:[]}))),n=u.default.createElement("div",null,t,u.default.createElement("br",null),u.default.createElement("label",{style:g.label},"PolyLine Marker Name:",u.default.createElement("br",null),u.default.createElement("input",{key:8,style:g.input,type:"text",ref:"polyLineName",defaultValue:this.state.polyLineName,onInput:this.handlePolyLineName,onClick:function(){e.refs.polyLineName.focus()}})),u.default.createElement("div",null,"Line Width:",u.default.createElement(v.default,{min:"1",max:"100",step:"1",defaultValue:this.state.polyLineLineWidth,handler:this.handlePolyLineLineWidth})),u.default.createElement("div",null,"Color:",u.default.createElement(h.default,{value:this.state.polyLineColor,onChangeColor:this.handlePolyLineColor,textures:[]}))),i=void 0;0===this.state.mode?i=n:1===this.state.mode&&(i=r);var o=this.tabDescription.map(function(t,r){var n=e.state.mode===r;return u.default.createElement(f.default,{key:r,index:r,kind:t.kind,icon:t.icon,selectTool:function(t){e.setState({mode:t})},selected:n,tooltipPlace:"bottom"})});return u.default.createElement("div",{className:"draw-panel",style:g.wrapper},u.default.createElement("div",{className:"container",style:g.container},u.default.createElement("div",{className:"tabs",style:g.tabs},o),u.default.createElement("div",{className:"draw-form",style:g.form},i)))}}]),t}(u.default.Component);t.default=y},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(17),h=n(c),d=r(287),f=n(d),p=r(15),m=n(p),v=r(6),g=(n(v),r(11)),y=(n(g),r(18)),b=n(y),_=r(288),w=n(_),x=r(289),M=n(x),E={panel:{fontFamily:"Open Sans, sans-serif",fontSize:"0.75rem"},panelDisable:{pointerEvents:"none",backgroundColor:"#111"},tabs:{width:"100%",margin:"none",padding:"0 0 0 0",height:"40px",borderBottomStyle:"solid",borderBottomColor:"black"},panelContainer:{padding:"0 0 0 0",width:"100%"},board:{width:"100%",margin:"none",padding:"0 0 0 0",overflowX:"hidden",overflowY:"scroll",height:"460px",borderRadius:"0 0 3px 3px"},infoChunk:{userSelect:"none",display:"table",width:"100%",verticalAlign:"top",backgroundColor:"#666666",borderRadius:"3px",boxShadow:"0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22)",borderTop:"1px solid black",borderBottom:"1px solid black",padding:"5px 5px"},selector:{width:"100%",color:"#fff",backgroundColor:"#2a2b2d",border:"1px solid #000",fontSize:"14px"}},A=function(e){function t(e){i(this,t),console.log("construct shader panel with props",e);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.selectTabHandler=r.selectTabHandler.bind(r),r.selectBtnHandler=r.selectBtnHandler.bind(r),r.selectMaterialHandler=r.selectMaterialHandler.bind(r),r.tabDescription=[{kind:"SCENE",icon:"fa fa-cog"},{kind:"MATERIAL",icon:"fa fa-picture-o"}],r.rendererType=["Phong","PBR","Matcap"],r.state={selectedTab:1,selectedTabKind:r.tabDescription[1].kind,activeRendererIndex:0,activeRenderer:r.rendererType[0],currentMaterialIndex:0,hasTarget:!1,targetID:null,setMaterialModeOn:!1},r.props.service.refresh=function(){r.props.service.target&&(r.materials=r.props.service.target?r.props.service.target.getMaterials():[],r.setState({selectedTab:1,selectedTabKind:r.tabDescription[1].kind,activeRendererIndex:0,activeRenderer:r.rendererType[0],currentMaterialIndex:0,hasTarget:!0,targetID:r.props.service.target.ID,setMaterialModeOn:!1}))},r}return a(t,e),s(t,[{key:"selectTabHandler",value:function(e){this.setState({selectedTab:e,selectedTabKind:this.tabDescription[e].kind})}},{key:"selectBtnHandler",value:function(e){var t="mtlphongshadermaterial";switch(e){case 0:t="mtlphongshadermaterial";break;case 1:t="mtlpbrshadermaterial";break;case 2:t="mtlmatcapshadermaterial"}var r=this.materials[this.state.currentMaterialIndex];t!==(r&&r.description?r.description.type.toLowerCase():"unsupported type")&&(this.props.earth.materialManager.setObjectMaterial(this.props.service.target,t,this.props.service.target.getMtlParams()),this.materials=this.props.service.target?this.props.service.target.getMaterials():[]),this.setState({activeRendererIndex:e,activeRenderer:this.rendererType[e]})}},{key:"selectMaterialHandler",value:function(e){e.target.value>=0&&e.target.value<this.materials.length&&this.setState({currentMaterialIndex:e.target.value})}},{key:"render",value:function(){var e=this;if(!this.state.hasTarget)return u.default.createElement("div",null,u.default.createElement("span",{style:E.infoChunk},"Please select a marker"));var t=this.tabDescription.map(function(t,r){var n=e.state.selectedTab===r;return u.default.createElement(h.default,{key:r,index:r,kind:t.kind,icon:t.icon,selectTool:e.selectTabHandler,selected:n,tooltipPlace:"bottom"})}),r="Unsupported Material Type For Shader Panel",n=this.materials[this.state.currentMaterialIndex],i=void 0;i=n&&n.description?n.description.type.toLowerCase():r;var o=this.materials.map(function(e,t){return u.default.createElement("option",{key:t,value:t},e.name)}),a=u.default.createElement("div",null,u.default.createElement("div",{className:"my-select"},u.default.createElement("select",{style:E.selector,key:this.state.currentMaterialIndex,value:this.state.currentMaterialIndex,onChange:this.selectMaterialHandler},o)),u.default.createElement("div",null,u.default.createElement("span",{style:E.infoChunk},"Current Material Type: "),u.default.createElement("span",{style:E.infoChunk},i))),s=this.state.targetID?this.state.targetID:"NONE",l=u.default.createElement("div",null,u.default.createElement("div",null,u.default.createElement("span",{style:E.infoChunk},"marker ID: "),u.default.createElement("span",{style:E.infoChunk},s)),u.default.createElement(m.default,{heading:"Change Material",info:"Change Basic Shading Effects",hasButton:!0,buttonON:this.state.setMaterialModeOn,collapsed:!this.state.setMaterialModeOn,onToggle:function(t){e.setState({setMaterialModeOn:t})}},u.default.createElement(b.default,{buttons:this.rendererType,activeIndex:this.state.activeRendererIndex,click:this.selectBtnHandler}))),c=void 0;switch(this.state.selectedTabKind){case"SCENE":c=l;break;case"MATERIAL":switch(i){case"mtlphongshadermaterial":c=u.default.createElement(f.default,{service:this.props.service,material:n});break;case"mtlpbrshadermaterial":c=u.default.createElement(w.default,{service:this.props.service,material:n});break;case"mtlmatcapshadermaterial":c=u.default.createElement(M.default,{service:this.props.service,material:n})}c=u.default.createElement("div",null,a,c)}return u.default.createElement("div",{className:"shader-panel",style:E.panel},u.default.createElement("div",{className:"container",style:E.panelContainer},u.default.createElement("div",{className:"tabs",style:E.tabs},t),u.default.createElement("div",{className:"board scrollbar",style:E.board},c)))}}]),t}(u.default.Component);t.default=A},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(15),h=n(c),d=r(6),f=n(d),p=r(11),m=n(p),v={board:{width:"100%",margin:"none",padding:"0 0 0 0",overflowX:"hidden",overflowY:"scroll",height:"460px",borderRadius:"0 0 3px 3px"},sliderContainer:{padding:"0 0 0 0",textAlign:"center",height:"35px"}},g=function(e){function t(e){i(this,t),console.log("construct phong shader panel");var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.setAmbientColor=r.setAmbientColor.bind(r),r.setAmbientTexture=r.setAmbientTexture.bind(r),r.setAmbientPercentage=r.setAmbientPercentage.bind(r),r.setDiffuseState=r.setDiffuseState.bind(r),r.setDiffuseColor=r.setDiffuseColor.bind(r),r.setDiffuseTexture=r.setDiffuseTexture.bind(r),r.setDiffusePercentage=r.setDiffusePercentage.bind(r),r.setSpecularState=r.setSpecularState.bind(r),r.setSpecularColor=r.setSpecularColor.bind(r),r.setSpecularTexture=r.setSpecularTexture.bind(r),r.setSpecularPercentage=r.setSpecularPercentage.bind(r),r.setSpecularShininess=r.setSpecularShininess.bind(r),r.state=r._getStateParams(e),r}return a(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){this.setState(this._getStateParams(e))}},{key:"_getStateParams",value:function(e){var t=e.material,r=t.getAmbient(),n=t.getDiffuse(),i=t.getSpecular(),o=[];r.texturePath&&o.push({name:r.texturePath,path:r.texturePath}),n.texturePath&&o.push({name:n.texturePath,path:n.texturePath}),i.texturePath&&o.push({name:i.texturePath,path:i.texturePath});var a={material:t,ambientColor:r.color,ambientTextureUsed:r.textureUsed,ambientTexturePath:r.texturePath,ambientPercentage:r.percentage,diffuseState:1===n.state,diffuseColor:n.color,diffuseTextureUsed:n.textureUsed,diffuseTexturePath:n.texturePath,diffusePercentage:n.percentage,specularState:1===i.state,specularColor:i.color,specularTextureUsed:i.textureUsed,specularTexturePath:i.texturePath,specularPercentage:i.percentage,specularShininess:i.shininess,textures:o};return console.log("[phongshaderpanel] state",a),a}},{key:"setAmbientColor",value:function(e){var t=e.rgb,r=[];r.push(t.r/255),r.push(t.g/255),r.push(t.b/255),this.state.material.setAmbientColor(r),this.setState({ambientColor:e.hex})}},{key:"setAmbientTexture",value:function(e){this.state.material.setAmbientTexture(e),this.setState({ambientTexturePath:e})}},{key:"setAmbientPercentage",value:function(e){this.state.material.setAmbientPercentage(e),this.setState({ambientPercentage:e})}},{key:"setDiffuseState",value:function(e){var t=e?1:0;this.state.material.setDiffuseState(t),this.setState({diffuseState:e})}},{key:"setDiffuseColor",value:function(e){var t=e.rgb,r=[];r.push(t.r/255),r.push(t.g/255),r.push(t.b/255),this.state.material.setDiffuseColor(r),this.setState({diffuseColor:e.hex})}},{key:"setDiffuseTexture",value:function(e){this.state.material.setDiffuseTexture(e),this.setState({diffuseTexturePath:e})}},{key:"setDiffusePercentage",value:function(e){this.state.material.setDiffusePercentage(e),this.setState({diffusePercentage:e})}},{key:"setSpecularState",value:function(e){var t=e?1:0;this.state.material.setSpecularState(t),this.setState({specularState:e})}},{key:"setSpecularColor",value:function(e){var t=e.rgb,r=[];r.push(t.r/255),r.push(t.g/255),r.push(t.b/255),this.state.material.setSpecularColor(r),this.setState({specularColor:e.hex})}},{key:"setSpecularTexture",value:function(e){this.state.material.setSpecularTexture(e),this.setState({specularTexturePath:e})}},{key:"setSpecularPercentage",value:function(e){this.state.material.setSpecularPercentage(e),this.setState({specularPercentage:e})}},{key:"setSpecularShininess",value:function(e){this.state.material.setSpecularShininess(e),this.setState({specularShininess:e})}},{key:"render",value:function(){return u.default.createElement("div",null,u.default.createElement(h.default,{heading:"Ambient",info:"Phong material ambient color"},u.default.createElement("div",{className:"row",style:{width:"90%",margin:"5px auto"}},u.default.createElement("div",{className:"col-sm-1",style:v.sliderContainer},u.default.createElement(m.default,{value:this.state.ambientColor||"#00aa00",textures:this.state.textures,texturePath:this.state.ambientTexturePath,onChangeColor:this.setAmbientColor,onTexture:this.setAmbientTexture})),u.default.createElement("div",{className:"col-sm-11",style:v.sliderContainer},u.default.createElement(f.default,{min:"0",max:"100.0",step:"1",defaultValue:this.state.ambientPercentage,handler:this.setAmbientPercentage})))),u.default.createElement(h.default,{heading:"Diffuse",info:"Phong material diffuse color",hasButton:!0,buttonON:this.state.diffuseState,onToggle:this.setDiffuseState},u.default.createElement("div",{className:"row",style:{width:"90%",margin:"5px auto"}},u.default.createElement("div",{className:"col-sm-1",style:v.sliderContainer},u.default.createElement(m.default,{value:this.state.diffuseColor||"#00aa00",textures:this.state.textures,texturePath:this.state.diffuseTexturePath,onTexture:this.setDiffuseTexture,onChangeColor:this.setDiffuseColor})),u.default.createElement("div",{className:"col-sm-11",style:v.sliderContainer},u.default.createElement(f.default,{min:"0",max:"100.0",step:"1",defaultValue:this.state.diffusePercentage,handler:this.setDiffusePercentage})))),u.default.createElement(h.default,{heading:"Specular",info:"Phong material specular color",hasButton:!0,buttonON:this.state.specularState,onToggle:this.setSpecularState},u.default.createElement("div",{className:"row",style:{width:"90%",margin:"5px auto"}},u.default.createElement("div",{className:"col-sm-1",style:v.sliderContainer},u.default.createElement(m.default,{value:this.state.specularColor,textures:this.state.textures,texturePath:this.state.specularTexturePath,onChangeColor:this.setSpecularColor,onTexture:this.setSpecularTexture})),u.default.createElement("div",{className:"col-sm-11",style:v.sliderContainer},u.default.createElement(f.default,{min:"0",max:"100.0",step:"1",defaultValue:this.state.specularPercentage,handler:this.setSpecularPercentage}))),u.default.createElement("div",{className:"row",style:{width:"90%",margin:"5px auto"}},u.default.createElement("span",{style:{fontSize:"15px"}},"Shininess"),u.default.createElement(f.default,{min:"0",max:"100",step:"1",defaultValue:this.state.specularShininess,handler:this.setSpecularShininess}))))}}]),t}(u.default.Component);t.default=g},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(15),h=n(c),d=r(6),f=n(d),p=r(11),m=n(p),v={board:{width:"100%",margin:"none",padding:"0 0 0 0",overflowX:"hidden",overflowY:"scroll",height:"460px",borderRadius:"0 0 3px 3px"},sliderContainer:{padding:"0 0 0 0",textAlign:"center",height:"35px"}},g=function(e){function t(e){i(this,t),console.log("construct pbr shader panel");var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.setMetallic=r.setMetallic.bind(r),r.setRoughness=r.setRoughness.bind(r),r.setSpecularF0=r.setSpecularF0.bind(r),r.setBaseColorPercentage=r.setBaseColorPercentage.bind(r),r.setBaseColor=r.setBaseColor.bind(r),r.setBaseColorTexture=r.setBaseColorTexture.bind(r),r.state=r._getStateParams(e),r}return a(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){this.setState(this._getStateParams(e))}},{key:"_getStateParams",value:function(e){var t=e.material,r=t.getBaseColor(),n=[];return r.texturePath&&n.push({name:r.texturePath,path:r.texturePath}),{material:t,metallic:t.getMetallic().value,roughness:t.getRoughness().value,f0:t.getSpecularF0().value[0],baseColor:r.color,baseColorTextureUsed:r.textureUsed,baseColorTexturePath:r.texturePath,baseColorPercentage:r.percentage,textures:n}}},{key:"setMetallic",value:function(e){this.state.material.setMetallic(e),this.setState({metallic:e})}},{key:"setRoughness",value:function(e){this.state.material.setRoughness(e),this.setState({roughness:e})}},{key:"setSpecularF0",value:function(e){var t=[e,e,e];this.state.material.setSpecularF0(t),this.setState({f0:e})}},{key:"setBaseColor",value:function(e){var t=e.rgb,r=[];r.push(t.r/255),r.push(t.g/255),r.push(t.b/255),this.state.material.setBaseColor(r),this.setState({baseColor:e.hex})}},{key:"setBaseColorTexture",value:function(e){this.state.material.setBaseColorTexture(e),this.setState({baseColorTexturePath:e})}},{key:"setBaseColorPercentage",value:function(e){this.state.material.setBaseColorPercentage(e),this.setState({baseColorPercentage:e})}},{key:"render",value:function(){return u.default.createElement("div",null,u.default.createElement(h.default,{heading:"Base Color",info:"PBR material base color value"},u.default.createElement("div",{className:"row",style:{width:"90%",margin:"5px auto"}},u.default.createElement("div",{className:"col-sm-1",style:v.sliderContainer},u.default.createElement(m.default,{value:this.state.baseColor,textures:this.state.textures,texturePath:this.state.baseColorTexturePath,onChangeColor:this.setBaseColor,onTexture:this.setBaseColorTexture})),u.default.createElement("div",{className:"col-sm-11",style:v.sliderContainer},u.default.createElement(f.default,{min:"0",max:"100.0",step:"1.0",defaultValue:this.state.baseColorPercentage,handler:this.setBaseColorPercentage})))),u.default.createElement(h.default,{heading:"Metallic",info:"PBR material metallic value"},u.default.createElement("div",{className:"row",style:{width:"90%",margin:"5px auto"}},u.default.createElement(f.default,{min:"0",max:"1.0",step:"0.01",defaultValue:this.state.metallic,handler:this.setMetallic}))),u.default.createElement(h.default,{heading:"Roughness",info:"PBR material roughness value"},u.default.createElement("div",{className:"row",style:{width:"90%",margin:"5px auto"}},u.default.createElement(f.default,{min:"0",max:"1.0",step:"0.01",defaultValue:this.state.roughness,handler:this.setRoughness}))),u.default.createElement(h.default,{heading:"Specular F0",info:"PBR material specular f0 value"},u.default.createElement("div",{className:"row",style:{width:"90%",margin:"5px auto"}},u.default.createElement(f.default,{min:"0",max:"1.0",step:"0.01",defaultValue:this.state.f0,handler:this.setSpecularF0}))))}}]),t}(u.default.Component);t.default=g},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(15),h=n(c),d=r(6),f=(n(d),r(11)),p=n(f),m={board:{width:"100%",margin:"none",padding:"0 0 0 0",overflowX:"hidden",overflowY:"scroll",height:"460px",borderRadius:"0 0 3px 3px"},sliderContainer:{padding:"0 0 0 0",textAlign:"center",height:"35px"}},v=function(e){function t(e){i(this,t),console.log("construct matcap shader panel");var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.setMatcapTextureTest=r.setMatcapTextureTest.bind(r),r.setMatcapTextureFractionTest=r.setMatcapTextureFractionTest.bind(r),r.state=r._getStateParams(e),r}return a(t,e),s(t,[{key:"_getStateParams",value:function(e){var t=e.material,r=[],n=t.getMatcapTexturePath().value;return n&&r.push({name:n,path:n}),{material:t,matcapTexturePath:n,fraction:t.getFraction().value,textures:r}}},{key:"componentWillReceiveProps",value:function(e){this.setState(this._getStateParams(e))}},{key:"setMatcapTextureTest",value:function(e){this.state.material.loadMatcapTexture(e),this.setState({matcapTexturePath:e})}},{key:"setMatcapTextureFractionTest",value:function(e){var t=e.rgb,r=[];r.push(t.r/255),r.push(t.g/255),r.push(t.b/255),this.state.material.setMatcapTextureFraction(r),this.setState({fraction:e.hex})}},{key:"render",value:function(){return u.default.createElement("div",null,u.default.createElement(h.default,{heading:"Matcap Texture",info:"matcap material texture"},u.default.createElement("div",{className:"row",style:{width:"90%",margin:"5px auto"}},u.default.createElement("div",{className:"col-sm-1",style:m.sliderContainer},u.default.createElement(p.default,{value:this.state.fraction,textures:[{name:"matcap-1.jpg",path:"https://bytebucket.org/sgaoae/altizure-shader-dev/raw/b2eda53a34b424951320ec209f097a5bb02685c9/examples/images/matcap-1.jpg"},{name:"matcap-2.jpg",path:"https://bytebucket.org/sgaoae/altizure-shader-dev/raw/b2eda53a34b424951320ec209f097a5bb02685c9/examples/images/matcap-2.jpg"},{name:"matcap-3.jpg",path:"https://bytebucket.org/sgaoae/altizure-shader-dev/raw/b2eda53a34b424951320ec209f097a5bb02685c9/examples/images/matcap-3.jpg"},{name:"matcap-4.jpg",path:"https://bytebucket.org/sgaoae/altizure-shader-dev/raw/b2eda53a34b424951320ec209f097a5bb02685c9/examples/images/matcap-4.jpg"},{name:"matcap-5.jpg",path:"https://bytebucket.org/sgaoae/altizure-shader-dev/raw/b2eda53a34b424951320ec209f097a5bb02685c9/examples/images/matcap-5.jpg"},{name:"matcap-6.jpg",path:"https://bytebucket.org/sgaoae/altizure-shader-dev/raw/b2eda53a34b424951320ec209f097a5bb02685c9/examples/images/matcap-6.jpg"},{name:"matcap-7.jpg",path:"https://bytebucket.org/sgaoae/altizure-shader-dev/raw/b2eda53a34b424951320ec209f097a5bb02685c9/examples/images/matcap-7.jpg"}],texturePath:this.state.matcapTexturePath,onTexture:this.setMatcapTextureTest,onChangeColor:this.setMatcapTextureFractionTest})))))}}]),t}(u.default.Component);t.default=v},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(18),h=n(c),d=r(6),f=n(d),p={wrapper:{fontFamily:"Open Sans, sans-serif",fontSize:"1.5rem",height:"500px",overflowX:"hidden",overflowY:"scroll",borderRadius:"0 0 3px 3px",color:"white"},container:{padding:"0 0 0 0",width:"100%"},control:{width:"80%",margin:"0 auto"}},m=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleBtnClick=r.handleBtnClick.bind(r),r.setScaleHandler=r.setScaleHandler.bind(r),r.initState={controlType:0,canFinish:!1},r.state=r.initState,r}return a(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;this.props.service.enableFinishBtn=function(){e.setState({canFinish:!0})}}},{key:"componentWillUnmount",value:function(){this.props.service.enableFinishBtn=void 0}},{key:"handleBtnClick",value:function(e){e?this.props.service.handleFinish():this.props.service.handleCancel(),this.setState(this.initState)}},{key:"setScaleHandler",value:function(e){this.props.service.marker&&this.props.service.marker.setPose(void 0,void 0,e)}},{key:"render",value:function(){var e=this,t=this.props.service.marker,r=0;return t&&(r=t.scale),u.default.createElement("div",{className:"poseture-panel-wrapper scrollbar",style:p.wrapper},u.default.createElement("div",{className:"container",style:p.container},u.default.createElement("div",{className:"marker-info"},u.default.createElement("div",{className:"text-center"},u.default.createElement("h1",null,"Posture"))),u.default.createElement(h.default,{buttons:["TRANSLATE","ROTATE"],activeIndex:this.state.controlType,click:function(t){e.setState({controlType:t}),e.props.service.changeControlType(0===t?"translate":"rotate")}}),u.default.createElement("br",null),u.default.createElement("div",{className:"row",style:p.control},u.default.createElement("input",{type:"submit",value:"CANCEL",className:"btn btn-danger",style:{float:"left"},onClick:function(){e.handleBtnClick(!1)}}),u.default.createElement("input",{type:"submit",value:"FINISH",className:"btn btn-success",style:{float:"right"},onClick:function(){e.handleBtnClick(!0)},disabled:!this.state.canFinish})),u.default.createElement("br",null),u.default.createElement("div",{style:p.control},"Scale:",u.default.createElement(f.default,{min:"0.1",max:"10",step:"0.1",defaultValue:r,handler:this.setScaleHandler}))))}}]),t}(u.default.Component);t.default=m},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(17),h=n(c),d=r(6),f=n(d),p=r(15),m=n(p),v=r(16),g=n(v),y={wrapper:{fontFamily:"Open Sans, sans-serif",fontSize:"1.5rem",borderRadius:"0 0 3px 3px",color:"white",userSelect:"none"},container:{padding:"0 0 0 0",width:"100%"},hr:{margin:"10px 10px",border:"0",height:"1px",backgroundImage:"linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0))"},cardTable:{userSelect:"none",display:"table",width:"100%",height:"100px",verticalAlign:"top",backgroundColor:"#a6a6a6",borderRadius:"3px",boxShadow:"0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22)",borderTop:"1px solid black",borderBottom:"1px solid black",padding:"5px 5px"},cardview:{padding:"0 0 0 0",overflowX:"hidden",overflowY:"scroll",width:"90%",height:"273px",margin:"0 auto"},list:{listStyleType:"none",padding:"0",margin:"0",color:"white"},heading:{marginTop:"0",marginBottom:"5px"},info:{paddingTop:"10px",paddingBottom:"10px"},btns:{float:"right",textDecoration:"none",verticalAlign:"middle"},tabs:{width:"100%",margin:"none",padding:"0 0 0 0",height:"40px"}},b=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.addCameraPose=r.addCameraPose.bind(r),r.removeCameraPose=r.removeCameraPose.bind(r),r.handleAnimation=r.handleAnimation.bind(r),r.handleTimeInterval=r.handleTimeInterval.bind(r),r.handleSpeed=r.handleSpeed.bind(r),r.setCurrentPose=r.setCurrentPose.bind(r),r.handleCollapse=r.handleCollapse.bind(r),r.tabDescription=[],r.state={animating:e.service.animating,timeInterval:e.service.timeInterval,speed:e.service.speed,collapsed:!1},r.cameraPoses=e.service.cameraPoses,r.screenShots=e.service.screenShots,r.imgwidth=e.service.imgwidth,r.imgheight=e.service.imgheight,r.props.service.targetPanel=r,r}return a(t,e),s(t,[{key:"componentDidUpdate",value:function(e,t){for(var r=0;r<this.screenShots.length;++r){var n="canvas"+r,i=g.default.findDOMNode(this.refs[n]);if(!i)break;var o=i.getContext("2d");o.clearRect(0,0,this.imgwidth,this.imgheight);for(var a=o.createImageData(this.imgwidth,this.imgheight),s=0;s<a.data.length;s++)a.data[s]=this.screenShots[r][s];o.putImageData(a,0,0)}var l=g.default.findDOMNode(this.refs.cardList);l&&(l.scrollTop=l.scrollHeight)}},{key:"_producePoseCard",value:function(e,t){var r=this,n=(e.lng,e.lat,e.alt,e.north,e.tilt,"Camera Pose "+t),i="canvas"+t;return u.default.createElement("div",{style:y.cardTable,key:t,onClick:function(){return r.setCurrentPose(t)}},u.default.createElement("div",{className:"row",style:{margin:"auto"}},u.default.createElement("div",{className:"col-sm-10",style:y.heading},u.default.createElement("span",{style:{fontWeight:"500"}},n)),u.default.createElement("div",{className:"col-sm-2"},u.default.createElement("a",{style:Object.assign({},y.btns,{verticalAlign:"top"}),className:"fa fa-times fa-2x",title:"remove this pose",draggable:"false",onClick:function(){return r.removeCameraPose(t)}}))),u.default.createElement("canvas",{width:this.imgwidth,height:this.imgheight,ref:i}))}},{key:"handleCollapse",value:function(e){g.default.findDOMNode(this.refs.camerapanel);e?this.props.extra.setPanelHeight(80):this.props.extra.setPanelHeight(500),this.setState({collapsed:e})}},{key:"setCurrentPose",value:function(e){this.props.service.setCurrentPose(e)}},{key:"addCameraPose",value:function(){var e=this.props.service.stopAnimation();this.props.service.addCameraPose(),this.setState({animating:e})}},{key:"removeCameraPose",value:function(e){var t=this.props.service.stopAnimation();this.props.service.removeCameraPose(e),this.setState({animating:t})}},{key:"handleAnimation",value:function(){var e=this.state.animating;e=!e,e=e?this.props.service.playAnimation():this.props.service.stopAnimation(),this.setState({animating:e})}},{key:"handleTimeInterval",value:function(e){e>0&&(this.props.service.setTimeInterval(1e3*e),this.setState({timeInterval:1e3*e}))}},{key:"handleSpeed",value:function(e){this.props.service.setSpeed(e),this.setState({speed:e})}},{key:"render",value:function(){var e=this,t=(this.tabDescription.map(function(t,r){var n=e.state.mode===r;return u.default.createElement(h.default,{key:r,index:r,kind:t.kind,icon:t.icon,selectTool:function(t){e.setState({activeIndex:t})},selected:n,tooltipPlace:"bottom"})}),this.cameraPoses.map(function(t,r){return e._producePoseCard(t,r)})),r=u.default.createElement("div",{style:y.cardview,ref:"cardList"},t),n=this.state.animating?"btn-link-dark fa fa-stop-circle fa-fw fa-2x":"btn-link-dark fa fa-play-circle fa-fw fa-2x",i=void 0;return i=u.default.createElement("div",null,u.default.createElement("div",{className:"row",style:{margin:"auto"}},u.default.createElement("div",{className:"col-sm-6"},u.default.createElement("input",{type:"submit",value:"Add Pose",className:"btn btn-success",style:{float:"left"},onClick:this.addCameraPose})),u.default.createElement("div",{className:"col-sm-6"},u.default.createElement("a",{style:y.btns,className:n,title:"animation button",draggable:"false",onClick:this.handleAnimation}))),r,u.default.createElement("div",{className:"row",style:{margin:"auto"}},u.default.createElement("div",{className:"col-sm-3"},u.default.createElement("span",{style:{fontSize:"15px"}},"Time Interval (s):")),u.default.createElement("div",{className:"col-sm-9"},u.default.createElement(f.default,{min:"0.1",max:"20",step:"0.1",defaultValue:this.state.timeInterval/1e3,handler:this.handleTimeInterval}))),u.default.createElement("div",{className:"row",style:{margin:"auto"}},u.default.createElement("div",{className:"col-sm-2"},u.default.createElement("span",{style:{fontSize:"15px"}},"Speed:")),u.default.createElement("div",{className:"col-sm-10"},u.default.createElement(f.default,{min:"0.01",max:"5",step:"0.01",defaultValue:this.state.speed,handler:this.handleSpeed})))),u.default.createElement("div",{className:"camera-panel-wrapper",style:y.wrapper,ref:"camerapanel"},u.default.createElement("div",{className:"container",style:y.container,onMouseLeave:function(t){e.props.service.mouseInPanel=!1},onMouseEnter:function(t){e.props.service.mouseInPanel=!0}},u.default.createElement("div",{className:"text-center"},u.default.createElement("span",{style:{fontSize:"20px"}},"Camera Animation")),u.default.createElement("hr",{style:y.hr}),u.default.createElement(m.default,{heading:" ",info:"",collapsed:this.state.collapsed,handleCollapse:this.handleCollapse},i)))}}]),t}(u.default.Component);t.default=b},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(17),h=(n(c),r(15)),d=n(h),f=r(6),p=n(f),m=r(11),v=(n(m),r(18)),g=(n(v),r(94)),y=n(g),b=r(293),_=n(b),w=r(294),x=n(w),M={panel:{fontFamily:"Open Sans, sans-serif",fontSize:"0.75rem"},panelDisable:{pointerEvents:"none"},tabs:{width:"100%",margin:"none",padding:"0 0 0 0",height:"40px",borderBottomStyle:"solid",borderBottomColor:"black"},panelContainer:{padding:"0 0 0 0",width:"100%"},board:{width:"100%",margin:"none",padding:"0 0 0 0",overflowX:"hidden",overflowY:"scroll",height:"500px",borderRadius:"0 0 3px 3px"},infoChunk:{userSelect:"none",display:"table",width:"100%",verticalAlign:"top",backgroundColor:"#666666",borderRadius:"3px",boxShadow:"0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22)",borderTop:"1px solid black",borderBottom:"1px solid black",padding:"5px 5px",color:"white"},selector:{width:"100%",color:"#fff",backgroundColor:"#2a2b2d",border:"1px solid #000",fontSize:"14px"},sliderContainer:{padding:"0 0 0 0",textAlign:"center",height:"35px"},input:{width:"100%",fontSize:"12px",backgroundColor:"#2a2b2d",border:"none",borderRadius:"3px",height:"25px"},label:{width:"100%"},form:{width:"90%",padding:"10px 0 30px 0",margin:"0 auto",color:"white",letterSpacing:"1px"},hr:{margin:"10px 10px",border:"0",backgroundImage:"linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0))"}},E=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={hasTarget:!1},r.props.service.refresh=function(){if(r.props.service.target){var e=r.props.service.target;r.apis=r.props.service.readAllGetterAndSetter(e),r.uisettings=r.props.service.filterApis(r.apis),r.setState({hasTarget:!0})}},r}return a(t,e),s(t,[{key:"render",value:function(){var e=this;if(!this.state.hasTarget)return u.default.createElement("div",null,u.default.createElement("span",{style:M.infoChunk},"Please select a marker"));for(var t=this.uisettings,r=0,n=[],i=0;i<t.length;++i){(function(i){var o=t[i],a=[];if(o.map(function(t){switch(t.type){case"number":a.push(e._uifornumber(t,r)),r+=1;break;case"boolean":a.push(e._uiforboolean(t,r)),r+=1;break;case"string":a.push(e._uiforstring(t,r)),r+=1;break;case"ternaryobject":a.push(e._uiforternaryobject(t,r)),r+=1}}),0===a.length)return"continue";n.push(u.default.createElement(d.default,{key:r,heading:" ",info:"",handleCollapse:function(t){t||e.forceUpdate()}},a)),r+=1,n.push(u.default.createElement("hr",{key:r,style:M.hr})),r+=1})(i)}return u.default.createElement("div",{className:"marker-panel",style:M.panel},u.default.createElement("div",{className:"container",style:M.panelContainer},u.default.createElement("div",{className:"board scrollbar",style:M.board},n)))}},{key:"_uifornumber",value:function(e,t){var r=this,n=this.props.service.target[e.methodName],i=e.hasSetter?{}:M.panelDisable;return u.default.createElement("div",{key:t,style:Object.assign({},M.infoChunk,i)},u.default.createElement("span",null,e.name),u.default.createElement(p.default,{min:n/10,max:10*n,step:n/100,defaultValue:n,handler:function(t){e.hasSetter&&(r.props.service.target[e.methodName]=t)}}))}},{key:"_uiforboolean",value:function(e,t){var r=this,n=this.props.service.target[e.methodName],i=e.hasSetter?{}:M.panelDisable;return u.default.createElement("div",{key:t,style:Object.assign({},M.infoChunk,i)},u.default.createElement("div",{style:{width:"95%"}},u.default.createElement("div",{style:{display:"inlineBlock",float:"left"}},u.default.createElement("span",{style:{float:"left"}},e.name)),u.default.createElement("div",{style:{display:"inlineBlock",float:"right"}},u.default.createElement(y.default,{checked:n,onChange:function(t){e.hasSetter&&(r.props.service.target[e.methodName]=t)}}))))}},{key:"_uiforstring",value:function(e,t){var r=this,n=this.props.service.target[e.methodName],i=e.hasSetter?{}:M.panelDisable;return e.hasSetter?u.default.createElement("div",{key:t,style:Object.assign({},M.infoChunk,i)},u.default.createElement(_.default,{value:n,name:e.name,onUpdate:function(t,n,i){e.hasSetter&&(e.isAsync?r.props.service.target[e.methodName]={data:t,onSuccess:function(){console.log("[MarkerPanel] _uifornumber onSuccess",e.methodName,t),i(t)},onFail:function(){console.log("[MarkerPanel] _uifornumber onFail",e.methodName,t),i(n)}}:r.props.service.target[e.methodName]=t)}})):u.default.createElement("div",{key:t,style:Object.assign({},M.infoChunk,i)},u.default.createElement("span",null,e.name,":",u.default.createElement("br",null),n))}},{key:"_uiforternaryobject",value:function(e,t){var r=this,n=this.props.service.target[e.methodName],i=e.hasSetter?{}:M.panelDisable;return u.default.createElement("div",{key:t,style:Object.assign({},M.infoChunk,i)},u.default.createElement(x.default,{name:e.name,value:n,onUpdate:function(t){e.hasSetter&&(r.props.service.target[e.methodName]=t)}}))}}]),t}(u.default.Component);t.default=E},function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c={input:{width:"100%",fontSize:"12px",backgroundColor:"#2a2b2d",border:"none",borderRadius:"3px",height:"25px"}},h=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.updateText=r.updateText.bind(r),r.setValue=r.setValue.bind(r),r.state={name:e.name?e.name:"unknown field",value:e.value},r}return a(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){this.refs.textInput.value=e.value,this.setState({name:e.name?e.name:"unknown field",value:e.value})}},{key:"setValue",value:function(e){this.refs.textInput.value=e,this.setState({value:e})}},{key:"updateText",value:function(e){if(this.props.onUpdate)try{this.props.onUpdate(e,this.state.value,this.setValue)}catch(e){return void(this.refs.textInput.value=this.state.value)}this.setState({value:e})}},{key:"render",value:function(){var e,t=this;return u.default.createElement("div",null,u.default.createElement("span",null,this.state.name),u.default.createElement("input",(e={style:c.input,ref:"textInput",type:"text",defaultValue:this.state.value},n(e,"ref","textInput"),n(e,"onBlur",function(e){var r=e.target.value;t.updateText(r)}),n(e,"onKeyPress",function(e){if(13===e.charCode){var r=e.target.value;t.updateText(r)}}),e)))}}]),t}(u.default.Component);t.default=h},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u={ternaryBox:{width:"30%",float:"left",margin:"3px",textAlign:"center"},input:{fontSize:"12px",backgroundColor:"#2a2b2d",border:"none",borderRadius:"3px",width:"100%",height:"25px",textAlign:"center"}},c=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.updateText=r.updateText.bind(r),r.state={name:e.name,value:e.value},r}return o(t,e),a(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({name:e.name,value:e.value})}},{key:"updateText",value:function(e,t){var r=this.state.value;if("number"==typeof r[e]){var n=parseFloat(t);if(isNaN(n))return void(this.refs[e].value=r[e]);r[e]=n}else r[e]=t;if(this.props.onUpdate)try{this.props.onUpdate(r)}catch(t){return void(this.refs[e].value=r[e])}this.refs[e].value=r[e],this.setState({value:r})}},{key:"render",value:function(){var e=this,t=Object.keys(this.state.value).slice(0,3),r=t.map(function(t,r){var n=e.state.value[t];return l.default.createElement("div",{key:r,style:{width:"100%",height:"30px"}},l.default.createElement("div",{style:{display:"inlineBlock",float:"left",width:"25%"}},l.default.createElement("span",null,t)),l.default.createElement("div",{style:{display:"inlineBlock",float:"right",width:"75%"}},l.default.createElement("input",{style:u.input,type:"text",defaultValue:n,ref:t,onBlur:function(r){var n=r.target.value;e.updateText(t,n)},onKeyPress:function(r){if(13===r.charCode){var n=r.target.value;e.updateText(t,n)}}})))});return l.default.createElement("div",null,l.default.createElement("span",null,this.state.name),l.default.createElement("div",{style:{width:"95%",margin:"auto",marginTop:"5px"}},r))}}]),t}(l.default.Component);t.default=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(0),u=n(l),c=r(15),h=n(c),d=r(16),f=(n(d),{wrapper:{fontFamily:"Open Sans, sans-serif",fontSize:"1.5rem",borderRadius:"0 0 3px 3px",color:"white",userSelect:"none"},container:{padding:"0 0 0 0",width:"100%"},hr:{margin:"10px 10px",border:"0",height:"1px",backgroundImage:"linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0))"},cardTable:{userSelect:"none",display:"table",width:"100%",height:"100px",verticalAlign:"top",backgroundColor:"#a6a6a6",borderRadius:"3px",boxShadow:"0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22)",borderTop:"1px solid black",borderBottom:"1px solid black",padding:"5px 5px"},cardview:{padding:"0 0 0 0",overflowX:"hidden",overflowY:"scroll",width:"90%",height:"400px"},list:{listStyleType:"none",padding:"0",margin:"0",color:"white"},heading:{marginTop:"0",marginBottom:"5px"},info:{paddingTop:"10px",paddingBottom:"10px"},btns:{float:"right",textDecoration:"none",verticalAlign:"middle"},tabs:{width:"100%",margin:"none",padding:"0 0 0 0",height:"40px"}}),p=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._produceMeasurementCard=r._produceMeasurementCard.bind(r),r.addMeasurement=r.addMeasurement.bind(r),r.removeMeasurement=r.removeMeasurement.bind(r),r.cancelMeasurement=r.cancelMeasurement.bind(r),r.handleCollapse=r.handleCollapse.bind(r),r.measurements=e.service.measurements,r.state={collapsed:!1,scrollToBottom:!1},e.service.panel=r,r}return a(t,e),s(t,[{key:"componentDidUpdate",value:function(e,t){this.state.scrollToBottom&&(this.refs.cardList.scrollTop=this.refs.cardList.scrollHeight,this.state.scrollToBottom=!1)}},{key:"_produceMeasurementCard",value:function(e,t){var r=this,n=e.volume,i=e.number;return u.default.createElement("div",{style:f.cardTable,key:t},u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"col-sm-10"},u.default.createElement("span",{style:{fontWeight:"500"}},"Measurement ",i)),u.default.createElement("div",{className:"col-sm-2"},u.default.createElement("a",{style:Object.assign({},f.btns,{verticalAlign:"top"}),className:"fa fa-times fa-2x",title:"remove this measurement",draggable:"false",onClick:function(){r.removeMeasurement(t)}}))),u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"col-sm-2"},u.default.createElement("a",{style:Object.assign({},f.btns),className:"fa fa-calculator",title:"compute volume",draggable:"false",onClick:function(){r.measurements[t].volume=r.measurements[t].altizureProjectMarker.getRegionVolume(r.measurements[t].polygonMarker),r.forceUpdate()}})),u.default.createElement("div",{className:"col-sm-10"},u.default.createElement("span",null,"Volume: ",n))))}},{key:"addMeasurement",value:function(){this.props.service.addMeasurement()}},{key:"cancelMeasurement",value:function(){this.props.service.clearThisMeasurement()}},{key:"removeMeasurement",value:function(e){this.props.service.removeMeasurement(e),this.forceUpdate()}},{key:"handleCollapse",value:function(e){e?this.props.extra.setPanelHeight(80):this.props.extra.setPanelHeight(500),this.setState({collapsed:e})}},{key:"render",value:function(){var e=this,t=this.measurements.map(function(t,r){return e._produceMeasurementCard(t,r)}),r=u.default.createElement("div",{style:f.cardview,ref:"cardList"},t),n=void 0;return n=u.default.createElement("div",null,u.default.createElement("div",{className:"row",style:{margin:"auto"}},u.default.createElement("div",{className:"col-sm-6"},u.default.createElement("input",{type:"submit",value:"New Measurements",className:"btn btn-success",style:{float:"left"},onClick:this.addMeasurement})),u.default.createElement("div",{className:"col-sm-6"},u.default.createElement("input",{type:"submit",value:"Cancel",className:"btn btn-success",style:{float:"right"},onClick:this.cancelMeasurement}))),r),u.default.createElement("div",{className:"camera-panel-wrapper",style:f.wrapper,ref:"measurepanel"},u.default.createElement("div",{className:"container",style:f.container},u.default.createElement("div",{className:"text-center"},u.default.createElement("span",{style:{fontSize:"20px"}},"Measurements")),u.default.createElement("hr",{style:f.hr}),u.default.createElement(h.default,{heading:" ",info:"click to collapse the panel",collapsed:this.state.collapsed,handleCollapse:this.handleCollapse},n)))}}]),t}(u.default.Component);t.default=p},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(297),s=n(a),l=r(298),u=n(l),c=r(299),h=n(c),d=r(300),f=n(d),p=r(301),m=n(p),v=r(302),g=n(v),y=r(303),b=n(y),_=r(304),w=n(_),x=r(305),M=n(x),E=r(306),A=n(E),T=r(307),k=n(T),S=function(){function e(t){i(this,e),this.services={insertservice:new s.default(t),drawservice:new u.default(t),shaderservice:new h.default(t),posetureservice:new f.default(t),patrolservice:new m.default(t),removeservice:new g.default(t),savesceneservice:new b.default(t),cloudservice:new w.default(t),cameraservice:new M.default(t),markerservice:new A.default(t),measureservice:new k.default(t)},this.currentService=null,this.getServiceByName=this.getServiceByName.bind(this),this.stopCurrentService=this.stopCurrentService.bind(this)}return o(e,[{key:"getServiceByName",value:function(e){var t=this.services[e.toLowerCase()];return this.currentService=t,this.currentService.serviceWillBegin(),this.currentService}},{key:"stopCurrentService",value:function(){this.currentService&&(this.currentService.serviceWillStop(),this.currentService=null)}}]),e}();t.default=S},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(10),a=function(){function e(t){n(this,e),this.earth=t.earth,this.mouseCache=null,this.markerOptions=null,this.rollOverMarker=null,this.markerType=null,this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.createRollOverMarker=this.createRollOverMarker.bind(this),this.addMarker=this.addMarker.bind(this),this.events=[{name:"mousemove",handler:this.handleMouseMove},{name:"mousedown",handler:this.handleMouseDown},{name:"mouseup",handler:this.handleMouseUp}],this._el=document.createElement("div"),document.getElementsByTagName("body")[0].appendChild(this._el),this._el.style.display="none",this._el.id="insert-dom",this._el.addEventListener("obj_loaded",this.createRollOverMarker,!1)}return i(e,[{key:"serviceWillBegin",value:function(){this.events.map(function(e){document.addEventListener(e.name,e.handler,!1)})}},{key:"serviceWillStop",value:function(){this.events.map(function(e){document.removeEventListener(e.name,e.handler,!1)}),this.rollOverMarker&&(this.rollOverMarker.shapeHolder.traverse(function(e){"Mesh"===e.type&&(e.geometry.dispose(),e.material.map&&e.material.map.dispose(),e.material.dispose())}),this.earth.markerLayer.removeChild(this.rollOverMarker),this.rollOverMarker=null)}},{key:"disableAllTools",value:function(){document.dispatchEvent(new CustomEvent("deactive_tool"))}},{key:"handleMouseMove",value:function(e){if(null!==this.rollOverMarker){this.rollOverMarker.shapeHolder.visible=!0;var t={x:e.clientX,y:e.clientY},r=void 0;"AltizureProjectMarker"!==this.markerType&&(r=this.earth.pickOnProjects(e)),r||(r=this.earth.pick(t)),this.rollOverMarker.setPose(r,null,null)}}},{key:"handleMouseDown",value:function(e){if(0===e.button){var t={x:e.clientX,y:e.clientY},r=void 0;"AltizureProjectMarker"!==this.markerType&&(r=this.earth.pickOnProjects(e)),r||(r=this.earth.pick(t)),this.mouseCache=r}}},{key:"handleMouseUp",value:function(e){if(null!==this.rollOverMarker&&0===e.button){var t={x:e.clientX,y:e.clientY},r=void 0;"AltizureProjectMarker"!==this.markerType&&(r=this.earth.pickOnProjects(e)),r||(r=this.earth.pick(t)),function(e,t,r,n){return(e-r)*(e-r)+(t-n)*(t-n)<1e-9}(this.mouseCache.lat,this.mouseCache.lng,r.lat,r.lng)&&this.addMarker(r)}}},{key:"createRollOverMarker",value:function(e){this.rollOverMarker&&(this.rollOverMarker.shapeHolder.traverse(function(e){"Mesh"===e.type&&(e.geometry.dispose(),e.material.map&&e.material.map.dispose(),e.material.dispose())}),this.earth.markerLayer.removeChild(this.rollOverMarker),this.rollOverMarker=null);var t=this;e.detail.type&&"AltizureProjectMarker"===e.detail.type&&e.detail.projectID?(this.markerType="AltizureProjectMarker",function(e){t.earth.apiService.project({pid:e}).then(function(r){return t.markerOptions={position:{lng:r.geoInfo.centerLong,lat:r.geoInfo.centerLat,alt:10},name:r.name,earth:t.earth,projInfo:r,errHandler:function(r){console.error("createAltizureMarker",e,r),t.disableAllTools()}},t.rollOverMarker=new o.AltizureProjectMarker(t.markerOptions),t.rollOverMarker.shapeHolder.visible=!1,Promise.resolve()}).catch(function(r){return console.error("createAltizureMarker",e,r),t.disableAllTools(),Promise.resolve()})}(e.detail.projectID)):e.detail.type&&"TagMarker"===e.detail.type?(this.markerType="TagMarker",function(e,r,n){t.markerOptions={position:{lng:0,lat:0,alt:0},earth:t.earth,imgUrl:e,scale:r,name:n},t.rollOverMarker=new o.TagMarker(t.markerOptions),t.rollOverMarker.shapeHolder.visible=!1}(e.detail.tagImgUrl,e.detail.tagScale,e.detail.tagName)):(this.markerType="OBJMarker",function(){t.markerOptions={position:{lng:0,lat:0,alt:0},earth:t.earth,name:e.detail.name,shape:"CUSTOMIZE",objUrl:e.detail.objUrl,mtlUrl:e.detail.mtlUrl,upDir:e.detail.upDir,scale:e.detail.scale,isRollOver:!0,errHandler:function(e){console.error("create roll over marker err",e),t.disableAllTools()}},t.rollOverMarker=new o.OBJMarker(t.markerOptions),t.rollOverMarker.shapeHolder.visible=!1}())}},{key:"addMarker",value:function(e){var t=void 0;"OBJMarker"===this.markerType?t=new o.OBJMarker(Object.assign({},this.markerOptions,{position:{lng:e.lng,lat:e.lat,alt:e.alt},isRollOver:!1})):"AltizureProjectMarker"===this.markerType?(t=this.rollOverMarker,t.setPose({lng:e.lng,lat:e.lat,alt:e.alt}),this.rollOverMarker=null,this.disableAllTools()):"TagMarker"===this.markerType&&(t=new o.TagMarker(Object.assign({},this.markerOptions,{position:{lng:e.lng,lat:e.lat,alt:e.alt}})))}},{key:"updateCurrentRollOverMarker",value:function(e,t){if(this.rollOverMarker)if("OBJMarker"===e&&this.rollOverMarker instanceof o.OBJMarker)for(var r in t)switch(r){case"scale":this.markerOptions.scale=t.scale,this.rollOverMarker.setPose(void 0,void 0,t.scale)}else if("TagMarker"===this.markerType&&this.rollOverMarker instanceof o.TagMarker)for(var n in t)switch(n){case"tagScale":this.markerOptions.scale=t.tagScale,this.rollOverMarker.setPose(void 0,void 0,t.tagScale)}}},{key:"insertObject",value:function(e){e?document.getElementById("insert-dom").dispatchEvent(new CustomEvent("obj_loaded",{detail:e})):console.warn("[InsertService] insertObject input options is nothing",e)}}]),e}();t.default=a},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(10),a=function(){function e(t){n(this,e),this.earth=t.earth,this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.setDrawObjectState=this.setDrawObjectState.bind(this),this.drawObject=this.drawObject.bind(this),this._constructMarkerOptions=this._constructMarkerOptions.bind(this),this._clearHelperMarker=this._clearHelperMarker.bind(this),this.events=[{name:"mousemove",handler:this.handleMouseMove},{name:"mousedown",handler:this.handleMouseDown},{name:"mouseup",handler:this.handleMouseUp}],this.stillHelperMarker=null,this.stillHelperMarkerOptions=null,this.movingHelperMarker=null,this.movingHelperMarkerOptions=null,this.currentMarker=null,this.markerOptions=null,this.drawObjectType="NONE"}return i(e,[{key:"serviceWillBegin",value:function(){this.events.map(function(e){document.addEventListener(e.name,e.handler,!1)})}},{key:"serviceWillStop",value:function(){this.events.map(function(e){document.removeEventListener(e.name,e.handler,!1)}),this.finishCurrentDrawing(),this.currentMarker=null}},{key:"handleMouseMove",value:function(e){if(null!==this.movingHelperMarker||null!==this.stillHelperMarker){var t={x:e.clientX,y:e.clientY},r=this.earth.pickOnProjects(e);if(r||(r=this.earth.pick(t)),r){this.movingHelperMarker&&this.movingHelperMarker.setPose(r,void 0,void 0);var n=new o.LngLatAlt(r.lng,r.lat,r.alt);if("PolyLineMarker"===this.drawObjectType){if(this.stillHelperMarker){var i=this.stillHelperMarker.points;i[i.length-1]=new o.LngLatAlt(r.lng,r.lat,r.alt),this.stillHelperMarker.points=i,this.stillHelperMarker.update()}}else if("PolygonMarker"===this.drawObjectType&&this.stillHelperMarker){var a=this.stillHelperMarker.points[0],s=this.pointCloseEnough(a,n);this.stillHelperMarker.points[this.stillHelperMarker.points.length-1]=s?a:n,this.stillHelperMarker.update()}}}}},{key:"pointCloseEnough",value:function(e,t){return(t.lng-e.lng)*(t.lng-e.lng)+(t.lat-e.lat)*(t.lat-e.lat)<5e-10}},{key:"handleMouseDown",value:function(e){var t={x:e.clientX,y:e.clientY},r=this.earth.pickOnProjects(e);r||(r=this.earth.pick(t)),0===e.button?this.leftMouseCache=r:2===e.button&&(this.rightMouseCache=r)}},{key:"handleMouseUp",value:function(e){function t(e,t,r,n){return(e-r)*(e-r)+(t-n)*(t-n)<1e-9}var r={x:e.clientX,y:e.clientY},n=this.earth.pickOnProjects(e);n||(n=this.earth.pick(r)),0===e.button?t(this.leftMouseCache.lat,this.leftMouseCache.lng,n.lat,n.lng)&&this.drawObject(n):2===e.button&&t(this.rightMouseCache.lat,this.rightMouseCache.lng,n.lat,n.lng)&&this.finishCurrentDrawing()}},{key:"setDrawObjectState",value:function(e){e?(this.currentMarker=null,this.finishCurrentDrawing(),"PolygonMarker"===e.drawObjectType?(this.drawObjectType="PolygonMarker",this.markerOptions={points:[]},this.stillHelperMarkerOptions={points:[],earth:this.earth,scale:1,imgUrl:"./public/assets/img/tag/normal/wifi.png",color:this.panelState.polygonColor,lineWidth:1,pointVisible:!1,fenceHeight:5}):"PolyLineMarker"===e.drawObjectType&&(this.drawObjectType="PolyLineMarker",this.markerOptions={points:[]},this.stillHelperMarkerOptions={points:[],earth:this.earth,scale:1,color:16777215,lineWidth:1,pointVisible:!1})):console.warn("[DrawService] drawObject options not defined")}},{key:"drawObject",value:function(e){if("NONE"!==this.drawObjectType)if("PolygonMarker"===this.drawObjectType){var t=new o.LngLatAlt(e.lng,e.lat,e.alt);if(this.stillHelperMarker?(this.stillHelperMarker.points[this.stillHelperMarker.points.length-1]=t,this.stillHelperMarker.points.push(t),this.stillHelperMarker.update()):(this.stillHelperMarkerOptions.points=[t,t],this.stillHelperMarker=new o.PolyLineMarker(this.stillHelperMarkerOptions)),this.markerOptions.points.push(t),this.markerOptions.points.length>3){var r=this.markerOptions.points[0],n=this.pointCloseEnough(r,t);!0===n&&(this._constructMarkerOptions("PolygonMarker"),this.currentMarker=new o.PolygonMarker(this.markerOptions),this.finishCurrentDrawing())}}else if("PolyLineMarker"===this.drawObjectType){var i=new o.LngLatAlt(e.lng,e.lat,e.alt);this.stillHelperMarker?(this.stillHelperMarker.points=[i,i],this.stillHelperMarker.update()):(this.stillHelperMarkerOptions.points=[i,i],this.stillHelperMarker=new o.PolyLineMarker(this.stillHelperMarkerOptions)),this.markerOptions.points.push(i),this.markerOptions.points.length>1&&(this.currentMarker?this.currentMarker.addPointMarker(i):(this._constructMarkerOptions("PolyLineMarker"),this.currentMarker=new o.PolyLineMarker(this.markerOptions)))}}},{key:"finishCurrentDrawing",value:function(){this.drawObjectType="NONE",this._clearHelperMarker()}},{key:"updateState",value:function(e,t){if(t&&(this.panelState=Object.assign({},this.panelState,t),this.currentMarker))if("PolygonMarker"===e&&this.currentMarker instanceof o.PolygonMarker)for(var r in t)switch(r){case"polygonOpacity":this.currentMarker.opacity=t.polygonOpacity;break;case"polygonColor":this.currentMarker.color=t.polygonColor;break;case"polygonTop":this.currentMarker.top=t.polygonTop;break;case"polygonBottom":this.currentMarker.bottom=t.polygonBottom;break;case"polygonName":this.currentMarker.name=t.polygonName}else if("PolyLineMarker"===e&&this.currentMarker instanceof o.PolyLineMarker)for(var n in t)switch(n){case"polyLineLineWidth":this.currentMarker.lineWidth=t.polyLineLineWidth;break;case"polyLineColor":this.currentMarker.color=t.polyLineColor;break;case"polyLineName":this.currentMarker.name=t.polyLineName}}},{key:"_constructMarkerOptions",value:function(e){if("PolygonMarker"===e){var t=this.markerOptions.points;t[t.length-1]=t[0];var r={points:t,top:this.panelState.polygonTop,bottom:this.panelState.polygonBottom,color:this.panelState.polygonColor,opacity:this.panelState.polygonOpacity};this.markerOptions={volume:r,earth:this.earth,name:this.panelState.polygonName}}else"PolyLineMarker"===e&&(this.markerOptions={points:this.markerOptions.points,name:this.panelState.polyLineName,earth:this.earth,lineWidth:this.panelState.polyLineLineWidth,color:this.panelState.polyLineColor,visible:!0,pointVisible:!1})}},{key:"_clearHelperMarker",value:function(){this.stillHelperMarker&&(this.stillHelperMarker.destruct(),this.stillHelperMarker=null),this.movingHelperMarker&&(this.movingHelperMarker.destruct(),this.movingHelperMarker=null)}}]),e}();t.default=a},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t){n(this,e),this.earth=t.earth,this.target=null,this.handleMarkerclick=this.handleMarkerclick.bind(this),this.events=[{name:"marker_click",handler:this.handleMarkerclick}]}return i(e,[{key:"serviceWillBegin",value:function(){console.log("shader service will begin"),this.earth.markerLayer.children.map(function(e){e.clickable=!0,e.on("click",function(t){console.log("[move service] marker click",e),document.dispatchEvent(new CustomEvent("marker_click",{detail:{marker:e}}))})}),this.events.map(function(e){document.addEventListener(e.name,e.handler,!1)})}},{key:"serviceWillStop",value:function(){console.log("shader service will stop"),this.earth.markerLayer.children.map(function(e){e.clickable=!1}),this.events.map(function(e){document.removeEventListener(e.name,e.handler,!1)}),this.target=null}},{key:"handleMarkerclick",value:function(e){var t=this.target?this.target.ID:null,r=e.detail.marker?e.detail.marker.ID:null;null!==r&&t!==r&&(console.log("[shaderservice] marker change from ",t," to ",r),this.target=e.detail.marker,this.refresh&&this.refresh())}}]),e}();t.default=o},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(10),a=function(){function e(t){n(this,e),this.earth=t.earth,this.mouseCache=null,this.markerType=null,this.marker=null,this.markerInit=null,this.state=null,this.controlType="translate",this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleMarkerclick=this.handleMarkerclick.bind(this),this.detailModification=this.detailModification.bind(this),this.changeControlType=this.changeControlType.bind(this),this.handleFinish=this.handleFinish.bind(this),this.handleCancel=this.handleCancel.bind(this),this.events=[{name:"mousedown",handler:this.handleMouseDown},{name:"mouseup",handler:this.handleMouseUp},{name:"marker_click",handler:this.handleMarkerclick},{name:"mousemove",handler:this.handleMouseMove}]}return i(e,[{key:"serviceWillBegin",value:function(){console.log("poseture service will begin"),this.earth.markerLayer.children.map(function(e){e.clickable=!0,e.on("click",function(t){document.dispatchEvent(new CustomEvent("marker_click",{detail:{marker:e}}))})}),this.events.map(function(e){document.addEventListener(e.name,e.handler,!1)}),this.state=0}},{key:"serviceWillStop",value:function(){console.log("poseture service will stop"),this.earth.markerLayer.children.map(function(e){e.clickable=!1}),this.events.map(function(e){document.removeEventListener(e.name,e.handler,!1)}),this.mouseCache=null,this.markerType=null,this.markerInit=null,this.controlType="translate",this.marker&&(this.marker.detachControl(),this.marker instanceof o.OBJMarker&&this.marker.setBboxColor(this.markerBboxColor),this.marker=null,this.earth.unfreeze()),this.state=0}},{key:"handleMouseMove",value:function(e){if(this.marker&&2===this.state){var t={x:e.clientX,y:e.clientY},r=void 0;"AltizureProjectMarker"!==this.marker.type&&(r=this.earth.pickOnProjects(e)),r||(r=this.earth.pick(t)),this.marker.setPose(r,null,null)}}},{key:"handleMouseDown",value:function(e){if(0===e.button){var t={x:e.clientX,y:e.clientY},r=void 0;this.marker&&"AltizureProjectMarker"!==this.marker.type&&(r=this.earth.pickOnProjects(e)),r||(r=this.earth.pick(t)),this.mouseCache=r}}},{key:"handleMouseUp",value:function(e){if(0===e.button){var t={x:e.clientX,y:e.clientY},r=void 0;this.marker&&"AltizureProjectMarker"!==this.marker.type&&(r=this.earth.pickOnProjects(e)),r||(r=this.earth.pick(t)),function(e,t,r,n){return(e-r)*(e-r)+(t-n)*(t-n)<1e-9}(this.mouseCache.lat,this.mouseCache.lng,r.lat,r.lng)&&(1===this.state?this.state=2:2===this.state&&(this.state=3,this.detailModification()))}}},{key:"handleMarkerclick",value:function(e){0===this.state&&(this.state=1,this.marker=e.detail.marker,this.markerType=this.marker.type,this.markerInit={position:this.marker.position,orientation:this.marker.orientation,scale:this.marker.scale},this.marker instanceof o.OBJMarker&&(this.markerBboxColor=this.marker.setBboxColor(new o.Color(1,0,0)))),3===this.state&&this.marker.ID!==e.detail.marker.ID&&(this.state=1,this.marker.detachControl(),this.marker instanceof o.OBJMarker&&this.marker.setBboxColor(this.markerBboxColor),this.earth.unfreeze(),this.marker=e.detail.marker,this.markerType=this.marker.type,this.markerInit={position:this.marker.position,orientation:this.marker.orientation,scale:this.marker.scale},this.marker instanceof o.OBJMarker&&(this.markerBboxColor=this.marker.setBboxColor(new o.Color(1,0,0))))}},{key:"detailModification",value:function(){this.enableFinishBtn&&this.enableFinishBtn(),this.marker.showControl(this.controlType),this.earth.freeze()}},{key:"changeControlType",value:function(e){this.marker&&this.controlType!==e&&this.marker.setControlMode(e),this.controlType=e}},{key:"handleFinish",value:function(){this.marker&&(this.marker.detachControl(),this.marker instanceof o.OBJMarker&&this.marker.setBboxColor(this.markerBboxColor),this.marker=null,this.earth.unfreeze()),this.mouseCache=null,this.markerType=null,this.markerInit=null,this.controlType="translate",this.state=0}},{key:"handleCancel",value:function(){this.marker&&(this.marker.detachControl(),this.marker.setPose(this.markerInit.position,this.markerInit.orientation,this.markerInit.scale),this.marker instanceof o.OBJMarker&&this.marker.setBboxColor(this.markerBboxColor),this.earth.unfreeze(),this.marker=null),this.mouseCache=null,this.markerType=null,this.markerInit=null,this.controlType="translate",this.state=0}}]),e}();t.default=a},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(10),a=function(){function e(t){n(this,e),this.earth=t.earth,this.mouseCache=null,this.markerType=null,this.state=null,this.marker=null,this.animations=null,this.markerBboxColor=null,this.handleMarkerclick=this.handleMarkerclick.bind(this),this.resetAnimation=this.resetAnimation.bind(this),this.playAnimation=this.playAnimation.bind(this),this.getPose=this.getPose.bind(this),this.savePatrolToServer=this.savePatrolToServer.bind(this),this.setToPose=this.setToPose.bind(this),this.events=[{name:"marker_click",handler:this.handleMarkerclick},{name:"reset_animation",handler:this.resetAnimation}]}return i(e,[{key:"serviceWillBegin",value:function(){console.log("patrol service will begin"),this.earth.markerLayer.children.map(function(e){e.clickable=!0,e.on("click",function(t){document.dispatchEvent(new CustomEvent("marker_click",{detail:{marker:e}}))})}),this.events.map(function(e){document.addEventListener(e.name,e.handler,!1)}),this.state=0}},{key:"serviceWillStop",value:function(){console.log("patrol service will stop"),this.earth.markerLayer.children.map(function(e){e.clickable=!1}),this.events.map(function(e){document.removeEventListener(e.name,e.handler,!1)}),this.marker&&(this.marker.animate=function(){},this.marker.setBboxColor(this.markerBboxColor)),this.marker=null,this.mouseCache=null,this.markerType=null,this.markerBboxColor=null,this.animations=null,this.state=0}},{key:"handleMarkerclick",value:function(e){if(this.marker&&!0===this.marker.playing)return void console.warn("cannot change marker while playing animation. Please reset animation first");this.marker&&this.marker.ID===e.detail.marker.ID||(this.marker&&this.markerBboxColor&&this.marker.setBboxColor(this.markerBboxColor),this.marker=e.detail.marker,this.markerBboxColor=this.marker.setBboxColor(new o.Color(1,0,0)),this.animations=this.marker.patrolRoutes,this.setAnimations&&this.setAnimations(this.animations,this.marker.ID),console.log("marker clicked",this.marker))}},{key:"getPose",value:function(){if(this.marker){return{position:this.marker.getUpdatePosition(),orientation:this.marker.orientation}}console.error("[PatrolService recordAnimation] no marker selected")}},{key:"setToPose",value:function(e){this.marker&&this.marker.setPose(e.position,new o.Quaternion(e.orientation._x,e.orientation._y,e.orientation._z,e.orientation._w))}},{key:"playAnimation",value:function(e){this.marker&&this.marker.playAnimation(e)}},{key:"resetAnimation",value:function(e){console.log("resetAnimation"),this.resetUI&&this.resetUI(),this.marker&&this.marker.playing&&this.marker.resetAnimation(e)}},{key:"savePatrolToServer",value:function(){this.marker.patrolRoutes=this.animations;var e=prompt("save to file (relative path `./examples/...`):");null==e||""===e?console.error("Cannot save to the file",e):this.earth.exportToServer(e)}}]),e}();t.default=a},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t){n(this,e),this.earth=t.earth,this.handleMarkerclick=this.handleMarkerclick.bind(this),this.events=[{name:"marker_click",handler:this.handleMarkerclick}]}return i(e,[{key:"serviceWillBegin",value:function(){console.log("poseture service will begin"),this.earth.markerLayer.children.map(function(e){e.clickable=!0,e.on("click",function(t){document.dispatchEvent(new CustomEvent("marker_click",{detail:{marker:e}}))})}),this.events.map(function(e){document.addEventListener(e.name,e.handler,!1)})}},{key:"serviceWillStop",value:function(){console.log("poseture service will stop"),this.earth.markerLayer.children.map(function(e){e.clickable=!1}),this.events.map(function(e){document.removeEventListener(e.name,e.handler,!1)})}},{key:"handleMarkerclick",value:function(e){e.detail.marker.destruct(),this.earth.markerLayer.removeChild(e.detail.marker)}}]),e}();t.default=o},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t){n(this,e),this.earth=t.earth,this.events=[]}return i(e,[{key:"serviceWillBegin",value:function(){console.log("save scene service will begin"),this.events.map(function(e){document.addEventListener(e.name,e.handler,!1)});var e=this.earth.metaInfo&&this.earth.metaInfo.name?this.earth.metaInfo.name:(new Date).toString(),t=prompt("save to file (relative path `./examples/...`):",e);null==t||""===t?console.error("Cannot save to the file",t):this.earth.exportToServer(t),setTimeout(function(){document.dispatchEvent(new CustomEvent("deactive_tool"))},500)}},{key:"serviceWillStop",value:function(){console.log("save scene service will stop"),this.events.map(function(e){document.removeEventListener(e.name,e.handler,!1)})}}]),e}();t.default=o},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t){n(this,e),this.earth=t.earth,this.events=[{name:"mousemove",handler:this.handleMouseMove},{name:"mousedown",handler:this.handleMouseDown},{name:"mouseup",handler:this.handleMouseUp}]}return i(e,[{key:"serviceWillBegin",value:function(){console.log("cloud service will begin")}},{key:"serviceWillStop",value:function(){console.log("cloud service will stop")}},{key:"handleMouseMove",value:function(e){}},{key:"handleMouseDown",value:function(e){var t={x:e.clientX,y:e.clientY};console.log("down",t)}},{key:"handleMouseUp",value:function(e){var t={x:e.clientX,y:e.clientY};console.log("up",t)}}]),e}();t.default=o},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(10),a=function(){function e(t){n(this,e),this.earth=t.earth,this.addCameraPose=this.addCameraPose.bind(this),this.animateCamera=this.animateCamera.bind(this),this.playAnimation=this.playAnimation.bind(this),this.stopAnimation=this.stopAnimation.bind(this),this.setTimeInterval=this.setTimeInterval.bind(this),this.setSpeed=this.setSpeed.bind(this),this.setCurrentPose=this.setCurrentPose.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.captureScreen=this.captureScreen.bind(this),this.events=[{name:"mousedown",handler:this.handleMouseDown}],this.cameraPoses=[],this.screenShots=[],this.nextPose=0,this.animating=!1,this.timeInterval=5e3,this.speed=.1,this.imgwidth=200,this.imgheight=200,this.timeouts=[]}return i(e,[{key:"serviceWillBegin",value:function(){this.events.map(function(e){document.addEventListener(e.name,e.handler,!1)})}},{key:"serviceWillStop",value:function(){this.stopAnimation(),this.events.map(function(e){document.removeEventListener(e.name,e.handler,!1)}),this.cameraPoses=[],this.screenShots=[]}},{key:"handleMouseDown",value:function(e){if(0===e.button&&!this.mouseInPanel){var t=this.stopAnimation();this.targetPanel&&this.targetPanel.setState({animating:t})}}},{key:"setCurrentPose",value:function(e){e>=this.cameraPoses.length||(this.animating?(this.stopAnimation(),this.nextPose=e%this.cameraPoses.length,this.playAnimation()):this.earth.camera.flyTo(this.cameraPoses[e]))}},{key:"setTimeInterval",value:function(e){e<=0||(this.timeInterval=e)}},{key:"setSpeed",value:function(e){this.speed=e}},{key:"addCameraPose",value:function(){if(!this.animating){this.cameraPoses.push(this.earth.camera.pose);var e=this.captureScreen(this.imgwidth,this.imgheight);this.screenShots.push(e)}}},{key:"removeCameraPose",value:function(e){this.animating||e>=this.cameraPoses.length||(this.cameraPoses.splice(e,1),this.screenShots.splice(e,1))}},{key:"animateCamera",value:function(){this.animating&&this.cameraPoses.length>0&&this.nextPose<this.cameraPoses.length&&(this.earth.camera.flyTo(this.cameraPoses[this.nextPose],this.speed),this.nextPose=(this.nextPose+1)%this.cameraPoses.length,this.timeouts.push(setTimeout(this.animateCamera,this.timeInterval)))}},{key:"playAnimation",value:function(){return!this.animating&&this.cameraPoses.length>0&&(this.animating=!0,this.animateCamera()),this.animating}},{key:"stopAnimation",value:function(){return this.animating&&(this.animating=!1,this.timeouts.map(function(e){clearTimeout(e)}),this.timeouts=[],this.nextPose=0),this.animating}},{key:"captureScreen",value:function(e,t){var r=this.earth.earthView.renderer,n=this.earth.earthView.camera,i=this.earth.scene,a=r.getContext(),s=a.canvas.clientWidth,l=a.canvas.clientHeight,u=new o.WebGLRenderTarget(e,t,{minFilter:o.NearestFilter,magFilter:o.NearestFilter,format:o.RGBAFormat});r.setSize(e,t),n.aspect=e/t,n instanceof o.OrthographicCamera&&(n.right=n.top*n.aspect,n.left=-n.right),n.updateProjectionMatrix(),r.render(i,n,u,!0),r.setSize(s,l),n.aspect=s/l,n instanceof o.OrthographicCamera&&(n.right=n.top*n.aspect,n.left=-n.right),n.updateProjectionMatrix();var c=new Uint8Array(e*t*4);a.readPixels(0,0,e,t,a.RGBA,a.UNSIGNED_BYTE,c);var h,d,f;for(h=0;h<4*e;h+=4)for(d=0;d<Math.floor(t/2);d++){var p=e*d*4+h,m=[];for(f=0;f<4;f++)m[f]=c[p+f];var v=e*(t-d-1)*4+h;for(f=0;f<4;f++)c[p+f]=c[v+f],c[v+f]=m[f]}return c}}]),e}();t.default=a},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t){n(this,e),this.earth=t.earth,this.target=null,this.handleMarkerclick=this.handleMarkerclick.bind(this),this.events=[{name:"marker_click",handler:this.handleMarkerclick}],this.allowTypeList=["number","boolean","string"],this.blockNameList=["interactable","clickable"]}return o(e,[{key:"serviceWillBegin",value:function(){this.earth.markerLayer.children.map(function(e){e.clickable=!0,e.on("click",function(t){document.dispatchEvent(new CustomEvent("marker_click",{detail:{marker:e}}))})}),this.events.map(function(e){document.addEventListener(e.name,e.handler,!1)})}},{key:"serviceWillStop",value:function(){this.earth.markerLayer.children.map(function(e){e.clickable=!1}),this.events.map(function(e){document.removeEventListener(e.name,e.handler,!1)}),this.target=null}},{key:"handleMarkerclick",value:function(e){var t=this.target?this.target.ID:null,r=e.detail.marker?e.detail.marker.ID:null;null!==r&&t!==r&&(this.target=e.detail.marker,this.refresh&&this.refresh())}},{key:"readAllGetterAndSetter",value:function(e){var t=[],r=e,n=[];do{r=Object.getPrototypeOf(r),n=function(e){var t=[];return Object.getOwnPropertyNames(e).forEach(function(r){var n=Object.getOwnPropertyDescriptor(e,r);if("function"==typeof n.get){var i=n.set?n.set:null;t.push({getter:n.get,setter:i,name:r})}}),t}(r),1===n.length&&"__proto__"===n[0].name||t.splice(0,0,n)}while(1!==n.length||"__proto__"!==n[0].name);return t}},{key:"filterApis",value:function(e){for(var t=this,r=[],n=0;n<e.length;++n){var o=e[n],a=[];o&&function(){var e={};o.map(function(t){e[t.name]=t}),o.map(function(t){if(t.name.endsWith("Async")){var r=t.name.substring(0,t.name.length-5);e[r]=null}});var r=[];for(var n in e)null!==e[n]&&r.push(e[n]);for(var s=0;s<r.length;++s){for(var l=r[s],u=!1,c=0;c<t.blockNameList.length;++c)if(l.name===t.blockNameList[c]){u=!0;break}if(!u){for(var h=!1,d=void 0,f=t.target[l.name],p=0;p<t.allowTypeList.length;++p)(void 0===f?"undefined":i(f))===t.allowTypeList[p]&&(h=!0,d=t.allowTypeList[p]);if(!h&&"object"===(void 0===f?"undefined":i(f))){3===Object.keys(f).length&&(h=!0,d="ternaryobject")}if(h){var m=!!l.setter,v=l.name.endsWith("Async"),g=l.name;v&&(g=g.substring(0,g.length-5)),a.push({name:g,methodName:l.name,hasSetter:m,isAsync:v,type:d})}}}}(),r.push(a)}return r}}]),e}();t.default=a},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(10),a=function(){function e(t){n(this,e),this.earth=t.earth,this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.pointCloseEnough=this.pointCloseEnough.bind(this),this.addMeasurement=this.addMeasurement.bind(this),this.removeMeasurement=this.removeMeasurement.bind(this),this.completeMeasurement=this.completeMeasurement.bind(this),this.clearThisMeasurement=this.clearThisMeasurement.bind(this),this.get_altizureprojectmarker=this.get_altizureprojectmarker.bind(this),this.measurements=[],this.totalMeasurementsNumber=0,this.doingMeasurement=!1,this.events=[{name:"mousedown",handler:this.handleMouseDown},{name:"mouseup",handler:this.handleMouseUp},{name:"mousemove",handler:this.handleMouseMove},{name:"get_altizureprojectmarker",handler:this.get_altizureprojectmarker}],this.leftMouseCache={},this.stillHelperMarker=null,this.stillHelperMarkerOptions=null,this.markerOptions=null,this.theAltizureProjectMarker=null}return i(e,[{key:"serviceWillBegin",value:function(){this.earth.markerLayer.children.map(function(e){e.clickable=!0,e.on("click",function(t){document.dispatchEvent(new CustomEvent("get_altizureprojectmarker",{detail:{marker:e}}))})}),this.events.map(function(e){document.addEventListener(e.name,e.handler,!1)})}},{key:"serviceWillStop",value:function(){this.clearThisMeasurement(),this.earth.markerLayer.children.map(function(e){e.clickable=!1}),this.events.map(function(e){document.removeEventListener(e.name,e.handler,!1)})}},{key:"get_altizureprojectmarker",value:function(e){this.doingMeasurement&&(this.theAltizureProjectMarker||e.detail.marker instanceof o.AltizureProjectMarker&&(this.theAltizureProjectMarker=e.detail.marker))}},{key:"handleMouseDown",value:function(e){if(0===e.button&&this.doingMeasurement){var t={x:e.clientX,y:e.clientY},r=this.earth.pickOnProjects(e);r||(r=this.earth.pick(t)),0===e.button&&(this.leftMouseCache=r)}}},{key:"handleMouseUp",value:function(e){if(0===e.button&&this.doingMeasurement){var t={x:e.clientX,y:e.clientY},r=this.earth.pickOnProjects(e);if(r||(r=this.earth.pick(t)),0===e.button&&function(e,t,r,n){return(e-r)*(e-r)+(t-n)*(t-n)<1e-9}(this.leftMouseCache.lng,this.leftMouseCache.lat,r.lng,r.lat)&&(r=new o.LngLatAlt(r.lng,r.lat,r.alt),this.doingMeasurement&&(this.stillHelperMarker?this.stillHelperMarker.points.push(r):(this.stillHelperMarkerOptions.points=[r,r],this.stillHelperMarker=new o.PolyLineMarker(this.stillHelperMarkerOptions)),this.markerOptions.points.push(r),this.markerOptions.points.length>3&&this.pointCloseEnough(r,this.markerOptions.points[0])))){var n=this.markerOptions.points;n[n.length-1]=n[0],this.markerOptions.points=n,this.completeMeasurement()}}}},{key:"handleMouseMove",value:function(e){if(this.doingMeasurement&&this.stillHelperMarker){var t={x:e.clientX,y:e.clientY},r=this.earth.pickOnProjects(e);r||(r=this.earth.pick(t));var n=this.stillHelperMarker.points;this.pointCloseEnough(r,n[0])?(n[n.length-1]=n[0],this.stillHelperMarker.color="#FF0000"):(n[n.length-1]=r,this.stillHelperMarker.color="#FFFFFF"),this.stillHelperMarker.points=n,this.stillHelperMarker.update()}}},{key:"pointCloseEnough",value:function(e,t){return(t.lng-e.lng)*(t.lng-e.lng)+(t.lat-e.lat)*(t.lat-e.lat)<5e-10}},{key:"addMeasurement",value:function(){this.clearThisMeasurement(),this.doingMeasurement=!0,this.stillHelperMarkerOptions={points:[],earth:this.earth,scale:1,color:16777215,lineWidth:1,pointVisible:!1},this.markerOptions={points:[]}}},{key:"completeMeasurement",value:function(){var e=this,t={points:this.markerOptions.points,top:40,bottom:0,color:"#F10100",opacity:.1};this.markerOptions={volume:t,earth:this.earth};var r=new o.PolygonMarker(this.markerOptions);this.totalMeasurementsNumber+=1;var n={volume:"To be computed...",number:this.totalMeasurementsNumber,polygonMarker:r,altizureProjectMarker:this.theAltizureProjectMarker};this.measurements.push(n),this.clearThisMeasurement(),this.panel&&this.panel.setState({scrollToBottom:!0}),setTimeout(function(){var t=(new Date).getTime();n.volume=n.altizureProjectMarker.getRegionVolume(n.polygonMarker);var r=(new Date).getTime();console.log("[MeasureService] completeMeasurement compute time: ",r-t),e.panel&&e.panel.setState({scrollToBottom:!0});var i=(new Date).getTime();console.log("[MeasureService] completeMeasurement update time: ",i-r)},500)}},{key:"clearThisMeasurement",value:function(){this.doingMeasurement=!1,this.stillHelperMarker&&this.stillHelperMarker.destruct(),this.stillHelperMarker=null,this.stillHelperMarkerOptions=null,this.markerOptions=null,this.theAltizureProjectMarker=null}},{key:"removeMeasurement",value:function(e){var t=this.measurements[e];t&&(t.polygonMarker&&t.polygonMarker.destruct(),t.polygonMarker=null),this.measurements.splice(e,1)}}]),e}();t.default=a}]);